<!DOCTYPE html>
<html lang="en">
    <head>
	<meta name="generator" content="Hugo 0.95.0" />
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Milky板板の博客</title><meta name="Description" content="Milky板板"><meta property="og:title" content="Milky板板の博客" />
<meta property="og:description" content="Milky板板" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://uioqps.github.io/" /><meta property="og:image" content="https://uioqps.github.io/logo.png"/><meta property="og:site_name" content="Milky板板の博客" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://uioqps.github.io/logo.png"/>

<meta name="twitter:title" content="Milky板板の博客"/>
<meta name="twitter:description" content="Milky板板"/>
<meta name="application-name" content="Milky板板の博客">
<meta name="apple-mobile-web-app-title" content="Milky板板の博客"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://uioqps.github.io/" /><link rel="alternate" href="/index.xml" type="application/rss+xml" title="Milky板板の博客">
    <link rel="feed" href="/index.xml" type="application/rss+xml" title="Milky板板の博客"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https:\/\/uioqps.github.io\/","inLanguage": "en","author": {
                "@type": "Person",
                "name": "Milky"
            },"description": "Milky板板","image": {
                "@type": "ImageObject",
                "url": "https:\/\/uioqps.github.io\/images\/Apple-Devices-Preview.png",
                "width":  3200 ,
                "height":  2048 
            },"thumbnailUrl": "https:\/\/uioqps.github.io\/images\/screenshot.png","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","name": "Milky板板の博客"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Milky板板の博客"><span class="header-title-pre"><i class='fa-sharp fa-light fa-dolphin' aria-hidden='true'></i></span>Milky板板の博客</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/categories/documentation/"> Docs </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/uioQPS/" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Milky板板の博客"><span class="header-title-pre"><i class='fa-sharp fa-light fa-dolphin' aria-hidden='true'></i></span>Milky板板の博客</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/categories/documentation/" title="">Docs</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/uioQPS/" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="page home" data-home="posts"><div class="home-profile"><div class="home-avatar"><a href="/posts/" title="Posts"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/avatar.png"
        data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x"
        data-sizes="auto"
        alt="/images/avatar.png"
        title="/images/avatar.png" width="588" height="614" /></a></div><div class="home-subtitle"><div id="id-1" class="typeit"></div></div><div class="links"><a href="https://github.com/uioQPS" title="GitHub" target="_blank" rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden="true"></i></a><a href="https://www.instagram.com/shuang9958" title="Instagram" target="_blank" rel="noopener noreffer me"><i class="fab fa-instagram fa-fw" aria-hidden="true"></i></a><a href="https://t.me/Jibaro_S" title="Telegram" target="_blank" rel="noopener noreffer me"><i class="fab fa-telegram-plane fa-fw" aria-hidden="true"></i></a></div></div>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-11/">【bioinfo】-Q&A-「11」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第11题 使用cutadapt去除adapter Hello大家好！我们又见面了！
通过前面的生物信息学10个基础问题，我相信大家对测序的基本原理，FASTA与FASTQ格式以及FastQC的质控报告都有了一个清楚的认识。那么接下来，我们就要进一步学习，学习如何把原始的FASTQ测序结果一步一步的准备成可以用来比对（mapping）的质控过后的FASTQ。
我们知道，测序结果中可能会有若干条序列存在adapter的信息，而adapter的信息一般是不在基因组上存在的。所以，在比对之前如果不把adapter去干净，我相信你会得到1个非常非常低的mapping rate。
img
图1 RNA-Seq建库的结果，如果不去adapter接下来根本比对不上！
通常情况下，**我们都是使用cutadapt这个软件进行adapter（接头）序列的去除。cutadapt这个软件不但支持单端序列，还支持双端序列的切除，同时还支持gz格式的自动压缩与解压缩。**1个常用的切除命令类似：
1 2 3 4 5 6 7 8  # 在linux 命令行模式下 cutadapt -a ADAPTER_FWD -A ADAPTER_REV -o out.1.fastq -p out.2.fastq reads.1.fastq reads.2.fastq # -a是第1个文件的adapter序列 # -A是第2个文件的adapter序列 # -o是第1个输出文件 # -p是第2个输出文件 # reads.1.fastq 是第1个输入文件，也就是双端测序中的read-1 # reads.2.fastq 是第2个输入文件，也就是双端测序中的read-2   那么我们今天需要思考的问题，与切除adapter的具体内容有关。
1. cutadapt中-a/-A 参数与-g/-G参数分别代表什么意思？Illumina测序过程中，一般不会用到哪个参数？
1 2 3 4 5 6 7  -a 后⾯面跟⼀一段核苷酸序列列，代表单端测序中3&#39;端需要去掉的adapter; -A 代表双端测序中，read2的3&#39;端需要去掉的adapter; 注意:如果是双端测序数据，-a针对read1起作⽤用; -g 后⾯面也分别是⼀一段核苷酸序列列，代表单端测序中5&#39;端adapter序列列; -G 的⽤用法可以类⽐比-a/-A，是针对reads2的5&#39;端的adapter; 通常情况下，Illumina测序过程中5&#39;端不不会测出adapter序列列，所以-G/-g⼀一般不不会被⽤用到。   2.</div><div class="post-footer">
        <a href="/bioinfo-q-a-11/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/fastqc/">FastQC</a>,&nbsp;<a href="/tags/cutadapt/">cutadapt</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-10/">【bioinfo】-Q&A-「10」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第10题 读懂FastQC报告之adapter与kmer Hello大家好！
我们又见面了！今天是我们的FastQC中最后1次提问啦！今天，我们要聊得是adapter与kmer的问题。
我们在第5题 测序建库的adapter 的时候讨论过adapter的问题，我们知道adapter的最主要的作用是为了能够与flowcell连接，方便进行桥式PCR。那么我们的fastq文件中到底含不含adapter呢？FastQC报告就能告诉我们。
同时呢，我们今天还会讨论kmer的问题，相关的报告FastQC也会输出出来。
Part I adapter部分
img
图 1-1 1个正常的adapter报告
img
图 1-2 1个RNA-Seq的adapter报告
Part II kmer部分
img
图 2-1 正常的RNA-Seq建库kmer统计
img
图 2-2 加入random barcode的RNA-Seq建库kmer统计
img
图 2-3 kmer的统计显著性分析
关于adapter的问题： 1. Illumina的通用adapter序列是什么？图1-1与图1-2中的各种不同颜色的图例是什么意思？
1 2 3 4 5 6 7 8 9 10  Illumina Paired End Adapters(cannot be used for multiplexing) Top adapter 5&#39; ACACTCTTTCCCTACACGACGCTCTTCCGATC*T 3&#39; Bottom adapter 5&#39; P-GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG 3&#39; **来源** http://bioinformatics.cvr.ac.uk/blog/illumina-adapter-and-primer-sequences/ 不同颜色的图例代表不同的测序通用的adapter； 如果在当时fastqc分析的时候-a选项没有内容，则默认使用图例中的通用adapter序列进行统计。   2.</div><div class="post-footer">
        <a href="/bioinfo-q-a-10/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/fastqc/">FastQC</a>,&nbsp;<a href="/tags/adapter/">adapter</a>,&nbsp;<a href="/tags/kmer/">kmer</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-9/">【bioinfo】-Q&A-「9」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第9题 读懂FastQC报告中的duplicate问题 Hello大家好！
我们又见面了！本周我们预计会把前10个问题提出来，结束我们的测序原理与FastQC部分。
今天我们来详细聊聊duplicate问题。
duplicate的产生主要是因为Illumina建库的过程中，一般会需要使用PCR来帮助扩增插入序列的浓度。
在扩增的过程中，如果PCR扩增轮数过大，就会出现duplicate的问题，即产生一模一样的若干条序列。
FastQC中“Sequence Duplication Levels”图是用来刻画duplicate情况的。
img图1 duplicate结果图
那么我们今天的问题如下：
1. 图1中的横坐标是什么意思，纵坐标是什么意思？
横坐标代表序列重复水平，纵坐标代表重复水平序列占所有序列的百分比
2. 图1中的红线和蓝线分别代表什么意思？
红线：代表去duplicate之后序列理论重复性分布（服从possion distribution或者binomial distribution）情况
蓝线：代表全部的序列重复性分布情况
3. 图1中的duplicate是全部序列的duplicate的情况吗？还是随机筛选了一部分？为什么要这样做？
是选择的每一个文件里面前100, 000条序列作为样本进行的计算，因为样本本身很大，前100, 000已经能够代表样本的重复性。
4. 如果让你写程序，判断1个fastq文件中duplicate的比例，你的大概思路是什么？
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  # Python风格的伪代码 # 第1步，对序列进行排序 sort the FASTQ file by the sequence, and names as sorted_file; # 第2步，对排序的序列统计是否为duplicate total_num = 1 duplication_num = 0 reads_1 = sorted_file.</div><div class="post-footer">
        <a href="/bioinfo-q-a-9/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/fastqc/">FastQC</a>,&nbsp;<a href="/tags/duplicate/">duplicate</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-8/">【bioinfo】-Q&A-「8」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第8题 读懂FastQC报告 Part III Hello 大家好！ 我们又见面了！
最近总搞FastQC报告的研读，是不是都看烦了？没关系，我们再搞最后2次，就进入下一个主题啦！昨天的问题中，我们告诉大家FastQC的报告中最重要的几张图都在下面用红框框出来了。今天我们来研读2张图。
img
第1张图是：Per sequence GC content
img
图1-1 human 全基因组测序FastQC 结果图
img
图1-2 human 全基因组测序FastQC 结果图
第2张图是：Sequence Length Distribution
img
图2-1 刚下机以后的fastq数据进行FastQC 结果图
相关的问题与思考：
1. 图1-1 与 图1-2 中的横坐标是什么意思？ 纵坐标是什么意思？
横轴是0-100%；纵轴是拥有相对GC含量的序列所对应的数量
2. 图1-1中是human全基因组测序，结合昨天的问题，那么peak的中间大约应该在多少？
上一次的问题中GC总体比例大约在42%左右，所以如果这是human全基因组测序，那么peak在横坐标对应42的位置比较好
3. 图1-2与图1-1有哪些显著的不同？造成这些不同的原因有可能是什么？遇到这个问题，我们通常应该做些什么？
图1-1有一个peak，并且与热力学理论值（蓝线）基本吻合 图1-2有两个peak，并且其中一个peak与蓝线相差很多，当红色的线出现双峰，基本上是混入了其他物种的DNA序列
遇到这个问题，首先进行mapping，统计有多大比例reads map到了目标参考基因组上，如果比例非常低说明污染严重，数据不可用
如果大部分reads都map成功，剩余一部分可以通过blast检查是混入了哪些污染物，过滤掉这些reads就可以，不影响后续的分析
4. 图2-1的横坐标是什么意思？纵坐标是什么意思？
横坐标代表序列长度，纵坐标代表长度为某一bp的序列所对应的数量
5. 图2-1是刚下机的fastq数据进行FastQC 结果图，有什么特点？为什么会出现这样的结果？如果对刚下机的fastq数据进行cut adapter，图2-1还会是这样的结果吗？为什么？
测序仪成功下机的数据都是整齐的一定长度的序列，比如最常用的illumina X Ten 是双端150bp；
测序过程当中产生的不足150bp的序列在下机时已经被过滤掉了；
如果进行cut adapter，序列的长度将不一致，因为reads中包含信息的insert的长度并不完全一致，150bp的测序长度是否已经包含了adapter的序列是未知的，因此cut adapter之后的reads长度不同
（这里应该说的是3’ adapter）
能力扩展题： 请想办法，计算Human genome 19（hg19）每一条染色体的GC含量。
1 2 3 4 5 6 7 8 9  # 思路1 - UCSC或者Emble下载Human genome 19（hg19）染色体序列； - 直接把下载的序列使用FASTQQC检测序列“质量” - report中Sequence content across all bases会显示GC结果 # 思路2 - UCSC或Emble下载Human genome 19（hg19）染色体序列； - 写Python程序一次读取序列内容； - 统计每一条染色体的GC含量； - 具体的代码及方法可以参考知乎Live   </div><div class="post-footer">
        <a href="/bioinfo-q-a-8/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/fastqc/">FastQC</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-7/">【bioinfo】-Q&A-「7」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">读懂FastQC报告 Part II Hello 大家好！
今天我们接着昨天的话题来继续进行与FastQC结果有关的提问。
我们昨天主要是针对FastQC结果中的boxplot进行了相关的探索，boxplot一般是认为FastQC几张必看的质控图之一。一般情况下FastQC的结果会包含下面几个图，而我们主要会看下图圈出来的几个。
img
接下来的几天我们就把这些图来一个一个讨论清楚。
我们昨天讨论了“Per base sequence quality”，今天先来讨论 “Per base sequence content”
img图1
img图2
问题：
1. 图1与图2中横坐标是什么意思？纵坐标是什么意思？
横轴代表1到150bp；纵轴代表ATCG在该bp的百分比
2. 图1是1个正常的DNA 全基因组测序结果，为什么前面的几bp线是波动的？后面的线是平衡的？
根据Wason-Crick配对原则，A和T应该相等，G和C应该相等
但是一般测序的时候，刚开始测序仪状态不稳定，很可能出现不平衡的情况
像这种情况
如果测序的得分很高，可以不进行trim开始部分的序列信息
如果测序得分很低，需要进行trim开始部分的序列信息
3. 图2是1个特殊RNA建库的测序结果，4条线出现波动更可能是什么原因造成的？
RNA是单链核苷酸，GC或AT的含量并没有直接的关系
4条线的波动是由于模板中ATCG的量不同导致的（就是所谓GC不平衡）
4. 在图1中你能不能看出一个恒定的量？（提示，同一物种间相同，不同物种间一般不同）如果能看出来，这个量是什么？数值大约是多少？ GC含量在同一物种中是一个恒定值。
图1中GC总体比例大约在42%（目测）</div><div class="post-footer">
        <a href="/bioinfo-q-a-7/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/fastq/">fastq</a>,&nbsp;<a href="/tags/qc/">QC</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-6/">【bioinfo】-Q&A-「6」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">读懂FastQC报告 Part I Hello 大家好！
通过前面的5个问题，我相信大家对Illumina测序，测序的储存文件格式，一些简单的建库原理已经有了一个初步的认识。那么接下来，我们就要用我们学到的知识去解决一些问题啦。
在实际操作和处理过程中，我们拿到的Illumina测序数据应该是.fastq.gz格式，其中gz表示的是使用gzip进行压缩，fastq表示使用fastq格式进行存储。获得数据的第一步，通常就是使用FastQC软件进行质控。
FastQC会对每一个输入的fastq.gz文件生成1个html网页和一个zip的压缩包。压缩包里是网页中包含的图片信息，因此我们只需要看网页里面整理好的内容就好。
今天的问题围绕着FastQC的质控图来展开，请看下面2张图。
img
图1 - 1个Illumina测序结果， reads1 的 per-base quality boxplot
img
图2 - 1个Illumina测序结果， reads2 的 per-base quality boxplot
问题如下：
  图中的横坐标表示什么意思？  横轴是测序序列的第1个碱基到第150个碱基
图中的纵坐标表示什么意思？  总左边表示每一bp所对应的测序质量值
前面讲过将该碱基判断错误概率值P取log10之后再乘以-10
得到的结果再加上Phred值对应ASCII表所得到的的值就是该碱基测序的质量值
Q = -10*log10(error P)
即20表示1%的错误率，30表示0.1%的错误率
 图中的蓝色线是什么意思？  蓝色的细线是各个位置的质量值的平均值的连线
图中的box 下面的bar ， 上面的bar，箱体的下沿，箱体的上沿，箱体内部的横线分别代表什么意思？  每1个boxplot，都是该位置的所有序列的测序质量的一个统计
上面的bar是90%分位数
下面的bar是10%分位数
箱子的中间的横线是50%分位数
箱体上缘是75%分位数
箱体下缘是25%分位数
分位数解释：
​ 如果一组数的25%分位数是a，意味着a超过了这组数中25%数字的大小
 图1与图2最主要的区别在哪里？结合我们之前的问题，为什么会出现这种情况？  相比于reads 1的测序结果，reads 2的测序质量均匀性差，准确率低
主要原因： reads 2 的测序是在 reads 1 150 bp 测序完成后 forward strands再通过1次桥式PCR合成reverse strands 这之后再进行荧光测序 测序质量差的主要原因是因为长时间测序结束后，合成酶的活性降低，导致合成时加不上一些碱基，最终同步性变差，主要属于phasing错误.</div><div class="post-footer">
        <a href="/bioinfo-q-a-6/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/fastq/">fastq</a>,&nbsp;<a href="/tags/qc/">QC</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-5/">【bioinfo】-Q&A-「5」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">测序建库的adapter Hello大家好！
上周我们已经把Illumina测序的基础内容基本搞清了，那么本周的问题我们主要是为围绕着测序后续的质控与建库细节来进行。
今天我们提出的问题是Illumina目前常用的双端测序建库办法中，会在打断的序列前后加上adapter，请问：
  adapter是什么意思？adapter与primer有什么区别？  adapter在中文是适配器或者接口的意思，在前面的内容中已经提到将测序序列打碎成片断后要将末端补平然后添加adapter，用于与flowcell上的oligo匹配固定并为后续桥式PCR做准备，而前面提到的Index与adapter之间的位置关系一般为adapter1-Index-fragment-adapter2，adapter2通过与oligo互补连接在flowcell上，在进行完桥式PCR之后进行测序时，添加primer，这一段primer的序列是与Index互补的而非adapter1，所以最终拿到的测序结果应该是Index+fragment+adapter2或者Index+部分fragment
 比如最终的测序结果是 AATTCCGGATCGATCG…，那么adapter的序列可能出现在哪一端，还是两端都有可能出现？为什么？  一般出现在3’端，在上面第1题中已经说到，最终的测序结果应该是Index+fragment+adapter2或者Index+部分fragment，也就是说测序的方向是从5’到3’，adapter只可能出现在3’端。
 参考资料：
a) 加adapter的示意图 b) Illumina测序视频 生物信息学100个基础问题 —— 第3题 Illumina测序技术细节探究</div><div class="post-footer">
        <a href="/bioinfo-q-a-5/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/adapter/">adapter</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-4/">【bioinfo】-Q&A-「4」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">Illumina测序技术细节探究 II 我们接着第2个问题，第3个问题接着问。既然我们已经知道的Illumina测序的基本概念，基本过程；也知道了Illumina测序的主要特点。那么还是要有个细节的探索。
  Illumina目前主流的测序仪都有哪几种型号？各自大概的通量是多少？（也就是1个run能跑出多少数据）  目前主流的测序仪及其通量主要是Hiseq2500（50-1000Gb）、Hiseq3000（125-750Gb）、Hiseq4000（125-1500Gb）、Hiseq X Five（900-1800Gb）和Hiseq X Ten（900-1800Gb）
 Illumina目前的测序技术，最核心的就是边合成边测序，即我们常说的 Sequencing by synthesis （SBS），那么为什么能够实现SBS？  经过桥式PCR之后同一段序列已经成簇，下一段就是开始进行测序，这一步比较简单，就是加入primer，然后添加经过特殊处理的ATCG四种碱基，特殊的地方有两点：一个是碱基部分加入了荧光基团，可以激发出不同的颜色，另一个是脱氧核糖3号位加入了叠氮基团而不是常规的羟基，这个叠氮集团保证了每次只能够在序列上添加1个碱基.
这样每1轮测序，保证只有1个碱基加入的当前测序链。这时候测序仪会发出激发光，并扫描荧光。因为一个cluster中所有的序列是一样的，所以理论上，这时候cluster中发出的荧光应该颜色一致。随后加入试剂，将脱氧核糖3号位的—N2改变成—OH，然后切掉部分荧光基团，使其在下一轮反应中，不再发出荧光。如此往复，就可以测出序列的内容。  我们在第1问中，问了大家一个问题“Illumina测序技术为什么不能像第1代测序技术一样测500bp以上？”，这里面主要涉及到两种错误，一种叫phasing，一种叫pre-phasing，分别是什么意思？  通俗来讲phasing表示本来同步添加的碱基有一些没加上，而pre-phasing则是加多了，都会导致当前bp的荧光检测出现噪音，造成phasing的主要原因是合成酶的活性降低，而pre-phasing则可能是叠氮基团性质不稳定，转化为羟基在一步检测中添加了不止一个碱基。
reference: Diagnosing problems with phasing and pre-phasing on Illumina platforms
 </div><div class="post-footer">
        <a href="/bioinfo-q-a-4/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/illumina/">illumina</a>,&nbsp;<a href="/tags/sbs/">SBS</a>,&nbsp;<a href="/tags/phase-correct/">phase correct</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-3/">【bioinfo】-Q&A-「3」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">Illumina测序技术细节探究 目前我们最常使用的就是Illumina公司的测序技术，Illumina公司的测序技术最明显的几个特点是：价格低，通量高，测序读长短。那么我们今天的问题，就是围绕Illumina测序技术的细节来提问的。
  什么是Illumina测序adapter？同一批上机的adapter序列一样吗？它的作用是什么？  adapter的中文意思为适配器或者接口，在illumina测序过程中关键一步是将文库片段固定在flowcell上，然后通过桥式PCR将片段扩增，在被打断成300~500bp的长度的片段末端被补平后adaptor将被添加到片段两端，一方面用于将片段固定在flowcell上，同时adaptor中还包含桥式PCR所需要的引物  一个完整的Illumina测序过程是那几步？  完整的测序过程仅包含两步，第一是桥式PCR扩增，第二是以4色荧光可逆终止反应为核心技术的测序；
 什么是桥式PCR技术？为什么要进行桥式PCR？ 加上adaptor之后的DNA样品与flowcell上固定的oligo（寡链核苷酸）匹配后就被固定在flowcell上，通过桥式PCR进行扩增成cluster,便于后面的荧光测序，主要步骤为：   进行第一轮扩增，将序列补成双链。加入NaOH强碱性溶液破坏DNA的双链，并洗脱。由于最开始的序列是使用化学键连接的，所以不会被洗。 加入缓冲溶液，这时候序列自由端的部分就会和旁边的oligo进行匹配 进行一轮PCR，在PCR的过程中，序列是弯成桥状，所以叫桥式PCR，一轮桥式PCR可以使得序列扩增1倍 如此循环下去，就会得到一个具有完全相同序列的cluster
 我们都说，测序结果会包含index，那么index是什么？有什么作用？  一条lane能测得的数据量在30G左右，而一个样品的测序量一般不会这么大，所以在建库的时候对每一种样品的接头加上不同的标签序列，这个标签就叫做Index，有了index就可以同时在一个lane中测多种数据了，后期可以根据index将数据分开；  我们所说的flowcell，lane，tile都是什么意思？  flowcell 是指Illumina测序时，测序反应发生的位置，1个flowcell含有8条lane lane 每一个flowcell上都有8条泳道，用于测序反应，可以添加试剂，洗脱等等 tile 每一次测序荧光扫描的最小单位  Illumina测序结果质量表示方法采用的是Phred33还是Phred64？ 最新的测序质量结果一般都为Phred33，但是早期的测序数据可能出现Phred64。   </div><div class="post-footer">
        <a href="/bioinfo-q-a-3/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/illumina/">illumina</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-2/">【bioinfo】-Q&A-「2」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">测序技术初探 现在我们实验室或者公司常用第1代测序与第2代测序，那么：
  第1代测序 sanger 测序法的原理是什么？通量比较低的核心原因是什么？  sanger法测序及双脱氧链终止法，它采取DNA复制原理，通过在DNA复制过程中添加双脱氧三磷酸核苷酸（ddNTP）终止DNA链的延伸，在DNA链不同位置的延伸终止判断该位置的碱基类型。但是凝胶电泳的时间较长，导致sanger法测序通量低。
 作为2006年正式发布的illumina测序技术，或者称为第2代测序技术的代表性技术，其最大的特点是什么？  高通量，成本低，但测序长度较短。
 Illumina测序技术的核心是什么？  核心内容有两个，一个是桥式PCR，主要用于扩大信号；另一个是4色荧光可逆终止反应，使illumina测序可以实现边合成边测序的技术。
 Illumina测序技术为什么不能像第1代测序技术一样测500bp以上？  主要的原因有两个，一方面测序时，经过长时间的PCR，会有不同步的情况。比如一开始1个cluster中是100个完全一样的DNA链，但是经过1轮增加碱基，其中99个都加入了1个碱基，显示了红色，另外1个没有加入碱基，不显示颜色。这时候整体为红色，我们可以顺利得到结果。随后，在第2轮再加入碱基进行合成的时候，之前没有加入的加入了1个碱基显示红色，剩下的99个显示绿色，这个时候就会出现杂信号。当测序长度不断延长，这个杂信号会越来越多，最后很有可能出现50个红，50个绿色，这时信号不足以判断碱基类型；第二就是测序过程中合成酶的活性越来越不稳定，后面碱基添加出现问题。
 </div><div class="post-footer">
        <a href="/bioinfo-q-a-2/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/illumina/">illumina</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-1/">【bioinfo】-Q&A-「1」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-16">2020-02-16</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">FASTA 与 FASTQ格式详解  写在最前面的话：
为什么第2篇要写fastq和fasta这两种储存sequence的格式呢？主要是因为这两种数据储存格式是我们后续分析主要处理的两种数据格式。无论是后面的双序列比对（pairwise alignment）还是进化树构建（phylogenetic tree）亦或是高通量分析的回贴（mapping）数据的原始输入都是这两种格式。所以，为了后面更复杂的一些算法软件，我们就得先打好基础喽，Let’s go ！
 FASTA 概述一下，fasta格式是一种非常简单的储存序列的格式，可以储存核酸序列（DNA/RNA）也可以储存蛋白质的氨基酸序列（Amino Acid sequence，简称AA序列），主要分成2个部分。
 是以“&gt;”为开始的一行主要储存的是序列的描述信息； 剩下的是序列部分，中间，前后都可以有空格。序列部分按照官方文档的说明应该是小于120就行，一般70到80左右。 其实实际操作中，程序处理的时候都是自动去掉空格和换行符，把序列读成1行再处理，所以，我也干过把整条人类染色体都放到一行的233举动，这么算下来，一行可以有240*10E6这么长！~~~ 举一个栗子！  AA序列 1 2 3 4  &gt;sp|P69905|HBA_HUMAN Hemoglobin subunit alpha OS=Homo sapiens GN=HBA1 MVLSPADKTNVKAAWGKVGAHAGEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHG KKVADALTNAVAHVDDMPNALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTP AVHASLDKFLASVSTVLTSKYR   这个例子是从UniRef数据库中下载的人类血红蛋白α亚基的序列。我们先看第1行：
1  &gt;sp|P69905|HBA_HUMAN Hemoglobin subunit alpha OS=Homo sapiens GN=HBA1   这一行中，
 P69905是这个序列在UniRef中的编号 HBA_HUMAN是这个序列的简称，Hemoglobin subunit alpha是全称 OS=Homo sapiens是物种 GN=HBA1是指基因的名字为HBA1. 后面的内容就是这个HBA1基因对应的蛋白的序列。其实根据官方文档，氨基酸都是用单字母表示，对应表如下：  1 2 3 4 5 6 7 8 9 10 11 12 13  A alanine P proline B aspartate/asparagine Q glutamine C cystine R arginine D aspartate S serine E glutamate T threonine F phenylalanine U selenocysteine G glycine V valine H histidine W tryptophan I isoleucine Y tyrosine K lysine Z glutamate/glutamine L leucine X any M methionine * translation stop N asparagine - gap of indeterminate length   核酸序列 为了方便大家理解，我们继续使用人类血红蛋白a亚基对应的mRNA序列，这个序列是从NCBI RefSeq数据库中下载的。</div><div class="post-footer">
        <a href="/bioinfo-q-a-1/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/fasta/">fasta</a>,&nbsp;<a href="/tags/fastq/">fastq</a>,&nbsp;<a href="/tags/ngs/">ngs</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/greedy-algorithm/"></a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="0001-01-01">0001-01-01</time></span></div><div class="content">From local optima to global optima Distribution problem 455.Assign Cookies (Easy)
1 2 3 4 5 6 7 8 9 10 11 12  int findContentChildren(vector&lt;int&gt;&amp; children, vector&lt;int&gt;&amp; cookies) { sort(children.begin(), children.end()); sort(cookies.begin(), cookies.end()); int child = 0, cookie = 0; while (child &lt; children.size() &amp;&amp; cookie &lt; cookies.size()) { if (children[child] &lt;= cookies[cookie]) ++child; ++cookie; } return child; }   You need to sort two vector from small to large.</div><div class="post-footer">
        <a href="/greedy-algorithm/">Read More</a></div>
</article><ul class="pagination"><li class="page-item ">
                    <span class="page-link">
                        <a href="/">1</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link" aria-hidden="true">&hellip;</span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/8/">8</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/9/">9</a>
                    </span>
                </li><li class="page-item active">
                    <span class="page-link">
                        <a href="/page/10/">10</a>
                    </span>
                </li></ul></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/uioQPS/" target="_blank">Milky</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"data":{"id-1":"A bioinformatics/programming learning recording website."},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
