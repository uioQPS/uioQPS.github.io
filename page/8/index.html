<!DOCTYPE html>
<html lang="en">
    <head>
	<meta name="generator" content="Hugo 0.95.0" />
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Milky板板の博客</title><meta name="Description" content="Milky板板"><meta property="og:title" content="Milky板板の博客" />
<meta property="og:description" content="Milky板板" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://uioqps.github.io/" /><meta property="og:image" content="https://uioqps.github.io/logo.png"/><meta property="og:site_name" content="Milky板板の博客" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://uioqps.github.io/logo.png"/>

<meta name="twitter:title" content="Milky板板の博客"/>
<meta name="twitter:description" content="Milky板板"/>
<meta name="application-name" content="Milky板板の博客">
<meta name="apple-mobile-web-app-title" content="Milky板板の博客"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://uioqps.github.io/" /><link rel="alternate" href="/index.xml" type="application/rss+xml" title="Milky板板の博客">
    <link rel="feed" href="/index.xml" type="application/rss+xml" title="Milky板板の博客"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https:\/\/uioqps.github.io\/","inLanguage": "en","author": {
                "@type": "Person",
                "name": "Milky"
            },"description": "Milky板板","image": {
                "@type": "ImageObject",
                "url": "https:\/\/uioqps.github.io\/images\/Apple-Devices-Preview.png",
                "width":  3200 ,
                "height":  2048 
            },"thumbnailUrl": "https:\/\/uioqps.github.io\/images\/screenshot.png","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","name": "Milky板板の博客"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Milky板板の博客"><span class="header-title-pre"><i class='fa-sharp fa-light fa-dolphin' aria-hidden='true'></i></span>Milky板板の博客</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/categories/documentation/"> Docs </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/uioQPS/" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Milky板板の博客"><span class="header-title-pre"><i class='fa-sharp fa-light fa-dolphin' aria-hidden='true'></i></span>Milky板板の博客</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/categories/documentation/" title="">Docs</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/uioQPS/" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="page home" data-home="posts"><div class="home-profile"><div class="home-avatar"><a href="/posts/" title="Posts"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/avatar.png"
        data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x"
        data-sizes="auto"
        alt="/images/avatar.png"
        title="/images/avatar.png" width="588" height="614" /></a></div><div class="home-subtitle"><div id="id-1" class="typeit"></div></div><div class="links"><a href="https://github.com/uioQPS" title="GitHub" target="_blank" rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden="true"></i></a><a href="https://www.instagram.com/shuang9958" title="Instagram" target="_blank" rel="noopener noreffer me"><i class="fab fa-instagram fa-fw" aria-hidden="true"></i></a><a href="https://t.me/Jibaro_S" title="Telegram" target="_blank" rel="noopener noreffer me"><i class="fab fa-telegram-plane fa-fw" aria-hidden="true"></i></a></div></div>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-35/">【bioinfo】-Q&A-35</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-19">2020-02-19</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第35题 RNA-Seq 数据的定量之RPKM和FPKM Hello大家好！好久不见了！
根据之前的规划，我们将用接下来的几期问题来探索一下RNA-Seq定量的问题，也就是要探索一下我们常说的RPKM，FPKM，TPM，raw count 和RSEM，前面4个指标都比较直观，方便理解，最后一个RSEM需要涉及到一些机器学习的知识，我们尽量给大家把比较复杂的问题简单化，方便大家的入门。
RNA-Seq定量过程中的比较问题 RNA-Seq的基本假设是什么？简单来说就是 细胞/组织/个体 的两种不同状态进行比较，比较的目的就是寻找差异表达gene，然后从差异表达gene来推断造成生理状态不同的原因。
而我们的RNA-Seq一般情况下是针对mRNA以及带polyA的lncRNA进行建库测序分析的。那么理论上把测序的FASTQ文件mapping到参考基因组上，再结合参考基因组的GTF/GFF文件就可以找到全基因组的每一个gene上mapping到了多少个reads count。
拿到了reads count以后，我们就会尝试着想要比较gene之间的表达量的关系，但是这时候往往会面临两个问题，举个例子：
 问题1: 比如我有gene3，有1000条测序reads，gene4有2000条测序reads，那么我能否说gene4就一定比gene3的表达量高？（图1 gene3 与 gene4） 问题2: 比如我有gene1，有1000条测序reads，我的另一个处理条件下gene2有2000条测序reads，我能否就说geneA在处理条件下表达量降低了？（图1 gene1与gene2）  在面临这些比较问题的时候，我们就需要对mapping到gene的reads count进行矫正，至少根据问题1我们知道应该在矫正的时候考虑过gene长度的问题；根据问题2，我们大概应该能够猜想到，矫正的时候应该需要考虑整体测序量的问题。到此，RPKM和FPKM这两个指标就应运而生了。
图1 ( Manuel Garber et al., Nature Methods, 2011 )
什么是RPKM与FPKM？ RPKM = Reads Per Kilobase per Million mapped reads
假设回贴到geneA 的 reads count为 CountA，geneA的exon总长度为Len(A) Kbp，总的测序量为D兆reads，那么：
1  geneA RPKM = CountA / Len(A) / D * 10^9   那么什么是FPKM呢？先来看一下FPKM的定义：
FPKM = Fragments Per Kilobase per Million mapped reads</div><div class="post-footer">
        <a href="/bioinfo-q-a-35/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/rna-seq/">RNA-seq</a>,&nbsp;<a href="/tags/rpkm/">RPKM</a>,&nbsp;<a href="/tags/fpkm/">FPKM</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-34/">【bioinfo】-Q&A-34</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-19">2020-02-19</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第34题 做RNA-Seq的数据分析逻辑是怎样的？ Hello 大家好！我们又见面了！
为什么要做RNA-Seq？ 先来谈谈为什么要做RNA-Seq。假设我们没有RNA-Seq技术，当我们看到经过某1个条件/刺激/处理以后，我们的研究对象，细胞，植株，亦或是可爱的小白鼠有了一些变化。这个时候我们通过观察和实验得到了1个判断：
1  当对A进行B刺激的时候会出现表型C。   当有了这个判断以后，正常的推理思路是，表型的出现很大可能是由于研究对象的蛋白含量的变化引起的。而蛋白的含量最直接的控制就来自于gene表达的变化。如果我们能够有办法测量A在进行B刺激以后全部的gene表达变化的gene list D，理应能够得到下一个判断：
1  当对A进行B刺激的时候会出现表型C，而这个表型C造成的原因很有可能是来自于D这些基因的变化。   但是这里有个问题，这个刺激需要是一种比较稳定的条件，比如对细胞系进行稳定敲除（knock out）一个gene；再比对用药物持续对植株进行喷洒等等。而不能是，我向细胞盘吐了口唾液，然后立即建库去测RNA-Seq。这是因此，我们在推断表型C造成的原因的时候，认为是gene的表达造成的，而从信号响应，到最终的gene表达的变化是需要时间的。因此，刺激以后，过一段时间以后才会出现变化，一般这个时间间隔是以小时为单位计算的。
因此，当我们认为表型C和刺激B之间是由于gene list D影响的，那么我们就要做RNA-Seq。
为什么能做RNA-Seq？ 那么，我们为什么能做RNA-Seq？貌似是一个很简单的问题，其实不然，这是几十年技术的积累。让RNA-Seq能够走进“寻常百姓家“的原因有很多，能轻而易举想到的：测序费用的降低；基因组的公布/相关物种基因组的公布；分子生物学技术的成熟等等。
想象一下，如果有一天我们突然不能做RNA-Seq了，那么我们再去想做我们判断的检验就可要1个gene挨着1个gene的去做qRT-PCR了！或者是做价格和准确不不如测序的micro array检测。
拿到数据以后我们应该做点什么？ 还是回到我们之前的判断：
 当对A进行B刺激的时候会出现表型C，而这个表型C造成的原因很有可能是来自于D这些基因的变化  核心问题是找到这个gene list D，而这个问题的本质就是去寻找对A进行B刺激前后的差异。那么差异又可以分成几个方向去寻找：
1 2 3 4  方向1. 表达量的差异； 方向2. 可变剪切的差异； 方向3. 修饰的差异； 方向4. 其他可能存在调控机制的差异；   针对不同的方向去寻找差异，方法也是不同的，比如方向1,2,3的分析方法就有非常大的不同。而选定方向以后，寻找差异的思路又可以扩展开：
1 2 3 4  1. 差异与whole genome相比是否有一定的分布倾向性？ 2. 差异是个例还是具有普遍性？（更换细胞系是否能重复？） 3. 差异与表型是否有统计学相关性？ ... ...   当我们确定了方向与寻找差异思路以后，最后一步就是去展示分析结果，说直白些就是数据可视化。好的图表可以让人一眼就看出差异所在，不用文字就知道作者要表达的意思。数据可视化这方面，有非常多的工具可以使用比如R就非常方便。</div><div class="post-footer">
        <a href="/bioinfo-q-a-34/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/rna-seq/">RNA-seq</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-33/">【bioinfo】-Q&A-33</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-19">2020-02-19</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第33题 什么是链特异性的RNA-Seq？ Hello 大家好！我们又见面了。
最近，我们一直在围绕着RNA-Seq的相关技术在进行讨论，我们聊过了polyA+与rRNA-的建库策略问题，我们也聊过了测序深度与测序仪通量的问题，那么今天我们来聊一下链特异性RNA-Seq的建库问题。
1.什么是链特异性建库与链非特异性建库RNA-Seq 图1-1 链特异性建库与非特异性建库示意图 （Zhao et al., BMC Genomics，2015）
在RNA-Seq建库的时候，第一步都是进行RNA到cDNA的反转录，在反转录以后，普通的RNA-Seq就直接使用random primer进行第2条链合成，随后加adapter。这样构建出来的RNA-Seq库进行测序以后是分不清这个序列是来自于genome的那条链的，因为被测序的有可能是gene的foward strand 也有可能是reverse strand。
而链特异性的RNA-Seq建库是通过一定的建库策略，让RNA在反转录和加adapter的过程以后还能够保存链的信息的建库策略。如图1-2所示，红色的reads表示mapping到了genome的foward strand，蓝色的reads表示mapping到了genome的reverse strand。对于这个gene来说，它本身存在于foward strand，链特意建库的F图就完全能够说明这个现象；但是G图是普通的RNA-Seq建库，也就是不区分链的信息，因此在这个foward strand gene附近的reads有mapping到foward strand的，也有mapping到reverse strand的情况。
图1-2 F为链特异性建库，G为非特异性建库（Dmitri Parkhomchuk et al., NAR, 2009）
2.链特异性建库的优势与劣势 那么链特异性RNA-Seq的优势在于哪里呢？是在于它能够处理一些gene overlap比较复杂的情况。我们都知道，几乎所有高等生物的gene在genome中的分布都是非均匀的，而且一般都是没有链的偏好性。换句话说，两个gene重叠，一个在foward strand，一个在reverse strand是很常见的显现，如图2-1所示。
图2-1 genome两条链都存在gene的情况（Joshua Z Levin et al., Nature Methods, 2010）
如果是普通的RNA-Seq，是分不清这些overlap区域的reads到底来自于哪一个gene，这就给定表达量带来了非常大的麻烦。但是链特异性的RNA-Seq就不会，如果只是foward strand的gene表达那么reads就只会mapping到对应的链上。
所以，用链特异性的建库方法，是能够更加准确进行gene定量的。
至于链特异性建库的劣势，大概有2点吧：1个是贵，1个是操作复杂对于珍贵样品（比如人体组织样品）一旦建库不成功就game over了。
3.链特异性建库的方法有几种，最常用的是哪种? 至于链特异性的建库方法，现在有若干种，但是最常用的其实是2种，1种是RNA ligation methods；1种是dUTP method。
3.1 RNA ligation method 图3-1 RNA ligation methods（Joshua Z Levin et al., Nature Methods, 2010）</div><div class="post-footer">
        <a href="/bioinfo-q-a-33/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/rna-seq/">RNA-seq</a>,&nbsp;<a href="/tags/aq100/">AQ100</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-32/">【bioinfo】-Q&A-32</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-19">2020-02-19</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第32题 1个RNA-Seq样本到底要测多少序列？ 我们讨论了到底选择哪种策略进行建库，主要就是polyA + 和 rRNA-这两种方式。在选定建库策略以后，我们自然会问一个问题，如果我们去做RNA-Seq每个重复到底要测多少测序量呢？
先聊聊测序价格 我们这里讨论的问题，都是以Illumina公司的二代测序为准。目前市面上公司能够提供测序服务的，大多数是Illumina的HiSeq平台，HiSeq X平台，NextSeq平台以及通量最高的NovaSeq平台。以上这些平台，在平时实验中我们都是进行双端150bp的测序模式，也就是我们常说的paired-end 150bp，所以一对reads的通量是150bp X 2 = 300bp
注：下问中提到所有测序仪参数全部来自于Illumina官网！
1.1 HiSeq系列 HiSeq系列的参数如图1-1所示，最常用的是HiSeq2500与HiSeq4000。HiSeq系列目前已经逐渐被边缘化或者是定制化，主要是用来做定制测序双端 250 bp的测序，或者单端50bp的测序。根据定制的模式不同，价格也不同。平均下来，价格大约是100~ 120 RMB / 1Gbp
图1-1 HiSeq系列平台参数
1.2 HiSeq X Ten测序仪 这个型号的测序仪是目前市场上的主力，1个flowcell可以有8条lane，每条lane可以产生100~120Gbp的测序数据，包lane的价格大约在8000RMB ~ 10000RMB左右，平均下来的价格是80 ~ 100RMB / Gbp
图1-2 Illumina HiSeq X Ten测序仪
1.3 测序最快的NextSeq系列 NextSeq采用了最新的双色荧光系统，而不是Illumina以前的四色荧光系统，因此运行速度大大提升，大约1天左右的时间就可以完成上机测序（HiSeq大约是3到4天），这个测序仪只有在我们对样本和实验比较着急的时候才会使用。价格也会比HiSeq系列高若干倍。不过，NextSeq的出现，给我们提了个醒，Illumina以后会通过逐渐优化测序仪站稳医院临床快速检测的脚跟。
1.4 通量最高，最便宜的NovaSeq系列 NovaSeq系列测序仪没有lane的概念，是一个完整的flowcell，运行一次可以产生6Tbp左右的数据。如果你想测个几百个样品，那么NovaSeq绝对是你的首选。现在市场价大约可以压缩到40~50RMB/Gbp
对于human来说RNA-Seq需要测多深？ 这个问题之前已经有人专门研究过，实验方案就是先把样品测很深比如50M pair（1M = 10^6），然后去随机抽取若干序列，比如每隔10M做一次抽样，再去计算每一次抽样结果的FPKM值，最后看基因的FPKM在多少测序量的时候能够稳定。根据图2-1所示，大约到了30M reads 的时候就可以稳定找出差异表达基因。 图2-1 探索测序量与差异表达基因的关系 （Yuwen Liu et al., 2014, Bioinformatics）
同时，ENCODE计划里面也公布了RNA-Seq的数据测序标准，在ENCODE的标准中原文如下：
 \1. Replicate number: Experiments should be performed with two or more biological replicates.</div><div class="post-footer">
        <a href="/bioinfo-q-a-32/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/rna-seq/">RNA-seq</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-31/">【bioinfo】-Q&A-31</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-19">2020-02-19</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第31题 RNA-Seq建库用哪种策略？ Hello 大家好！ 我们又见面了！
我们将与大家一同讨论与转录组建库，基因的差异表达分析等相关的内容。
今天我们讨论的是RNA-Seq建库策略问题。
什么是RNA-Seq建库 RNA-Seq建库简单来说，就是把我们想要进行转录组测序的样品（一盘细胞，若干片叶子等）提取RNA，并给RNA（主要是mRNA）序列加上adapter（接头）的过程。最终的目的是为了让转录组的片段两边都连上已知的adapter序列，方便之后的测序。结构如图1-1所示，图中所示的文库片段就是我们这里说的转录组片段。
在整个实验过程中，有几个关键的问题值得思考。
  第1方面，最终拿去测序仪进行测序的一定都是DNA片段，因此我们需要对实验提取到的RNA序列进行反转录成cDNA，然后再进行连接adapter。不过这个问题不算难，因为只要有RNA的序列，就可以使用random primer进行随机反转录，获得对应的cDNA片段。而在cDNA片段上链接adapter就是标准的DNA连接反应，非常简单。
  第2方面，细胞中含量最多的是rRNA，其次是tRNA，mRNA与lncRNA只占大约5%左右甚至更低，而我们真正关心的往往就是mRNA与lncRNA代表的基因表达量。那么怎么对mRNA或者是lncRNA进行富集呢？这就是我们今天要跟大家强调的富集策略问题。
  PolyA + 与 rRNA -两种富集策略 一般来说，我们做RNA-Seq的假设是基于：
1 2 3 4 5  某一个条件影响了表型 --&gt; 假设，表型是由蛋白的变化引起的 --&gt; 假设，蛋白的变化大概率是由对应gene表达量的改变引起的 --&gt; 因此，需要对gene进行定量 --&gt; 最终，进行RNA-Seq   1 polyA + 建库策略 也正是因为上述的推理过程，我们才需要去做RNA-Seq对全转录组进行gene的定量分析。在绝大多数情况下，我们关心的gene都是protein coding gene或者是与其结构非常详细的lncRNA（long non-coding RNA）这些gene在形成成熟的mRNA以后，往往都会在3’末端带有polyA 尾巴，如图2-1所示。同时，成熟的tRNA，rRNA，miRNA等等都不带有经典的polyA尾巴。
因此，如果我们使用一段 带有能与A配对的T的磁珠就可以与对应的带有polyA尾巴的RNA结合，随后再经过随机打断，反转录，加adapter就可以完成建库，这样的建库策略叫做polyA + 或者 polyA positive。核心是对带有polyA尾巴的RNA进行富集。
2 rRNA -建库策略 那么polyA positive策略有个比较大的问题就是，会丢掉很多不带有polyA尾巴的RNA序列，比如tRNA，比如有些lncRNA以及一些特殊的mRNA。同时，我们知道细胞中含量占绝大多数的是序列重复的rRNA，如果我们把rRNA去除之后也就可以顺利进行建库测序。这个过程是对rRNA进行若干次的消化，使得rRNA都被降解而其他类型的RNA不受影响。随后再进行随机打断，反转录，加adapter。这种RNA-Seq的建库策略为rRNA - 或称为 rRNA minus。这种策略的核心是尽可能多的去除rRNA。
提问环节 今天的提问，偏生物细节，不过也都是我们必须要掌握的内容。
问题1：请查阅资料，给出正常人类细胞中rRNA，tRNA，mRNA的大致比例；</div><div class="post-footer">
        <a href="/bioinfo-q-a-31/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/rna-seq/">RNA-seq</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-30/">【bioinfo】-Q&A-30</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-18">2020-02-18</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第30题 IGVTools使用的一些小技巧 闲话少说，Let’s go！
1 2 3 4 5 6 7  目录 1. IGV Tools支持的文件类型与绘图方式； 2. 提供RNA-Seq的mapping测试数据； 3. IGV Tools设置Reads的排序方式； 4. IGV Tools画Sashimi plot； 5. 使用IGV Tools浏览公共数据； 6. 视频教程部分   1. IGV Tools支持的文件类型与绘图方式 我们之前已经介绍过IGV Tools可以对多种数据进行可视化，那么IGV Tools支持的数据类型有哪些呢？根据官方手册的介绍IGVTools主要支持下列数据类型： 表1-1 IGV Tools支持的数据格式与数据内容 （http://software.broadinstitute.org/software/igv/DefaultDisplay）
通过表1-1我们知道，通过IGV Tools我们可以载入FASTA文件作为参考序列；可以载入BAM文件读取比对信息；可以载入BED（一般是各种peak的注释信号）还可以载入GFF/GTF的基因注释文件；当然还有一些特殊格式比如mutation的数据等等。对于这些数据，IGV Tools会用哪些方式来进行可视化呢？ 表1-2 数据类型可视化标准 （http://software.broadinstitute.org/software/igv/DefaultDisplay）
根据表1-2所示，对于不同数据类型，IGV Tools有自己的可视化方式。大家其实不必完全记住这些内容，有一个大概的印象即可，关键是要会用这个工具。
2. 提供RNA-Seq的mapping测试数据 为了方便大家学习，我为大家准备了一点RNA-Seq的mapping好的BAM文件与BAM-index文件。我们接下来的分析也都以这套数据为例进行操作。
1  链接：https://pan.baidu.com/s/1nORmpD9DU6yK4zzmWan_lw 密码：orbz   3. IGV Tools设置Reads的排序方式 我们向IGV Tools提供的BAM文件必须是按参考基因组坐标排序过的，且需要提供BAM文件的index 文件（bai 文件），但是对于IGV Tools来说，当我们zoom in一段区域以后，比如缩放到TP53这个基因区域，我们是可以对这个区域里面的reads进行各种方式排序与分组的。
图3-1显示的是 TP53基因，reads按比对到参考基因组位置排序的可视化图； 图3-1 TP53基因， reads按比对到参考基因组位置排序（默认） 图3-2 TP53基因，reads按照 start location进行排序</div><div class="post-footer">
        <a href="/bioinfo-q-a-30/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/igvtools/">IGVTools</a>,&nbsp;<a href="/tags/aq100/">AQ100</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-29/">【bioinfo】-Q&A-29</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-18">2020-02-18</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第29题 如何使用IGVTools对mapping结果进行可视化？ Hello 大家好，我们又见面了！
1 2 3 4 5  目录 1. 前言 2. IGV Tools的简介； 3. IGV Tools的下载与安装； 4. IGV Tools的可视化初探（indel, mutation, etc）   1. 前言 我们为大家介绍了如何使用samtools tview对BAM文件在命令行中进行可视化的操作。但是有的时候我们需要在论文里对回贴（mapping）数据进行可视化. 这篇文章我们先来教大家下载安装并使用IGVTools对测序数据进行可视化；下一篇我们会教大家怎么用IGVTools来进行RNA-Seq数据的可视化。
2. IGV Tools的简介 IGV Tools =Integrative Genomics Viewer Tools
简单翻译一下就是基因组数据可视化工具，主要的功能就是对高通量测序数据的mapping结果进行可视化。IGV Tools是基于Java开发的，开发者是Broad Institute（伯德研究所），这个研究所可以算是当前生物医学领域最为牛的研究所之一，在他们的带动下推出了一系列的生物信息学工具，IGVTools，GATK都是他们搞出来的。
在IGV Tools中，可以对sorted BAM，BED，GTF/GFF，bigwig/wig，bedgraph等数据进行可视化，基本上是我们平时最常用可视化工具。无论是全基因组测序，RNA-Seq，ChIP-Seq等等都可以进行可视化。
IGV Tools的官方主页：
https://software.broadinstitute.org/software/igv/home
3. IGV Tools的下载与安装 IGV Tools是基于Java环境运行的，因此没有装Java的同学可能第一次安装这个软件之前需要先安装一遍，不过需要注意的是，根据IGV的安装说明，需要使用Java8，最新版的Java9还不能支持。
3.1 Java 8 的下载与安装 下载地址https://java.com/zh_CN/download/
在这个页面里下载Java并安装就算是搞定了Java环境。
3.2 下载IGV Tools IGV Tools也有不同的版本我们一般选择最新版即可，目前的最新版是2.4版本。
下载地址 https://software.broadinstitute.org/software/igv/download
如果是Mac就选择下载1.Mac App，如果是Windows系统就选择2.Windows Zip，我们这里的演示环境为Windows就直接下载 对应版本即可。</div><div class="post-footer">
        <a href="/bioinfo-q-a-29/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/igv/">IGV</a>,&nbsp;<a href="/tags/mapping/">mapping</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-28/">【bioinfo】-Q&A-28</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-18">2020-02-18</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第28题 如何使用samtools tview在命令行下对BAM文件进行可视化？ Hello 大家好！ 我们又见面了！
今天我们来讨论一下，怎么在命令行模式下对BAM文件进行快速地比对信息，也就算是命令行模式下的一种可视化了，虽然这种可视化没啥图形~
当然，如果你把BAM文件使用本地的工具也可以进行非常好的可是吧，比如使用IGV Tools。这个IGV Tools是一个我们最常用的可视化工具，我们在以后会进行详细地讨论，今天就只聊一聊命令行里这个的这个小工具—— samtools tview
1. 一些基本概念 其实，我们之前已经在第22题提醒过大家使用samtools tview这个工具了。它可以sort好的BAM文件进行可视化，并提供随机访问功能。
测试文件
1 2  # SAM测试文件的baidu盘下载地址 链接：https://pan.baidu.com/s/15gVVYPRu3VbF_uKbJUUGrA 密码：2drn   什么叫随机访问呢？
简单来说就是访问染色体任何1个位置的比对情况，速度差不多，而不受染色体先后顺序的影响。比如，我们比对时染色体是chr1，chr2，chr3…按顺序排列的，如果按顺序访问chr3的数据，就必须先读chr1，chr2的数据；而一点我们对BAM文件进行了sort，同时建立了BAM文件的index，那么就可以直接访问chr3的数据。
BAM文件怎么排序及建立index？
这个也很容易，使用samtools sort就好！我们在第22题的时候已经为大家简单介绍了。
大家需要注意，samtools sort是可以按reads的名称或reads的mapping结果进行排序的，我们这里一定要注意，需要按照mapping的结果进行排序，也就是mapping到染色体5’端的reads在前，靠3’端的reads在后。
在sort完以后，需要使用smtools index进行建立index，BAM index的名字为BAM文件名后加.bai
1 2 3 4 5 6  # 对SAM文件转换成BAM文件 samtools view -hb ./test.sam &gt; test.bam # 对BAM文件按mapping结果进行排序 samtools sort -O BAM -T test_sort.bam.temp -o test_sort.bam test.bam # 对BAM文件建立index samtools index test_sort.bam test_sort.bam.bai   2.</div><div class="post-footer">
        <a href="/bioinfo-q-a-28/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/samtools/">samtools</a>,&nbsp;<a href="/tags/bam/">BAM</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-27/">【bioinfo】-Q&A-27</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-18">2020-02-18</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第27题 GENCODE与Ensembl GTF/GFF到底哪里不同？怎么下载？ 1. 基因注释的不同版本问题  RefSeq Gene注释，对gene的不同转录本进行注释，1个转录本对应1个编号成为RefSeq id，例如对于可以翻译成蛋白的转录本，都会以NM_开头如NM_015658；对于不能翻译的转录本，都会以NR_开头如NR_027055； **Ensembl注释；**对gene的不同转录本进行注释，以ENSG开头的表示Ensembl gene_id如ENSG00000227232，以ENST开头的表示Ensembl transcript id如ENST00000438504 **UCSC gene注释；**对gene的不同转录本进行注释，一般是类似uc004cpf这样的名称。  但是，RefSeq有一些注释不够完整，或者说有一些可能存在的，有用的gene转录本，所以有的时候我们会推荐大家使用Ensembl或者GENCODE的注释，那么我们今天的问题来了——Ensembl和GENCODE的GTF/GFF注释有什么不同？
2. GENCODE上下载GTF/GFF 先说说GENCODE是什么吧，根据GENCODE的官方说明文档，GENCODE的目的是为了建立一个公用可信的gene注释体系，其缩写的对应关系为：
The GENCODE Project = Encyclopædia of genes and gene variants
好了，让我们先访问以下GENCODE的官方网站：https://www.gencodegenes.org/
其实，大家可以发现GENCODE的网站上，只提供了Human和Mouse两个物种的注释信息，但这两个物种也是平时研究的时候最关心最常用的两个物种。每个物种有若干个版本，我们一般下载最新版本就好了。下面以Human的数据下载为例为大家进行讲解。
大家可以看出来，GENCODE已经对数据做了非常好的整理，不但提供了各种类型数据的下载，而且在下方的Metadata部分，还解释了每一种数据的元数据。也就是不但告诉我们注释的结果，还告诉了我们为什么这么注释，真的很良心！
在这里，我们就为大家下载了最常用的gene annotation也就是第1个文件Comprehensive gene annotation 的 GTF格式。
3. GENCODE与Ensembl GTF/GFF有什么不同？ 我们先来看一下这两者的数据内容：
从Ensembl下载下来的GTF文件；
1 2 3 4 5 6 7 8 9 10  #!genome-build GRCh37.p13 #!genome-version GRCh37 #!genome-date 2009-02 #!genome-build-accession NCBI:GCA_000001405.14 #!genebuild-last-updated 2013-09 1 ensembl_havana gene 11869 14412 .</div><div class="post-footer">
        <a href="/bioinfo-q-a-27/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/refseq/">RefSeq</a>,&nbsp;<a href="/tags/gtf/">GTF</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-26/">【bioinfo】-Q&A-26</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-18">2020-02-18</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第26题 什么是RefSeq Gene? 怎么给NCBI反馈问题？ Hello 大家好，我们又见面了！
昨天我们给大家介绍了怎么下载GTF/GFF文件，并让大家尝试使用2种方法分别从UCSC genome browser上下载RefSeq Gene GTF（hg19版本）；以及Ensembl网上下载Ensembl Gene GTF（hg19版本），还在最后的提问环节让大家比较了一下这两者的不同。
1. 常用的Gene注释 其实，常用的gene注释有不同的来源，这个来源一般是某一个组织通过一定的方法来确定下来的参考gene的相关注释信息。比如常用的有：
 RefSeq Gene注释，对gene的不同转录本进行注释，1个转录本对应1个编号成为RefSeq id，例如对于可以翻译成蛋白的转录本，都会以NM_开头如NM_015658；对于不能翻译的转录本，都会以NR_开头如NR_027055； **Ensembl注释；**对gene的不同转录本进行注释，以ENSG开头的表示Ensembl gene_id如ENSG00000227232，以ENST开头的表示Ensembl transcript id如ENST00000438504 **UCSC gene注释；**对gene的不同转录本进行注释，一般是类似uc004cpf这样的名称。  针对1个参考基因组版本，比如human的hg19参考基因组版本，会有来自各种不同组织，不同方法的基因注释。这些基因注释各有优劣，没有绝对的好与绝对的坏，只有掌握他们的注释规则，才能找到最适合我们课题的基因注释。所以，我们今天先来介绍一下RefSeq Gene的注释规则与原理。
2. RefSeq 计划与RefSeq gene RefSeq = The NCBI Reference Sequence
这个计划是由NCBI提出的，意图是为所有常见生物提供非冗余，人工选择过的参考序列。一个物种的RefSeq注释通常包含：参考基因组，参考转录组，参考蛋白序列，参考SNP信息，参考CNV信息等等。
RefSeq基本上我们最常用的一个gene注释版本了，因为经过了人工挑选，挑选出来的gene或者是转录本都十分可靠。在RefSeq的官方说明文档中，这么写了一句话 “It is a unique resource because it provides a large, multi-species, curated sequence database.” 这个curated是什么意思，大家可以查查字典~
从RefSeq的官方网站上可以下载到N个物种的参考序列信息，从无核到有核，从原核到真核，从低等到高等应有尽有。不过呢，这里面还是human的信息注释得最为全面，并且在RefSeq的主页上做了单独的页面链接
页面中的Human Genome Resource and Download就可以进入Human资源的专题页面，如图2-1，图2-2所示。 图2-1 Human Genome Resource and Download页面上半部分 图2-2 Human Genome Resource and Download页面的download部分</div><div class="post-footer">
        <a href="/bioinfo-q-a-26/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/refseq/">RefSeq</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-25/">【bioinfo】-Q&A-25</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-18">2020-02-18</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第25题 GTF/GFF的注释是怎么来的，应该从哪里下载？ Hello everyone! 我们又见面了！
我们昨天刚刚回答了GTF/GFF文件到底是什么的问题，那么我们今天尝试回答GTF/GFF文件是怎么来的，从哪里能够下载。
根据BBQ24问的介绍，我们知道了GTF是GFF的2.0版本。（以后我们把这两者到简称为GTF文件好了！）主要记录的内容是基因组上基因的结构，包括哪里是exon，哪里是intron，哪里是CDS，哪里是start codon，哪里是stop codon. 在提问的环节，我们也设置了问题让大家去吐槽GTF文件糟糕的的文件结构（希望大家能吐得开心！）。
今天我们来为大家介绍GTF文件是怎么来的。
1. 什么是参考GTF/GFF文件 针对一些已经通过测序计划，拼装好基因组序列信息的物种，一般会同时提供其转录组的注释信息，也就是我们所说的GTF/GFF文件。常用的模式生物，比如human（人），mouse（小鼠），rat（大鼠），chicken（鸡），lizard（蜥蜴），Arabidopsis thaliana（拟南芥）等等都已经有非常好的 全基因组参考序列（FASTA文件），以及转录组注释信息（GTF或GFF文件）。
因此，直接到能够提供下载地址的网站上下载就好了。
图1给大家展示了已经公布参考基因组哺乳动物的系统发生树，大家可以看看人类和哪种动物演化距离最近。
图1 已经公布参考基因组的哺乳动物系统发生树（http://asia.ensembl.org/info/about/speciestree.html）
多说一句，这个下载下来的FASTA文件就是我们所谓的参考基因组，需要用这个文件去构建mapping的index；下载下来的GTF文件是转录组注释信息，一般在计算表达量的时候需要提供。
2. 什么是拼装转录本 在进行转录组分析的过程中，我们经常会听到一句话叫“用XX软件拼装转录本”，这句话是什么意思呢？不都有参考转录组了，还要拼个啥转录组？
第1个方面，对于无参考基因组，无参考转录组的物种来说，往往需要通过RNA-Seq的数据自己拼出参考转录组，然后再进行下游的数据分析。所以，对于无参分析来说，往往需要自己拼装转录本，生成自己的参考转录组信息，也包括注释信息（GTF文件）。
第2个方面，对于有非常好注释的基因组，例如human来说。不同的细胞条件可能不同，一些永生化的细胞系往往都具有“癌症”的特征，这些细胞的转录组，基因组或多或少都有结构的变异，以及转录本的差异。
举个例子，有一个geneA，在参考转录组中注释的是从chr1:1000 ~ 15000进行转录，但是在另外的细胞系中有可能就是从chr1:980 ~ 15050进行转录。这种转录起始和终点的不同是很常见的现象。
因此，有时候为了比较严谨地进行下游序列分析，是需要根据已知的参考转录组以及测序数据对其进行一个修饰。
常用的软件是cufflinks，stringtie等等。
不过，对于有参考转录组的物种，一般情况下，我还是建议不要去自己拼转录本，也不要去做什么所谓的修正，意义不大。除非你研究的体系非常特殊。
3. 从哪里下载参考转录组GTF/GFF文件呢？ 关于下载GTF/GFF文件的内容，给大家介绍2个最常用的网站：
 1个是UCSC genome browser (UCSC Genome Browser-网址链接） 1个是Ensembl（Ensembl 网址链接） 注意：对于植物的Ensembl网站（Ensembl Plants）  3.1 从UCSC genome browser下载human的GTF文件 1 2 3 4 5 6  1. 打开UCSC genome browser网站 2. 在Tools里选择 Table Browser 3. 打开Table Browser以后，设置相关的需要内容（图3.</div><div class="post-footer">
        <a href="/bioinfo-q-a-25/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/gtf/">GTF</a>,&nbsp;<a href="/tags/gff/">GFF</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/bioinfo-q-a-24/">【bioinfo】-Q&A-24</a>
    </h1><div class="post-meta"><span class="post-author"><a href="https://github.com/uioQPS/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Milky</a></span>&nbsp;<span class="post-publish">published on <time datetime="2020-02-18">2020-02-18</time></span>&nbsp;<span class="post-category">included in <a href="/categories/bioinfo/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>bioinfo</a>&nbsp;<a href="/categories/ngs/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ngs</a></span></div><div class="content">第24题 GFF，GTF到底是什么？ Hello大家好！我们又见面了！
在第23问的时候，我们开始学习了转录组相关的生物信息学。在转录组分析的过程中，往往需要基因注释文件，通常是GFF或者是GTF文件，那么这两个文件的内容是什么？有什么特点呢？这是我们今天要探索的问题。
1. 我们为什么需要基因注释文件？ 通过对外显子（exon）的可变剪切，同1个基因可以形成多种蛋白（https://en.wikipedia.org/wiki/Alternative_splicing）
我们的gene在基因组上的结构不是连续的，而是exon-intron-exon（exon=外显子，intron=内含子）分隔开的。
基因要表达，首先会先发生转录过程，转录出包含intron的pre-mRNA序列，然后再进行可变剪切，加5’帽子，3’ PolyA尾巴等一系列复杂的加工过程才会形成成熟的mRNA。
在进行转录组序列比对，尤其是mRNA序列比对的时候，经常需要处理跨越两个exon之间的reads，所以在进行序列比对的时候往往需要对基因组有一个注释，**告诉比对软件哪个位置是gene的exon，哪个地方是gene的intron，这个就是我们所说的基因注释信息。**所以，它里面核心内容就是一大堆gene在基因组上的坐标，以及这个gene本身的一些属性。
2. GTF与GFF都是基因注释文件 GTF = General Transfer Format
GFF = General Feature Format
GFF有若干个版本，简单来说，GTF是GFF文件的其中一个版本，我们一般认为GTF文件就是GFF 2.0版本的内容。一个标准的GTF/GFF2.0文件需要包括9列内容，一个简单的示意图如下：
图2 1个标准的GTF格式文件，文件不包括前面的行号
这9列分别是什么呢？ 我试着为大家翻译ensembl网站的说明文件（GFF/GTF File Format）。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  # 所有的列必须用TAB分隔，总共有9列内容，第9列是补充列； # 补充列的内容可以为空，但是前面8列必须有内容，如果想表达空的概念，则需要用&#34;.&#34;； # 第1列 seqname 染色体的名称，需要与genome FASTA文件中的染色体名对应，别一个用&#34;chr1&#34;一个用&#34;Chr1&#34;； # 第2列 source 注释来自哪里，比如图2表示来自NCBI RefSeq数据库； # 第3列 feature 此行的注释类型，一般有exon，CDS，stop_codon, start_codon等等； # 第4，5列 start，end 此行注释的起始和终止位置，标准的GTF/GFF都是以1为染色体的起点（1-based system）; 注意！无论这个gene是正链还是负链，start的坐标都小于end坐标； # 第6列 score 一般存放打分值，比如拼装的可信度之类。下载的官方注释文件一般为0.</div><div class="post-footer">
        <a href="/bioinfo-q-a-24/">Read More</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/aq100/">AQ100</a>,&nbsp;<a href="/tags/reference/">reference</a></div></div>
</article><ul class="pagination"><li class="page-item ">
                    <span class="page-link">
                        <a href="/">1</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link" aria-hidden="true">&hellip;</span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/6/">6</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/7/">7</a>
                    </span>
                </li><li class="page-item active">
                    <span class="page-link">
                        <a href="/page/8/">8</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/9/">9</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/10/">10</a>
                    </span>
                </li></ul></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/uioQPS/" target="_blank">Milky</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"data":{"id-1":"A bioinformatics/programming learning recording website."},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
