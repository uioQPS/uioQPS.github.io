[{"categories":null,"content":"A class和B class的GPCRs如何不同样激活G蛋白 heterotrimeric guanine nucleotide–binding protein (G protein) 异源三聚体鸟苷酸结合蛋白 GPCR激活hallmark： outward movement of the cytoplasmic end of transmembrane domain 6 (TM6)，opens up an intracellular cavity to accommodate the Gα subunit 在细胞质的TM6跨膜区会向外扩展，打开了一个细胞内的空腔来容纳Ga亚基。 A/B GPCRs的差别： In family B GPCRs, TM6 shows a disruption of the helical fold and the formation of a sharp kink. This differs from the gradual bending in TM6 observed in family A GPCRs. Class B的TM6会有螺旋折叠的破坏和尖锐扭结的形成(需要更多的能量)，而class A的TM6仅仅只是逐渐弯曲。 Class B的GPCR缺少class A有的保守的结构motif，conserved structural motifs and conformational switches. DRY/ERY NPxxY PIF motifs 要激活Class B GPCR所需的能量更高。其apo state能量更低。 peptide binding results in conformational changes on the extracellular side that leads to an expansion rather than a contraction of the ligand binding cavity. 多肽结合后细胞外的构象变化是扩张而不是结合空腔的收缩。 从受体核心转离的扭结 TM6 是所有 B 族 GPCR 复合物的共同特征。需要 Gs 结合来启动 TM6 的结构变化可能是 B 族 GPCRs 的一般机制。 Class B在G蛋白激活中存在限速步骤：核苷酸释放和随后的 GTP 结合。Gs 与 β2AR 的快速紧密相互作用很可能导致 GDP 亲和力的更快下降，从而导致比 GCGR 更快的核苷酸释放。 Class A在transducer解偶联后TM6会迅速恢复到松弛状态。 A/B GPCRs的共同点： outward movements of TM5 and TM6 ","date":"2022-03-19","objectID":"/classa-and-classb/:0:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Difference in the activation mechanism of family A and family B GPCRs affects G protein signaling. ","date":"2022-03-19","objectID":"/classa-and-classb/:1:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Development of a soluble glucagon analog, ZP3780 为了鉴定GCGR的复合物结构，设计了glucagon analog（异高血糖素类似物）提高了在水溶液中的溶解性和稳定性（中性 pH 值下易于快速形成纤维状聚集体） native sequence in the N terminus of the peptide, which is important for ligand efficacy保留多肽N端，ZP3780 激活受体能够形成足够稳定的 GCGR-Gs 复合物。胰高血糖素类似物 ZP3780 作为完全激动剂，包括四个 C 末端突变，与野生型 (WT) 胰高血糖素相比，仅略微降低亲和力，同时显示出相似的最大可达到反应 (Emax)。 ","date":"2022-03-19","objectID":"/classa-and-classb/:2:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Cryo-EM structure of ZP3780-bound GCGR–Gs complex 胰高血糖素类似物在细胞外结构域 (ECD) 和受体的跨膜束之间形成连续的 α-螺旋。 ","date":"2022-03-19","objectID":"/classa-and-classb/:3:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Structural insights into ligand efficacy in GCGR 在完全激动剂 ZP3780 中，D9 的羧基与 TM7 的 N 末端残基 R378 形成盐桥，似乎将 TM7 拉向 TM6； Mutation of R378 to alanine completely inhibits GCGR-mediated cAMP signaling. R378对于GCGR的激活很重要。TM7 位置的改变伴随着 ECL3 向受体核心的移动。 完全激动剂 ZP3780 和部分激动剂 NNC1702 的 N 末端位置的比较表明 H1 的缺失导致 NNC1702 向上移动至 TM7（图 2B）。 在这个位置，部分激动剂会在完全激活的受体构象中与 TM1 和 TM7 发生冲突（图 S4，A 和 B）。 除了 TM1 和 TM7 运动的空间限制之外，与 ZP3780 相比，D9E 突变允许部分激动剂与 TM7 的细胞外末端（残基 R3787.35 和 Q3747.31）形成额外的极性接触，这可能使其稳定在 处于非活动状态并阻止 ECL3 向内移动（图 2，B 和 C）。 此外，缺失的 N 末端 H1 和 ECL3 中缺乏重排很可能限制了 W3045.36 的向内旋转，因此，对于 GCGR 的完全激活很重要的 TM5 的平移旋转（图 2C） . ","date":"2022-03-19","objectID":"/classa-and-classb/:4:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Agonist-induced structural changes in TM6 部分激动剂 NNC1702 完全激动剂 ZP3780 PxxG motif （P3566.47-L3576.48-L3586.49-G3596.50） Compared with the NNC1702-bound receptor structure showing an outward movement of the extracellular tip of TM6 induced by peptide binding, the ZP3780-bound GCGR-Gs complex reveals partial unwinding of helix 6 above the PxxG motif to avoid spatial clashes with both the peptide and the repositioned TM7. P356 rotates away by approximately 90°, which probably causes the PxxG motif to shift inward toward TM3 and TM7. Substitution of F322 to alanine results in decreased potency of glucagon from 0.14 nM to 110 nM, indicating that the rearrangement of TM5 and packing of F322 against the PxxG motif is important for receptor activation. ","date":"2022-03-19","objectID":"/classa-and-classb/:5:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Coupling of GCGR to Gs Gαs 的 C 端 α5 螺旋插入受体核心，与 TM5 和 TM6 和螺旋 8（H8）中的残基形成广泛的亲水相互作用，并与 TM3 形成疏水接触。 A notable difference between GCGR and β2AR, a family A GPCR that couples predominantly to Gs, is the extent of interaction between the intracellular loop 2 (ICL2) and the hydrophobic pocket in Gs formed by the αN-β1 loop, the β2-β3 loop, and the α5 helix of Gαs. 细胞内环 2 (ICL2) 与由 αN-β1 环、β2-β3 环和 Gαs 的 α5 螺旋形成的 Gs 中的疏水袋之间的相互作用程度。 ","date":"2022-03-19","objectID":"/classa-and-classb/:6:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Functional impact of structural differences between family B and family A GPCRs active conformation of family B receptors in complex with Gs shows a distinct sharply kinked TM6 when compared with Gs-coupled family A GPCRs such as the β2AR, where TM6 moves outward without the formation of a helix break. GTP-turnover assays: GCGR shows significantly lower guanine nucleotide exchange factor (GEF) activity than β2AR；是因为 longer-lived GDP-bound complex of GCGR inhibitory effect of GDP； higher potency of GDP in destabilizing high-affinity glucagon binding of the GCGR in comparison with GTP Bodipy-GTPγS binding studies： GCGR shows a slower Bodipy-GTPγS (kon = 0.001 s−1) binding rate compared with the β2AR (kon = 0.003s−1), which demonstrates that the efficiency of GDP release and GTP binding are significantly reduced compared with those of β2AR and thus represents the major underlying rate limiting steps for GCGR-mediated G protein activation. 这是可以通过GCGR-Gs复合物对GDP比GTP的亲和力高来解释的。 radioligand filtration binding:. ensure that the specific activity was comparable between the two receptors Förster resonance energy transfer (FRET): Cy3B-labeled receptors and Sulfo-Cy5-labeled heterotrimeric G protein, Gs, in bulk detergent solutions to avoid nonspecific adsorption of lipidated G proteins to HDL particles. [3H]-GDP dissociation assay: receptor-induced GDP release; GCGR catalyzed nucleotide release from [3H]-GDP loaded Gs with a substantially slower rate. B class能形成更稳定的GDP-bound Gs结构，形成nucleotide-free complex表现的能量更低。这是可以通过GCGR的ICL2和 αN-β1 loop, the β2-β3 loop, and the α5 helix of Gαs 的疏水口袋更弱的相互作用来解释的。 NanoBiT complementation-based G protein dissociation assay： less efficient G protein activation mediated by GCGR. lower GEF activity of GCGR in comparison with the β2AR. ","date":"2022-03-19","objectID":"/classa-and-classb/:7:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Agonist binding alone does not stabilize an active conformation of the GCGR double electron-electron resonance (DEER) spectroscopy(双电子-电子共振 (DEER) 光谱): 最小的半胱氨酸 GCGR 构建体 (mC-GCGR)，以通过基于硫醇的化学进行位点特异性标记。 饱和浓度（5 倍摩尔过量，0.5 mM）添加完全激动剂 ZP3780 并没有改变距离分布，表明 TM5 和 TM6 在激动剂结合时不会发生配体诱导的构象变化。相反，在 β2AR 的情况下，TM4 和 TM6 之间的 DEER 距离测量表明，激动剂结合通过稳定 TM6 的外部构象来增加活性状态的数量。 没有观察到活性构象的这种 DEER 距离群体意味着与 β2AR 和其他特征 A 家族 GPCR 相比，在单独存在激动剂的情况下，GCGR 的完全活性构象状态的能级显着更高。 ZP3780 添加到 GCGR 后，bimane 荧光光谱的最大发射波长 (λmax) 存在微小但具有统计学意义的差异。λmax 中的这种小红移表明配体结合在受体的细胞内侧诱导了一些构象改变，这些改变略微改变了附着在 TM6 上的荧光团周围的局部环境。假设配体结合诱导 TM6 附近受体其他区域的构象变化，这可能触发 GDP 结合的 Gs 与受体的初始接合。相比之下，将激动剂肾上腺素 (Epi) 添加到 β2AR 会导致强度降低和 λmax 中更明显的红移，表明 TM6 向外运动（图 6D，蓝色）。TM6 置换发生在 β2AR 中的激动剂结合上，但在 GCGR 中没有（图 6A）。Gs 添加到与 ZP3780 结合的 GCGR 中会导致强度降低和 λmax 出现适度的 5 nm 红移（图 6C，粉红色）。这表明 GCGR 与激动剂和 Gs 的相互作用是诱导 TM6 构象变化所必需的，这是形成无核苷酸受体-G 蛋白复合物所必需的。 ","date":"2022-03-19","objectID":"/classa-and-classb/:8:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Persistent active state of GCGR after G protein dissociation Fluorescence spectroscopy to probe conformational changes in TM6： 4-chloro-7-nitrobenz-2-oxa-1,3-diazole (NBD)（对于构象变化的反应更强）–labeled mC-GCGR-349C and bimane-labeled β2AR in complex with Gs. FRET studies to directly detect nucleotide-dependent dissociation of the G protein: Gs to ZP3780- bound GCGR (Fig. 6E, purple) or Epi-bound β2AR (Fig. 6F, green) Decrease in NBD or bimane fluorescence intensity due to TM6 outward movement in the G protein–coupled fluorescently labeled receptors 状态稳定后，addition of GDP (Fig. 6F, brown) or GTPγS (Fig. 6F, violet) to β2AR-Gs, resulted in Gs dissociation. 荧光光谱恢复到激动剂结合受体的波长和强度。 尽管我们观察到在添加 GDP 或 GTPγS 后 FRET 的变化导致 GCGR-Gs 复合物几乎完全解离。孵育 10 分钟后未观察到 NBD 荧光的变化。表示TM6没有返回到非活动状态并保持打开状态。GCGR 的活性状态在 G 蛋白解离后会持续数分钟，然后才会缩回跨膜束。TM6 在 ZP3780 存在下比在部分激动剂存在下保持更开放的构象。表明配体的功效可能在稳定 TM6 在扭结的向外构象中发挥作用。 ","date":"2022-03-19","objectID":"/classa-and-classb/:9:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Receptor-mediated Gs dissociation of family B receptors is slower compared with family A GPCRs Class B受体的Gs解离比Class A要慢。 测试了除了 GCGR（GLP1、PAC1 和 PTH）之外的三个 B 族 GPCR 与 Gs 偶联的四个 A 族 GPCR（β2AR）：5-羟色胺受体 4 (5-HT4)、组胺H2 受体 (H2R)、前列腺素 D2 受体 (DP) 和加压素受体 2 (V2R) NanoBiT complementation-based G protein dissociation assay to measure the Gs dissociation kinetics 相对于所有测试的 A 类受体，B 族受体通常催化显着较慢的 Gs 解离速率。 确定每个实验的所有 GPCR 的表达水平，以确保细胞质膜中的受体密度相似。 ","date":"2022-03-19","objectID":"/classa-and-classb/:10:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"Overview Message Class B结合了ligand，降低中间态的能量，对于有TM6构象变化的完全激活态的能量没什么变化。 Class A结合了ligand会稳定TM6向外移的中间态并且产生一小部分完全激活态。所以不仅仅是大大降低中间态的能量，还降低了全激活态的能量。GTP 诱导的 β2AR 信号复合物解离完全逆转了 G 蛋白的作用，导致受体的能量分布与单独存在激动剂时相似。与 GCGR 相比，由于完全活跃和中间状态之间的能垒较低，弛豫相对较快。 G蛋白参与GCGR-Gs复合物无核苷酸状态是降低活性状态能量必须的，这导致扭结形成和 TM6 远离受体核心移动，以容纳 Gαs 的 C 端 α5 螺旋。活性和中间受体构象之间提出的高能垒，与β2AR相比，GCGR的TM6在完全活性构象中持续存在更长的时间。 ","date":"2022-03-19","objectID":"/classa-and-classb/:11:0","tags":null,"title":"Structural insights into differences in G protein activation by family A and family B GPCRs","uri":"/classa-and-classb/"},{"categories":null,"content":"GTP酶激活蛋白加速GTP水解。 The GTPase cycle G蛋白激活需要结合上GTP。GPCR激活表现出GEF活性就是一个消耗GTP的过程。 在这个过程中加入ADP，会使没有被消耗的GTP转化为ATP。这是两个竞争性结合游离磷酸的过程。然后通过将ATP的信号转换为荧光信号进行检测。 也就是说，GTP消耗的越多，剩下的ATP就越少，检测的荧光越弱，说明GPCR的活性更高。 GEFs help in loading of GDP-bound inactive GTPases(G protein) with GTP. The GEF buffer contains higher amounts of free Mg2+, and as a consequence, the nucleotide loading is catalyzed solely by GEFs. 可以检测Intrinsic GTPase 、GAP-Stimulated GTPase、GAP Activity 、GEF Activity. GTPase/GAP Buffer: To perform a GAP activity assay, be sure to include the cognate GTPase.要进行 GAP 活性测定，请务必包含同源 GTPase。 GEF Buffer: To perform a GEF activity assay, be sure to include the cognate GTPase and GAP.要执行 GEF 活性测定，请确保包含同源 GTPase 和 GAP。 配体结合的G蛋白偶联受体会发生构象变化，从而表现出鸟苷酸交换因子(GEF) 的特性，通过以三磷酸鸟苷（GTP）交换G蛋白上本来结合着的二磷酸鸟苷（GDP）使G蛋白的α亚基与β、γ亚基分离。 Some Tips: The final GTP concentration in the GTPase reaction should be no more than 5μM. 最佳 GTPase 活性需要 DTT 的存在。 我们建议在使用前在 GTPase、GAP 或 GEF 反应（在适当的缓冲液中）中添加最终浓度为 1mM 的 DTT。 ratio of 1:1:2 (GTPase reaction:GTPase-GloTM Reagent:Detection Reagent) 2X GTPase-GAP solution containing 1mM DTT, GTPase and GAP at twice the desired final concentration in GEF Buffer. dilute the GEF to be studied in GEF Buffer containing 10μM GTP. Initiate the GTPase reaction by adding 5μl of the 2X GTPase-GAP solution. Incubate the reaction at room temperature (22–25°C) for the optimal time, generally 60–120 minutes. GTPase-GloTM Reagent: Add 10μl of reconstituted GTPase-GloTM Reagent to the completed GTPase reaction, mix briefly and incubate with shaking for 30 minutes at room temperature (22–25°C). Add 20μl of Detection Reagent, and incubate the plate for 5–10 minutes at room temperature (22–25°C). Measure luminescence. A positive result: ","date":"2022-03-19","objectID":"/gtp-turnover-assay/:0:0","tags":null,"title":"GTPase-activating proteins (GAP) accelerate the GTP hydrolysis mediated by GTPases","uri":"/gtp-turnover-assay/"},{"categories":null,"content":"M3系列文章概览 M3R的结构特征/功能作用/G蛋白偶联特异性的决定 Receptor 药用靶标 G protein M1 神经系统疾病（如阿尔茨海默病和精神分裂症）/学习、记忆和认知 Gq/11 M2 调节人体心率和许多中枢神经系统功能 Gi/o M3 激活后受体磷酸化，募集b抑制蛋白能力受损 / 糖耐量受损伴随着M3受体介导的胰岛胰岛素释放降低 Gq/11 M4 神经系统疾病（如阿尔茨海默病和精神分裂症） /学习、记忆和认知 Gi/o inverse agonist, tiotropium Positive allosteric modulators/正变构调节剂 (PAM) SAR, structure–activity relationship (Q)SAR 也是模型或数学关系（通常是统计相关性），它将与结构相关的特性与另一个感兴趣的特性或活动的存在或不存在或效力相关联。(Q)SAR最基本的数学形式是： 活性 = f（物理化学或结构特性） SARs 模型的开发需要三个组件： 为一组化学品（即因变量）提供活性（通常通过实验测量）的数据集。这组化学品通常由一些选择标准定义。因变量通常是可监测活性。 同一组化学品的结构标准或与结构相关的特性数据集（即自变量）。自变量通常是结构属性。 关联这两个数据数组的方法（通常是统计分析方法）。将结构与活动联系起来的方法范围从简单的线性回归，到更复杂的方法（例如偏最小二乘分析），再到最复杂的机器学习技术（例如神经网络）。 正构结合位点的比较/选择性 ligand结合的动态变化 2018- Structure-guided development of selective M3 muscarinic acetylcholine receptor antagonists M3 muscarinic acetylcholine receptor (M3R) antagonist chronic obstructive pulmonary disease （COPD） ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:0:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"比较M2R和M3R的正构结合位点 M3R的Tiotropium会识别非保守残基亮氨酸，M2R的QNB识别非保守残基苯丙氨酸。compound c的docking pose表明一个扩大的向上环可以越过M2R的非保守苯丙氨酸。 ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:1:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"Structure-based ligand design up-righting and rotation of ring B steric interactions with Phe181 for compound 6b 键的迁移 构象的限制 卤化 这篇文章找到了一个cmpd 6o（BS46），在小鼠体内验证了可以降低心率和降低气道阻力的功能。解了M3R与选择性拮抗剂6o (BS46) 复合的晶体结构。M3R的ICL3的细胞内环替换成mT4L。而在M2R中因为Phe181的空间阻碍而不能与6o结合。从而实现在比M2R选择性提高100倍，在体内有1000倍的选择性的效果。6o是根据M2R的拮抗剂QNB来设计的。 2012- Structure and dynamics of the M3 muscarinic acetylcholine receptor ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:2:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"M3R的主要结构特征 accessible surface for the M3 receptor bound to tiotropium (spheres) shows the receptor covering the ligand with a tyrosine lid (outlined in red). M3 receptor structure coloured by sequence conservation among the five mAChR subtypes. Poorly conserved regions are shown with larger backbone diameter. The orthosteric and allosteric sites are indicated in blue and red elliptical shaded areas, respectively, and the ligand tiotropium is shown as spheres. ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:3:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"ligand结合的动态变化 结合位点附近的 M2 和 M3 受体之间存在 Phe (M2)/Leu (M3) 序列差异。这会在 M3 受体中产生一个扩大的结合袋，用红色勾勒并用箭头表示。M3 Y5297.39 和 D1473.32 的位移(黑色虚线); Y5297.39 的位移可能源于 2.61 位的序列差异（M2 中的 Tyr 80 和 M3 中的 Phe 124）。 ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:4:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"G蛋白偶联特异性的决定条件 Distances were measured between Ca atoms of TM5 residue 5.62 and TM3 residue 3.54 (x-axis), and TM5 residue 5.62 and TM6 residue 6.37 (y-axis). Structural alignment of mammalian Gi/o-coupled and Gq/11-coupled receptor structures. 2017- Structure-based discovery of selective positive allosteric modulators of antagonists for the M2 muscarinic acetylcholine receptor 发现了M2 antagonist的PAM 628分子。 2014- Muscarinic acetylcholine receptors: novel opportunities for drug development 【Feather】 毒蕈碱乙酰胆碱受体是调节中枢和外周神经系统的许多基本功能的 G 蛋白偶联受体亚家族。 ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:5:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"T2D 2 型糖尿病的关键病理生理特征之一是胰腺 β 细胞无法分泌足够的胰岛素来克服外周胰岛素抵抗。 β 细胞 M3 受体促进胰岛素释放的能力取决于 Gq 家族 G 蛋白的存在； M3 receptor-mediated activation of arrestin-dependent β-cell pathways may further enhance insulin secretion； ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:6:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"Modes of targeting mAChRs (GPCRs) by different classes of ligands： Orthosteric allosteric achieve greater receptor selectivity and promote more physiological response patterns bitopic target the allosteric site to achieve selectivity and the orthosteric site to provide high affinity. 2013- Activation and allosteric modulation of a muscarinic acetylcholine receptor 用酵母库筛选nanobody的方法找到nanobody9-8，并解析正构结合激动剂iperoxo和nanobody复合物结构。 2019- Structures of the M1 and M2 muscarinic acetylcholine receptor/G-protein complexes 解析了M1R和G11复合物结构，M2R和Go的复合物电镜结构。 2016- Crystal structures of the M1 and M4 muscarinic acetylcholine receptors M1-M4的结构对比 M1-M4正构异构结合位点残基比较 M4R的共建网络 2019- Conformational Complexity and Dynamics in a Muscarinic Receptor Revealed by NMR Spectroscopy M2R结合ligand的动态landscape 2013- Muscarinic Receptors as Model Targets and Antitargets for Structure-Based Ligand Discovery 【Feather】 In the M3 receptor, M2 Phe181 is replaced by a leucine ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:7:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"Docking poses for selected M2 muscarinic receptor hits. ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:8:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"Docking for selective M3 receptor ligands. 一些M2的ligand因为M3R的结合口袋更加亲水，溶剂可及性更好，会表现出对M3更高的亲和力。 ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:9:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":"Compound 16 activates M3 but not M2 receptors. ","date":"2022-03-12","objectID":"/m3-muscarinic-acetylcholine-receptors-overview/:10:0","tags":null,"title":"M3 Muscarinic Acetylcholine Receptors Overview","uri":"/m3-muscarinic-acetylcholine-receptors-overview/"},{"categories":null,"content":" PKD1（protein kinase C-like serine/threonine kinase） 胰岛上表达的M3-毒蕈碱受体通过受体磷酸化/抑制蛋白依赖性信号传导调节葡萄糖稳态。这个过程以蛋白激酶D1的激活为中心，该激酶在β-抑制蛋白募集到磷酸化的M3-毒蕈碱受体的下游起作用。 M3-毒蕈碱受体在激动剂占据后被一系列蛋白激酶快速磷酸化，这些蛋白激酶包括 GPCR 激酶 (GRK) 家族成员，以及酪蛋白激酶 1α 和蛋白激酶 CK2 。 受体磷酸化会调节 glucose-dependent insulin release from pancreatic islets, a response that is known to be augmented by para-sympathetic pathways （副交感神经通路）acting on M3-muscarinic receptors expressed on pancreatic β-cells。 ","date":"2022-03-19","objectID":"/m3-help-insulin/:0:0","tags":null,"title":"M3-muscarinic receptor promotes insulin release via receptor phosphorylation/arrestin-dependent activation of protein kinase D1","uri":"/m3-help-insulin/"},{"categories":null,"content":"Characterization of a Phosphorylation-Deficient Mutant M3-Muscarinic Receptor. 通过同位素[32P]orthophosphate检测磷酸化，发现磷酸化缺陷小鼠b-arrestin降低，但是不影响Gq响应Ca2+增加。 乙酰甲胆碱刺激的 [3H] 肌醇磷酸形成在M3敲除的小鼠中完全不存在。M3R-KI (Knock In)小鼠胰岛的乙酰甲胆碱刺激产生与野生型胰岛观察到的相似的反应. ","date":"2022-03-19","objectID":"/m3-help-insulin/:1:0","tags":null,"title":"M3-muscarinic receptor promotes insulin release via receptor phosphorylation/arrestin-dependent activation of protein kinase D1","uri":"/m3-help-insulin/"},{"categories":null,"content":"M3-Muscarinic Receptor Phosphorylation Regulates Insulin Release from Isolated Pancreatic Islets. M3受体的磷酸化调控胰岛的胰岛素释放。 ","date":"2022-03-19","objectID":"/m3-help-insulin/:2:0","tags":null,"title":"M3-muscarinic receptor promotes insulin release via receptor phosphorylation/arrestin-dependent activation of protein kinase D1","uri":"/m3-help-insulin/"},{"categories":null,"content":"Disrupted Coupling of the M3-Muscarinic Receptor to PKD1 Underlies the Deficiency in Insulin Release in M3R-KI Mice. M3-毒蕈碱受体与 PKD1 的中断偶联才会导致胰岛素释放障碍。Recombinant cells and pancreatic islets, M3-muscarinic receptor activation of PKD1 was regulated by the phosphorylation status of the M3-muscarinic receptor. M3 磷酸化受损deficient后降低PKD1磷酸化。说明M3-muscarinic receptor signaling to PKD1 was mediated not via Gq/11-coupling but rather via receptor phosphorylation and β-arrestin signaling. 再证明b-arrestin敲掉之后降低PKD1磷酸化（理解为PKD1的激活） 证明胰岛水平上，PKD1的激活是完全依赖于M3受体。 把PKD1敲了之后，胰岛素的释放明显（在M3激活后WT胰岛素成倍升高）不成倍数。 M3磷酸化——\u003ePKD1磷酸化（激活） M3磷酸化——\u003eb-arrestin——\u003ePKD1磷酸化（激活） 胰岛M3——\u003ePKD1激活 PKD1激活——\u003e胰岛素释放 ","date":"2022-03-19","objectID":"/m3-help-insulin/:3:0","tags":null,"title":"M3-muscarinic receptor promotes insulin release via receptor phosphorylation/arrestin-dependent activation of protein kinase D1","uri":"/m3-help-insulin/"},{"categories":null,"content":"Schematic illustrating the mecha- nisms involved in M3-muscarinic receptor- mediated facilitation of insulin release. M3-毒蕈碱受体增加胰岛素分泌需要 PKD1 活性，并且这种活性受 M3 磷酸化状态的调节。 毒蕈碱受体介导胰岛素释放早期阶段的能力被认为是通过 Gq/11 偶联到钙和 PKC 途径; 延长的胰岛素释放被 M3-毒蕈碱受体增强，其作用方式独立于 G 蛋白信号传导，但依赖于 PKD1 上游的受体磷酸化/抑制蛋白信号传导。 ","date":"2022-03-19","objectID":"/m3-help-insulin/:4:0","tags":null,"title":"M3-muscarinic receptor promotes insulin release via receptor phosphorylation/arrestin-dependent activation of protein kinase D1","uri":"/m3-help-insulin/"},{"categories":null,"content":"Abbreviations cAMP cyclic adenosine monophosphate GPCRs G protein-coupled receptors GRK G protein-coupled receptor kinase ICL intracellular loop Nb32 nanobody 32 Nb35 nanobody 35 TM transmembrane helix V2R vasopressin receptor type 2 V2T V2R tail β2AR β2 adrenergic receptor βarr beta-arrestin 2017- Muscarinic receptor regulates extracellular signal regulated kinase by two modes of arrestin binding 毒蕈碱乙酰胆碱受体通过两种arrestin结合的方式调节细胞外信号调节激酶 Arrestin既可以在GPCR蛋白激酶磷酸化后触发脱敏和内吞作用，也可以招募和调节细胞外信号调节激酶（ERK）级联的活性。 β-arrestin 以两种不同的结合模式（瞬时和稳定）与 M1 毒蕈碱乙酰胆碱受体 (M1Rs) 结合。在任何一种结合模式下都检测到抑制蛋白中类似的分子内构象变化。 当与磷酸化 M1R 稳定结合时，β-arrestin 支架并激活 MEK 依赖性 ERK。相反，当瞬时结合时，β-arrestin 通过募集蛋白磷酸酶降低 ERK 活性。所有这些 ERK 信号都在质膜上发展。 FRET 揭示了 SNAP 标记的 WT M1R 与 Gq-CFP 和 β-arrestin 2-CFP 的激动剂诱导的相互作用。 total internal reflection fluorescence (TIRF) 全内反射荧光: 利用光线全反射后在介质另一面产生衰逝波的特性，激发荧光分子以观察荧光标定样品的极薄区域，只有极靠近全反射面的样本区域会产生荧光反射,观测的动态范围通常在200nm以下。 Increased recruitment and colocali- zation of β-arrestin with the M1R during agonist application. 2020- Terminating G-Protein Coupling: Structural Snapshots of GPCR-β-Arrestin Complexes 综述： G蛋白和arrestin结合的构象变化可以看GPCR激活的关键 不同的arrestin蛋白会结合到GPCR C端或者ICL磷酸化的不同的地方 受体之间也存在相似和独特性 2021- Noncanonical scaffolding of Gai and b-arrestin by G protein–coupled receptors 设计优先靶向 G 蛋白或 b-arrestin 信号传导的药物，以产生更具选择性的 GPCR 靶向药物，即偏向配体。G蛋白和arrestin介导的是不同的通路。 2021- Noncanonical interactions of G proteins and b-arrestins: from competitors to companions Current model of GPCR signaling mechanisms： 不发生guanine nucleotide exchange，形成Gai:b-arrestin complexes，可以 scaffold ERK and may link noncanonical G protein binding and catalytic b-arrestin activation. action at a distance: In endosome, C-terminal and ICL3 binding is not require to initiate catalytic (catalytically driven guanine nucleotide exchange) b-arrestin activity. BRET: a donor luciferase and an acceptor fluorophore. The acceptor fluorophore has longer excitation/emission wavelengths than the donor, which is necessitated by energy loss that occurs during transfer. 2021- Signaling at the endosome: cryo-EM structure of a GPCR–G protein–beta-arrestin megacomplex GPCR 与传感器的激活和相互作用的途径，通过形成巨型复合体导致在内体内持续信号传导 bioluminescent resonance energy transfer (BRET) 生物发光共振能量转移： 确定分子之间的接近性，用于megacomplex上Ga和b-arrestin分子检测。 b2AR (proto-typical class A GPCR) b2V2R (b2AR where the C-termi- nal tail was exchanged for the vasopressin type 2 receptor [V2R] C-terminal) maintains the pharmacological proper- ties of the b2AR, but has significantly higher affinity for barr than for b2AR, and this increase in affinity manifests predominantly as a change in the receptor internalization pattern from class A to B V2R (proto-typical class B GPCR) agonist-promoted BRET between RlucII-67-Gas (1), RlucII-Gg2 (2), or RlucII-CD8 (3) and GFP10-barr1/2. BRET titration curves using a constant amount of RlucII-67-Gas, RlucII-Gg2, or RlucII-CD8 and increasing amounts of GFP10-barr1 (B) or GFP10-barr2 (D) Kinetics of agonist-promoted BRET ","date":"2022-03-19","objectID":"/barr/:0:0","tags":null,"title":"b-arrestin overview","uri":"/barr/"},{"categories":null,"content":"高通量筛选G蛋白偶联受体的功能性抗体 combining glycosylphosphatidylinositol-anchored antibody cell display with β-arrestin recruitment-based cell sorting and screening.将糖基磷脂酰肌醇锚定抗体细胞展示与基于 β-arrestin 募集的细胞分选和筛选相结合。 抗体基因型与表型；GPI 和 GPCR 在脂筏中的共定位促进了 GPI 锚定抗体与 GPCR 靶点的相互作用 免疫抗体库中鉴定出一组针对人类 apelin 受体的抗体拮抗剂和抗体激动剂来验证该方法。 相比之下，噬菌体展示仅从相同的库中获得了中性结合剂和抗体拮抗剂 sdAb GPI-anchored sdAb library (1 × 108 cells） apelin 13: 100nM 激动剂 460nm 530nm代表 产物/substrate：越低越好 ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:0","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"1、APJ PathHunter assay 阳性clone的可溶性sdAbs有抑制剂活性 ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:1","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"2、PathHunter β-arrestin reporter assay 不适合筛选表面抗体的细胞文库，洗完之后没有fluorescent substrate for the reporter enzyme nor the product resides in the cells ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:2","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"3、Tango/APJ β-arrestin assay β-内酰胺酶报告酶水解前后细胞中保留荧光底物 POC study：APJ gene is stably integrated into the genome, as well as a transcription factor linked to the C-terminus of APJ through a tobacco etch virus (TEV) protease site. 细胞稳定表达β-arrestin and TEV protease fusion protein 转录因子的切割 随后的 β-内酰胺酶报告基因的表达 β-内酰胺酶介导的酶促反应 ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:3","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"4、LANCE cAMP assay（antagonist activity） 2000 cells in 10 μl assay buffer (HBSS + 5 mM HEPES + 0.1% BSA) were added into each well on a 96-half well assay plate and stimulated with test antibodies (at agonist mode), or with apelin 13 ligand at EC80 dose together with test antibodies (at antagonist mode) in the presence of 2.5 μM forskolin. ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:4","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"Proof of concept study and generation of a GPI-anchored sdAb library. pHBLV-puro-GPI 慢病毒表达载体 Covalently linked DAF allows his-tagged sdAbs to anchor to GPI through a flexible linker；共价连接DAF让sdAb锚定到GPI 概念验证 (POC) 研究，APJ 中性结合 sdAb JN126、激动性抗体-配体融合 JN126P13、拮抗性 sdAb JN241 和一个对照 sdAb E3，JN126 和 JN241 是先前通过噬菌体展示从 APJ 免疫文库中分离出来的 APJ sdAb，而 JN126P13 是与 apelin 13 共价连接到中性结合 sdAb JN126 的 C 末端的抗体-配体融合物。 产生重组慢病毒和转导稳定表达 CHO-k1 衍生的 PathHunter β-arrestin 报告细胞的 APJ 后，我们通过流式细胞术测量抗体表面表达水平，并通过 β-arrestin 募集测定测试转导细胞的生物学功能。 磷脂酰肌醇磷脂酶 C（PI-PLC）处理这些细胞显着降低了这些抗体的表面密度，证实它们确实锚定在 GPI 上（sup1c） 在 PathHunter β-arrestin 测定中，GPI 锚定的 sdAb JN241 和抗体-配体融合 JN126P13 被证实分别是拮抗剂和激动剂，而中性结合 sdAb JN126 和对照 sdAb E3 是无功能的（sup1d，e） a)功能实验证明 all four tested sdAbs behave the same as that in APJ PathHunter reporter cells b)cells with antagonistic antibodies anchored on the cell surface c)cells with agonistic antibodies anchored on the cell surface 丰富 APJ 特异性 sdAb 克隆: 293FT/huAPJ 细胞对噬菌体展示的免疫文库进行了一轮淘选，然后将插入物从淘选文库批量转移到慢病毒载体 pHBLV-puro-GPI。 我们在 pHBLV-puro-GPI 中构建了一个 GPI 锚定的 sdAb 文库，大小为 4×107(表达cell-displayed sdAb library可用anti-his antibody) ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:5","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"Function-based cell sorting and screening for sdAb antagonists. antagonist activity 分选cell： low product intensity at 460 nm and high substrate intensity at 530 nm cells with antagonist activity were enriched based on the dramatically decreased ratio of product/substrate intensity 127 single-cell clones were subsequently tested for antagonist activity by β-arrestin recruitment assay. In all, 104 out of 127 cell clones showed higher than 20% inhibition. 阳性细胞单克隆RT-PCR得到抗体基因测序 IC50测定 the percentage inhibition of a cell clone correlates well with the IC50 of soluble sdAb isolated from the corresponding cell clone 细胞克隆的抑制百分数和分离得到的可溶sdab的IC50高度相关 ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:6","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"Sequence and epitope comparison of isolated APJ sdAb antagonists. IC50s obtained by the cAMP assay correlate with those by the β-arrestin recruitment assay 与主要与 ECL2 结合的噬菌体展示衍生的 sdAb 拮抗剂不同，通过基于功能的细胞分选和筛选分离的 sdAb 拮抗剂与 APJ 上的不同表位结合，可分为五组; 其余两组具有中度至弱拮抗剂活性的组与 APJ 的 N 端和几乎所有三个细胞外环（第 4 组和第 5 组）结合，表明它们对受体的构象完整性更敏感。 ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:7","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"Function-based cell sorting and screening for sdAb agonists. β-arrestin recruitment-based cell sorting for the cells with high product intensity (signal at 460 nm) and low substrate intensity (signal at 530nm) following the reporter substrate loading 72 cell clones were screened by Tango/APJ β-arrestin assay at agonist mode One sdAb agonist, designated JN300 agonist activity was confirmed with the presence of the product (in blue color) 可溶性 sdAb JN300 的结合和激动剂活性。 JN300 与人类 APJ 表达细胞特异性结合。测试其与野生型 (WT) APJ、APJ E174A 突变体和 APJ/DOR 环交换嵌合体 的结合来定位 JN300 的表位。我们发现对 N 末端或三个 ECL 环的任何变化都会显着破坏 JN300 与 APJ 的结合，这表明 APJ 受体的结构完整性对于 JN300 介导的受体激动是至关重要的。 在 β-arrestin、cAMP 和基于 PathHunter 的 APJ 内化试验中，JN300 的半数最大有效浓度 (EC50) 为 80-90 nM。我们在氨基酸序列和表达水平上将 JN300 与分离的十种 sdAb 拮抗剂进行了比较, JN300除了JN300的CDR1较短外，在V、D、J基因使用和CDR环长度方面没有表现出任何特殊特征，但JN300在293F瞬时表达系统中的产量低于10 种 sdAb 拮抗剂。我们目前正在尝试共结晶 APJ 和 JN300 复合物。复杂结构的解析可以揭示 JN300 介导的受体激动作用。 ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:8","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":null,"content":"Overview 一种将 GPI 锚定抗体细胞表面展示与 β-arrestin 募集报告基因分析相结合来有效鉴定针对 GPCR 的抗体拮抗剂和激动剂的新方法。 在抗体基因扩增和亚克隆之前，可以通过直接用PI-PLC消化GPI锚定抗体获得可溶性抗体，快速确认生物功能，进一步减少工作量，加快功能鉴定过程。 基于 β-抑制蛋白募集的细胞分选和筛选，而不是监测基于 G 蛋白的信号传导。基于β-抑制蛋白募集的细胞分选和筛选的优势在于它不依赖于对靶受体的G蛋白信号特异性的了解。 APJ 作为模型 GPCR 靶标来验证该方法，并确定了一组具有不同表位的 APJ sdAb 拮抗剂，并且据我们所知，这是第一次来自免疫 sdAb 文库的 sdAb 激动剂。 sdAb 拮抗剂和非功能性结合剂分别主要结合 ECL2 和 APJ 的 N 端。 APJ ECL2 对配体结合至关重要，并在介导配体诱导的受体激活中起重要作用。可以理解的是，sdAbs 与 ECL2 的结合阻断了 apelin 13 与配体结合口袋的结合，从而产生竞争性拮抗剂活性，而 sdAbs 与 N 端的结合不影响配体结合。 something to improve： 大型噬菌体展示的抗体文库转移到慢病毒载体中之前使用了一轮噬菌体文库淘选来丰富结合物而不失去多样性。引入一轮基于结合的噬菌体文库淘选可能会导致激动性克隆的丢失，只发现了一种 sdAb 激动剂。 GPI 锚定的激动剂抗体对细胞的组成性激活导致细胞中激动剂抗体基因的丢失甚至细胞凋亡，这导致基于功能的激动剂 sdAb 基因无法恢复。 细胞分选和筛选。也有可能在分选过程中细胞密度高时，细胞被相邻细胞展示的激动剂抗体激活，这可能导致假阳性信号。 GPI 锚定抗体的诱导表达可以减轻这种负面影响并提高分离激动剂抗体的分选和筛选效率。 APJ sdAb 激动剂 JN300 是迄今为止发现的第一个针对 A 类 GPCR 的抗体激动剂，A 类 GPCR 是用于药物发现的最大和最重要的 GPCR 家族。 JN300 可治疗慢性心力衰竭。由于 APJ 也参与血管生成，并且在实体瘤中观察到 APJ 升高，因此本研究中确定的 APJ sdAb 拮抗剂可能具有通过阻断肿瘤血管生成来治疗实体瘤的潜力。 这种基于功能的抗体高通量筛选方法可应用于所有 GPCR 靶标。它还可以通过使用监测下游信号通路的报告基因检测来适应分离针对非 GPCR 的功能性抗体。我们相信这里描述的新方法将极大地促进具有治疗潜力的 GPCR 功能抗体的鉴定，这可能为抗体治疗创造新的范例。 ","date":"2022-04-26","objectID":"/functional-sdab-panning/:1:9","tags":null,"title":"sdAb panning","uri":"/functional-sdab-panning/"},{"categories":["Vue"],"content":"Vue ","date":"2023-12-03","objectID":"/vue/:1:0","tags":["前端学习","Vue"],"title":"Vue","uri":"/vue/"},{"categories":["Vue"],"content":"数据的双向绑定 数据层（Model）：应用的数据及业务逻辑 视图层（View）：应用的展示效果，各类UI组件 业务逻辑层（ViewModel）：框架封装的核心，它负责将数据与视图关联起来 数据变化后更新视图 视图变化后更新数据 MVVM这里的控制层的核心功能便是 “数据双向绑定” ","date":"2023-12-03","objectID":"/vue/:1:1","tags":["前端学习","Vue"],"title":"Vue","uri":"/vue/"},{"categories":["Vue"],"content":"Vue指令 v-if 跟在某一个标签后 后面的变量为true，这个元素就存在，否则消失 \u003cspan v-if=\"seen\"\u003eNow you see me\u003c/span\u003e \u003cbutton @click=\"toggle\"\u003e切换显示与隐藏\u003c/button\u003e toggle是需要在methods里指定的方法名称 toggle:function(){this.seen=!this.seen} 改变变量的方法 v-bind v-bind把某个数据属性的值绑定到相应的DOM属性上去，非事件属性 \u003cspan v-bind:title=\"message\"\u003e鼠标放上去有message变量显示\u003c/span\u003e v-on绑定的是事件属性 v-on \u003cbutton v-on:click=\"reverse\"\u003ereverse\u003c/button\u003e reverse是method中指定的方法 v-for 数组循环，可以进行数组对应的输出 \u003cli v-for=\"todo in todos\"\u003e {{ todo.text }}} \u003c/li\u003e data需要指定todo的字典数组 todos:[{text: ’learn Vue’},{text:‘hello Vue’},{}] Vue语法 div的id指定的是\u003cscript\u003e中new的Vue 三要素： el：指定DOM节点的定位符 data: {}, methods: {} 资源推荐 面试官推荐 https://vue3js.cn/interview/vue/structure.html 实现数据绑定的做法：发布者-订阅者模式（backbone.js） ","date":"2023-12-03","objectID":"/vue/:1:2","tags":["前端学习","Vue"],"title":"Vue","uri":"/vue/"},{"categories":["Website"],"content":"Abstract jquery 是一个轻量化的JavaScript代码库，支持多种浏览器，主要特性为支持CSS3的全部选择器，方便选取各种元素，以及对于元素进行css样式定义，以及获取计算的样式 ","date":"2023-09-11","objectID":"/jquery/:0:0","tags":["前端学习","JavaScript"],"title":"Jquery","uri":"/jquery/"},{"categories":["Website"],"content":"选择和创建元素 $(\"\u003c\\/div\u003e\") $(\"#productprice\") 选择(tag)和创建(\u003c/\u003e)元素，产出的是类数组的DOM集合 创建多个标签 ","date":"2023-09-11","objectID":"/jquery/:0:1","tags":["前端学习","JavaScript"],"title":"Jquery","uri":"/jquery/"},{"categories":["Website"],"content":"jquery对象和DOM元素对象 jquery对象是一个类数组对象，取第一个[0]是对应的DOM元素 a=createTableNaive() b=$(a) b[0]=a ","date":"2023-09-11","objectID":"/jquery/:0:2","tags":["前端学习","JavaScript"],"title":"Jquery","uri":"/jquery/"},{"categories":["Website"],"content":"append方法 a.appendChild(c) 返回是对象 a.append(c) 返回的是数组对象可以继续加 元素有父元素parentNode removeChild 父元素.append(子元素) appendTo是 子元素.appendTo(父元素) jQuery有一个方法设计规则，就是基本上所有的操作方法都是返回的是左边执行的this对象，但是find chileren方法除外，因为find children方法是在父元素向下寻找子元素集合的方法。 ","date":"2023-09-11","objectID":"/jquery/:0:3","tags":["前端学习","JavaScript"],"title":"Jquery","uri":"/jquery/"},{"categories":["Website"],"content":"区别于js js中：var item_item=$(“item”).value 只能选择id，而不能选择td 通过id取到输入框input，才有value属性；td对象没有value值 ","date":"2023-09-11","objectID":"/jquery/:0:4","tags":["前端学习","JavaScript"],"title":"Jquery","uri":"/jquery/"},{"categories":["Website"],"content":"事件处理函数 有一个参数，参数是事件对象，这个事件对象里面有很多信息，比如那个键盘按键被按下，鼠标点击事件触发的位置，以及currentTarget就是处理当前事件的当前对象，target是说引发当前事件的根源对象 // preventDefault会屏蔽事件的默认行为，比如a标签的点击事件，preventDefault会不让标签进行跳转 // stopPropagation 会屏蔽事件的继续传播，不论是在捕获阶段还是在冒泡阶段，都会停止后面的事件传播。但是停止事件传播并不代表屏蔽默认行为。 // mouseover 鼠标移上去 mousemove 鼠标在元素上移动 mouseout 鼠标移出 // click 是单击事件 dblclick是双击事件，但实际上也会先触发两次click单击事件以后，再触发一次双击事件dblclick // mousedown mouseup ","date":"2023-09-11","objectID":"/jquery/:0:5","tags":["前端学习","JavaScript"],"title":"Jquery","uri":"/jquery/"},{"categories":["Website"],"content":"getComputedStyle方法 window.getComputedStyle是获取DOM元素计算后的全部样式信息对象，也是一个类数组对象，数组的内容是所有的样式属性 // 里面的所有的属性名称必须是animation-delay这样比如 // a = window.getComputedStyle(document.getElementById('test1')); console.log(a.animationDelay); console.log(a['animation-delay']); 这两个是等价的 // 同理，jQuery 之所以能够获取当前的背景色，jQuery的写法是$(\"#test1\").css(\"background-color\"); // $(\"tr\")意思是说选定当前页面上所有的tr元素，但是 // $(\"\u003ctr\u003e\") 意思是说创建一个新的空白的tr标签 我现在想要获取到test1元素的背景色是多少，一般来说定义它的背景色可以这么写 //document.getElementById(\"test1\").style.background = \"yellow !important\"; //document.getElementById(\"test1\").style.setProperty(\"background\", \"yellow\", \"important\"); function $A(s){ return document.getElementById(s); } //console.log($A(\"test1\").style.background); //console.log(window.getComputedStyle($A(\"test1\"))[\"background-color\"]); //console.log($(\"#test1\").css(\"background-color\")); //$(\"#test1\").css(); ","date":"2023-09-11","objectID":"/jquery/:0:6","tags":["前端学习","JavaScript"],"title":"Jquery","uri":"/jquery/"},{"categories":["Website"],"content":"cloneNode方法 cloneNode是克隆本节点对象为一个新对象，cloneNode有一个参数，如果不传，就只克隆本元素自己，如果传true就把自己包含所有的子元素都克隆一遍。 ","date":"2023-09-11","objectID":"/jquery/:0:7","tags":["前端学习","JavaScript"],"title":"Jquery","uri":"/jquery/"},{"categories":["Website"],"content":" 浏览器里面的JavaScript分为主要两部分，一部分是JavaScript的核心编程，就是基础语法，函数，string boolean number 关系表达式，运算表达式等 另外一部分是DOM编程，就是宿主对象上面的编程，在网页开发里面，就是对于document对象的编程 DOM document object model CSS里面有选择器和样式表，构成了网页的样式，结合html和css生成了网页页面，通过javascript给页面元素加上了响应逻辑，可以动态的修改页面。 ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:0","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"querySelectorAll方法 var collection = document.querySelectorAll(\"#orderinfo tbody .rowAmount\"); // document下面的querySelectorAll是说按照css的选择器进行选定dom元素的一个方法 ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:1","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"appendChild方法 td_control.appendChild(btn); //[].push 像后面追加 对应的还有prepend就是[].unshift向前追加 ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:2","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"Array slice reverse push pop shift unshift //数组有这些方法 //console.log(a.slice(0)); //console.log(Array.prototype.slice.call(a, 0)); ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:3","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"构造函数 Object.defineProperty set get enumerable 使用prototype原型继承 var val; Object.defineProperty(a, \"xxx\", { set: function(s){ val = s; }, get: function () { return val; } }); a.xxx = 222; a.xxx; for (var x in a) { } ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:4","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"函数的call apply方法 a ={ x:1, y: function(){ console.log(this.x); } } a.y(); function test(a,b,c,d){ console.log(this.x, a,b,c,d); } test.call(a,1,2,3,4); test.apply(a, [1,2,3,4]); ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:5","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"javascript对象 instanceof方法 函数 bind方法实现 以及数组对象使用方法 //test.prototype = new test2(); //var xx = new test(); //console.log(xx instanceof Object); function test2 (){ this.yyy = 1234; } test.prototype = new test2(); var b = new test(); console.log(b instanceof Array); console.log(b.yyy); ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:6","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"bind方法 function bind(func, context) { return function(){ // 在这里无论this是谁，结果都不会变 return func.apply(context, Array.prototype.slice.call(arguments, 0)); } } a= { aa: 1234, bb: function () { console.log(this.aa); } }; a.bb(); var f = a.bb; f(); var g = bind(f, a); g(); var b ={ aa:2222, bb:g, cc:f }; b.bb(); b.cc(); ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:7","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"事件冒泡 dom对象的一个方法，叫做addEventListener，他有三个参数，第一个参数是事件名称，第二个参数是事件处理函数，第三个参数是是否是捕获期间的事件处理函数，如果不是默认是冒泡期间的函数 onload这种方式是通过类似在冒泡阶段进行事件绑定的一种方式，但是如果后面继续使用addEventListener绑定冒泡阶段事件的话，后面的函数执行顺序会排在前面的.onload函数执行顺序的后面 如果.onload被赋值了多次，那么执行顺序还按照第一次onload和addEventListener确定的执行顺序进行执行 onload事件和DOMContentLoaded时间的区别，是DOMContentLoaded事件是dom树完成，onload是dom树完成，并且所有的外部资源img js css都加载完成才会触发。 window.onload = function(){ console.log(\"onload handler 1\"); } // 等价于下面这个 window.addEventListener(\"load\", function(){ console.log(\"onload handler 2\"); }); ","date":"2023-09-11","objectID":"/javascript6%E5%AE%9E%E6%88%98/:0:8","tags":["前端学习","JavaScript"],"title":"JavaScript6实战","uri":"/javascript6%E5%AE%9E%E6%88%98/"},{"categories":["Website"],"content":"闭包函数怎么写（函数内部的函数） document.addEventListener(\"mouseup\", mouseUpHandler); return { cancel: function(){ elem.removeEventListener(\"mousedown\", mouseDownHandler); document.removeEventListener(\"mousemove\", mouseMoveHandler); document.removeEventListener(\"mouseup\", mouseUpHandler); } }; btn.onclick = function(){ $(\"orderinfo\").getElementsByTagName(\"tbody\")[0].removeChild(row); }; return{ getsum:function(){ return amount; } } ","date":"2023-09-11","objectID":"/%E9%97%AD%E5%8C%85%E5%87%BD%E6%95%B0/:0:1","tags":["前端学习","JavaScript"],"title":"闭包函数","uri":"/%E9%97%AD%E5%8C%85%E5%87%BD%E6%95%B0/"},{"categories":["Website"],"content":"闭包函数怎么调用 var draggables = {}; function enableDrag(id){ if (!draggables[id]) { draggables[id] = dragInit($(id)); } } function disableDrag(id) { if (!draggables[id]) { return; } draggables[id].cancel(); delete draggables[id]; } ","date":"2023-09-11","objectID":"/%E9%97%AD%E5%8C%85%E5%87%BD%E6%95%B0/:0:2","tags":["前端学习","JavaScript"],"title":"闭包函数","uri":"/%E9%97%AD%E5%8C%85%E5%87%BD%E6%95%B0/"},{"categories":["Website"],"content":"添加总金额的功能 td_amount.className=\"rowAmount\";//把要加的项加上类名，便于选择 \u003ctfoot\u003e \u003ctd colspan=\"3\"\u003e总金额\u003c/td\u003e \u003ctd colspan=\"2\" id=\"totalAmount\"\u003e0\u003c/td\u003e \u003c/tfoot\u003e //表格加入一行固定的总金额在最后 id是totalAmount function calcDraw(){ var cellection=document.querySelectorAll(\"#item_table tbody .rowAmount\") var amount=0; for(var i= 0;i\u003ccollection.length;i++){ amount+=Number(collection[i].innerHTML); } $(\"totalAmount\").innerHTML=amount; } //修改totalAmount 的值，通过选择器指定类名来累加得到值 ","date":"2023-09-11","objectID":"/%E9%97%AD%E5%8C%85%E5%87%BD%E6%95%B0/:0:3","tags":["前端学习","JavaScript"],"title":"闭包函数","uri":"/%E9%97%AD%E5%8C%85%E5%87%BD%E6%95%B0/"},{"categories":["Website"],"content":"对象 document 方法 getElementById() 变量 var userInfo = document.getElementById(“userInfo”) 函数 function addrow(){} 事件绑定 td4.innerHTML = “删除” a标签绑定了按钮事件 A example var row = document.createElement(“tr”); var td1 = document.createElement(“td”); row.appendChild(td1); tr类型能增加td类型的子元素 申明一个变量；通过一个找/新建id的方法 var userInfo = document.getElementById(“userInfo”); var row = document.createElement(“tr”); 给变量赋值；通过获取id/变量名的值 td_unitprice.innerHTML= $(“productunitprice”).value; 把变量加入父级 row.appendChild(td_id); 表的结构 table有不同的tag：tbody； tbody属于数组，类似于tr； tr标签的对象有appendchild的方法增加td元素。 $(“orderinfo”).getElementsByTagName(“tbody”)[0].appendChild(row[a]); 绑定事件 myButton.onclick = function(){ $(\"orderinfo\").getElementsByTagName(\"tbody\")[0].removeChild(row); }; ","date":"2023-08-18","objectID":"/js%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%96%B9%E6%B3%95/:0:0","tags":["前端学习","JavaScript"],"title":"JS对象和方法","uri":"/js%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%96%B9%E6%B3%95/"},{"categories":["Website"],"content":"作用域 顶级作用域 \u003e test内部执行期间作用域 \u003e 返回的新函数对象执行期间的作用域(abcd) var abc = 1234; // 顶级作用域 function test(){ // test内部执行期间作用域 var t1 = \"11111111111111\"; var abcd = \"hello world\"; return function (){ // 返回的新函数对象执行期间的作用域 console.log(abcd); console.log(t1); }; } ","date":"2023-08-11","objectID":"/js%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/:0:1","tags":["前端学习","JavaScript"],"title":"JS的作用域和构造函数","uri":"/js%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/"},{"categories":["Website"],"content":"闭包 指定函数的作用域以及函数与其周围状态（变量、函数等）之间的关系。 闭包是指一个函数可以访问其声明时的词法作用域，即使在它被调用的时候，它的外部作用域已经不再存在。 Abstract 封装数据和行为： 通过闭包，可以创建私有变量和函数，只有内部函数能够访问，从而实现数据的封装和隐藏。 模块化编程： 闭包可以帮助创建独立的模块，避免全局命名冲突，同时允许公开只需要暴露的接口。 回调函数和事件处理程序： 在异步编程中，闭包可以用来保存状态和数据，确保在回调函数中访问正确的数据。 实现函数工厂： 通过闭包，可以动态生成具有不同初始值或行为的函数。 ","date":"2023-08-11","objectID":"/js%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/:0:2","tags":["前端学习","JavaScript"],"title":"JS的作用域和构造函数","uri":"/js%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/"},{"categories":["Website"],"content":"JavaScript 简介 JavaScript是一种运行在浏览器中的解释型的编程语言。在Web世界里，只有JavaScript能跨平台、跨浏览器驱动网页，与用户交互。 JavaScript代码放到\u003chead\u003e中 \u003chead\u003e \u003cscript\u003e alert('Hello, world'); \u003c/script\u003e \u003c/head\u003e JavaScript可以对DOM树进行增查删改的操作，对doument对象，方法进行操作。 .getElementbyId() 嵌入式JS \u003cbutton onclick=\" JS code\"\u003e\u003c/button\u003e 完成事件绑定 变量 js里面变量声明规则，变量只能以_或者英文字母开头，后面可以包括数字英文下划线 javascript 里面对象描述是{开头}结尾的，然后是一堆一堆的key value值 key值如果不带引号就按变量声明规则规则处理，如果带引号，只要是合法字符串就可以 var a = { aaa: 1234, 12_34_555_1: \"qqqq\", \"aaa-+bbb\": \"qqqqq\", bbb: \"wwwww\", eee: function() { console.log(this); console.log(this.bbb); console.log(\"---------------------------\"); //console.log(\"12345\"); } a.eee(); 对象的使用一种是.aaa 这种方法只能后面跟合法的变量名 如果是其他的数字类型或者非法变量名但是合法字符串只能[“xxxx”] 函数调用的时候，函数执行上下文对象this看函数.前面的对象就是this的值 Abstract 变量涵盖范围 函数 对象 布尔值 true false 字符串 数字 isNaN（）不是数字就是true ","date":"2023-08-11","objectID":"/js%E7%9A%84%E5%8F%98%E9%87%8F%E5%92%8C%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87/:0:1","tags":["前端学习","JavaScript"],"title":"JS的变量和变量提升","uri":"/js%E7%9A%84%E5%8F%98%E9%87%8F%E5%92%8C%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87/"},{"categories":["Website"],"content":"布局相关 margin-top:5px 上边距 a标签的文字居中？ a标签如果是内联元素，内联元素在一个块级元素内部怎么垂直居中：改变父元素行高line-height写成和父元素的高度一样，它内部的内联元素垂直方向上就剧中了。 z-index 在z轴上的层级，数大的排在数小的上面,页面上有很多绝对定位的窗口，都可能互相覆盖，谁在上面，谁在下面，就靠z-index排序. z-index的排序是根据父级走。relative absolute fixed都可以用z-index，默认的static静态定位不能用z-index，static不涉及元素重叠。 \u003cul\u003e和\u003cli\u003e 可以用来写目录\u003cul\u003e相当于一个列表,\u003cli\u003e指定样式。 .submenu_container, .menu_wrapper { padding: 0px; margin: 0px; cursor: pointer; } .menu { float: left; position: relative; width: 20%; height: 64px; line-height: 64px; margin: 0px; padding: 0px; list-style: none; color: #eee; text-align: center; } 样式相关 https://icons.mydrivers.com/2020/www/icon_2020.png 这种图标怎么找到定位？ 怎么实现下拉菜单？ Abstract js js实现，可以实现那种鼠标一放上去不立即显示子菜单，而是延迟0.2 0.3秒显示，因为可能用户是不小心鼠标移上去的 hover伪类实现 下拉菜单是菜单的一个子元素，默认是隐藏的;在鼠标放在菜单上就是hover状态时候才显示出来 注意float和display inline-block不要同时写，inline-block不起作用 代码相关 输入框元件一定要指定name吗，有什么作用？ ","date":"2023-07-28","objectID":"/%E5%89%8D%E7%AB%AF%E9%97%AE%E9%A2%98%E6%B8%85%E5%8D%95/:0:0","tags":["前端学习","HTML"],"title":"前端问题清单","uri":"/%E5%89%8D%E7%AB%AF%E9%97%AE%E9%A2%98%E6%B8%85%E5%8D%95/"},{"categories":["Website"],"content":"float导致的父元素高度塌陷 在文档流中，当父元素的高度设置为自适应的时候（height：auto），此时父元素的高度默认会被子元素撑开。但是当为我们子元素设置浮动（float）以后，子元素就会完全脱离文档流，导致子元素无法撑开父元素高度的情况出现。 流式布局 一种等比例缩放布局方式，在CSS代码中使用百分比来设置宽度，也称百分比自适应的布局。 可以保证当前屏幕分辨率发生改变的时候，页面中的元素大小也可以跟着改变，所以流式布局是移动端开发常用的一种布局。 浮动布局 元素的水平方向浮动，意味着元素只能左右移动而不能上下移动。 一个浮动元素会尽量向左或向右移动，直到它的外边缘碰到包含框或另一个浮动框的边框为止。 浮动元素之后的元素将围绕它。 浮动元素之前的元素将不会受到影响。 如果图像是右浮动，下面的文本流将环绕在它左边： \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"/\u003e \u003ctitle\u003e浮动布局\u003c/title\u003e \u003cstyle type=\"text/css\"\u003e .container{ width: 970px; margin: 0 auto; } .head, .foot{ clear: both; margin: 10px auto; } .middle{ clear: both; margin: 10px auto; } .item-1{ background-color: red; width: 277px; height: 103px; float: left; } .item-2{ background-color:chartreuse; width: 137px; height: 49px; float: right; } .item-3{ background-color:chartreuse; width: 679px; height: 46px; float: right; margin-top: 8px; } .item-4{ background-color:gold; width: 310px; height: 435px; float: left; margin-right: 10px; } .item-5{ background-color:lightblue; width: 450px; height: 240px; float: right; margin-right: 10px; } .item-6{ background-color: lightblue; width: 450px; height: 110px; float: right; margin-top: 10px; margin-right: 10px; } .item-7{ background-color: lightblue; width: 450px; height: 30px; float: right; margin-top: 10px; margin-right: 10px; } .item-8{ background-color: purple; width: 190px; height: 400px; float: right; } .item-9{ background-color: green; width: 650px; height: 25px; float: right; margin-top: 10px; } .item-10{ background-color: blue; width: 970px; height: 35px; } /* 清除浮动 */ .clearfix:after{ content:\"\"; display:block; visibility:hidden; height:0; clear:both; } .clearfix{zoom:1;} \u003c/style\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv class=\"head clearfix\"\u003e \u003cdiv class=\"item-1\"\u003e\u003c/div\u003e \u003cdiv class=\"item-2\"\u003e\u003c/div\u003e \u003cdiv class=\"item-3\"\u003e\u003c/div\u003e \u003c/div\u003e \u003cdiv class=\"middle clearfix\"\u003e \u003cdiv class=\"item-4\"\u003e\u003c/div\u003e \u003cdiv class=\"item-8\"\u003e\u003c/div\u003e \u003cdiv class=\"item-5\"\u003e\u003c/div\u003e \u003cdiv class=\"item-6\"\u003e\u003c/div\u003e \u003cdiv class=\"item-7\"\u003e\u003c/div\u003e \u003cdiv class=\"item-9\"\u003e\u003c/div\u003e \u003c/div\u003e \u003cdiv class=\"foot\"\u003e \u003cdiv class=\"item-10\"\u003e\u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 如何解决父元素塌陷？ 给父元素添加固定高度。 （缺点：添加了固定高度的父元素高度不再自适应） 给父元素添加属性overflow: hidden; 这时父元素就变成bfc block formatting context （缺点：当子元素有定位属性时,容器以外的部分会被裁剪掉) 在子元素的末尾添加一个高度为0的空白 div来清除浮动属性。 （缺点：在页面中添加无意义的div会造成代码冗余） 给父元素中添加一个伪元素 .父元素:after{ content: \"\"; height: 0; clear: both; overflow: hidden; display: block; visibility: hidden; } 当高度塌陷是因为position设置为absolute所导致的时候，上面的四种方法除了第一种把高度写死之外，其它三种方法都是无效的。 解决父元素高度塌陷的通常解决办法是在父元素中开启BFC。当子元素脱离文档流的原因是float，则可以通过开启BFC解决。但是如果子元素脱离文档流是因为absolute或者fixed，则开启BFC同样不管用。 Abstract 内联元素又名行内元素(inline element)，和其对应的是块元素(block element)，都是html规范中的概念。 ","date":"2023-07-27","objectID":"/%E7%88%B6%E5%85%83%E7%B4%A0%E5%A1%8C%E9%99%B7%E9%97%AE%E9%A2%98/:0:1","tags":["前端学习","HTML"],"title":"父元素塌陷问题","uri":"/%E7%88%B6%E5%85%83%E7%B4%A0%E5%A1%8C%E9%99%B7%E9%97%AE%E9%A2%98/"},{"categories":["Website"],"content":"定义initGame函数 初始化stack的二维数组 根据键盘判断左右移动方向 设置pause变量 调用游戏开始函数 ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:1:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义endGame函数 timer ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:2:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义runGame函数 if (!currentBlock) { if (stack[3][9]) { endGame(); return; } currentBlock = [4, 10]; redraw(); return; } if (canMove(currentBlock)) { moveDown(currentBlock); } else { stack[currentBlock[0] - 1][currentBlock[1] - 1] = true; currentBlock = null; } checkClear(); redraw(); ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:3:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义canMove函数 var can; var max; for (var i = 0; i \u003c stack[currentBlock[0] - 1].length; i++) { if (stack[currentBlock[0] - 1][i]) { max = i + 1; } } if (block[1] - 1 \u003e 0 \u0026\u0026 (block[1] - max \u003e 1 || !max)) { return true; } else { return false; } ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:4:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义reDraw函数 ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:5:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义makeElement函数 ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:6:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义moveDown函数 ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:7:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义pressLeft函数 ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:8:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义checkClear函数 ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:9:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"定义togglepause函数 ","date":"2023-07-03","objectID":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/:10:0","tags":["前端学习","JS"],"title":"一个俄罗斯方块的js代码","uri":"/%E4%B8%80%E4%B8%AA%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97%E7%9A%84js%E4%BB%A3%E7%A0%81/"},{"categories":["Website"],"content":"浮动布局 .aaa { width: 400px; height: 100px; border: 1px solid red; font-size: 32px; text-align: center; line-height: 100px; } // 行高100px 字体居中 .b1 { width: 20px; height: 20px; background: red; display: inline-block; } .www2 .ooo { vertical-align: bottom; line-height: 1; float: left; height: 50px; background: red; border-radius: 10px; } //没有空格 .www .ooo { vertical-align: bottom; line-height: 1; display: inline-block; height: 50px; background: red; border-radius: 10px; } //有空格 border-box content-box ","date":"2023-07-01","objectID":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A04/:0:0","tags":["前端学习","HTML"],"title":"前端学习4","uri":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A04/"},{"categories":["Website"],"content":"1、流式布局 标准文档流，从上到下，从左到右 内联元素 块级元素的内联元素可定位 display：inline-block 行高 ","date":"2023-07-01","objectID":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A03/:0:1","tags":["前端学习","HTML"],"title":"前端学习3","uri":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A03/"},{"categories":["Website"],"content":"2、浮动布局 Relative和absolute两种定位方式 1、 fixed 浮动固定 2、 absolute 绝对于父元素的定位（body） margin：auto margin-left：10px margin-right：10px 3、 relative 相对于自身定位 transform (-50%,-50%) 4、 清除浮动 float: left overflow：hidden 父元素的高度随着子元素的高度变化 ","date":"2023-07-01","objectID":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A03/:0:2","tags":["前端学习","HTML"],"title":"前端学习3","uri":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A03/"},{"categories":["Website"],"content":"3、定位布局 top left bottom .mainContent { width: 800px; margin: 0 auto; } .popModal { position: absolute; width: 800px; height: 400px; top: 50%; left: 50%; /*百分比是相对于父级定位元素相对的宽度进行计算*/ /*margin-left: -10%; margin-top: -10%;*/ transform: translate(-50%, -50%); /*百分比是相对于元素自身宽度进行计算*/ background: green; border-radius: 20px; } \u003cbody\u003e \u003cdiv class=\"mainContent\"\u003e \u003c!-- position定位 relative 相对自身的原始位置进行定位 absolute 相对于最近的带有定位元素样式的父元素进行定位 --\u003e \u003cimg src=\"airplane1.jpg\" /\u003e \u003cdiv class=\"popModal\"\u003e我是一个弹窗\u003c/div\u003e \u003c/div\u003e \u003c/body\u003e ","date":"2023-07-01","objectID":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A03/:0:3","tags":["前端学习","HTML"],"title":"前端学习3","uri":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A03/"},{"categories":["Website"],"content":"单选框 \u003cinput id=\"t1\" type=\"radio\" name=\"gender\" value=\"1\" /\u003e1 \u003cinput id=\"t2\" type=\"radio\" name=\"gender\" value=\"2\" /\u003e2 \u003cinput id=\"t3\" type=\"radio\" name=\"gender\" value=\"3\" checked /\u003e3 \u003cinput id=\"t4\" type=\"radio\" name=\"gender\" value=\"4\" /\u003e4 \u003cinput id=\"t5\" type=\"radio\" name=\"gender\" value=\"5\" /\u003e5 \u003cinput id=\"t6\" type=\"radio\" name=\"gender\" value=\"6\" /\u003e6 多选框 \u003cselect name=\"country\" multiple\u003e \u003coption value=\"China\"\u003eChina\u003c/option\u003e \u003coption value=\"UK\"\u003eUK\u003c/option\u003e \u003coption value=\"Japan\"\u003eJapan\u003c/option\u003e \u003coption value=\"USA\"\u003eUSA\u003c/option\u003e \u003c/select\u003e 输入框 \u003cinput name=\"user_id\" value=\"005\" type=\"text\" /\u003e \u003ctextarea name=\"content\" maxlength=\"10\" placeholder=\"please write content...\" required\u003e \u003c/textarea\u003e 下拉框 \u003cselect name=\"country\" \u003e \u003coption value=\"China\"\u003eChina\u003c/option\u003e \u003coption value=\"UK\"\u003eUK\u003c/option\u003e \u003coption value=\"Japan\"\u003eJapan\u003c/option\u003e \u003coption value=\"USA\"\u003eUSA\u003c/option\u003e \u003c/select\u003e submit按钮 \u003cinput type=\"submit\" value=\"Submit\" /\u003e 有序列表 \u003col\u003e \u003cli\u003evgfb\u003c/li\u003e \u003cli\u003ederrf\u003c/li\u003e \u003cli\u003eyus\u003c/li\u003e \u003c/ol\u003e 无序列表 \u003cstyle\u003e ul{ list-style: none; } ul li{ padding: 20px 10px; //列表项行距 } ul li:hover{ background: aqua; cursor: cell; border-style: solid; //鼠标选中效果 } \u003c/style\u003e \u003cul\u003e \u003cli\u003evgfb\u003c/li\u003e \u003cli\u003ederrf\u003c/li\u003e \u003cli\u003eyus\u003c/li\u003e \u003c/ul\u003e nodeType 属性以数字形式返回指定节点的节点类型。 如果节点是元素节点，则 nodeType 属性将返回 1。 如果节点是属性节点，则 nodeType 属性将返回 2。 如果节点是文本节点，则 nodeType 属性将返回 3。 如果节点是注释节点，则 nodeType 属性将返回 8。 ","date":"2023-07-01","objectID":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A02/:0:0","tags":["前端学习","HTML"],"title":"前端学习2","uri":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A02/"},{"categories":["Website"],"content":"前端学习 HTML标签（1） ","date":"2023-06-28","objectID":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A01/:1:0","tags":["前端学习","HTML"],"title":"前端学习1","uri":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A01/"},{"categories":["Website"],"content":"块级元素 padding 占据空间有background margin 无背景色 \u003ca\u003e\u003c/a\u003e 属性： href 链接页面 target 打开空页面 \u003cimg\u003e\u003c/img\u003e 属性： src 图片路径 width height alt 找不到时显示的文字 style=\"display: block; margin: 0px auto;\" 居中图片 \u003cdiv\u003e\u003c/div\u003e 属性：块级元素 style=\"background: aquamarine;color: blue;width: 800px;margin: 50px auto 100px auto\" 背景色/字体颜色/定位（上右下左） \u003cspan\u003e\u003c/span\u003e 属性：不能单独占据一行 \u003cbr/\u003e 换行 ","date":"2023-06-28","objectID":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A01/:1:1","tags":["前端学习","HTML"],"title":"前端学习1","uri":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A01/"},{"categories":["Website"],"content":"表单 \u003cform\u003e\u003c/form\u003e 方法：默认get，会显示参数到网址 Name：\u003cinput type=\"text\" name=\"attr1\"/\u003e 输入框 \u003cinput type=\"submit\" name=\"Submit-btn\" value=\"submit\"/\u003e 按钮键value赋值 复习题目 1 div有什么特点 和span img a元素有什么区别? 2 想做一个div自动居中要怎么做，原理是什么? 3 如何做一个表单，表单的post提交如何设置? 4 a标记想打开一个新的窗体要如何设置 ","date":"2023-06-28","objectID":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A01/:1:2","tags":["前端学习","HTML"],"title":"前端学习1","uri":"/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A01/"},{"categories":null,"content":"这是我的关于页面。 ","date":"2023-06-27","objectID":"/about/:0:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"Bodipy-GTPγS GCGR结合GTP慢一些 a non-hydrolyzable fluorescently labeled GTP analog, which is self- quenched in solution. 不可水解的荧光标记GTP类似物 nucleotide-free receptor complexes 核苷酸free受体复合物 GCGR shows a slower Bodipy-GTPγS (kon = 0.001 s−1) binding rate compared with the β2AR (kon = 0.003s−1)，说明 efficiency of GDP release and GTP binding are significantly reduced. ","date":"2022-03-19","objectID":"/associate-assays/:1:0","tags":null,"title":"Assays","uri":"/associate-assays/"},{"categories":null,"content":"Förster resonance energy transfer (FRET) GCGR结合Gs比b2慢一些 监测GPCR-Gs结合： Cy3B-labeled GCGR (red) / Cy3B-labeled β2AR (blue) Sulfo-Cy5-labeled Gs 间发生荧光能量共振转移 G protein association rate for GCGR with an association rate constant (kon) of 0.0044 s−1 is only slightly slower than for β2AR (kon = 0.0077 s−1) decrease in donor fluorescence shows comparable rates of association between the receptors and Gs ","date":"2022-03-19","objectID":"/associate-assays/:2:0","tags":null,"title":"Assays","uri":"/associate-assays/"},{"categories":null,"content":"[3H]-GDP dissociation assay GCGR的GDP解离会慢一些 GCGR catalyzed nucleotide release from [3H]-GDP loaded Gs with a substantially slower rate [dissociation rate constant (koff) = 0.002 s−1] compared with β2AR (koff = 0.042 s−1) 受体催化了[3H]-GDP loaded Gs的核苷酸水解 ","date":"2022-03-19","objectID":"/associate-assays/:3:0","tags":null,"title":"Assays","uri":"/associate-assays/"},{"categories":null,"content":"NanoBiT（NanoLuc Binary Technology） GCGR激活的G蛋白更少 Gα 亚基和 Gβγ 亚基之间的相互作用通过称为 NanoBiT (Promega) 的基于 NanoLuc 的酶互补系统进行监测。 NanoBiT-Gs 蛋白由在 α 螺旋结构域与大片段 (LgBiT) 融合的 Gαs 亚基和具有 C68S 突变的 N 末端小片段 (SmBiT) 融合的 Gγ2 亚基组成，与未标记的 Gβ1 亚基一起表达。使用载体处理的倍数变化信号来绘制 G 蛋白解离响应。 GPCR 配体诱导的 Gs 解离的代表性动力学数据 ! NanoBiT 基于互补的 G 蛋白解离测定法测量Gs解离动力学 表达 NanoBiT-Gs 蛋白和指定 GPCR 的 HEK293 细胞加载了腔肠素（一种荧光素酶底物），该细胞经过优化以在测试的 GPCR 中同等表达。在测量初始发光信号后，将载体或指定浓度的配体手动添加到细胞中。 测量配体浓度增加时的时间依赖性 Gs 解离和拟合绘制的浓度依赖性速率： 最大 Gs 解离速率的比较表明，相对于所有测试的 B 类受体，B 族受体通常催化显着较慢的 Gs 解离速率 (P = 0.019) ","date":"2022-03-19","objectID":"/associate-assays/:4:0","tags":null,"title":"Assays","uri":"/associate-assays/"},{"categories":null,"content":"overall 不含核苷酸的 Rab （G蛋白）和 GEF 形成稳定的二元复合物 ","date":"2022-03-19","objectID":"/associate-assays/:5:0","tags":null,"title":"Assays","uri":"/associate-assays/"},{"categories":null,"content":"PDB ","date":"2022-03-19","objectID":"/assays-sup/:1:0","tags":null,"title":"Assays Sup","uri":"/assays-sup/"},{"categories":null,"content":"隐藏侧链 ","date":"2022-03-19","objectID":"/assays-sup/:1:1","tags":null,"title":"Assays Sup","uri":"/assays-sup/"},{"categories":null,"content":"比对结构 align ClassA_gpr75_human_Active_7BU7_2021-11-02_GPCRdb, 3sn6 and chain R（指定受体） fetch 3sn6 align ClassA_gpr75_human_Active_7BU7_2021-11-02_GPCRdb, 7rmg and chain R（匹配的不好，NK1R helix8在膜上应该是水平而非翘起） create gfp, 3WLD and resi 59-302 （分离两个部分，可以隐藏其中一个） β2AR-Gs (pink, PDB 3SN6) peptide ligand–free state of GCGR (Fab-bound GCGR, blue, PDB 5XEZ) partial agonist NNC1702-bound GCGR (orange, PDB 5YQZ) GCGR GDP-bound Gαs (green, PDB 6EG8) Comparison between the interaction of ICL2 of GCGR (cyan) and β2AR (pink) (PDB 3SN6) 完全激活态 ZP3780 （GCGR-Gs） 特征： H-bonds (dotted lines) with residues in TM1, TM3, TM7, and ECL3 (cyan) The presence of H1 in ZP3780 ensures interaction with Q232 and may induce rearrangement of residues in TM5. interaction of D9 seems to stabilize TM7 and ECL3 displacement, which might trigger GCGR activation. R378对激活起决定性作用 Substantial structural change is observed in TM6, which moves outward by 18 Å and partially unwinds to form a kink with an angle of 105°. 部分激活态 partial-agonist NNC1702 （5YQZ） 特征： 和完全激活比， 没有H1 and has a D9E mutation 没有TM6 kink的向外摆（Reorientation of residues in TM3, TM5, and TM7 around the PxxG motif加速TM6变化）T351来度量 非激活态 Fab-bound GCGR（5XEZ） PxxG motif (P3566.47-L3576.48-L3586.49-G3596.50) b2R激活的Gs结构变化 ClassB：GDP-bound Gαs / nucleotide-free Gαs 后者α5 helix to engage the receptor core, and conformational rearrangements in the α1 helix and α5-β6 loop. 产生extensive polar interactions with TM5, TM6, and helix 8 (H8)。 在ClassB中是丙氨酸，hydrophobic pocket less efficiently；在ClassA中是苯丙氨酸F139 on ICL2，参与hydrophobic pocket lined by residues from the αN-β1 loop, the β2-β3 loop, and the α5 helix ","date":"2022-03-19","objectID":"/assays-sup/:1:2","tags":null,"title":"Assays Sup","uri":"/assays-sup/"},{"categories":null,"content":"Assay ","date":"2022-03-19","objectID":"/assays-sup/:2:0","tags":null,"title":"Assays Sup","uri":"/assays-sup/"},{"categories":null,"content":"GDP解离实验 GPCR-Gs-GDP复合物发生核苷酸水解，GDP才disassociate. A/B GPCR都在HDL particles和在去垢剂中的G蛋白亚基中进行重构。 Gas：Tcep/GDP，加大量的3H-GDP到终浓度2.5uM，孵育一小时 再加Gbr：DDM/Tcep，孵育30min GPCR in HDL：2mM GTP，100uM agonist，1h孵育 GDP load的G蛋白三聚体，5uM GPCR混合 不同的时间点，500ul wash buffer add to 20ul reaction microanalysis filter holder (EMD Milipore) and pre-wet mixed cellulose filters（滤膜） buffer洗，RT 1h晾干，残留的GDP放射性会bound to filters. liquid scintillation spectrometry(检测) 随着时间增加，解离下来的越多，膜上的荧光信号越强，代表bound的GDP越少。样品在闪烁液中引起闪烁，把核辐射能转换成光子。 ","date":"2022-03-19","objectID":"/assays-sup/:2:1","tags":null,"title":"Assays Sup","uri":"/assays-sup/"},{"categories":null,"content":"Bodipy-GTPγS binding （GTP结合实验） Bodipy-GTPγS是一个不水解的荧光标记的GTP类似物。在溶液中自己淬灭。结合G蛋白荧光会增强因为荧光团不淬灭。所以能看nucleotide-free GPCR–G protein complexes的GTP结合率。 对照：150 nM BODIPY-FL-GTPγS in the absence of receptor-G protein complexes for 100 s to establish the baseline fluorescence intensity 实验：Nucleotide-free GCGR-Gs and β2AR-Gs complexes（GDP的结合状态 此时GTP荧光弱） fluorescence form BODIPY-FL-GTPyS (Thermo Fisher) was recorded in 500 uL quarz cuvettes using the Fluorolog spectrophotometer (HORIBA). The fluorophore was exited at 495 nm and emission was detected at 508 nm at 22°C. Receptor-G protein complexes were added to 1 μM快速混合，取出看kinetics spectra，理论上结合了G蛋白的GTP荧光信号会增强。 随着时间增加，结合的GTP越多，和G蛋白结合的GTP被保护起来不会淬灭，荧光信号越强。 ","date":"2022-03-19","objectID":"/assays-sup/:2:2","tags":null,"title":"Assays Sup","uri":"/assays-sup/"},{"categories":null,"content":"DEER 用bis-(2,2,5,5-tetramethyl-3- imidazoline-1-oxyl-4-yl)disulfide (IDSL)标记受体；制样加ligand用80%的甘油冷冻起来，转移到硼硅酸盐毛细管。The observe pulses −70 MHz offset from the pump pulse，an echo nutation回声章动可以测定Optimal pulse lengths. L-curve criterion用于正则参数的距离分布确定。 测量DEER distance distributions；加了全激动剂之后也没有改变距离，说明TM5、6没有经历配体诱导的构像变化。 对比在b2中，DEER distance measurements between TM4 and TM6 have shown that agonist binding increases the population of the active state by stabilizing the outward conformation of TM6. 说明higher energy level of the fully active conformational state of GCGR in the presence of agonist alone compared with the β2AR ","date":"2022-03-19","objectID":"/assays-sup/:2:3","tags":null,"title":"Assays Sup","uri":"/assays-sup/"},{"categories":null,"content":"Bimane bimane 荧光光谱的最大发射波长 (λmax)说明一些构象的改变。 10uM Receptor + 5mol bimane or NBD 受体是最小的半胱氨酸 GCGR 构建体 (mC-GCGR)，以通过基于硫醇的化学进行位点特异性标记。 size exclusion chromatography purify receptors to remove label。 加了Gs后用cuvette检测受体Bimane，NBD荧光 λmax change of ligand and Gs binding是独立的测量荧光受体的不同状态得到的。拟合的 λmax 值作为高斯拟合的平均值。 TM6向外摆荧光会下降。 加了GDP/GTP后，尽管FRET 的变化导致 GCGR-Gs 复合物几乎完全解离，但是TM6没有复位，Bimane的信号还是很低。 ","date":"2022-03-19","objectID":"/assays-sup/:3:0","tags":null,"title":"Assays Sup","uri":"/assays-sup/"},{"categories":["virus","ngs"],"content":"概述 SARS幸存者的记忆B细胞中确定了几种感兴趣的单克隆抗体 位于冠状病毒的刺突结构中的感染性复合物刺突蛋白（S蛋白）三聚体，对冠状病毒能够识别宿主细胞表面上的ACE2受体、与之融合并将它们的遗传物质注入到宿主细胞中的能力至关重要。 S309抗体是保守抗体能抵抗多病毒。 单独或混合使用S309抗体限制冠状病毒形成突变体的能力，使得它们不能够逃避单个抗体的治疗。 ","date":"2020-08-31","objectID":"/%E4%BA%BA%E7%B1%BB%E5%8D%95%E5%85%8B%E9%9A%86sars-cov%E6%8A%97%E4%BD%93%E5%AF%B9sars-cov-2%E7%9A%84%E4%BA%A4%E5%8F%89%E4%B8%AD%E5%92%8C%E4%BD%9C%E7%94%A8/:0:1","tags":["SARS-Cov-2","antibody"],"title":"人类单克隆SARS-CoV抗体对SARS-CoV-2的交叉中和作用","uri":"/%E4%BA%BA%E7%B1%BB%E5%8D%95%E5%85%8B%E9%9A%86sars-cov%E6%8A%97%E4%BD%93%E5%AF%B9sars-cov-2%E7%9A%84%E4%BA%A4%E5%8F%89%E4%B8%AD%E5%92%8C%E4%BD%9C%E7%94%A8/"},{"categories":["virus","ngs"],"content":"Identifying a SARS-CoV-2 cross-neutralizing mAb 鉴定一个SARS-Cov-2的交叉中和单克隆抗体 broad usage of V gene segments, and were not clonally related Eight out of the twenty-five mAbs bound to CHO cells that express SARS-CoV-2 S glycoprotein or SARS-CoV S glycoprotein, with half-maximal effective concentration values These results suggest that S306 and S310 may recognize post-fusion SARS-CoV-2 S glycoprotein, which has recently been proposed to be abundant on the surface of authentic SARS-CoV-2 viruses the S309 IgG bound to the immobilized SARS-CoV-2 S domain and to the ectodomain trimer of the S glycoprotein with sub-picomolar and picomolar avidities, respectively The S309 Fab bound with nanomolar to sub-nanomolar affinities to both molecules comparable binding affinities of S309 to SARS-CoV and SARS-CoV-2 S glycoprotein(fig1.c) pseudovirus neutralization using a murine leukaemia virus(MLV) pseudotyping system Structural basis of S309 cross-neutralization S309交叉中和抗体的结构 We determined 3D reconstructions at 3.7 Å and 3.1 Å resolution, respectively, of the ectodomain trimer of the SARS-CoV-2 S glycoprotein with a single open SBdomain and in a closed state (apply- ing three-fold symmetry), both with three S309 Fabs bound S309 recognizes a proteoglycan epitope on the SARS-CoV-2 S , distinct from the receptor-binding motif. The epitope is accessible in both the open and closed states of the S glycoprotein, which explains the stoichiometric binding of Fab to the trimer of the S glycoprotein The 20-residue-long CDRH3 sits atop the SBhelix that com- prises residues 337–344, and also contacts the edge of the SB5-stranded β-sheet (residues 356–361), overall accounting for about 50% of the buried surface area CDRH3 and CDRL2 sandwich the glycan of the SARS-CoV-2 S glycoprotein at posi- tion N343, through contacts with the core fucose moiety (consistent with a previous study that detected SARS-CoV-2 N343 core-fucosylated peptides by mass spectrometry16) and to a lesser extent with the other saccharides within the glycan chain The structural data explain the S309 cross-reactivity between SARS-CoV-2 and SARS-CoV, as 17 out of 22 residues of the epitope are strictly conserved ","date":"2020-08-31","objectID":"/%E4%BA%BA%E7%B1%BB%E5%8D%95%E5%85%8B%E9%9A%86sars-cov%E6%8A%97%E4%BD%93%E5%AF%B9sars-cov-2%E7%9A%84%E4%BA%A4%E5%8F%89%E4%B8%AD%E5%92%8C%E4%BD%9C%E7%94%A8/:0:2","tags":["SARS-Cov-2","antibody"],"title":"人类单克隆SARS-CoV抗体对SARS-CoV-2的交叉中和作用","uri":"/%E4%BA%BA%E7%B1%BB%E5%8D%95%E5%85%8B%E9%9A%86sars-cov%E6%8A%97%E4%BD%93%E5%AF%B9sars-cov-2%E7%9A%84%E4%BA%A4%E5%8F%89%E4%B8%AD%E5%92%8C%E4%BD%9C%E7%94%A8/"},{"categories":["virus","ngs"],"content":"Mechanism of S309-mediated neutralization S309介导的中和机制 The cryo-EM structure of S309 bound to SARS-CoV-2 S glycoprotein presented here, combined with the structures of SARS-CoV-2 SBand SARS-CoV SBin complex with ACE2, indicate18–20,43that the Fab engages an epitope distinct from the receptor-binding motif and would not clash with ACE2 upon binding to S glycoprotein Biolayer interferom- etry analysis of S309 Fab or IgG binding to the SARS-CoV-2 SBdomain or the ectodomain trimer of S glycoprotein confirmed the absence of competition between S309 and ACE2 for binding to the SARS-CoV-2 S glycoprotein To further investigate the mechanism of S309-mediated neutraliza- tion, we compared side-by-side infection of SARS-CoV-2–MLV in the presence of either S309 Fab or S309 IgG. Both experiments yielded comparable IC50values (3.8 and 3.5 nM, respectively), indicating similar potencies for IgG and Fab However, S309 IgG-mediated neu- tralization reached 100%, whereas neutralization plateaued at about 80% in the presence of S309 Fab IgG-specific bivalent mechanisms—such as S-glycoprotein trimer cross-linking, steric hindrance or aggregation of virions44—may contribute to the ability of S309 to fully neutralize pseudovirions. Fc-dependent effector mechanisms, such as antibody-dependent cell cytotoxicity (ADCC) mediated by natural killer cells, can contribute to viral control in individuals infected with virus. We observed efficient S309- and S306-mediated ADCC of SARS-CoV-2 S-glycoprotein-transfected cells, whereas the other mAbs that we tested showed limited or no activity ADCC was observed only using natural killer (effector) cells that express the high-affinity FcγRIIIa variant (V158) but not the low-affinity variant (F158) (fig.d) These results, which we confirmed using a FcγRIIIa cell reporter assay (Fig. 3e), suggest that S309 Fc engineering could poten- tially enhance the activation of natural killer cells with the low-affinity FcγRIIIa variant (F158) However, FcγRIIa signalling was observed only for S309 (fig.g) ","date":"2020-08-31","objectID":"/%E4%BA%BA%E7%B1%BB%E5%8D%95%E5%85%8B%E9%9A%86sars-cov%E6%8A%97%E4%BD%93%E5%AF%B9sars-cov-2%E7%9A%84%E4%BA%A4%E5%8F%89%E4%B8%AD%E5%92%8C%E4%BD%9C%E7%94%A8/:0:3","tags":["SARS-Cov-2","antibody"],"title":"人类单克隆SARS-CoV抗体对SARS-CoV-2的交叉中和作用","uri":"/%E4%BA%BA%E7%B1%BB%E5%8D%95%E5%85%8B%E9%9A%86sars-cov%E6%8A%97%E4%BD%93%E5%AF%B9sars-cov-2%E7%9A%84%E4%BA%A4%E5%8F%89%E4%B8%AD%E5%92%8C%E4%BD%9C%E7%94%A8/"},{"categories":["virus","ngs"],"content":"Enhancing SARS-CoV-2 neutralization 加强SARS-Cov-2的中和能力 To gain more insight into the epitopes recognized by our panel of mAbs, we used structural information, escape mutant analysis26,32,35and biolayer-interferometry-based epitope binning to map the antigenic sites that are present on the SARS-CoV and SARS-CoV-2 SBdomains Given the lower number of mAbs that cross-react with SARS-CoV-2, we were able to identify site IV targeted by S309 and S303, and sites II and III targeted by S304 and S315 (Fig. 4b). Although S304 and S315 alone were weakly neutralizing, the combination of either of these mAbs with S309 resulted in an enhanced neutralization potency, compared to single mAbs, against both SARS-CoV-2–MLV and authentic SARS-CoV-2 (Figs. 1f, 4c, d). In summary, our study identifies S309 as a human mAb that has broad neutralizing activity against multiple sarbecoviruses (includ- ing SARS-CoV-2), via recognition of a highly conserved epitope in the SBdomain that comprises the N343 glycan (N330 in SARS-CoV S gly- coprotein). Furthermore, S309 can recruit effector mechanisms and showed increased neutralization in combination with weakly neutraliz- ing mAbs, which may mitigate the risk of viral escape. Our data indicate the potential to discover potently neutralizing pan-sarbecovirus mAbs, define antigenic sites to include in vaccine design and pave the way to support preparedness for future outbreaks of sarbecoviruses. As S309 shows promise as an effective countermeasure to the COVID-19 pandemic caused by SARS-CoV-2, Fc variants of S309 with increased half-life and effector functions have entered an accelerated develop- ment path towards clinical trials. ","date":"2020-08-31","objectID":"/%E4%BA%BA%E7%B1%BB%E5%8D%95%E5%85%8B%E9%9A%86sars-cov%E6%8A%97%E4%BD%93%E5%AF%B9sars-cov-2%E7%9A%84%E4%BA%A4%E5%8F%89%E4%B8%AD%E5%92%8C%E4%BD%9C%E7%94%A8/:0:4","tags":["SARS-Cov-2","antibody"],"title":"人类单克隆SARS-CoV抗体对SARS-CoV-2的交叉中和作用","uri":"/%E4%BA%BA%E7%B1%BB%E5%8D%95%E5%85%8B%E9%9A%86sars-cov%E6%8A%97%E4%BD%93%E5%AF%B9sars-cov-2%E7%9A%84%E4%BA%A4%E5%8F%89%E4%B8%AD%E5%92%8C%E4%BD%9C%E7%94%A8/"},{"categories":["virus","ngs"],"content":"人体免疫系统产生的中和抗体可以有效防止病毒感染细胞。靶向性中和抗体可以作为血浆治疗的有效成分。 方法： 8558个抗原结合的IgG1+克隆型（clonotype）中筛选出14种高强效中和抗体。 BD-368-2抗体对SARS-CoV-2具有较强的治疗效果和预防保护作用：将BD-368-2抗体注射到受感染的小鼠体内时，病毒载量降低了约2400倍；将BD-368-2抗体注射到未受感染的小鼠体内时，它们免受病毒感染. We performed small conditional RNA (scRNA) and scVDJ sequencing on the freshly isolated B cells or CD27+memory B cell subsets using 10X Chromium 50mRNA and VDJ sequencing To enrich for RBD-binding B cells, we utilized both biotinylated RBD and S protein to select for antigen-binding B cells through magnetic beads separation the scRNA-seq data enabled us to perform cell-typing based on mRNA expression for memory B cell identifications First, only enriched clonotypes containing IgG1-expressing B cells were selected (Figure 1C） The most potent mAb BD-368-2, which was selected from the same clonotype as BD-368 (Figure 1C), ex- hibited an IC50of 1.2 ng/mL. To increase the efficiency of neutralizing mAbs identification, we developed a set of criteria to filter out the clonotypes that have low chances to produce neutralizing mAbs (Figure 1D). We further screened all ELISA-positive mAbs for neutralizing ability using a SARS-CoV-2 pseudovi- rus system. We found that only RBD-binding mAbs showed pseudovirus neutralization effects (Figure 1E) Both full-length S protein and the RBD protein could enrich for RBD-binding mAbs but with distinct efficiency (Figure 1F). Among all the neutralizing mAbs isolated from enriched clono- types, seven of them showed potent neutralization ability with an IC50lower than 0.05mg/mL against SARS-CoV-2 pseudovirus (Figures 2A and 2C) To evaluate their neutralization potential against the authentic virus, we performed the plaque reduction neutralization test (PRNT) using authentic SARS-CoV-2 isolated from COVID-19 patients. Among all mAbs tested, BD-368-2 dis- played the highest potency against the authentic virus with an IC50of 15 ng/mL (Figures 2B and 2C). A total of 9 hACE2 transgenic mice were used in this study and were equally split into three groups (n = 3). The prophylactic efficacy was examined by intraperitoneally injecting 20 mg/kg (of mice body weight) BD-368-2 into hACE2 transgenic mice 24 h before viral infection (Figure 3A) We recorded the body weight for each mice daily after infection for 5 days (Fig- ure 3A) and found that the therapeutic and prophylactic treat- ment groups maintained their body weight, whereas the negative control group significantly lost weight (Figure 3B) This indicates that BD-368-2 applied both before and after the infection could greatly improve the physiological condition of the SARS-CoV- 2-infected mice. Moreover, we analyzed the viral load by qRT- PCR of the lungs at 5 dpi (Yang et al.,2007) and found that injec- tions of BD-368-2 before the viral challenge could completely inhibit SARS-CoV-2 Furthermore, applying BD- 368-2 2 h after infection could result in a 3–4 log decrease in virus copies in mice lung, indicating an effective reduction of SARS- CoV-2 replication (Figure 3C). Together, BD-368-2 exhibits high therapeutic and prophylactic efficacyin vivo. To date, no SARS-CoV-2 neutralizing mAb structures are recorded in the Protein Database (PDB), which could serve as a reference. To address this, we solved the cryo-EM structure of BD23-Fab in complex with the S ectodomain trimer at an overall resolution of 3.8 A The S ectodomain here adopts an asymmetric confor- mation as previously reported (Wrapp et al., 2020), with the RBD in one protomer (mol A) adopting an ‘‘up’’ position, whereas the other two RBDs (mol B and C) adopt ‘‘down’’ positions. In this 3D reconstruction, a single BD23-Fab is observed per S trimer, and it binds the ‘‘down’’ RBD in protomer B. Only the heavy chain variable domain of BD-23 is involved in binding to the RBD (Figure 4B). In fact, a comparison with the RBD-ACE2 complex structure demon- strates that BD23-Fab competes with ACE2 for binding to RBD (Figure 4C). The CDR3Hsequence of the identified mAbs shared high homology with m396 (2d","date":"2020-08-31","objectID":"/%E5%BA%B7%E5%A4%8D%E6%82%A3%E8%80%85b%E7%BB%86%E8%83%9E%E9%AB%98%E9%80%9A%E9%87%8F%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8F%E9%89%B4%E5%AE%9A%E7%9A%84%E6%8A%97sars-cov-2%E7%9A%84%E4%B8%AD%E5%92%8C%E6%8A%97%E4%BD%93/:0:0","tags":["SARS-Cov-2","antibody"],"title":"康复患者B细胞高通量单细胞测序鉴定的抗SARS-CoV-2的中和抗体","uri":"/%E5%BA%B7%E5%A4%8D%E6%82%A3%E8%80%85b%E7%BB%86%E8%83%9E%E9%AB%98%E9%80%9A%E9%87%8F%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8F%E9%89%B4%E5%AE%9A%E7%9A%84%E6%8A%97sars-cov-2%E7%9A%84%E4%B8%AD%E5%92%8C%E6%8A%97%E4%BD%93/"},{"categories":["virus","ngs"],"content":"概述： 人源化单克隆抗体H014，通过与S受体结合区域(RBD)结合，在纳米水平上有效中和SARS-CoV-2和SARS-CoV伪病毒以及真实的SARS-CoV-2（RBD处于开放构像才可以） 对可用的抗SARS-CoV和SARS-CoV-2中和抗体的表位分析发现了广泛的交叉保护表位。 H014 Ig G和Fab片段都与两个RBD紧密结合，在SARS-CoV-2 RBD和SARS-CoV RBD的亚nM水平上具有相当的结合亲和力 伪病毒中和试验表明，H014具有强大的中和活性：针对SARS-CoV-2和SARS-CoV假病毒的50％中和浓度值（IC50）分别为3 nM和1 nM。 针对真正的SARS-CoV-2菌株（BetaCoV / Beijing / AMMS01 / 2020）进行的噬斑减少中和测试（PRNT）验证了中和活性，IC50为38 nM，比假分型系统中观察到的低50倍 在先前建立的对SARS-CoV-2感染敏感的人ACE2（hACE2）人源化小鼠模型中评估H014的体内保护功效（15）。 在该模型中，由于hACE2在肺细胞上的表达，SARS-CoV-2进入肺部并与人类疾病一样复制，在感染后5天表现出肺部病理（dpi）。 hACE2-人源化小鼠经鼻腔感染5×105 PFU（1剂，治疗）后4小时（1剂，治疗）或之前12小时和4小时（2剂，预防加治疗）后以50 mg / kg腹膜内注射 SARS-CoV-2（BetaCoV /北京/ AMMS01 / 2020）。 在第5天处死所有受攻击的动物。而在第5天，PBS组（对照）肺中的病毒载量飙升至约107 RNA拷贝/ g。 值得注意的是，在预防组和预防组与治疗组中，H014处理分别在第5天导致肺中病毒滴度降低了约10倍和100倍（图1D）。 肺部病理分析表明，SARS-CoV-2引起轻度间质性肺炎，其特征是在PBS治疗后炎症细胞浸润，肺泡间隔增厚和明显的血管系统损伤。 相反，在接受H014治疗的小鼠的肺切片中未观察到明显的肺泡上皮细胞病变或局灶性出血（图1E），表明H014在治愈COVID-19中具有潜在的治疗作用。 具有H014 Fab片段的复合物中稳定的SARS-CoV-2 Sectodomain的Cryo-EM表征表明，该复合物采用三种不同的构象状态，分别对应于一个RBD打开+两个RBD关闭（状态1），两个RBD打开 +一个已关闭的RBD（状态2）和所有三个已打开的RBD（状态3） 有趣的是，在冷冻EM数据的3D分类期间，即使存在过多的Fab，也观察到了完全封闭的（状态4）SARS-CoV-2 S三聚体的结构，没有任何Fab结合，尽管存在过量的Fab，这表明H014的结合位点 通过蛋白质“呼吸”和随机的RBD运动暴露 asymmetric cryo-EM reconstructions of the 4 states at 3.4 – 3.6 Å H014 recognizes a conformational epitope on one side of the open RBD, only involving protein/protein contacts, dis- tinct from the receptor-binding motif (RBM) H014互补位构成了所有六个互补决定区（CDR）环（CDRL1-3和CDRH1-3）和异常的重链框架（HF-R，残基58-65），它们与RBD形成紧密的相互作用，从而导致 在约1,000Å2的掩埋区域 轻链和重链的可变域通过疏水和亲水接触分别占埋藏表面积的32％和68％。 H014表位由21个残基组成，主要位于α2-β2-η2（残基368-386），η3（残基405-408、411-413），α4（残基439）和η4（残基503）区域， 它们在RBD的一侧构造了一个空腔（图2，B和D，以及图S7）。 12个残基的长CDRH3插入该腔中，富集疏水残基（YDPYYVM）的CDRH3接触RBD的五链β-折叠（β2）区域的η3和边缘（fig.2D） RBD与H014之间的紧密结合主要归因于两个补丁的广泛疏水相互作用：一个由CDRH2的F54，来自CDRH3和A411的Y101，RBD的P412和Y508形成，另一个由Y49 from CDRL2, P103, Y104, Y105 from CDRH3 and V407, V503 and Y508 of the RBD （fig.2E） 此外，CDRH1和HF-R的亲水性接触进一步增强了RBD-H014的相互作用，从而在25°C或37°C的温度下，在亚nM水平上具有极高的结合亲和力 (fig.2E) 为了研究H014是否会干扰SARS-CoV-2或SARS-CoV的RBD与ACE2的结合，我们在蛋白质和细胞水平上进行了竞争性结合测定。 酶联免疫吸附试验（ELISA）表明，H014能够与重组ACE2竞争结合SARS-CoV-2和SARS-CoV的RBD，EC50值分别为0.7 nM和5 nM。 此外，H014有效地阻止了SARS-CoV-2 RBD与表达ACE2的293T细胞的结合以及重组ACE2与SARS-CoV-2 S的表达293T细胞的结合（图3B）。为了验证其在三聚体S上的潜在完全闭塞，我们通过将三聚体S首先暴露于H014，然后暴露于ACE2或相反的方式，进行了两组表面等离振子共振（SPR）分析。如预期的那样，H014的结合完全阻止了ACE2与三聚体S的结合。此外，ACE2可能会从三聚体S置换并被H014取代（图3C）。为了在基于细胞的病毒感染模型中进一步验证这些结果，进行了实时RT-PCR分析以量化残留在宿主细胞表面的病毒数量，这些病毒暴露于病毒在病毒附着之前或之后附着在细胞上在4°C下。 H014以剂量依赖的方式有效地防止了SARS-CoV-2附着在细胞表面，已经结合到细胞表面的病毒颗粒可能会被H014部分剥离（图3D）。 H014-SARS-CoV-2三聚体S复合物的结构在ACE2-SARS-CoV-2 RBD复合物结构上的叠加显示ACE2和H014之间存在冲突，这是由于属于结合位点的区域重叠造成的在RBD的顶螺旋（η4）处（图3E）。该观察结果与大多数已知的SARS RBD靶向抗体复合物完全不同，在后者中，抗体直接识别RBM（22-25）。因此，H014阻止SARS-CoV-2附着于宿主细胞的能力可以归因于与ACE2的空间冲突。与RBM相似，H014表位仅在开放状态下可访问，表明其作用类似于HBM。 RBM –在与宿主细胞相互作用中涉及动态干扰。我们的结构与先前报道的冠状病毒S结构（不包括人类冠状病毒HKU1（20））一起观察到了S1亚基的呼吸，它介导了“封闭”和“开放”构象之间的过渡。 In contrast to the hinge-like movement of the RBD observed in most structures, the conformational transi- tion from “close” to “open” observed in our structures mainly involves two steps of rotations: 1) counterclockwise move- ment of SD1 by ~25° encircling the hinge point (at residue 320); 2) the RBD rotates itself counterclockwise by ~60° These conformational rotations of the SD1 and RBD at proximal points relay an amplified alteration at the distal end, leading to opening up of adequate space for the binding of H014 or ACE2 模棱两可的是，在我们复杂的结构中观察到的特殊构象转变是由于H014的参与或SD1和RBD的协同运动导致的。 体液免疫对于预防冠状病毒感染是必不可少的，并且已证明消炎血浆的被动免疫可有效治疗SARS和COVID-19（12，26）。先前已经报道了许多SARS-CoV特异性中和抗体，包括m396、80R和F26G19，它们主要与RBM核心（SARS-CoV中的残基484-492）结合，只要RBD处于开放构象即可（图4，C和D）（24、27、28）。出乎意料的是，到目前为止，这些抗体均未显示出抗SARS-CoV-2的令人印象深刻的中和活性（7，8）。 S230是一种SARS-CoV中和抗体，尽管也需要RBD处于打开状态，但它在功能上模仿受体附着并促进膜融合，它可识别RBM顶部的小斑块（图4，C和D）（17 ）。最近，2003年来自SARS幸存者记忆B细胞的另外两种抗体（CR3022和S309）表现出与SARS-CoV-2的强结合力（9、10）。出人意料的是，CR3022无法在体外中和SARS-CoV-2，这可能是由于CR3022结合了一个隐秘的抗原决定簇，该抗原决定簇位于RBD的远端，并且仅当至少两个RBD处于打开状态时才可访问。此外，CR3022不与ACE2竞争与RBD的结合 ","date":"2020-08-31","objectID":"/%E6%9C%89%E6%95%88%E7%9A%84%E6%B2%BB%E7%96%97%E6%80%A7%E6%8A%97%E4%BD%93%E4%B8%AD%E5%92%8Csars-cov-2%E5%92%8Csars-cov%E7%9A%84%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/:0:1","tags":["SARS-Cov-2","antibody"],"title":"有效的治疗性抗体中和SARS-CoV-2和SARS-CoV的结构基础","uri":"/%E6%9C%89%E6%95%88%E7%9A%84%E6%B2%BB%E7%96%97%E6%80%A7%E6%8A%97%E4%BD%93%E4%B8%AD%E5%92%8Csars-cov-2%E5%92%8Csars-cov%E7%9A%84%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/"},{"categories":["virus","ngs"],"content":"conclusion 相比之下，最近报道的针对SARS-CoV和SARS-CoV-2的中和mAb S309识别了在SARS-CoV和SARS-CoV-2 RBD的打开和关闭状态均可访问的保守的含聚糖表位（ 10）。 S309的中和机制不依赖于受体结合的直接阻断，而是诱导抗体依赖性细胞的细胞毒性（ADCC）和抗体依赖性细胞的吞噬作用（ADCP）。 我们报道了一种有效的治疗性抗体H014，它可以通过阻断病毒与宿主细胞的附着来交叉中和SARS-CoV-2和SARS-CoV感染（图3）。 与其他抗体不同，H014结合RBD的一个完整侧面，从近端η2到RBM的远端边缘，并具有与SARS-CoV特异性抗体（例如m392、80R，F26G19，CR3022和S309）部分重叠的表位（图。 4，C和D）。 三种交叉反应抗体（CR3022，S309和H014）识别位于RBM以外的更多保守表位，其中CR3022表位与RBM距离最远（图4，C和D），提示其无法进行 中和SARS-CoV-2。 H014结合更保守的表位，其中一些与RBM非常接近，使其在交叉中和谱系B病毒中有效。 另外，识别超出RBM的更保守补丁的抗体将与靶向RBM的抗体具有协同作用，以增强中和活性，这可以减轻病毒逃逸的风险。 这项研究中揭示的H014表位的分子特征有助于在谱系B内发现广泛的交叉中和表位，并为基于结构的合理疫苗设计提出了有趣的目标。 我们的研究还强调了基于抗体的治疗性干预对COVID-19的治疗前景。 ","date":"2020-08-31","objectID":"/%E6%9C%89%E6%95%88%E7%9A%84%E6%B2%BB%E7%96%97%E6%80%A7%E6%8A%97%E4%BD%93%E4%B8%AD%E5%92%8Csars-cov-2%E5%92%8Csars-cov%E7%9A%84%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/:0:2","tags":["SARS-Cov-2","antibody"],"title":"有效的治疗性抗体中和SARS-CoV-2和SARS-CoV的结构基础","uri":"/%E6%9C%89%E6%95%88%E7%9A%84%E6%B2%BB%E7%96%97%E6%80%A7%E6%8A%97%E4%BD%93%E4%B8%AD%E5%92%8Csars-cov-2%E5%92%8Csars-cov%E7%9A%84%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/"},{"categories":["tech"],"content":"Crispr Cas9 Crisprcas9复合物可以介导内源基因组位点，使用工程改造的cas9激活复合物研究有效转录激活的sgRNA靶向规则，可以证明10个基因的多重激活。合成了一个包含70290个针对所有人类RefSeq编码亚型来筛选在激活后赋予对BRAF抑制剂抗性的基因。并且使用单个sgRNA和互补DNA的过表达验证了新的候选基因，最高筛选命中率的基因表达特征与细胞系和患者来源样品中的BRAF抑制剂抗性标记有关，这些结果共同证明了基于Cas9的激活剂作为强大的基因扰动技术的潜力。 ","date":"2020-08-30","objectID":"/crisprcas9-active-system/:1:0","tags":["张锋","crispr_cas9"],"title":"CrisprCas9 active system","uri":"/crisprcas9-active-system/"},{"categories":["tech"],"content":"Cas9-based activators Genetic perturbations： loss-of-function (LOF) ：RNA interference； RNA-guided endonuclease Cas9 from the microbial CRISPR (clustered regularly interspaced short palindromic repeat) adaptive immune system gain-of-function (GOF) ：cDNA library over expression systems（ drawback：transcript isoform variance ） three-component SAM system ","date":"2020-08-30","objectID":"/crisprcas9-active-system/:1:1","tags":["张锋","crispr_cas9"],"title":"CrisprCas9 active system","uri":"/crisprcas9-active-system/"},{"categories":["bioinfo","cryo-EM"],"content":"Grant Jensen cryo-EM The Grant Jensen Video series Probably the easiest way to learn EM and tomography. ","date":"2020-08-14","objectID":"/bioinfo-q-a-91/:1:0","tags":["AQ100","cryo-EM"],"title":"【bioinfo】-Q\u0026A-「91」","uri":"/bioinfo-q-a-91/"},{"categories":["bioinfo","cryo-EM"],"content":"outline 电流，线圈，旋钮。电子显微镜的基本结构。 电子枪eletron gun，电子透镜lense，色谱柱column，样品室chamber，能量过滤器，检测器，真空系统vaccum以及有关安全性 傅里叶变换和倒数空间。解释一维，二维，三维中的傅立叶变换。关于卷积和互相关的一些知识。 - What four parameters define a sine wave? What is the difference between a temporal and a spatial frequency? What in essence is a “Fourier transform”? How can the amplitude of each Fourier component of a waveform be found? 图像形成 幅度对比和相位对比，波传播以及添加具有不同相移的波如何产生不同的影响。这将使我们准备讨论对比度传递函数，散焦以及散焦的效果。 包络函数，最后，我们将讨论如何校正对比度传递函数振荡。 challenge 如何在电子显微镜的超高真空内保存原始状态的生物材料。现在，有些方法是在室温下完成的，还有一些方法涉及冷冻。我们将讨论所有这些。我们还将讨论使用的不同网格。 如何从电子显微镜传递的投影图像中获得三维重建 辐射损伤 层析成像 讨论层析成像样品制备的特殊问题 数据收集，如何选择记录倾斜序列和生成断层图所需的所有不同参数。 断层扫描所涉及的重建的特殊问题。如何识别断层图中的感兴趣对象。 这项技术的局限性 cryo-EM中的第二种基本形式，即单粒子分析 如何创建良好的初始模型 如何避免参考偏差，通常使用的基本工作流程的其他变化，如何评估分辨率 二维晶体学 样本准备问题，关于二维晶体学和重建数据收集的要点 ","date":"2020-08-14","objectID":"/bioinfo-q-a-91/:1:1","tags":["AQ100","cryo-EM"],"title":"【bioinfo】-Q\u0026A-「91」","uri":"/bioinfo-q-a-91/"},{"categories":["bioinfo","cryo-EM"],"content":"background ","date":"2020-08-14","objectID":"/bioinfo-q-a-91/:1:2","tags":["AQ100","cryo-EM"],"title":"【bioinfo】-Q\u0026A-「91」","uri":"/bioinfo-q-a-91/"},{"categories":["Structure Biology","Documentation"],"content":"M3R的结构特征/功能作用/G蛋白偶联特异性的决定 Receptor 药用靶标 G protein M1 神经系统疾病（如阿尔茨海默病和精神分裂症）/学习、记忆和认知 Gq/11 M2 调节人体心率和许多中枢神经系统功能 Gi/o M3 激活后受体磷酸化，募集b抑制蛋白能力受损 / 糖耐量受损伴随着M3受体介导的胰岛胰岛素释放降低 Gq/11 M4 神经系统疾病（如阿尔茨海默病和精神分裂症） /学习、记忆和认知 Gi/o ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:1:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"SAR, structure–activity relationship (Q)SAR 也是模型或数学关系（通常是统计相关性），它将与结构相关的特性与另一个感兴趣的特性或活动的存在或不存在或效力相关联。(Q)SAR最基本的数学形式是： 活性 = f（物理化学或结构特性） SARs 模型的开发需要三个组件： 为一组化学品（即因变量）提供活性（通常通过实验测量）的数据集。这组化学品通常由一些选择标准定义。因变量通常是可监测活性。 同一组化学品的结构标准或与结构相关的特性数据集（即自变量）。自变量通常是结构属性。 关联这两个数据数组的方法（通常是统计分析方法）。将结构与活动联系起来的方法范围从简单的线性回归，到更复杂的方法（例如偏最小二乘分析），再到最复杂的机器学习技术（例如神经网络）。 2018- Structure-guided development of selective M3 muscarinic acetylcholine receptor antagonists ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:2:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"比较M2R和M3R的正构结合位点 M3R的Tiotropium会识别非保守残基亮氨酸，M2R的QNB识别非保守残基苯丙氨酸。compound c的docking pose表明一个扩大的向上环可以越过M2R的非保守苯丙氨酸。 ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:3:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"Structure-based ligand design up-righting and rotation of ring B steric interactions with Phe181 for compound 6b 键的迁移 构象的限制 卤化 这篇文章找到了一个cmpd 6o（BS46），在小鼠体内验证了可以降低心率和降低气道阻力的功能。解了M3R与选择性拮抗剂6o (BS46) 复合的晶体结构。M3R的ICL3的细胞内环替换成mT4L。而在M2R中因为Phe181的空间阻碍而不能与6o结合。从而实现在比M2R选择性提高100倍，在体内有1000倍的选择性的效果。6o是根据M2R的拮抗剂QNB来设计的。 2012- Structure and dynamics of the M3 muscarinic acetylcholine receptor ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:4:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"M3R的主要结构特征 accessible surface for the M3 receptor bound to tiotropium (spheres) shows the receptor covering the ligand with a tyrosine lid (outlined in red). M3 receptor structure coloured by sequence conservation among the five mAChR subtypes. Poorly conserved regions are shown with larger backbone diameter. The orthosteric and allosteric sites are indicated in blue and red elliptical shaded areas, respectively, and the ligand tiotropium is shown as spheres. ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:5:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"ligand结合的动态变化 结合位点附近的 M2 和 M3 受体之间存在 Phe (M2)/Leu (M3) 序列差异。这会在 M3 受体中产生一个扩大的结合袋，用红色勾勒并用箭头表示。M3 Y5297.39 和 D1473.32 的位移(黑色虚线); Y5297.39 的位移可能源于 2.61 位的序列差异（M2 中的 Tyr 80 和 M3 中的 Phe 124）。 ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:6:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"G蛋白偶联特异性的决定条件 Distances were measured between Ca atoms of TM5 residue 5.62 and TM3 residue 3.54 (x-axis), and TM5 residue 5.62 and TM6 residue 6.37 (y-axis). Structural alignment of mammalian Gi/o-coupled and Gq/11-coupled receptor structures. 2017- Structure-based discovery of selective positive allosteric modulators of antagonists for the M2 muscarinic acetylcholine receptor 发现了M2 antagonist的PAM 628分子。 2014- Muscarinic acetylcholine receptors: novel opportunities for drug development 【Feather】 毒蕈碱乙酰胆碱受体是调节中枢和外周神经系统的许多基本功能的 G 蛋白偶联受体亚家族。 ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:7:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"T2D 2 型糖尿病的关键病理生理特征之一是胰腺 β 细胞无法分泌足够的胰岛素来克服外周胰岛素抵抗。 β 细胞 M3 受体促进胰岛素释放的能力取决于 Gq 家族 G 蛋白的存在； M3 receptor-mediated activation of arrestin-dependent β-cell pathways may further enhance insulin secretion； ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:8:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"Modes of targeting mAChRs (GPCRs) by different classes of ligands Orthosteric allosteric achieve greater receptor selectivity and promote more physiological response patterns bitopic target the allosteric site to achieve selectivity and the orthosteric site to provide high affinity. 2013- Activation and allosteric modulation of a muscarinic acetylcholine receptor 用酵母库筛选nanobody的方法找到nanobody9-8，并解析正构结合激动剂iperoxo和nanobody复合物结构。 2019- Structures of the M1 and M2 muscarinic acetylcholine receptor/G-protein complexes 解析了M1R和G11复合物结构，M2R和Go的复合物电镜结构。 2016- Crystal structures of the M1 and M4 muscarinic acetylcholine receptors M1-M4的结构对比 M1-M4正构异构结合位点残基比较 M4R的共建网络 2019- Conformational Complexity and Dynamics in a Muscarinic Receptor Revealed by NMR Spectroscopy M2R结合ligand的动态landscape 2013- Muscarinic Receptors as Model Targets and Antitargets for Structure-Based Ligand Discovery 【Feather】 In the M3 receptor, M2 Phe181 is replaced by a leucine ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:9:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"Docking poses for selected M2 muscarinic receptor hits. ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:10:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"Docking for selective M3 receptor ligands. 一些M2的ligand因为M3R的结合口袋更加亲水，溶剂可及性更好，会表现出对M3更高的亲和力。 ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:11:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["Structure Biology","Documentation"],"content":"Compound 16 activates M3 but not M2 receptors. ","date":"2020-06-18","objectID":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/:12:0","tags":["Receptor","Experiment"],"title":"M3系列文章概览","uri":"/m3%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0%E6%A6%82%E8%A7%88/"},{"categories":["tech"],"content":"SHERLOCK技术 ","date":"2020-02-26","objectID":"/sherlock-tech/:1:0","tags":["张锋","SHERLOCK","Cas13a"],"title":"SHERLOCK tech","uri":"/sherlock-tech/"},{"categories":["tech"],"content":"什么是SHERLOCK技术 SHERLOCK技术，全称是Specific High Sensitivity Enzymatic Reporter UnLOCKing，由华裔科学家张锋研发的一种新的快速，便宜，高灵敏度的诊断工具，相关文章发表在2017年的Science上[1]。SHERLOCK技术可以用于检测血清、尿液和唾液中低浓度的病毒，灵敏度可达阿摩尔级（aM，10的负18次方摩尔每升），而且可以用于检测病毒载量，区分不同的菌株，甚至可以分辨含有不同耐药突变的菌株和不同的癌症菌株突变，目前已经成功应用到武汉新型肺炎的检测中，具体的操作步骤已经公布在张锋课题组的网站上 (A protocol for detection of COVID-19 using CRISPR diagnostics)。 ","date":"2020-02-26","objectID":"/sherlock-tech/:1:1","tags":["张锋","SHERLOCK","Cas13a"],"title":"SHERLOCK tech","uri":"/sherlock-tech/"},{"categories":["tech"],"content":"SHERLOCK技术原理 SHERLOCK技术的原理由两部分组成，分别是RPA （Recombinase Polymerase Amplification）扩增和CRISPR-Cas13a系统。RPA是一种高灵敏度的等温扩增技术，在常温下即可完成核酸的快速扩增；CRISPR-Cas13a作为检测目的核酸序列的手段。下面将具体介绍这两个技术。 RPA 核酸扩增，可能大部分人接触到的仅有PCR（polymerase chain reaction），这说明你的知识该更新了。除了PCR，目前已有的核酸扩增技术还有RPA，NASBA（nucleic acid sequence-based amplification），SDA（strand displacement），RCA（rolling circle amplification），LAMP（the loop-mediated isothermal amplification），HAD (helicase-dependent amplification)，HCR (hybridization chain reaction)等技术 Detection，感兴趣的可以看相关的综述[2-4]。 RPA, Recombinase Polymerase Amplification，即重组酶聚合酶扩增技术。这是一种可以媲美PCR的技术，2006年由英国科技公司TwistDx发明。常规的PCR技术对温度控制有着复杂的要求，经历高温变性、低温复性还有中温延伸三个步骤，RPA就不需要这么麻烦，它的反应需要二种在常温下有活性的酶（重组酶，聚合酶），最适温度在25-42℃之间，不需要变性过程，这样就大大加快了扩增的速度，再加上不需要温控设备，这两点共同打造了真正便携式的快速DNA扩增技术。不仅方便快捷，RPA更“迷人”的地方在于扩增量十分高，能够将痕量的核酸（尤其是DNA）模板扩增到能够可以检测到的水平。痕量，顾名思义就是“该物质虽然存在，但只有‘痕迹’，无法用一般方法定量检测，通常含量＜0.1mg”。利用它可以从单分子得到大约1012的扩增产物。而且RPA还不需要复杂的样品处理，可以直接用病人的血清完成检测。 RPA的具体过程如Figure 1所示，涉及三个核心蛋白：recombinase, SSB, and strand-displacing polymerase。 首先，重组酶和引物结合形成复合物，在拥挤环境下利于复合物的形成。然后重组酶-引物复合物在目标DNA上寻找同源区域，找到之后会使得双链DNA解聚并形成D-loop。接下来SSB（单链结合蛋白）会结合到暴露的一条DNA链上，稳定D-loop，防止分支迁移。最后，聚合酶会使得重组酶与引物分离，并启动后续的扩增过程。整个过程中，recombinase, SSB, and strand-displacing polymerase还有引物可以被反复利用，在循环过程中，复制产物以指数形式增长，直到体系中的dNTP消耗完。 Figure1：RPA cycle CRISPR-Cas13a Cas13a蛋白，又称C2C2蛋白，它的发现历程比较有意思。2015年，张锋实验室通过序列比对发现Cas13a与众不同，跟cas9相比，其不具有Ruvc结构域，即没有DNA酶活性，但是具有两个HEPN结构域，即具有RNA酶活性，这一结论在2016年4月的Science杂志上得到了验证，Cas13a是一个RNA介导的RNA酶（figure2a）。然而，过个短短几个月之后，张锋的竞争对手Jennifer Doudna教授更进一步，在nature上发表文章，证实证明Cas13a具有两种RNA酶活性，一种是切割pre-crRNA称为成熟crRNA酶活性，一种是HEPN结构域的RNA酶活性，这个怎么理解呢，简单来说就是Cas13a除了能够切割crRNA之外，还可以切割其遇到的任何RNA，即所谓的**“collateral effect”，当然后一种RNA酶活性需要crRNA识别相应的RNA序列后才能激活**。基于这一点，可以通过猝灭荧光的RNA作为报告基团来检测目的RNA（figure2b），但是当时Doudna教授实验室的检测灵敏度只能够达到nM级别，没有实际应用价值。 Figure2：Cas13a complex and collateral activity SHERLOCK的诞生 前面提到过，CRISPR-Cas13a是不能被称为“SHERLOCK”的，因为Cas13a是达不到许多基础研究和临床应用所需要的灵敏度的。于是，张锋教授找了一个强有力的“外援”——RPA。利用RPA技术，在室温条件下，样品中的DNA或RNA含量可以快速得到提升，然后再将DNA转化成RNA。如此一来，Cas13a就进化成真正意义上的“SHERLOCK”了！ SHERLOCK其实是一个“团队”，张锋给Cas13a“配备”了两个助手：一个是引导它到达应该被切割的特异性RNA的“向导RNA”；另一个叫做“报告RNA”，因为Cas13a在切割完特定RNA后不会失活，所以在Cas13a完成任务开始“作乱”的时候，报告RNA就会被切断，发出荧光信号。这样研究人员们就知道，它已经找到了与其相匹配的RNA序列（Figure 3）。 Figure3：The scheme of SHERLOCK ","date":"2020-02-26","objectID":"/sherlock-tech/:1:2","tags":["张锋","SHERLOCK","Cas13a"],"title":"SHERLOCK tech","uri":"/sherlock-tech/"},{"categories":["tech"],"content":"SHERLOCK实验设计 主要包括样品处理，引物设计，crRNA设计以及结果检测等步骤。 样品处理 样品中的RNA酶会对检测结果带来极大的干扰，RNA酶导致向导RNA的讲解会产生假阴性的结果，RNA酶导致报告RNA的降解会带来假阳性的结果，为了避免这种干扰，在纯化核酸的过程中都需要加入RNA酶抑制剂。目前RPA已经分别有针对RNA提取和DNA提取的商业化试剂盒，保证结果不受RNA酶的影响。 引物设计 RPA扩增的引物一般为30-35 nt，包含正向和反向这一对引物，其中正向引物5’端通常含有T7启动子区，便于扩增之后的转录过程（Figure 4）。引物的退火温度在54-67℃之间，扩增的总长度在80-400 bp。 crRNA设计 向导RNA设计，最关键的一点在于不能与引物有互补，因为crRNA与引物的结合可能会导致与扩增产物的脱靶。间隔序列（spacer sequence）可以与扩增产物的任意区域配对，间隔序列要避免形成二级结构。直接重复序列（direct repeat sequence）位于间隔序列的5’端。间隔序列和直接重复序列共同构成crRNA，如Figure 4所示。crRNA根据正义链来设计，可以通过化学合成或者转染质粒的方式来获得。 Figure 4：The design of primer and crRNA 结果检测 目前常用的检测手段主要有荧光检测和层析检测。荧光检测是通过在一段寡聚RNA两端分别耦联荧光基团和淬灭基团来实现的，当含有目的产物是，报告RNA会被Cas13a切断，从而使体系内荧光基团发出荧光（Figure 5a）。层析检测则是在报告RNA的两端分别耦联荧光素和生物素，试纸条上的链霉素可以结合生物素，荧光素抗体可以结合荧光素，这样经过层析之后通过条带可以判断检测结果（Figure 5b）。 Figure5 ：Fluorescence detection and Lateral flow detection[9] ","date":"2020-02-26","objectID":"/sherlock-tech/:1:3","tags":["张锋","SHERLOCK","Cas13a"],"title":"SHERLOCK tech","uri":"/sherlock-tech/"},{"categories":["tech"],"content":"总结与展望 SHERLOCK技术具有以下的优点：1）高灵敏度：灵敏度可至aM级别，即1ul样品里的单个RNA或DNA分子都可以检测出来；2）高特异性：由于crRNA需要与目的核酸完全配对才会激活cas13a的RNA酶活性，所以单核苷酸突变也可以检测出来；3）快速：整个检测可以在1h内完成；4）成本低廉，一次检测的价格大约在0.6美元；5）便携：不需要借助PCR等精密的仪器，在常温下就可完成。凭借着其独特的优势，SHERLOCK技术有望在Point-of-care领域大放异彩。 基于RPA技术和CRISPR技术的结合还有很多可以挖掘的地方，基于Cas13a特性开发出的SHERLOCK是其中一个很好的例子，Cas13a的“collateral effect”是实现检测的前体，在Cas蛋白庞大的家族里面，我相信也会发现更多的有意思的酶用于核酸检测。 参考文献： [1] Jonathan S. Gootenberg, Omar O. Abudayyeh, Jeong Wook Lee, et al. Nucleic acid detection with CRISPR-Cas13a/C2c[J]. Science 4(2017) 438-442. [2] L. Yan, J. Zhou, Y. Zheng, et al, Isothermal amplified detection of DNA and RNA[J]. Mol. Biosyst. 10 (2014) 970–1003. [3] P. Craw, W. Balachandran, Isothermal nucleic acid amplification technologies for point-of-care diagnostics: a critical review[J].Lab Chip. 12 (2012) 2469–2486. [4] O. Piepenburg, C.H. Williams, D.L. Stemple, et al, DNA Detection Using Recombination Proteins[J]. PLoS Biol. 4 (2006) 1115–1121. [5] Ivan Magriñá Lobato, Ciara K. O’Sullivan. Recombinase Polymerase Amplification: Basics, applications and recent advances[J]. TrAC Trends in Analytical Chemistry. 1(2018) 19-35. [6] Rana K. Daher, Gale Stewart, Maurice Boissinot. Recombinase Polymerase Amplification for Diagnostic Applications[J]. Clinical Chemistry. 7(2016) 947-958. [7] Abudayyeh O O, Gootenberg J S, Konermann S, et al. C2c2 is a single-component programmable RNA-guided RNA-targeting CRISPR effector[J]. Science. 8(2016). [8] East-Seletsky A, O’Connell M R, Knight S C, et al. Two distinct RNase activities of CRISPR-C2c2 enable guide-RNA processing and RNA detection[J]. Nature. 9(2016) 270-273. [9] Max J. Kellner, Jeremy G. Koob, Jonathan S. Gootenberg, et al. SHERLOCK: nucleic acid detection with CRISPR nucleases[J]. Nature protocols 9(2019) 2986–3012. ","date":"2020-02-26","objectID":"/sherlock-tech/:1:4","tags":["张锋","SHERLOCK","Cas13a"],"title":"SHERLOCK tech","uri":"/sherlock-tech/"},{"categories":["bioinfo","immune"],"content":"解析肿瘤与免疫细胞的互作 癌症免疫疗法基于诱导或增强对癌症的免疫应答的药剂。 目前，除了靶向癌细胞的单克隆抗体外，单一疗法还基于三种策略：使用检查点阻断剂，接种新抗原和过继性T细胞转移。 另外，免疫单一疗法的组合以及免疫疗法和靶向疗法的组合也正在研究中。 癌症免疫疗法有可能适应肿瘤的变化，因为免疫系统能促进特定的T细胞的产生，识别肿瘤表面发生改变的抗原从而杀死肿瘤细胞。然而，肿瘤细胞可以通过上调免疫细胞表面的免疫检查点分子，如细胞毒性T淋巴细胞相关蛋白4（CTLA4）或程序性细胞死亡分子1（PD1）来逃避免疫系统的检测。最近，已经引入了几种阻断免疫检查点并由此增强抗肿瘤T细胞应答的抗体，并显示出显著的临床效果。接受CTLA4靶向抗体治疗的黑色素瘤患者，3年后存活曲线达到平台期，表明这种方法持久的益处甚至治愈潜力。此外，PD1靶向抗体的功效不仅在黑色素瘤中显示，而且在九种不同的肿瘤类型中也显示出来，如非小细胞肺癌，肝癌，肾癌和淋巴癌7。我们目前正在目睹检查点阻滞剂的快速发展，从150多项临床试验中可以看出，它们被用在单一疗法或联合治疗中7。然而，只有一小部分患者对检查点阻滞剂的单一疗法有反应，因此确定精确的作用模式和预测标志物是需要深入研究的主题。 继第一批癌症免疫疗法 - 即单克隆抗体的使用，以及检查点阻断剂免疫疗法的开发，和其他免疫治疗策略，包括治疗性疫苗和工程化T细胞，使得肿瘤 - 免疫细胞相互作用成为焦点。解析这些复杂的相互作用，有望鉴定预测性生物标志物，发展新药或新的治疗手段，并且促进机制研究。然而，由于这两种多细胞生态系统的演变和异质性，使得肿瘤-免疫细胞相互作用的研究具有相当大的挑战：癌症的发展，可以看作是一种进化过程；免疫系统，包含许多先天和适应性免疫细胞亚群，其中一些表现出表型可塑性并具有记忆。NGS技术和其他中高通量技术正在产生大量数据，需要信息系统来处理和分析数据，提取信息以开发机制理论并支持临床决策。因此，癌症免疫基因组学也可以被视为信息科学，并将为新型免疫治疗策略的开发和成功应用铺平道路。 首先简要介绍肿瘤-免疫细胞的相互作用，然后讨论用于挖掘癌症基因组数据和提取免疫参数的计算基因组学工具。 专注于对NGS数据的更高级别分析，包括肿瘤浸润淋巴细胞（TILs）的定量，肿瘤抗原的鉴定和T细胞受体（TCRs）的分析，并提供有关需求和功能的信息以帮助选择工具和分析管道的组装。 虽然这里的重点是癌症免疫学，但所讨论的计算方法也为研究其他疾病提供了手段，如自身免疫，炎症，感染或移植物抗宿主疾病。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-90/:1:0","tags":["AQ100","TCR"],"title":"【bioinfo】-Q\u0026A-90","uri":"/bioinfo-q-a-90/"},{"categories":["bioinfo","immune"],"content":"肿瘤-免疫细胞互作 癌症免疫循环包括几个连续步骤：癌细胞产生的新抗原在癌细胞死亡后释放并被树突细胞捕获。 接下来，树突细胞将主要组织相容性复合物（MHC）分子上捕获的抗原呈递给T细胞，导致针对癌症特异性抗原的效应T细胞应答的引发和活化。 在趋化因子梯度的指导下，活化的T细胞进入并渗入肿瘤部位。 T细胞通过T细胞受体（TCR）和新抗原-MHC复合物之间的相互作用特异性识别并结合癌细胞并杀死癌细胞（细胞溶解活性）。 各种分子和基因组学工具可用于评估这些癌症免疫细胞相互作用的每个阶段及其刺激或抑制因子。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-90/:1:1","tags":["AQ100","TCR"],"title":"【bioinfo】-Q\u0026A-90","uri":"/bioinfo-q-a-90/"},{"categories":["bioinfo","immune"],"content":"组学数据分析概述 NGS技术在基因组，转录组或表观基因组分析中的应用是肿瘤免疫基因组学数据的主要来源。此外，最近在图像技术和相关软件工具以及细胞表型分析技术方面取得了进展，可以生成与基因组类型相辅相成的数据类型。对于肿瘤免疫基因组学中大多数问题，可以应用与癌症基因组学中相同的NGS技术，它们包括全外显子组测序（WES），全基因组测序（WGS），RNA-seq，用于DNA甲基化分析的亚硫酸氢盐测序和单细胞测序。 然而，对于特定应用，例如TCR测序，需要仔细考虑读取长度，测序数据（WES，WGS或RNA-seq）的深度和类型。 在癌症免疫学的背景下对组学数据的分析可以被视为两步程序（图2）。在对原始数据进行预处理之后，第一步是组学数据分析，主要关注肿瘤本身。该步骤包括用于鉴定SNP，小的插入和缺失，拷贝数变异（CNV），结构变异，基因融合以及变体注释的工具。基因组分析组中的另一组工具用于分析使用RNA-seq评估的基因的表达，从WES和/或SNP阵列数据估计肿瘤异质性或分析DNA甲基化模式。第二类分析使用免疫基因工具，更关注肿瘤-免疫细胞相互作用。作为输入数据，它们使用基因组分析和/或原始测序数据的输出。这些免疫基因组学分析的结果提供了有关肿瘤微环境的两个关键特征的信息：浸润的免疫细胞的组成和功能定向以及肿瘤抗原的来源和数量。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-90/:1:2","tags":["AQ100","TCR"],"title":"【bioinfo】-Q\u0026A-90","uri":"/bioinfo-q-a-90/"},{"categories":["bioinfo","immune"],"content":"基因组数据确定肿瘤浸润的细胞组成 由于不同类型的TIL对肿瘤进展有不同的影响，确定肿瘤中免疫浸润的细胞组成不仅提供了预后信息，而且还可以促进标志物预测和新治疗策略的发展。成像和细胞表型技术被广泛使用，可以提供有关免疫结构的部分信息，但细胞表型分析技术的固有局限性阻碍了大量TIL亚群的特征化。因此，研究人员开发了计算基因组工具以提供TIL的全面图像。应用于此目的的计算基因组学工具可以分组为基因集富集分析（GSEA）和去卷积方法（图3a）。值得注意的是，GSEA和反卷积方法都依赖于个体细胞群的表达谱矩阵。用这些方法重建的TIL亚群包括在表达谱的参考矩阵中定义的免疫亚群。 富集方法依赖于基因集分析技术，基于样本之间的比较或单样本方法。 GSEA评估排序基因列表，用于统计富集参与某种途径和细胞过程的基因。在比较方法中，基于两种生物状态之间的差异表达对基因进行排序。或者，可以使用单样本GSEA（ssGSEA）富集评分，表示特定基因组中的哪些基因在单个样品中上调或下调了。 GSEA可用于解释从微阵列或RNA-seq获得的基因表达数据。 GSEA的优势在于它可以使用现有工具轻松应用，与传统的基因表达分析相比，没有额外的样本量要求。GSEA的必要要求是与特定免疫亚群相关的基因标记的组装（图3b）。在一项开创性研究中，从免疫和非免疫细胞的全血微阵列表达数据中定义了一组免疫特征基因34。最近，来自人免疫学项目的免疫学特征的基因集合（ImmuneSigDB）35被收录到分子特征数据库（MSigDB）36中。通过分析389项关于小鼠和人体免疫系统中细胞状态和扰动的已发表研究，产生了约5,000个注释良好的基因的补充35。 解卷积方法使用表达特征矩阵从来自细胞混合物的表达数据推断特定细胞比例（图3c）。基于该算法，开发了一种使用二次规划进行异质组织去卷积的R包.37。这个名为DeconRNASeq的软件包可以处理RNA-seq数据，但它仅在少数细胞类型的混合物上得到验证。已经开发了几种其他方法，其使用各种技术来解决病态反问题（表1）。最近，一种用于从大块肿瘤的微阵列数据推断白细胞亚型的计算方法（称为CIBERSORT）被引入38。 CIBERSORT使用22个白细胞亚群的信号表达矩阵并实现线性支持向量回归38。尽管计算方法有各种成功的应用，但仍有几个问题需要改进30。首先，需要具有基因表达谱的参考矩阵，所述基因表达谱来自血液样品或优选来自使用RNA-seq的肿瘤样品的分选的免疫细胞亚群。其次，由于解卷积对噪声敏感，因此必须开发和实现鲁棒算法。第三，需要使用独立方法验证方法，例如荧光激活细胞分选（FACS）或免疫组织化学。 与基于基因表达谱的去卷积方法一样，细胞谱系特异性DNA甲基化模式可用于检测和量化白细胞亚群39。为此目的，使用微阵列平台（即，Illumina Infinium 27k和450k DNA甲基化阵列），使用来自少数甲基化CpG基因座的信息到全基因组基因座开发了许多方法和工具39-41。将这种方法应用于亚硫酸氢盐测序技术的数据非常简单。从表观基因组关联研究中可以明显看出，表观基因组在不同细胞类型中的变异很大。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-90/:1:3","tags":["AQ100","TCR"],"title":"【bioinfo】-Q\u0026A-90","uri":"/bioinfo-q-a-90/"},{"categories":["bioinfo","immune"],"content":"肿瘤抗原的鉴定 T细胞能够识别与肿瘤细胞的MHC分子结合的肿瘤特异性抗原而排斥肿瘤。具有高肿瘤特异性的抗原 - 即由肿瘤细胞展示而不是由正常细胞展示 - 具有引发肿瘤特异性免疫应答的潜力，从而将不良副作用的风险降至最低，因此对于诸如工程化T细胞和治疗性疫苗的癌症免疫疗法具有重要意义。 三类抗原具有高肿瘤特异性：首先是病毒抗原，其源自在病毒感染的肿瘤细胞中表达的病毒基因；第二种是癌症种系抗原（CGAs），是通常仅由滋养细胞和种系细胞表达但在肿瘤细胞中具有异常表达的蛋白质;第三种是新抗原，它们是由体细胞突变基因的表达产生的肽链。自从发现第一个CGA，黑色素瘤抗原1（MAGE1;也称为MAGEA1）被鉴定以来，已经在几种肿瘤类型中鉴定到表达的大量癌症种系基因。迄今为止，Cancer-Testis数据库包含了有关CGA，和其在肿瘤和正常组织中的表达以及诱导的免疫应答的信息。利用可用的CGA列表，可直接在肿瘤和正常样品的RNA-seq数据中提取它们的表达水平。 新抗原可被认为具有严格的肿瘤特异性，因为它们源于恶性细胞中的突变基因的表达，但不存在于正常基因组中。为了引发免疫应答，必须将突变的蛋白质蛋白水解加工成短肽，然后与MHC分子结合，以呈递给T细胞（图4）。当从匹配的肿瘤和正常样品中获得NGS数据时，可以通过整合三个计算任务来计算新抗原（图4）：从匹配的肿瘤-正常样品中鉴定突变蛋白，然后进行HLA分型和然后预测新抗原-MHC的结合亲和力。 注意评估数据是否允许提取无偏见和有意义的信息。例如，阅读长度和覆盖深度对来自测序数据的免疫库和HLA等位基因的分析具有强烈影响。此外，还必须考虑用于生成数据的测序平台，以确定所选工具是否能够区分平台特异性测序错误与真实变体。另一个需要考虑的问题是批次效应，它是由不同实验条件引起的变异的技术来源。 可以使用降维工具（例如主成分分析）识别这些假象，并随后使用替代变量分析进行校正。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-90/:1:4","tags":["AQ100","TCR"],"title":"【bioinfo】-Q\u0026A-90","uri":"/bioinfo-q-a-90/"},{"categories":["bioinfo","zt"],"content":"Darwin IV 达尔文演化论最大的一个漏洞就是“寒武纪生命大爆发”：在寒武纪之前的地层中，只发现了简单的原核生物，但紧接着在短短2000万年之内，地球上同时蹦出了一系列与现代动物形态基本相同的动物，连达尔文自己都觉得无法自圆其说。所以，后人提出了很多新学说来对达尔文的演化论进行修正，下面我介绍几个比较有名的学说。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-89/:1:0","tags":["AQ100","evolu"],"title":"【bioinfo】-Q\u0026A-89","uri":"/bioinfo-q-a-89/"},{"categories":["bioinfo","zt"],"content":"新达尔文主义 最有名的代表性人物就是孟德尔，魏斯曼和摩尔根。（排名不分先后，大神们地下有知，不要出来咬我）孟德尔提出了性状分离，魏斯曼用切断尾巴的小鼠证伪了获得性遗传，摩尔根用果蝇证实了染色体携带遗传物质，这些应该都在中学生物课中讲授过（这点求证，我中学毕业的比较早，教材和现在不一样，只是讲课时看本科生都知道这些，所以猜他们中学时学过），我就不多啰嗦了。新达尔文主义最大的贡献就是把遗传和自然选择结合起来，但是也有很大缺陷，限于当时的认知水平，他们只在个体水平上研究演化。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-89/:1:1","tags":["AQ100","evolu"],"title":"【bioinfo】-Q\u0026A-89","uri":"/bioinfo-q-a-89/"},{"categories":["bioinfo","zt"],"content":"综合进化论或曰现代达尔文主义 综合进化论的主要观点有：彻底否定获得性遗传、强调进化的渐进性、认为进化是群体而非个体现象、将物种看作是一个生殖隔离的种群、肯定了自然选择的压倒一切的重要性、认为进化的速度和方向几乎完全是由自然选择所决定等。代表人物有杜布赞斯基（Dobzhansky，也有翻译成杜布尚斯基的，据说杜布赞斯基还曾将李森科的《遗传与变异》翻译成英文，只能慨叹大科学家也是人，也害怕攀附权贵的流氓）和赫胥黎等人。顺便八一八赫胥黎家族。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-89/:1:2","tags":["AQ100","evolu"],"title":"【bioinfo】-Q\u0026A-89","uri":"/bioinfo-q-a-89/"},{"categories":["bioinfo","zt"],"content":"间断平衡论 这是俩美国大牛埃尔德里奇（Niles Eldredge）和古尔德（Stephen Jay Gould）1972年提出的理论。他们认为进化是一种在短时间内爆发式产生的进化与在长时间稳定状态下的一系列渐变进化之间交替进行的过程，用图解释就是这样。 A是传统的观点，认为演化是稳步缓慢地进行的，而B间断平衡论认为演化可以在瞬间完成，之后长时间内物种的形态结构等等不发生什么变化。这个模型可以很好地解释“寒武纪生命大爆发”，但是依然有很大的漏洞，有人反驳说从南方古猿到直立人，脑容量从400ml增加到900ml用了350万年，这种脑容量的增长必须是渐变的，符合A的模型。所以间断平衡论还在争议中。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-89/:1:3","tags":["AQ100","evolu"],"title":"【bioinfo】-Q\u0026A-89","uri":"/bioinfo-q-a-89/"},{"categories":["bioinfo","zt"],"content":"分子进化中的中性学说 68年由木村资生（Motoo Kimura）提出的，他的观点是在分子水平上大多数的突变是中性的。学过生物学的都知道中心法则：遗传信息的流向是DNA—RNA—蛋白。在核酸翻译成蛋白的过程中，三个碱基编码一个氨基酸，也就是常说的三联密码子。如果仅有第三个碱基发生突变而不会影响编码的氨基酸，这个现象叫密码子的简并性。另外，很多时候氨基酸的突变也不会改变蛋白的功能区结构，同时基因组内还包括许多非编码区，非编码区的突变不会进行蛋白翻译，所以这种突变也是无义突变。木村先生就是从这点下手，计算碱基和蛋白的突变速率，得出这些突变往往并不会改变生物大分子的功能的结论，进而认为绝大多数突变是中性的，不会对个体造成有利或不利的影响。这种“中性突变”经过随机的“遗传漂变”在群体中固定下来或消失。请注意上面这句话中的“随机”二字，这个学说是通过中性突变和随机漂变这两个概念削弱了达尔文的选择理论，但依然不否认自然选择。本学说近年来受到很大关注，但由于提出的时间比较短，而且还有别的例子可以反驳中性学说，比如血红蛋白beta链第六位氨基酸突变本应导致镰刀形红细胞贫血症，这种病症的患者寿命极短，但却可以抗疟疾，使得在疟疾流行地区有很多人具有这种突变，所以本学说还需要更多的数据进行验证。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-89/:1:4","tags":["AQ100","evolu"],"title":"【bioinfo】-Q\u0026A-89","uri":"/bioinfo-q-a-89/"},{"categories":["bioinfo","structure"],"content":"B细胞受体胞外结构域的构象变化 在B淋巴细胞活化的起始阶段，抗原结合驱动B细胞受体胞外结构域内发生的构象变化。 B淋巴细胞是抗体免疫应答的核心效应细胞，通过分泌防护性抗体来清除入侵机体的病原体，从而保护人体的健康，并且留给人体记忆性免疫力。B淋巴细胞通过其表面表达的B细胞受体（BCR）识别外来病原体抗原，随后启动免疫活化进程。一直以来，抗原与BCR结合后起始B淋巴细胞活化的精细机制并不明确。该论文结合活细胞内蛋白质定点标记技术和荧光共振能量转移技术，利用全内反射荧光显微镜及荧光寿命显微镜等成像手段，研究了BCR在结合单价膜联抗原后，其胞外结构域内发生的构象变化。该论文发现IgM型BCR（IgM-BCR）在结合抗原后，膜联免疫球蛋白（mIg）分子内部发生了特定的构象变化；相比之下，IgG型BCR（IgG-BCR）在结合抗原后，mIg分子与Igα/β之间的距离发生了显著变化。上述构象变化与B淋巴细胞的活化强度密切相关。另外，IgM-BCR与IgG-BCR在结合抗原后表现出的构象变化差异取决于两者的mIg分子胞内区差异。这一发现为抗原结合起始BCR介导的B淋巴细胞活化的机制提供了新的解释：胞外的抗原结合通过引起BCR内部的构象变化，从而将活化信号传递至B淋巴细胞的胞内以开启下游信号通路。同时，这些研究成果也为B淋巴细胞免疫活化的调控机制研究提供了新的思路，帮助人们进一步理解B淋巴细胞活化的起始机制，从而对探索B淋巴细胞活化失调相关疾病的致病机理、以及药物与疫苗研发等重要工作提供新的理论依据。 lwl B细胞异常活化与相关疾病（Science、J Exp Med、Leukemia两篇、Cell Research、eLife和J Immunol两篇）、脂类代谢网络调控B细胞活化新机制（Cell、Science Immunology、Cell Reports、Nature Communications两篇、J Immunol和Frontiers in Immunology）、受体复合物调控B细胞活化新机制（Science Advances、PNAS、eLife、Chemical Science、International Immunology和J Leukoc Biol）和机械力感知系统调控B细胞活化新机制（J Cell Biol、Science Signaling、eLife两篇、J Immunol、Eur J Immunol和Protein Cell） 抗原结合引起的IgM-与IgG-BCR构象变化 ","date":"2020-02-24","objectID":"/bioinfo-q-a-88/:1:0","tags":["AQ100","BCR"],"title":"【bioinfo】-Q\u0026A-88","uri":"/bioinfo-q-a-88/"},{"categories":["bioinfo","structure"],"content":"首个硅藻光系统II-捕光天线超级复合体的近原子分辨率结构 单颗粒冷冻电镜技术解析的海洋硅藻角毛藻（Chaetoceros gracilis)光系统II-捕光天线超级复合体分辨率为3.02埃的三维结构，为解释硅藻 (diatom) 高效的能量传递和强大的光保护机制提供了关键的结构依据。 光系统II（PSII）是一个色素-蛋白超级复合体，它催化光诱导的水裂解反应，将太阳能转化为化学能，并释放出氧气。为了充分利用太阳能，光合生物进化出不同的捕光天线复合体（LHCs）用来捕获太阳能，并将能量传递给光系统II。捕光天线复合体II（LHCII）与PSII核心结合形成PSII-LHCII超级复合体。生活在不同环境处在不同光照条件下的不同进化路线上的光合生物有着复杂多变的LHCII。LHCII除了捕获光能之外，还有一个重要功能就是将强光照条件下吸收的多余的能量耗散掉，从而避免强光对光系统的损伤。 硅藻的适应性极强，除了空气和沙漠外，几乎所有的环境中都有硅藻，因此硅藻贡献了地球上每年原初生产力的25%左右（吸收二氧化碳的能力占全球生态系统的四分之一左右）。硅藻强大的适应能力依赖于其精致的细胞结构，高效的光合作用能力以及强大的光保护能力。硅藻的捕光天线系统主要结合叶绿素a/c和岩藻黄素（Fx），因此硅藻的捕光天线系统被命名为FCP，独特的捕光天线系统使硅藻在水下能高效的利用蓝绿光，同时还有极强的光保护能力 (图1)。 通过单颗粒冷冻电镜技术解析的海洋硅藻角毛藻（Chaetoceros gracilis)光系统II-捕光天线超级复合体的结构的整体分辨率达到3.02埃 (图2)。该结构显示PSII-FCPII超级复合体为二聚体，每个单体包含PSII核心的24个亚基和FCPII的11个亚基，还有200多个色素分子以及大量的脂质分子，整个PSII-FCPII超级复合体含有70个蛋白亚基，分子量高达1.4 MDa。硅藻的PSII核心与蓝藻和高等植物的比较相似，但是在放氧中心发现了另外5个外周蛋白，以及另外两个跨膜蛋白亚基，这两个跨膜蛋白亚基连接了PSII核心和FCPII。FCPII主要由两个四聚体组成，其中一个四聚体与PSII核心紧密结合（ST），另外一个则较为松散（MT）。另外还有三个FCP单体与PSII核心结合，其中两个FCP单体介导了结合较为松散的FCP四聚体（MT）与PSII核心的结合，第三个FCP单体结合在这个四聚体的外侧。硅藻PSII-FCPII的这种组装形式与绿色系进化路线光合生物的PSII-LHCII显著不同，硅藻紧密结合的FCP四聚体和松散结合的FCP四聚体的位置与高等植物紧密结合的LHCII三聚体和松散结合的LHCII三聚体的位置刚好相反。硅藻PSII-FCPII复合体近原子分辨率结构还揭示了大量的叶绿素a（Chls a）, 叶绿素c（Chls c），岩藻黄素（Fx），硅甲藻黄素（Ddx）和胡萝卜素（BCR）独特的排列方式，为阐明PSII-FCPII超级复合体独特的吸收光谱，高效的能量传递，水裂解和强大的光保护机制提供了重要基础，为揭示PSII复合体的进化演变提供了重要线索，也为人工模拟光合作用提供了新理论依据，同时为后续指导设计新型作物、提高作物的捕光和光保护效率提供了新思路。 A图从类囊体基质侧看整个PSII-FCPII超级复合体，虚线将整个结构分为两个单体。 B图将PSII-FCPII单体的各个亚基名称标识出来。 C图和D图将类囊体腔侧的5个蛋白亚基名称标识出来。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-87/:1:0","tags":["AQ100","EM"],"title":"【bioinfo】-Q\u0026A-87","uri":"/bioinfo-q-a-87/"},{"categories":["bioinfo","ncg"],"content":"组蛋白修饰通过促成相分离来调节染色质区室化 基因组被封闭在一个膜结合的细胞器中，即细胞核，以便更好地控制遗传信息流。在细胞核内，基因组被进一步调控形成很多区室或区域，这些区室或区域在调节基因表达时起重要作用。从它们的一些特征判断，这些动态实体区室类似于无膜细胞器。许多在染色质区室化中起作用的蛋白质具有LLPS的固有能力。这些包括之前关于植物中ADCP1的研究，其他还有HP1α，HP1a，CBX2。基于这些观察结果，有人已经提出染色质区室化是通过LLPS形成的。但是之前的研究都无法解释为什么无法自身或与DNA发生相分离的HP1β和HP1γ是如何行使类似的功能，以及组成型异染色质的形成是否受到人缘的三种HP1蛋白通过形成多价复合体与其识别的H3K9me3通过LLPS调节。 李丕龙和李海涛课题组合作证明在试管中，H3K9me3修饰与识别其修饰的HP1染色质结构域Chromodomain(CD)的多价态相互作用可导致异染色质的形成。作者使用了两种多价HP1-CD复合体（SUV39H1/HP1, TRIM28/HP1）以及人源细胞核提取物重点染色质片段（NE）、体外重组具有H3K9me3修饰的核小体串（NA）作为实验体系。几条证据表明这些液滴的形成是由于LLPS介导形成的。由此产生的液滴让人联想到异染色质的动态行为，以及对生化调节和突变表型的反应。作者得出结论，多价H3K9me3/CD相互作用驱动形成的LLPS是细胞中异染色质形成的关键作用力。综上所述，提出了组蛋白标记通过促进LLPS来调节染色体区室化的一般机制。 核小体串上的H3K9me3与HP1复合体的CD的多价相互作用介导的液-液相分离促进异染色质区室的形成 ","date":"2020-02-24","objectID":"/bioinfo-q-a-86/:1:0","tags":["AQ100","phase separation"],"title":"【bioinfo】-Q\u0026A-86","uri":"/bioinfo-q-a-86/"},{"categories":["bioinfo","structure"],"content":"5S核糖核蛋白复合体的合成与组装 对现有生命体系中生物大分子手性单一性问题,利用多学科交叉手段构建由L型核酸和D型蛋白质组成的镜像生物学体系。此前已报道镜像DNA的复制、PCR扩增、转录、逆转录、测序等多个系统 (Nat Chem, 8:698-704, 2016; Cell Discov, 3:17037, 2017; Chem, 5:848-857, 2019; Cell Chem Biol, 25:1151-1156, 2018)，并正在向构建基于镜像核糖体的镜像翻译系统方向努力，以实现完整的镜像中心法则。 构建镜像核糖体,镜像转录系统制备了镜像5S核糖体RNA，同时全化学合成了三个核糖体蛋白L5、L8和L25的镜像版本。实验表明，与天然系统相似，三个镜像核糖体蛋白均能与镜像5S核糖体RNA结合并形成复合体，而且这种结合具有手性选择性。此研究向构建由镜像核糖体RNA、转运RNA、核糖体蛋白及翻译因子组成的完整镜像翻译系统迈出了探索性的一小步。 体外组装 ","date":"2020-02-24","objectID":"/bioinfo-q-a-85/:1:0","tags":["AQ100","mirror"],"title":"【bioinfo】-Q\u0026A-85","uri":"/bioinfo-q-a-85/"},{"categories":["bioinfo","structure"],"content":"icSHAPE icSHAPE可以高通量地获取整个转录组的RNA结构。但是，之前的研究测得的是细胞内所有RNA的平均结构，不能区分不同空间分布的细胞组分间RNA结构的差异。 通过整合亚细胞分离技术与高通量RNA探测技术icSHAPE，解析了来自于人类和老鼠的两个不同细胞系染色体上，细胞核内与细胞质内三个组分的RNA结构。研究比较了不同亚细胞定位的RNA结构，并建立了RNA结构动态变化的位点图谱。通过关联研究，系统性分析了不同类型RNA修饰对RNA结构的影响，以及RNA结构和不同RNA结合蛋白（RBP）结合之间的相互关系。进一步，基于RNA的结构变化，将RNA的N6-甲基腺苷修饰（即m6A）的阅读器蛋白（reader）分成直接和间接阅读器（即结构阅读器）蛋白，以及阅读器和拮抗阅读蛋白。论文最后对新发现的m6A拮抗阅读蛋白LIN28A进行了验证。 出了RNA结构的动态变化特性，及其在基因调控中的功能意义。并深入解析了RNA结构动态变化的分子机制，特别是其与RNA修饰、RBP结合之间的相互关系。 by sunlei \u0026 stanford ","date":"2020-02-24","objectID":"/bioinfo-q-a-84/:1:0","tags":["AQ100","icSHAPE"],"title":"【bioinfo】-Q\u0026A-84","uri":"/bioinfo-q-a-84/"},{"categories":["bioinfo","structure"],"content":"如何利用同源建模预测蛋白质三级结构 已知蛋白质的一级序列，如何能够获得其三级结构呢？结构生物学领域的科学家们能够利用扫描电镜，核磁共振以及X衍射等手段获得绝大多数蛋白质的结构。但解析蛋白质结构毕竟是一个专门的领域，对于“门外汉”，同时又没有资金委托他人来解析结构的研究者来说，就只能自己预测了。 预测分为从头预测和同源建模。同源建模预测的准确度高于从头预测，尽管依然没有真实测定来的准确。通过对预测结构的分析, 是可以获得很多信息的，比如解释酶的催化机理或者预测蛋白质的突变位点, 推断蛋白质结构与功能的关系等等。那么如何利用同源建模来预测蛋白质的三级结构呢？ ","date":"2020-02-24","objectID":"/bioinfo-q-a-83/:1:0","tags":["AQ100","三级结构","同源建模"],"title":"【bioinfo】-Q\u0026A-83","uri":"/bioinfo-q-a-83/"},{"categories":["bioinfo","structure"],"content":"同源建模的原理 首先我们要了解同源建模的原理。同源建模具体指的是以与未知结构蛋白具有同源性的已知结构的蛋白作为模版，用生物信息学的方法通过计算机模拟和计算，根据一级序列预测其三维空间结构。 同源建模基于两个原理。第一，一个蛋白质的结构由其氨基酸序列唯一决定，知道其一级序列，在理论上就可以获取其二级结构以及三级结构。第二，蛋白质的三级结构在进化中更稳定或者说更保守。如果两个蛋白质的氨基酸序列有50%相同，那么约有90%的a-碳原子的位置偏差不超过3 Å，这是同源模型化方法在结构预测方面成功的保证。同源建模通常要求模板蛋白与目标蛋白的序列一致性高于30%。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-83/:1:1","tags":["AQ100","三级结构","同源建模"],"title":"【bioinfo】-Q\u0026A-83","uri":"/bioinfo-q-a-83/"},{"categories":["bioinfo","structure"],"content":"同源建模的步骤 同源建模可以通过以下7个步骤进行[1]： 1、搜索结构模型的模板(T)。 同源建模方法假设两个同源的蛋白质具有相同的骨架。为待预测的蛋白质建立模型时，首先按照同源蛋白质的结构建立模板T。所谓模板是一个已知结构的蛋白质，该蛋白质与目标蛋白质U的序列非常相似。如果找不到这样的模板，则无法运用同源模型法。 2、序列比对。 将目标蛋白质U的序列与模板蛋白质T的序列进行比对，使U的氨基酸残基与模板蛋白质的残基匹配。比对中允许插入和删除操作。 3、建立骨架。 将模板结构的坐标拷贝到目标U，仅拷贝匹配残基的坐标。在一般情况下，通过这一步建立目标蛋白质U的骨架。 4、构建目标蛋白质的侧链。 可以将模板相同残基的坐标直接作为目标蛋白质的残基坐标，但是对于不完全匹配的残基，其侧链构象是不同的，需要进一步预测。侧链坐标的预测通常采用已知结构的经验数据，如ROTAMERS 数据库中的经验结构数据。 5、构建目标蛋白质的环区(loop)。 在第2步的序列比对中，可能加入空位，这些区域常常对应于二级结构元素之间的loop，对于环区需要另外建立模型。一般也是采用经验性方法，从已知结构的蛋白质中寻找一个最优的环区，拷贝其结构数据。如果找不到相应的环区，则需要用其它方法。 6、优化模型。 通过上述过程为目标蛋白质U建立了一个初步的结构模型，在这个模型中可能存在一些不相容的空间坐标，因此需要进行改进和优化，如利用分子动力学、模拟退火等方法进行结构优化。 7、模型验证 蛋白质结构预测结果需要进行验证。下面是一个常用的结构检测服务器：来源于UCLA-DOE的SAVES服务器，http://services.mbi.ucla.edu/SAVES/ 这个服务器内包括6个用于预测结构准确性的工具，分别是PROCHECK、WHAT_CHECK、ERRAT、VERIFY_3D、PROVE、CRYST1 record matches、Ramachandran Plot、WedMol Viewer。这些软件可以分为两类：一类是检查结构的立体化学信息，比如PROCHECK。立体化学信息包括键长，键角，对称性，结构包埋率等等。另一类是检查序列与结构的匹配度，比如VERIFY_3D。用户可以同时运行所有的软件，也可以单独选择某一个进行运行。 PROCHECK生成的拉氏图（Ramachandran plot）。拉氏图就是蛋白质中残基的两个二面角ϕ 和 ψ 的相互关系图，将所有氨基酸的ϕ 和 ψ值相互对应，就可以做出这样的图了。在一个氨基酸中，ϕ指的是Ca与N之间的二面角， ψ指的是Cα与羧基C之间的二面角（详见下图）。 拉氏图分为四个区域: most favoured (red), additional allowed (yellow), generously allowed (light yellow) 以及disallowed (white)，红色表示的是最合适的区域，白色表示最不适合的区域。一个高质量的蛋白质结构的分辨率通常小于2 Å， R-factor小于20%。统计分析118个这样的蛋白质结构表明，对于一个高质量的模型结构来说，其90%的ϕ and ψ 值都应该在红色的区域内[2]。 下面对几个常用的软件进行简单介绍： Swiss-Model 这是非专业人士使用最广泛的一个工具，其特点是简单，自动化并且对学术团队免费。 网址：https://swissmodel.expasy.org Modeller 该软件由Sali lab开发，是非常常用的一个同源建模工具，目前最新版本是9.19，可在window和linux操作系统下运行。可以进行多聚体建模，二硫键建模，杂原子建模等。自带一套结构评价体系。该工具完全通过命令行控制，操作略复杂。 网址：https://salilab.org/modeller/ zhang服务器 Zhang服务器是使用I-TASSER算法用于蛋白质结构和功能预测的在线平台。 网址：https://zhanglab.ccmb.med.umich.edu/I-TASSER/ Yasara 一款商业化的多功能软件，内部包括同源建模模块。 网址：http://www.yasara.org/homologymodeling.htm nest nest由美国Columbia University 的Barry Honig教授及其同事开发，能够在SGI and Intel Linux平台下运行。 网址：http://honig.c2b2.columbia.edu/nest/ ","date":"2020-02-24","objectID":"/bioinfo-q-a-83/:1:2","tags":["AQ100","三级结构","同源建模"],"title":"【bioinfo】-Q\u0026A-83","uri":"/bioinfo-q-a-83/"},{"categories":["bioinfo","tech"],"content":"高性能磁标签：溶液与细胞内蛋白质三维结构测定、动态变化与作用研究的生物顺磁共振 Site-specific tagging of proteins with paramagnetic ions for determination of protein structures in solution and in cells 在Acc. Chem. Res.上总结了近10年生物体系的磁标签与蛋白质定点标记方法的发展，及其应用于生物磁共振（核磁共振和电子自旋共振）测定蛋白质三维结构、动态变化与细胞内行为。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-82/:1:0","tags":["AQ100","paramagnetic ions","structure"],"title":"【bioinfo】-Q\u0026A-82","uri":"/bioinfo-q-a-82/"},{"categories":["bioinfo","tech"],"content":"如何获取顺磁信息 蛋白质的三维结构、动态变化与相互作用是化学生物学和结构生物学研究中的重要内容，如何在细胞内环境下发展高分辨率方法阐述大分子作用机制与功能关系是迄需解决的重要问题。核磁共振和电子自旋共振分辨从原子核和电子层次上提供大分子的细微结构信息，发展高效的生物磁共振技术是了解细胞内环境下大分子运动机制的重要手段之一。核磁共振中的顺磁效应早期应用于复杂有机分子的谱学分析，随后逐渐应用到结构生物学和化学生物学研究领域中。核磁共振常用的顺磁效应有顺磁弛豫增强（paramagnetic relaxation enhancement, PRE）、赝接触位移（pseudocontact shift, PCS）和残余偶极耦合（residual dipolar coupling, RDC），这些信息都是研究生物大分子的重要结构约束条件。由于大部分生物大分子中不包含顺磁中心，因此获取顺磁信息需要对蛋白质进行定点修饰。核磁共振能提供原子分辨的蛋白质结构与作用信息，应用于生物磁共振研究的蛋白质定点修饰反应需要严格控制修饰的化学反应选择性和特异性并且同时保持蛋白质稳定的三维结构与活性。最近发展的双电子自旋共振（DEER）在测定大分子间作用过程中的距离变化，特别是细胞内行为，为精细大分子作用机制提供了重要研究手段，而DEER测定的关键是依靠高性能的顺磁标记物或顺磁探针；核磁共振中的顺磁效应同样依靠高性能的顺磁标签。因此发展温和、高产率的蛋白质定点顺磁标记方法是目前生物顺磁共振研究的重要内容。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-82/:1:1","tags":["AQ100","paramagnetic ions","structure"],"title":"【bioinfo】-Q\u0026A-82","uri":"/bioinfo-q-a-82/"},{"categories":["bioinfo","tech"],"content":"蛋白质定点顺磁标记中探针质量评价与顺磁效应分析 作者首先讨论了生物体系中通常应用到的顺磁性物质，论述并评价了自由基、过渡金属离子和稀土离子的适用性并提出稀土离子应用到细胞内生物磁共振（包括NMR和EPR）研究中的优越性，这是由于多数稀土三价阳离子的氧化还原稳定性、化学性质的类似性和多样的磁各向异性。随后根据多年的研究经验，作者系统论述了发展高质量顺磁探针应考虑的一些重要因素如金属螯合探针结合顺磁中心的稳定性、刚性、静电荷和疏水性以及探针与蛋白连接的稳定性和刚性，并系统论述了三种PRE、RDC和PCS之间的关系（图2）。由于顺磁效应的高灵敏性，作者特别强调了生物核磁中利用顺磁效应作为结构和动力学判据研究生物大分子体系该注意的一般问题。 通过蛋白质定点顺磁标记测定溶液中不稳定、低含量酶催化中间体的三维结构方法。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-82/:1:2","tags":["AQ100","paramagnetic ions","structure"],"title":"【bioinfo】-Q\u0026A-82","uri":"/bioinfo-q-a-82/"},{"categories":["bioinfo","tech"],"content":"通过PCS测定活细胞内蛋白质三维结构 已建立的位点特异性标记方法和新开发的顺磁探针的基础上，作者从真实的酶催化反应体系、活细胞和细胞内等几个事例说明了顺磁标记蛋白质在生物体系中的具体应用。1）作者通过定点顺磁标记方法以PCS为结构约束条件测定了真实反应体系中低含量（\u003c 30 μM）、不稳定（半衰期 \u003c 3 h） 酶催化中间体的三维结构（图3）。2）作者实现了以PCS为主要结构约束条件测定活细胞内蛋白质三维结构，该工作说明稳定顺磁标记探针在细胞内研究生物大分子结构与作用的实用性并提出PCS是细胞内蛋白质结构与动态分析的重要性结构约束条件（图4）。 由于顺磁核磁和电子自旋共振都借助于顺磁物质的特性，该课题组提出以生物核磁优化顺磁探针并应用到双电子自旋共振（DEER）测定中。作者证实生物核磁优化的刚性顺磁探针可以通过DEER测量获得高分辨的窄距离信息（图5）。该课题组通过发展高性能顺磁探针并成功应用到细胞内蛋白质的DEER测量中。 NMR研究中的刚性顺磁探针应用于EPR DEER测量中的高分辨距离信息 虽然已有多种顺磁探针报道，但是由于生物体系的复杂性，单一顺磁探针并不能简单适用于众多生物体系，作者建议应用多种顺磁探针并比较顺磁效应。 作者阐述了顺磁共振包括NMR和EPR在研究生物大分子体系的高度互补性并在原位条件下以原子分辨率水平研究生物大分子中的优势，并提出发展生物相容性定点标记蛋白质的挑战与机遇。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-82/:1:3","tags":["AQ100","paramagnetic ions","structure"],"title":"【bioinfo】-Q\u0026A-82","uri":"/bioinfo-q-a-82/"},{"categories":["bioinfo","tech"],"content":"molecular replacement是什么？ 分子置换（MR）是一种定相方法，它使用与晶体中的成分相关或同源的已知结构形式的先验信息。 由于MR不需要其他实验程序或数据，并且可以简化模型的构建，因此，当有合适的搜索模型时，MR通常是确定结构的首选方法。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-81/:1:0","tags":["AQ100","Molecular replacement","structure"],"title":"【bioinfo】-Q\u0026A-81","uri":"/bioinfo-q-a-81/"},{"categories":["bioinfo","tech"],"content":"Steps in structure solution with molecular replacement Model selection 合适的模型的结构通常是通过同源性搜索找到的（例如对于合理的近亲使用NCBI Blast或对于更远的亲属使用HHpred），并且可以通过与靶序列的序列同一性来表征。 使用分子替代品的主要限制是需要适当相似的搜索模型。 尽管没有确切的规则，但是序列同一性和MR成功之间的关系大致如下： Better than 40% identity: usually easy, unless large conformational changes are involved. 30-40%: MR usually possible, but sometimes more difficult. 20-30%: MR usually difficult if at all possible, careful model search and preparation required. Less than 20%: MR unlikely to work, but MR-Rosetta can help in marginal cases. In terms of RMSD, above 2.5A is very unlikely to work, while 1.5A or less is preferable. 经历大的构象变化的结构可能需要分成单独的域以进行搜索，而与序列同一性无关。 如果有多个类似的搜索模型可用，将它们组合到一个集成中通常会提高成功的可能性，尤其是如果使用Ensembler中的修整选项将该集成修整到其保守的核心时。 在Phenix中，可以使用Sculptor和Ensembler实用程序来准备搜索模型。 Sculptor可根据模型结构与目标序列之间的比对，通过修剪残基和侧链来改善模型，也可将B因子权重应用于模型，以减少不可靠的零件。 Ensembler可用于自动叠加同源模型。 推荐的顺序是先运行Sculptor，然后运行Ensembler，这是MR FAQ中解释的原因。 Molecular replacement 放置搜索模型的过程大致分为两个步骤，一个旋转函数(RF)确定其方向，一个平移函数(TF)确定其在单元格中的绝对位置。可以将多个组件按顺序放置以解决在非对称单元中包含多个副本的复杂晶体或晶体的结构。 Input files and mandatory parameters Phenix中的所有MR程序都需要一个包含实验数据（带有sigma）的单个反射文件。 Phaser-MR GUI将接受任何文件格式或数据类型，包括强度。 传统上，该过程使用所有反射，因此不需要R-free标志。 （与精化不同，这不会对最终的无R值产生明显的偏差，因为自由度非常低：每个分子旋转和平移六个自由度，而总B因子和估计的RMS误差则每个自由度。） 至少需要一个搜索模型； 在Phaser的上下文中，搜索模型通常称为“整体”。 在许多情况下，这将是包含一个结构的单个PDB文件。 对于更远的模型，可以改为使用实际的集成模型-具有多个MODEL记录的PDB文件或多个类似的PDB文件。 当使用多模型合奏时，所有模型都必须以相同的方向叠加。 Ensembler实用程序用于此目的。 搜索模型的大小，复杂性或数量没有限制。 对于复合物或多聚体，如果各个亚基的相对位置不变，则可以将整个组件（例如核糖体亚基）用作搜索模型，而不是分别放置每个组件。 另一种选择是使用电子密度（或者更确切地说，是包含预加权映射系数的MTZ文件）进行搜索，该密度通常以低分辨率求解或从cryoEM图像重建中获得。 这需要有关要搜索的地图部分的中心和范围的其他信息。 最好使用phenix.cut_out_density工具准备此MTZ文件，并确保将密度放置在至少是密度的x，y和z范围的2.5倍的单位单元中。 Phaser中使用的最大似然定相方法需要事先了解搜索模型与实际结构的偏差（或方差），以及预期的ASU含量或晶体的散射质量。 为了指定模型方差，可以使用RMSD值或百分比序列同一性（将使用从测试计算数据库确定的关系在内部进行转换）。 重要的是要尽可能减小方差（请参阅“模型选择”以获取指南），这通常需要消除原子或修改B因子。 给定PDB文件和序列比对，Sculptor实用程序将执行此步骤。 （这对于与目标分子具有高度序列同一性的搜索模型通常是不必要的，但是，特别是在较低序列同一性的情况下，强烈建议使用Sculptor实用程序处理模型。）此外，Ensembler实用程序可以修剪在成员之间有偏差的环。 合奏，仅保留保守的核心。 对于ASU内容物，您可以提供序列文件（蛋白质或核酸），或直接输入分子量。 如果知道，Phaser的独立版本还接受每个搜索集合的分数ASU内容。 请注意，ASU内容数据不一定与搜索集合具有1：1的对应关系（有关详细信息，请参阅MR FAQ）。 如果您希望在搜索多个亚基时仅指定复合物的分子量，则可以将复合物的质量作为单个组分输入。 （您也可以使用多记录FASTA格式的序列文件。）即使您仅从多个（例如，蛋白质-DNA复合物中的蛋白质）中搜索单个集合，您仍必须提供预期的ASU内容。 因为Phaser需要知道每个搜索模型包含不对称单元的哪一部分，所以整个晶体都是如此。 Outline of MR procedure 各向异性校正：按比例缩放反射以克服各向异性（特定方向上的弱数据）。 平移非晶体对称性（tNCS）校正：检查是否存在tNCS。 如果存在，确定描述副本之间平移和小的取向差异的参数，并将其用于计算校正因子。 旋转功能：识别模型的可能方向。 平移功能：给定来自RF的方向，找到晶胞中的绝对位置。 堆积分析：给定截止值，根据原子之间的碰撞数过滤TF结果。 精炼和定相：对放置的分子进行简单的刚体精炼，并根据最终溶液计算相。 对数似然增益计算：确定最终的LLG，可用于评估MR的成功性。 Limitations 由于模型偏差和/或多余的残渣而导致的包装冲突会导致抛出其他有效的解决方案。 相位器将尝试通过修剪精简到低占用率的链段来解决冲突。 如果这没有成功，则手动清除有害的残留物或降低填料的临界值可以解决该问题。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-81/:1:1","tags":["AQ100","Molecular replacement","structure"],"title":"【bioinfo】-Q\u0026A-81","uri":"/bioinfo-q-a-81/"},{"categories":["bioinfo","tech"],"content":"Automated Molecular replacement MRage框架将模型处理步骤和分子替换集成到一个应用程序中。 它提供了具有并行化选项的高度可定制的界面，并能够连接到NCBI Blast和wwPDB网站以执行同源性搜索并获取潜在模型。 Phaser主页上提供了单独的MRage教程。 ","date":"2020-02-24","objectID":"/bioinfo-q-a-81/:1:2","tags":["AQ100","Molecular replacement","structure"],"title":"【bioinfo】-Q\u0026A-81","uri":"/bioinfo-q-a-81/"},{"categories":["bioinfo","ngs"],"content":"methy-ATAC-seq同时测甲基化和染色质的可及性 伴随着10X genomics最近推出的sc-ATACseq的protocol，ATAC-seq技术将会掀起一股新的研究热潮。尤其是ATAC-seq与其他技术的结合，再搭上单细胞的快车，很多科学问题借助这个新的研究方法也许会有新的发现，至少会涌现出一批paper。 恰好看到群友推荐这篇methy-ATAC-seq的文章，可以同时检测甲基化与accessible chromatin，虽然目前还不是单细胞水平，不过还是值得一看。 doi: http://dx.doi.org/10.1101/445486 问题的提出 分开检测染色质的可及性和甲基化然后再整合分析，不能准确保证数据的一致性。将两种方法整合在一起，一次性检测染色质的可及性以及该区域的甲基化。 mATAC-seq方法 甲基化寡核苷酸被加载到Tn5上产生新的转座子 片段化 甲基脱氧胞嘧啶三磷酸（5-MdCTP）在转位后的末端修复反应中取代DCTP 这种修饰在mATAC-seq文库制备的最后步骤中保护Nextera adapter序列，这些序列是经过Tn5处理的染色质。 验证mATAC-seq与Omni-ATAC-seq和WGBS的一致性 DNA methylation detected by mATAC-seq replicates was highly reproducible at CpG Islands (r 2 =0.95) and peaks (r 2 =0.83) methylation levels reported by mATAC-seq correlated well with levels reported by WGBS at CpG Islands (r 2 =0.86) and peaks (r 2 =0.68) peak处的可及性和甲基化 显著性peak区域的RPKM和甲基化变化，以及相关的motif promotor区域的甲基化变化和可及性的比较 mRNA的变化与promotor区域的可及性变化 可及性和甲基化的整合分析 聚类 模块内启动子处的基因表达变化 RPKM,methylation,H2A.Z,启动子、增强子、CTCF的谱图变化 模块内的motif ","date":"2020-02-23","objectID":"/bioinfo-q-a-80/:1:0","tags":["AQ100","ATAC-seq","methylation"],"title":"【bioinfo】-Q\u0026A-80","uri":"/bioinfo-q-a-80/"},{"categories":["bioinfo","ngs"],"content":"Hi-C III 从 .hic 文件提取数据 此功能由 Juicebox tools 的 dump 命令完成。 https://github.com/aidenlab/juicer/wiki/Data-Extraction Arrowhead finding contact domains. arrowhead \u003cHiC file\u003e \u003coutput_file\u003e https://github.com/aidenlab/juicer/wiki/Arrowhead 生成一个12列的矩阵，每行包含以下信息 chromosome1 x1 x2 chromosome2 y1 y2 color corner_score Uvar Lvar Usign Lsign Explanations of each field are as follows: chromosome = the chromosome that the domain is located on x1,x2/y1,y2 = the interval spanned by the domain (contact domains manifest as squares on the diagonal of a Hi-C matrix and as such: x1=y1, x2=y2) color = the color that the feature will be rendered as if loaded in Juicebox corner_score = the corner score, a score indicating the likelihood that a pixel is at the corner of a contact domain. Higher values indicate a greater likelihood of being at the corner of a domain Uvar = the variance of the upper triangle Lvar = the variance of the lower triangle Usign = -1*(sum of the sign of the entries in the upper triangle) Lsign = sum of the sign of the entries in the lower triangle HiCCUPS HiCCUPS is an algorithm for finding chromatin loops. https://github.com/aidenlab/juicer/wiki/HiCCUPS 分为两个版本，gpu版本必须安装对应版本的CUDA。如果不能调用gpu的，可以使用cpu版本，加上参数–cpu。 与gpu版本的区别是限制在对角线8M范围内进行搜索，所以会有遗漏，但是大部分都会找到（The vast majority of peaks (98%) reflected loops between loci that are \u003c2 Mb apart）。 hiccups [-m matrixSize] [-c chromosome(s)] [-r resolution(s)] \u003cHiC file\u003e \u003coutputDirectory\u003e HiCCUPSDiff HiCCUPS Diff allows you to find differential loops between loop lists. https://github.com/aidenlab/juicer/wiki/HiCCUPSDiff APA ","date":"2020-02-23","objectID":"/bioinfo-q-a-79/:1:0","tags":["AQ100","HiC"],"title":"【bioinfo】-Q\u0026A-79","uri":"/bioinfo-q-a-79/"},{"categories":["bioinfo","ngs"],"content":"Hi-C II 上一章我们得到了.hic文件，从上图我们清楚的看出可以利用 juicer tools 对.hic 文件进行feature annotation 和 analysis 或者 data extration。也可以利用 juicebox 进行可视化。可视化文件主要使用的是 .hic 文件和各种 feature annotation 文件，例如 Contact domains 和 Loops 等。 .hic 文件的 pre 生成方法 https://github.com/aidenlab/juicer/wiki/Pre#file-format pre 命令允许我们从自己的数据转换成 .hic 文件，暂时没有需求先不写。 juicebox 可视化 下载软件 https://github.com/aidenlab/Juicebox/wiki/Download 英文官方教程 https://github.com/aidenlab/Juicebox/wiki 还有油管视频 可视化结果 ","date":"2020-02-23","objectID":"/bioinfo-q-a-78/:1:0","tags":["AQ100","HiC"],"title":"【bioinfo】-Q\u0026A-78","uri":"/bioinfo-q-a-78/"},{"categories":["bioinfo","ngs"],"content":"Hi-C I #创建工作目录，其后所有操作都在此目录下进行 mkdir ./opt cd opt #克隆 juicer git clone https://github.com/theaidenlab/juicer.git ln -s juicer/CPU scripts cd scripts/common wget http://hicfiles.tc4ga.com.s3.amazonaws.com/public/juicer/juicer_tools.1.7.6_jcuda.0.8.jar ln -s juicer_tools.1.7.6_jcuda.0.8.jar juicer_tools.jar cd ../.. # 参考基因组建立索引，我用的是 Homo_sapiens_assembly38.fasta mkdir references cd references cp \u003cpath\u003e/Homo_sapiens_assembly38.fasta # 或者 ln -s \u003cpath\u003e/Homo_sapiens_assembly38.fasta bwa index Homo_sapiens_assembly38.fasta cd .. # 添加限制性内切酶位点信息，注意自己的是不是 MboI 酶。 mkdir restriction_sites cd restriction_sites/ python2 ../juicer/misc/generate_site_positions.py MboI hg38_MboI ../references/Homo_sapiens_assembly38.fasta # 生成了 hg38_MboI.txt 文件 awk 'BEGIN{OFS=\"\\t\"}{print $1, $NF}' hg38_MboI.txt \u003e hg38.chrom.sizes cd .. # 添加 fastq 文件 (官方测试文件) mkdir fastq \u0026\u0026 cd fastq nohub wget http://juicerawsmirror.s3.amazonaws.com/opt/juicer/work/HIC003/fastq/HIC003_S2_L001_R1_001.fastq.gz \u0026 nohub wget http://juicerawsmirror.s3.amazonaws.com/opt/juicer/work/HIC003/fastq/HIC003_S2_L001_R2_001.fastq.gz \u0026 cd .. # 运行 Juicer bash scripts/juicer.sh -d \u003cpath/opt\u003e -D \u003cpath/opt\u003e -y restriction_sites/hg38_MboI.txt -z references/Homo_sapiens_assembly38.fasta -p restriction_sites/hg38.chrom.sizes -s MboI # 上面-z -p 设置绝对路径吧，要不然会识别不了。我直接改软件源码了，-d -D 都设置了还需要绝对路径，作者写的不人性化啊 fastq等文件输入 —》bwa比对 —》排序 —》合并 —》去PCR重复 —》生成 hic文件 结果文件 结果文件都放在了生成的 aligned 中，主要文件是 .hic 文件，其中的inter_30.hic 是设置了 mapq threshold \u003e30 后得到的结果。如果 GPU （cudd）可用，软件还会自动使用自带 HiCCUPS 算法计算 contact domains 并保存在 inter_30_contact_domains 文件夹中。如果GPU不可用，可手动用自带的 CPU HiCCUPS 算法来计算，后面章节有介绍。 hic文件格式请看 https://github.com/theaidenlab/juicebox/blob/master/HiC_format_v8.docx 重复样本合并 while getopts \"d:g:hxs:SD:\" opt; do case $opt in g) genomeID=$OPTARG ;; h) printHelpAndExit 0;; d) topDir=$OPTARG ;; s) site=$OPTARG ;; x) exclude=1 ;; S) stage=$OPTARG ;; D) juiceDir=$OPTARG ;; [?]) printHelpAndExit 1;; esac done ","date":"2020-02-23","objectID":"/bioinfo-q-a-77/:1:0","tags":["AQ100","HiC"],"title":"【bioinfo】-Q\u0026A-77","uri":"/bioinfo-q-a-77/"},{"categories":["bioinfo","ngs"],"content":"HiC分析pipe Mammalian genomes are spatially organized into compartments, topologically associating domains (TADs), and loops to facilitate gene regulation and other chromosomal functions. 3D interactions mostly occur within chromosomes (cis) rather than between chromosomes (trans), all methods detected more cis than trans interactions. 鉴定染色体交互 (identify chromatin interactions) Chromatin interactions are contacts between regions far from each other on the linear DNA sequence but close in 3D space； The total number of interactions called by each method increased with the number of reads retained by the filtering step for all tools at any resolution, although the rate of increase varied from tool to tool. Topologically Associating Domains (TADs) TADs are structural domains consisting of chromatin regions that are highly self-interacting but have limited interaction with regions in other domains; Used bin size (resolution) of at least 40 kb for TAD calling; cd /public/home/cotton/software/juicer/data java -jar ../CPU/juicer_tools.jar arrowhead -r 40000 -k NONE test.hic test_contact_domains_list Compartments The genome-wide chromosome conformation capture (Hi-C) has revealed that the eukaryotic genome can be partitioned into A and B compartments that have distinctive chromatin and transcription features. The current method for calculating A/B compartments is based on the Principal Component Analysis (PCA) of the normalized Hi-C interaction matrix (Lieberman-Aiden et al., 2009). The first eigenvector (Principal Component 1, PC1) of the correlation matrix is then defined as the compartment score, and genomic windows with positive or negative compartment scores are defined as A or B compartment, respectively. cd /public/home/cotton/software/juicer/data java -jar ../CPU/juicer_tools.jar eigenvector KR test.hic 1 BP 1000000 \u003e test.Compartments Chromatin loops HiCCUPS is an algorithm for finding chromatin loops. HiCCUPS 算法包含在 juicer 软件中，可按照如下手动单独运行（有GPU节点使用）： java -Xmx2g -jar ./CPU/juicer_tools.jar hiccups -h java -Xmx2g -jar ./CPU/juicer_tools.jar hiccups /public/home/cotton/software/3d-dna/xzp/Hs1.split.hic all_hiccups_loops java -Xmx2g -jar ./CPU/juicer_tools.jar hiccups -r 40000 -p 1 -i 3 -f 0.1 -d 80000 --ignore_sparsity /public/home/cotton/software/3d-dna/xzp/Hs1.split.hic hiccups_40kb Identification of chromatin interactions GOTHiC called the highest number of cis interactions; diffHic found the largest number of trans interactions; HiCCUPS, which aggregates nearby peaks into a single interaction, identified fewer interactions than all other tools. For interaction callers, HOMER and HiCCUPS yielded the highest proportion of interactions with a potential biological significance—although the potential of HiCCUPS could be fully exploited only in the analysis of very high-resolution data sets. Distance between the interacting points in cis GOTHiC found interactions at shorter mean distance at both 5- and 40-kb resolutions; At 5 kb, Fit-Hi-C called interactions at an average distance of more than 10 Mb; which was expected, as Fit-Hi-C is designed to call midrange interactions. At low resolution, GOTHiC had the highest concordance, most likely because it called a large number of short-range interactions in every sample replicate. At high resolution, the interactions found by HiCCUPS were the most conserved among replicates. At 5kb resolution, HiCCUPS and HOMER called the highest proportion of promoter–enhancer interactions, although not the highest absolute number. cis interaction 正确性和敏感性 GOTHiC recovered the largest number of true-positive interactions. HOMER and Fit-Hi-C performed comparably to GOTHiC, although they called a smaller number of total interactions. In high-resolution data sets, diffHic recalled the highest number of true positives, although HOMER identified more true positives than any other tool at comparable numbers of called interactions. The highest sensitivity was achieved by Fit-Hi-C. Identification of topologically ","date":"2020-02-23","objectID":"/bioinfo-q-a-76/:1:0","tags":["AQ100","HiC"],"title":"【bioinfo】-Q\u0026A-76","uri":"/bioinfo-q-a-76/"},{"categories":["bioinfo","cg"],"content":"single cell 如何研究宿主细胞和病原体之间的关系 Single-Cell RNA Sequencing to Understand Host−Pathogen Interactions 研究病原体为什么要用单细胞测序？ 为什么要做单细胞测序，其实已经是不言而喻的了，从下面一幅图也能体现出来。类似肿瘤的异质性，微生物，如细菌也存在很强的菌群异质性，除了细菌的亚克隆之外，还有合并感染等复杂的现象。如图所示的三种细胞群体特征，可能在bulk测序后得到相同的表型，因此而掩盖了真实的现象。一个典型的例子出现在大肠杆菌E.coli双稳态（bistability）的研究中。双稳态描述了一种可逆的双峰基因表达，导致两个不同的共存亚群。面对抗生素暴露，一小部分细菌群体会转化成持久细胞（persister cells），仍然以极低的生长速度存活。 除了细菌的菌群异质性和已知的宿主（免疫）细胞的异质性，细菌在宿主细胞中的寄生状态的多样性和动态变化又使得这类研究的复杂程度更上一层楼。当细菌接触到宿主细胞时，细菌可能内化，也可能不发生内化。当细菌内化发生了，宿主细胞作出的应答有可能是生存，清除或者死亡。生存状态下，细菌在宿主细胞内的可能发生增殖，也可能被抑制。死亡状态下，细菌可能共亡也可能逃逸。不同的感染结局可能由于细菌的表达谱差异或者宿主细胞的表达谱差异导致。而相同的感染结局也有可能是来源于具有表达差异的不同病原体-宿主组合。听完是不是觉得特别想吐血🤮？单细胞测序就像一个放大镜一样，可以让我们更细致的观察病原体感染的过程。因此我们非常需要它。 越来越多的单细胞测序方法涌现出来，对测序过程中任何环节的偏倚有了越来越好的修正方案。此外还有商业化的测序平台，如Fluidigm’s C1系统和10x Genomics，使单细胞测序从细胞分选、裂解、RNA提取、cDNA合成到建库测序变成流水线作业。针对单细胞的成套数据分析方法也不断被开发出来，如Seurat和SCDE已整合了单细胞测序数据分析的多步分析流程。 就像是当年人类基因组计划的升级版，多项单细胞层面的研究计划目前正在进行中，如Chan Zuckerberg研究所支持的The Human Cell Atlas，NIH支持的Human BioMolecular Atlas Program。这些计划中科学家们将对所有人体细胞类型和组织类型进行DNA、RNA和蛋白水平的研究，从而在细胞水平研究复杂机体的生物奥秘。除此之外，针对感染和免疫领域，Immunological Genome Project项目计划针对小鼠模型，检测所有免疫细胞亚型的表达谱数据，建立数据库，为研究免疫细胞行为，进化和发现新的免疫细胞亚型提供支持。该数据库收录了小鼠模型在不同感染疾病状态下，免疫细胞的单细胞测序数据。 微生物病原体与宿主关系的研究进展（举例） 最早的两篇从单细胞层面研究宿主-细菌相互关系的文章研究了鼠伤寒沙门氏菌和宿主巨噬细胞的相互作用。研究中仅对宿主细胞进行了单细胞测序，而病原菌则是利用荧光标记进行检测。Avraham等人研究发现细菌的变异性决定了宿主细胞的应答差异。感染的巨噬细胞的转录组分析揭示了一组双峰表达基因，它们富集在I型干扰素应答反应功能下，并且仅在三分之一的感染细胞中被诱导。该应答反应状态与细菌的PhoPQ双组分系统密切相关，由细菌表面LPS介导。研究进一步发现宿主细胞如果内化了高PhoPQ活性的细菌，则呈高I型干扰素应答反应；而宿主细胞如果内化了低PhoPQ活性的细菌，则呈低I型干扰素应答反应。研究证明了宿主的细胞的免疫应答反应差异是来源于感染细菌的菌群差异，而非宿主细胞的的异质性。Saliba等人则通过bulk dual-RNAseq发现内化的增殖型和非增殖型沙门氏菌可以引起宿主巨噬细胞不同的表型，有利于自己的生存。 文章作者认为目前研究进展所揭示的问题还比较初级，他提出了更多的研究议题有待我们去挖掘。这些都是写基金写本子非常好的主题，简直就是写作的源泉，我罗列一下。 从细菌的角度：为什么细菌选择性的感染某些细胞，而不是所有的细胞？为什么细菌在一些细胞中被清除，而在另一些中进行增殖？寄生的细菌是如何调控宿主细胞，帮助它们进行抗生素抵抗的？ 从宿主细胞的角度：如何鉴定感染的细胞和“旁观者”？宿主细胞的应答差异是由什么导致的？如果宿主细胞屈服，是什么决定了细胞死亡的模式？ 病毒与宿主关系的研究进展（举例） 病毒感染与细菌感染不同，病毒在感染前和感染过程中，其转录本不存在异质性。它们的异质性存在于核酸序列层面。它们可能来源于病毒亚群的核苷酸多态性，vmRNA（viral mRNA）的突变，病毒基因组拷贝数差异等。有些病毒，如流感病毒，它们的vmRNA也有尾部加poly A的特征，得益于此，常规的sc-RNAseq方法可以同时捕获病毒RNA，和宿主细胞mRNA共同进行建库和测序。通过比对病毒vmRNA序列，可以鉴定宿主细胞的感染状态。通过UMI计算vmRNA的丰度，可以获得宿主细胞的病毒载量信息。 Steuerman等人通过对感染流感病毒2天后的小鼠肺细胞进行单细胞测序，通过聚类对细胞亚群进行分类，结合细胞中的vmRNA水平，获得细胞的病毒载量信息，他们发现几乎所有类型的细胞中都可以检测到vmRNA，涵盖了62%的上皮细胞到22%的T细胞。这一发现挑战了传统的认知，认为流感病毒主要感染上皮细胞。这可能是由于以往研究是利用病毒表达的GFP报告基因，在其他类型的细胞中难以检测到造成的。这篇文章同时从侧面证明了利用单细胞进行病原菌研究的必要性，单细胞测序相比传统技术能拥有的更高的精度。研究人员还发现，上皮细胞的病毒载量差别能达到2个数量级，而在其他非上皮细胞中病毒载量通常很低。 另外一项研究中，Russell利用体外感染流感病毒的上皮细胞进行单细胞测序。体外试验在基因组水平上限定了流感病毒的单克隆性，最大限度的控制了病毒异质性导致的混杂因素。他们仍然观察到vmRNA在细胞之间载量的巨大差异。大部分感染的细胞仅检测到\u003c0.1% vmRNA，而有些细胞中能检测到50%的vmRNA。他们发现病毒载量的差异与病毒的基因表达和宿主感染相关的基因表达并不相关，而是和宿主氧化应激，G2-M细胞周期等基因的表达相关。这些结果背后的原因有待进一步研究。 从这两篇文章出发，作者又提出了一些有待被解答的问题。同样，它们也适合作为未来研究的主题。为什么有的细胞有高的病毒vmRNA载量，而其他细胞却似乎能限制病毒基因表达？vmRNA的差异导致了什么样的生物学结局？细胞中的病毒复制量是否从整理上决定宿主的感染结局？细胞裂解和潜伏感染之间的转化是如何调控的？ 研究病原体为什么(有时候)用不了单细胞测序？ 尽管sc-RNAseq技术发展迅猛，获得了越来越多的应用场景。比如一种名为Nuc-seq的方法可以对冰冻组织样本的细胞核进行分离标记，从而解除了单细胞研究只能做新鲜组织的限制。一种对细菌基因组分析的液滴法微流控技术，SiC-seq，也拓展到细菌单细胞转录组的应用领域。然而似乎技术的进步还没有普及到研究病原体-宿主相互作用领域。最理想的研究方案是能够对配对的宿主细胞及其内化的病原体进行同时测序（paired dual sc-RNAseq），如图c所示。 这种理想方案不能实现的原因之一来自于病原体（尤其是细菌）在宿主细胞中的表达丰度太低，并且与宿主细胞的mRNA含量形成巨大的悬殊。通过改进建库方法，算法流程以及增加测序深度取得了一些进展。scDual-seq技术的开发者声称，他们利用单个细胞和单个菌的纯化的RNA进行建库，该方法能够测序检测到470个沙门氏菌的转录本，提示尽管基因覆盖度较低，但针对单个细菌的检测是可行的。此外他们对内化了1-10个沙门氏菌的细胞进行测序，获得的转录本量和细菌数显示出了比较好的线性关系。但是该技术还没有经过体内实验验证。在自然状态下，绝大多数的细菌感染呈现宿主细胞和细菌1 vs 1的状态。低丰度的细菌转录本是目前技术发展最主要的挑战。 dual-sc-RNAseq的另一项挑战也是针对细菌的，它看似平凡，但非常困难。这一困难挡在了测序所有流程的最前面——细菌核酸提取的困难。由于具有夹馍，细胞壁等细胞结构，细菌的裂解变得困难。物理裂解法由于需要更大体积的溶剂无法配套常规的液滴法机械分选，化学裂解法则容易导致RNA降解或者污染，从而无法进行后续的建库实验。 病原体RNA量和宿主RNA量之间悬殊的差异也是dual sc-RNAseq的挑战之一。下图示意真核细胞RNA和细菌RNA的丰度关系。一个哺乳动物细胞大约含有10pg的总RNA，而单个细菌却只有100fg的总RNA，约为哺乳动物的百分之一。因此，在一个宿主细胞感染一个细菌的情况下，细菌的mRNA实际只占总提取RNA中的约0.05%。举个例子，病原菌中表达量最大的转录本，其含量和宿主细胞中表达量最小的转录本相当。因此可想而知，提高文库构建的效率，是提高基因覆盖率和检测率的关键。同时我们需要提高检测样本的细胞数来获得具有统计学意义的结果。尽管通过计算机工具和算法能有效降低分析所需的细胞数目，但这非常依赖所给定的病原菌的基因组注释信息的完整程度。 除了宿主细胞RNA对病原体RNA的稀释作用，病原体mRNA的捕获还存在另一项挑战。和真核细胞一样，细菌mRNA也只占其总RNA的5-10%。对于真核细胞，其mRNA具有ploy A尾的特征，因此通过互补的poly T引物可以很好的对其进行富集和捕获。而**原核细胞（细菌）的mRNA并没有poly A尾。**因此常规建库无可避免的会引入大量的rRNA和t","date":"2020-02-23","objectID":"/bioinfo-q-a-75/:1:0","tags":["AQ100","sc"],"title":"【bioinfo】-Q\u0026A-75","uri":"/bioinfo-q-a-75/"},{"categories":["bioinfo","cg"],"content":"总结 单细胞RNAseq革命拓宽了我们对细胞异质性的理解，并且认识到稀有细胞类型在所有生物学领域（包括宿主- 病原体相互作用）的存在和重要性。 这篇综述强调了宿主和病原体各自的异质性导致了他们遭遇后的无数可能的结果。 单细胞视角研究细胞行为将是我们研究复杂生理和病理状态下的生物学现象未来主要的研究手段。 ","date":"2020-02-23","objectID":"/bioinfo-q-a-75/:1:1","tags":["AQ100","sc"],"title":"【bioinfo】-Q\u0026A-75","uri":"/bioinfo-q-a-75/"},{"categories":["bioinfo"],"content":"病毒载体的构建什么区别 目的基因不能直接整合到大多数真核细胞，常用的手段是将目的基因包装成病毒来感染细胞，从而得到表达满足实验需求。 ","date":"2020-02-23","objectID":"/bioinfo-q-a-74/:1:0","tags":["AQ100","lentivirus","AAV"],"title":"【bioinfo】-Q\u0026A-74","uri":"/bioinfo-q-a-74/"},{"categories":["bioinfo"],"content":"病毒的种类 病毒有很多种，常见的有慢病毒和腺病毒 慢病毒 原理 慢病毒（Lentivirus）是逆转录病毒的一种。构建的siRNA / miRNA慢病毒载体，与化学合成的siRNA 和基于瞬时表达载体构建的普通 siRNA 载体相比，一方面可以扩增替代瞬时表达载体使用，另一方面，Lentivirus-siRNA克隆经过慢病毒包装系统包装后，可用于感染依靠传统转染试剂难于转染的细胞系如原代细胞、悬浮细胞和处于非分裂状态的细胞，并且在感染后可以整合到受感染细胞的基因组，进行长时间的稳定表达。 特点 1）直接包装成为假病毒颗粒，对分裂和非分裂细胞均有感染作用，适合 RNAi 研究和体内实验中难于转染的细胞 (比如神经元细胞、干细胞或其它原代细胞)。 2）可以通过简单方式，在短时间内获得稳定表达特定基因的多种细胞株。 3）可用于基因敲除、基因治疗和转基因动物研究。 4）无需任何转染试剂，操作简便。 5）可以根据客户需要制备多种标记。 慢病毒包装简要流程： 1）含有目的基因的慢病毒 RNAi 干扰载体的构建和质粒纯化提取。 2）慢病毒载体，包装系统共转染病毒包装细胞293T等。 3）培养 48hrs - 72hrs 左右，收集含有病毒的上清培养液。 4）病毒的纯化和浓缩。 5）分装、- 80 ℃保存。 6）滴度测定目的基因检定，并出具检测报告。 腺病毒 原理 腺病毒(Adenovirus，Ad)是一种无包膜的线状双链DNA病毒，其复制不依赖于宿主细胞的分裂。有近50个血清型，大多数Ad载体都是基于血清型2和5，通过转基因的方式取代E1和E3基因，降低病毒的复制能力。这些重组病毒仅在高水平表达E1和E3基因的细胞中复制，因此是一种适用于治疗的高效控制系统。 特点 1）几乎可以感染所有类型的细胞 2）可以获得复制缺陷型 (E1 和 E3 缺失) 的腺病毒 3）病毒滴度高，产生病毒经过浓缩后可以达到 1012 PFU/mL，能有效的进行增殖。 4）腺病毒载体感染宿主的范围比较广，制备容易，操作简单. 5）感染细胞时，不整合到染色体中，不存在激活致癌基因或插入突变等危险，生物安全性高。 腺病毒包装简要流程 1）构建表达 siRNA/miRNA 的腺病毒载体 2）采用 PacI 消化纯化的质粒。 3）消化好的腺病毒表达载体转染 293A 细胞，收获细胞以制备病毒粗提液。 4）将病毒粗提液感染 293A 细胞以扩增病毒。 5）分装，-80℃保存。 慢病毒和腺病毒的比较 慢病毒载体系统和腺病毒载体系统比较 病毒表达系统慢病毒表达系统（Lentivirus） 腺病毒表达系统（Adenovirus） 病毒基因组 RNA病毒 双链DNA病毒 复制 自主复制 自主复制 是否整合 病毒基因组整合于宿主基因组，长时间、稳定表达外源基因 病毒基因组游离于宿主基因组外，瞬时表达外源基因 感染细胞类型 感染分裂和不分裂细胞，适用于难转染的 原代细胞（如神经细胞）及体内实验感染分裂和不分裂细胞 表达风度 中水平表达 高水平表达 表达时间 慢（1-3天） 快（1-2天） 滴度滴度 最高可达10*8pfU/ml 滴度最高可达10*11pfU/ml 克隆容量 可插入不超过8kb的外源片段，滴度随插入片段长度增加而降低 可插入高达8kb的外源片段，滴度随插入片段长度增加而降低 免疫原性 低免疫原性 高免疫原性 ","date":"2020-02-23","objectID":"/bioinfo-q-a-74/:1:1","tags":["AQ100","lentivirus","AAV"],"title":"【bioinfo】-Q\u0026A-74","uri":"/bioinfo-q-a-74/"},{"categories":["bioinfo"],"content":"构建目的基因到载体 构建手段 一般是根据原始质粒信息确定克隆方案，有以下两种手段。 1）如果原始质粒与载体有匹配酶切位点，采用相应的内切酶切下相应片段，回收并连接到载体，酶切，并测序鉴定 2）如果没有匹配的酶切位点，则设计带有特殊接头的引物进行PCR扩增，得到目的片段，采用相应的内切酶切下相应片段，回收并连接到穿梭载体，酶切，并测序鉴定 质粒载体 概念 能够进行自主复制的环状DNA双链结构，包括真核生物的细胞器（主要指线粒体和叶绿体）中和细菌细胞拟核区以外的环状脱氧核糖核酸(DNA)分子 特征 质粒上常有抗生素的抗性基因，例如，四环素抗性基因或卡那霉素抗性基因等。有些质粒称为附加体(episome)，这类质粒能够整合进真菌的染色体，也能从整合位置上切离下来成为游离于染色体外的DNA分子。质粒在宿主细胞体内外都可复制。通过个些特性，人们可以把一些目的DNA片断构建在质粒中，通过转化入大肠杆菌中，利用选择培养基来筛选从而不断的复制，来得到目的产物。 ","date":"2020-02-23","objectID":"/bioinfo-q-a-74/:1:2","tags":["AQ100","lentivirus","AAV"],"title":"【bioinfo】-Q\u0026A-74","uri":"/bioinfo-q-a-74/"},{"categories":["bioinfo"],"content":"质粒DNA在大肠杆菌里转化 连接上目的基因的质粒转化大肠杆菌是为了让目的基因在大肠杆菌里扩增，然后提取质粒，以下是质粒DNA在大肠杆菌里转化的三步骤。 大肠杆菌感受态细胞的制备 1）从大肠杆菌平板上挑取一个单菌落于3mlLB培养基的试管中，37℃振荡培养过夜。 2）取0.4ml菌液转接到40mlLB液体培养基中，37℃振荡培养2~3h 3）菌液转移到50ml离心管中，冰上放置10min 4）4℃离心10min（4000r/min） 5）倒出培养液，将管口倒置以便培养液流尽 6）用冰浴的0.1mol/L氯化钙10ml悬浮细胞沉淀，立即冰浴30min 7）4℃离心10min（4000r/min） 8）倒出上清液，用冰浴的0.1mol/L氯化钙2ml悬浮细胞（冰上放置） 9）分装细胞，200ul一份，4℃保存 质粒DNA的转化 1）取200ul新鲜制备的感受态细胞，加入质粒DNA2ul混匀，冰浴30min 2）离心管放到42℃保温90s 3）冰浴2min 4）每管加800ulLB液体培养基，37℃培养1h（150r/min） 5）取适当体积（100ul）的复苏细胞，涂布在选择性培养基上，正置30min 6）倒置平皿37℃，12~16h，出现菌落 质粒提取步骤 1）取1~4ml在LB培养基中培养过夜的菌液，12000转离心1min，弃上清 2）加250ul溶液Ⅰ/RNaseA（溶液Ⅰ为细胞悬浮液）混合液，漩涡剧烈振荡直至菌体完全重新悬浮，室温静置1-2min。 3）加入250ul溶液Ⅱ（细胞裂解液），轻柔的反复颠倒混匀5-6次。室温放置1-2min，使菌体充分裂解，直至形成澄清的裂解溶液。 4）加入350ul溶液Ⅲ（中和液），立刻轻柔地反复颠倒混匀5-6次，此时会出现白色絮状沉淀。 5）12000室温离心10min，收集上清。 6）将上清置于DNA纯化柱中，静置1-2min。 7）12000转离心1min，弃滤液。 8）加入500ul溶液PB（洗涤液）12000转离心1min，弃滤液，目的是将硅胶膜上吸附的蛋白、盐等杂质洗脱，以获得高质量质粒DNA。 9）加入500ul溶液W（去盐液），12000转离心1min，弃滤液，重复一次。 10）12000转离心3min，以彻底去除纯化柱中残留的液体。 11）将DNA纯化柱置于新的离心管中，悬浮滴加50-100ul溶液Eluent（为无菌的双蒸水，PH为8.0-8.5），室温放置2min。 12）12000转离心1min，此时管底即为高纯度的质粒DNA，质粒于-20℃保存。 质粒提取步骤：吸取液体培养基于1.5ml离心管中12000转离心1min，弃上清，吸取培养基重复离心弃上清离心，留取少量菌液作为菌种保存，可直接置于-20℃——加250ulBufferS1悬浮细菌，悬浮均匀——加250ulBufferS2温和充分的上下翻转4-6次混合均匀，使菌体裂解——加350ulBufferS3温和上下翻转12000离心10min——取上清液转移到专用的制备管（2ml）12000转离心1min，弃滤液——加500ulBufferW112000转离心1min，弃滤液——加500ulBufferW212000转离心1min，弃滤液，重复一遍——将制备管置回2ml离心管12000转离心1min——将制备管移入新的1.5ml离心管中，加60~80ulEluent或离子水，室温1min12000转离心1min——移去制备管，将有质粒的离心管于4℃或是-20℃保存 ","date":"2020-02-23","objectID":"/bioinfo-q-a-74/:1:3","tags":["AQ100","lentivirus","AAV"],"title":"【bioinfo】-Q\u0026A-74","uri":"/bioinfo-q-a-74/"},{"categories":["bioinfo"],"content":"质粒DNA和其他包装质粒共转染293T细胞产生病毒（即病毒包装） 名词解释 293T细胞是由293细胞派生, 表达SV40大T抗原的人肾上皮细胞系, 被广泛应用于瞬时转染以过表达各种目标蛋白, 或是用以包装病毒。 脂质体：某些细胞质中的天然脂质小体，可作为生物膜，用于捕获外源性物质后更有效地运送到靶细胞，经同细胞融合而释放。 共转染的操作步骤 第一天：用无抗生素DMEM+10%FBS铺板293FT细胞，2ml/孔。确保第二天细胞密度达到80%-90%融合度 第二天： 1. 500ul 无血清培养基稀释2ug 表达质粒+1.5ug psPAX2+1.5ug pMD2.G 2. 500ul 无血清培养基稀释15ul 脂质体2000 3. 5min后，将DNA溶液和脂质体溶液混合，室温静止20min 4. 从6孔板中吸出1ml无血清培养基，然后滴加入1ml质粒和脂质体混合物。 5. 6-10h后，移除含有DNA-脂质体复合物的培养基，代之以正常培养液DMED+10%FB（从此刻开始算时间）。 第三天： 1.转染24h后，荧光显微镜下观察，转染效率应达到70%以上 第四天： 1.转染后48和72h分别收获含病毒的上清。 2.3000 rpm 离心20min，0.45um滤膜过滤，去除细胞沉淀。 3.12000转离心浓缩细胞、分装-80°C贮存。 4.滴度测定目的基因检定，并出具检测报告。 病毒包装的原理 质粒DNA为能转录出慢病毒遗传物质（RNA），但不能翻译出慢病毒的外壳及蛋白成分的载体质粒，其同时连有目的基因和报告基因，psPAX2为能表达慢病毒外壳的质粒，其表达产物可通过粘附机制更易穿过细胞膜， pMD2.G为慢病毒的膜蛋白质粒，通过 lipofectamine2000进行三质粒共转到靶细胞基因组中，宿主基因组在表达时，随宿主基因转录出的目的基因RNA与psPAX2、pMD2.G基因翻译出的蛋白组装为慢病毒。 在上述程序中提及的“第四天”收集病毒。在第五天再用该病毒感染靶细胞，病毒进入细胞后，其遗传物质RNA反转录出DNA，该基因再整合到靶细胞的基因组中，完成转染过程，因为质粒DNA只能转录出病毒RNA和表达目的基因却不能表达出病毒的外壳和膜蛋白成分，因此其不能像普通的病毒一样在宿主细胞能反复增殖，故对宿主细胞是无害的并且高效的将目的基因转然到靶细胞基因组中。 ","date":"2020-02-23","objectID":"/bioinfo-q-a-74/:1:4","tags":["AQ100","lentivirus","AAV"],"title":"【bioinfo】-Q\u0026A-74","uri":"/bioinfo-q-a-74/"},{"categories":["bioinfo"],"content":"慢病毒感染细胞 1）铺板：将对数生长期的细胞消化重悬后，按1*105/L密度接种于12孔板，生长过夜 2）感染：将70-80%铺满12孔板中的培养液吸除，换新鲜的培养液，同时加入PBS浓度梯度稀释的病毒液，混合均匀后即可放入孵箱培养。 3) 24h左右可换液，48小时即可看荧光，具体根据细胞状态来看。 荧光显微镜的操作流程 打开荧光器（30min内不能关闭，否则影响显微镜寿命），细胞培养板置于载物台，调节物镜和光圈，先用自然光观察视野内细胞，再关闭光，开启荧光通道，观察荧光强度，判定感染率。图片取样前可以调节曝光时间，增益值和彩色度使荧光照片最完美。（针对leica） 注意事项内容 1.病毒浓度要适宜，太少的话细胞被感染的也少，但是病毒浓度太大，对细胞有伤害。 2.感染病毒时培养基量少，以保证病毒的浓度，在培养10h左右可根据培养基颜色加培养基。 3.在不明确细胞感染复数情况下，可进行浓度梯度感染，计算细胞感染复数。 4.在加病毒后一般24h左右可换液，48小时即可看荧光，具体时间根据细胞状态来看。 ","date":"2020-02-23","objectID":"/bioinfo-q-a-74/:1:5","tags":["AQ100","lentivirus","AAV"],"title":"【bioinfo】-Q\u0026A-74","uri":"/bioinfo-q-a-74/"},{"categories":["bioinfo"],"content":"感染后的细胞检测方法 荧光初步检测 若有荧光，则表示病毒感染成功，但并不能确定目的基因是否整合到细胞中，待进一步检测，荧光有强弱之分，与病毒加入的量有关。 RNA的提取及RT-PCR检测 原理 因为真核细胞DNA含有很多非编码区，真核生物的DNA转录成为RNA之后，经过剪切和拼接，去掉这些非编码区，才能形成真正的mRNA，，是否表达真核生物的基因并表达相应的蛋白，只能通过提取其mRNA并RT-PCR这条途径来测定 RNA提取步骤 加1mlTrizol，吹打后移至1.5ml无菌的离心管中；加100ul氯仿剧烈振荡30s混匀，12000转15min，可看到明显分层；取上层透明液体至新的1.5ml离心管中，加等体积的异丙醇，混匀静置10min，12000转离心10min，弃上清，加1ml70%乙醇，12000转，离心10min，弃上清，风干剩余液体，最后加DEPC-水溶解RNA，电泳，粗步判定RNA纯度。 RT-PCR步骤： RT是一个逆转录的过程，用前一天提取好的总RNA，在加入引物，模版和酶，并在PCR仪的温度设置下，RNA可逆转录为cDNA。 PCR是cDNA在模版，引物，酶的作用下进行复制成双链DNA。（具体步骤省略） 6.3蛋白提取及Western检测 ","date":"2020-02-23","objectID":"/bioinfo-q-a-74/:1:6","tags":["AQ100","lentivirus","AAV"],"title":"【bioinfo】-Q\u0026A-74","uri":"/bioinfo-q-a-74/"},{"categories":["bioinfo","tech"],"content":"qPT-PCR原理是什么 RT-qPCR由普通PCR技术发展而来，它是在传统PCR反应体系中加入荧光化学物质（荧光染料或者荧光探针），根据各自不同的发光机制实时检测PCR退火、延伸过程中荧光信号变化来计算PCR每个循环中产物的变化量，目前最常见的方法为荧光染料法和探针法。 荧光染料法 一些荧光染料如SYBR Green Ⅰ，PicoGreen，BEBO等，它们本身不发光，但结合于dsDNA的小沟后会发出荧光。所以当PCR反应刚开始时机器并不能检测到荧光信号，当反应进行到退火-延伸（二步法）或者延伸阶段（三步法），此时双链打开，在DNA聚合酶的作用下新链合成，荧光分子就结合于dsDNA的小沟中并发出荧光，随着PCR循环数的增加越来越多的染料与dsDNA结合，荧光信号也不断的增强。以SYBR Green Ⅰ为例。 探针法 Taqman探针是最为常用的一种水解探针，在探针的5’端存在一个荧光基团，通常为FAM，探针本身则为一段与目的基因互补的序列，在探针的3’端有一个荧光猝灭基团，根据荧光共振能量转移原理(Förster resonance energy transfer， FRET)，当报告荧光基团（供体荧光分子）和猝灭荧光基团（受体荧光分子）激发光谱重叠且距离很近时（7-10nm），供体分子的激发可以诱发受体分子发荧光，而自身荧光减弱。所以PCR反应开始，探针游离于体系中完整存在时，报告荧光基团并不会发出荧光，当退火时，引物和探针结合于模板，在延伸阶段，聚合酶不断的合成新链，由于DNA聚合酶具有5’-3’核酸外切酶活性，到达探针时，DNA聚合酶就会将探针从模板上水解下来，报告荧光基团和猝灭荧光基团分开，释放荧光信号。由于探针和模板存在一对一的关系，所以在试验的精度和灵敏度上，探针法都要优于染料法。 Fig 1 qRT-PCR原理 引物设计 原则： 引物应用核酸系列保守区内设计并具有特异性。最好用cDNA序列，mRNA序列也可，如果没有则找出DNA序列的cds区域设计。 做荧光定量产物长度80-150bp最好，最长是300bp，引物长度一般在17-25碱基之间,上下游引物不能相差太大。 G+C含量在40%~60%之间，45-55％最佳。 TM值在58-62度之间。 尽量避免引物二聚体和自二聚体，（不要出现超过4对连续互补的碱基）发卡结构，如果不可避免，使ΔG\u003c4.5kJ/mol* 如果不能确保反转录过程中gDNA已经除干净，最好设计出夸内含子的引物* 3′端不可修饰，而且要避开AT,GC rich的区域，避开T/C,A/G连续结构（2-3个） 引物与非特异性扩增序列的同源性最好小于70％或者有8个互补碱基同源。 数据库： CottonFGD search by keywords 引物设计： IDT-qPCR primer design lncRNA引物设计 lncRNA： 和mRNA的步骤一致。 miRNA： 茎环法原理：由于miRNA全部为23nt左右的短序列，无法进行直接PCR检测，所以使用了茎环序列这个工具，茎环序列是一段50nt左右单链DNA，可以自身形成发卡结构，3’末端可以设计成与miRNA部分片段互补的序列，那么在反转录时就可以将目的miRNA连接到茎环序列上，那么总长度就达到70bp，就符合qPCR确定的扩增产物的长度。加尾法miRNA引物设计。 扩增特异性检测 Online blast database：CottonFGD blast by sequence similarity Local blast：参照用Blast+做本地blast，linux和macos可以直接建立本地数据库，win10系统需要安装ubuntu bash后也可以做。本地blast数据库建立及本地blast；win10开启ubuntu bash。 Notice：陆地棉海岛棉为四倍体作物，所以blast结果往往会是两个或多个匹配，以往经验以NAU的cds作为database进行blast很可能找到两个只有几个SNP差异的同源基因，通常通过引物设计是分不开这两个同源基因的，所以就将他们当做同一个来做，如果有明显的indel，通常把引物设计在indel上，但这样就可能导致引物的二级结构的自由能变高，导致扩增效率的下降，但这是不可避免的。 引物二级结构的检测 步骤: 打开oligo 7→输入模版序列→关闭子窗口→保存→将引物定位到模版上，按ctrl+D设定引物长度→分析各种二级结构，例如自二聚体，异二聚体，发卡，错配等。图4中最后两张图片为引物测试结果，前引物结果较好，没有明显的二聚体和发卡结构，没有连续的互补碱基，且自由能绝对值也小于4.5，而后引物则出现了连续6碱基互补，自由能为8.8；另外在3’端也出现了较为严重的二聚体话，出现了连续4碱基的二聚体，虽然自由能不高，但3’的二聚体化可以严重的影响扩增特异性和扩增效率。此外还需要对发卡及异二聚体，错配进行检查。 扩增效率检测 PCR反应的扩增效率严重的影响到PCR的结果，同样在qRT-PCR中，扩增效率对定量的结果尤为重要，除去反应液（reaction buffer）中其他物质及机器和protocol带来的影响，引物的质量对于qRT-PCR的扩增效率影响也非常大，为了保证结果的准确性，无论是相对荧光定量还是绝对荧光定量均需要对引物的扩增效率进行检测，而公认的有效的qRT-PCR的扩增效率为85%-115%之间有两种方法： 1.标准曲线法: a.将cDNA混合 b.梯度稀释 c.qPCR d.线性回归方程计算扩增效率 2.LinRegPCR LinRegPCR is a program for the analysis of real time RT-PCR Data,also called quantitative PCR(qPCR)data based on SYBR Green or similar chemistry. The program uses non-baseline corrected data,performs a baseline correction on each sample separately,determines a window-of-linearity and then uses linear regression analysis to fit a straight line through the PCR data set. From the slope of this line the PCR efficiency of each individual sample is calculated. The mean PCR efficiency per amplicon and the Ct value per sample are used to calculate a starting concentration per sample,expressed in arbitrary fluorescence units. Data input and output are through an Excel spreadsheet. 只需要混样，不需要做梯度 步骤: (以伯乐CFX96为例，不太清楚ABI的机器) 实验：为标准qPCR实验。 qPCR 数据输出 : LinRegPCR 可以识别两种形式的输出文件形式：RDML或者quantification Amplification result.实际上就是机器对循环数和荧光信号的实时检测值，通过对线性区段的荧光变化值分析得出扩增效率。 数据选择:理论上RDML值应该是可以用的,估计是我电脑的问题软件并不能识别RDML，所以我已excel输出值作为原始数据，建议先对数据进行粗筛选，例如加样失败的等造成的点可以在输出的数据中删掉（当然不删也可以，LinRegPCR后期会对这些点进行忽略） determine baselines 结果 如果没有做重复则不需要分组，如果做了重复在sample grouping中可以编辑分组，indentifier 中键入基因的名称，然后相同的会自动分为一组。最后，点击文件，输出excel，查看结果，每个孔的扩增效率及R2结果都会显示，其次如果你分了组，会显示校正过的扩增效率均值。保证每个引物的扩增效率位于85%-115%之间，过大或者过小都说明引物扩增效率较差。 实验过程： RNA的质量要求： 纯度：1.7 ＜OD260/OD280＜2.0（＜1.7时表明有蛋白质或酚污染；＞2.0时表明可能有异硫氰酸残存。 干净的核酸A260/A230应该在2左右。如果有在230 nm 处的强吸收提示污染有酚盐离子等有机化合物。此外可以用1.5%的琼脂糖凝胶电泳检测，要注意的是如果只检测纯度是否准确用非变性胶检测，不要点marker，因为ssRNA没有变性的情况下RNA的涌动率和分子量对数不程线性关系，无法正确表示分子量。 浓度：理论上不低于100ng/ul，如果浓度太低，一般情况下纯度也不高 此外，如果样品比较珍贵，且RNA浓度较高时建议提完后可以分装，将RNA稀释到终浓度100-300ng/ul做反转录。 反转录过程 在进行mRNA转录时，采用可以特异结合到polyA尾巴的oligo（dt）引物反转录，而lncRNA，circRNA则采用随即六聚体（Random 6 mer）引物对总RNA进行反转录，对于miRNA则使用miRNA特异的颈环引物进行反转录，很多公司现在推出了专门的加尾法试剂盒，对于茎环法而言，","date":"2020-02-23","objectID":"/bioinfo-q-a-73/:1:0","tags":["AQ100","PCR"],"title":"【bioinfo】-Q\u0026A-73","uri":"/bioinfo-q-a-73/"},{"categories":["bioinfo","immune"],"content":"非小细胞肺癌靶向治疗应答的早期无创检测 随着精准肿瘤学的出现，靶向治疗给越来越多的患者带来了生存获益。目前，临床上用于评判治疗效果和检测的手段主要有CT影像和组织活检，但是传统的检测方法无法快速检测肿瘤对药物的治疗反应以及肿瘤基因变化，并且频繁的CT影像易导致二次肿瘤的发生，组织活检是具有潜在并发症的侵入性手术，很少能发现肿瘤内部和肿瘤间异盾性的复杂性。临床中迫切需要开发可以实时、无创检测肿瘤对靶向治疗效果的新监测方法。本研究旨在通过对28位晚期肺癌患者血样中ctDNA(循环肿瘤DNIA)进行检测，开发出一种通过游离细胞肿瘤负荷(cfTL)测量评估肿瘤负荷的方法，该测量结合了许多驱动基因的序列变化以及全基因组结枸变化，允许检测分析所有患者中肿瘤相关的改变，分析了患者血样中肿瘤细胞的基因突变和染色体变化异常，并与CT影像结果进行对比，达到实时追踪治疗期间肿瘤负荷情况的目的。 cfTL测定原理图及治疗反应预测 对接受酪氨酸激酶抑制(TKI)治疗的转移性非小细胞肺癌(mNSCLC)患者进行基线和治疗后连续时间点的液体活检。TEC-Seq方法用于直接鉴定58个基因的序列改变，包括测序至＞30,000x覆盖的80,93个碱基，并且用全基因组方法鉴定cfDNA中的拷贝数变化。cfTL被定义为TKI靶向治疗中已检测到序列变化的患者靶向克隆中最丰富变化的突变等位基因片段，或基于PA评分确定没有可检测序列变化的患者是否存在非整倍体。在没有进行TKI治疗时对患者进行抽血，该点的cfTL为基线，在开始TKI治疗后进行数小时至数天的连续抽血，分析cfTL的动态变化，通过治疗后cfTL从基线到后续时间点的变化，可以实时评估患者对靶向治疗的反应，而CT影像要在治疗开始后5-7周对治疗效果进行反应评估。 治疗过程中ctDNA的动态变化 图2A，患者CGPLLU12，为奥斯替尼应答者治疗过程中的ctDNA变化，Z值评分和CT影像结果：图2B，患者CGPLLU244，为奥斯替尼无应答者治疗过程中ctDNA变化，Z值评分和CT影像结果。通过TEC-Seq方法鉴定的cfDNA克隆的突变等位基因片段显示了每个时间点的分析结果，亮绿色为ctDNA克隆，代表cfTL，红色箭头代表治疗开始：从全基因组数据分析中确定的cfDNA拷贝数的变化在每个时间点上显示为每个染色体臂的Z值（紫红色点）和PA值（中间橙色菱形)：灰色方块为在治疗过程中每隔一段时间用CT扫描测量的RECIST1.1的最长直泾总和(SLD)(上)；红色圆圈表示CT图像中每个患者有代表性的肿瘤病灶。对于奥斯替尼应答者，在治疗开始到第十天，ctDNA、Z值和PA值明显下降，表明患者已对奥斯替尼出现应答，而CT影像在治疗后的55天才检测出应答反应：CT影像得到的SLD表明应答患者在治疗8天后开始出现进行性疾病，而ctDNA、Z值和PA值在大约十天左右就能预测出患者的进行性疾病。对于奥斯替尼无应答者，在治疗开始后，通过ctDNA、Z值和PA值就可以预测其进行性疾病，而CT影像只能在37天后才能检测到。这些结果表明ctDNA分析比CT影像能更早预测患者的治疗效果。 酪氨酸激酶抑制剂治疗患者的游离细胞DNA特征 治疗开始后，从基线到ctDNA评估时，部分应答(蓝色)、稳定疾病(橙色)和进行性疾病(红色)患者的cfTL(A)和血浆突变敷(B)的变化。部分应答亚组还包括两名由RECIST诊断为不可测量疾病的患者，他们被归为临床反应者。图3A，所有对靶向治疗有初步客观影像学应答的患者显示cfTL显着降低，突变等位基因浓度从基线时的平均10.80%降至治疗开始后中位时间19天时的0.18%:在影像学稳定的患者中，突变等位基因浓度从基线时的平均2.24%降低到治疗开始后的1.04%:相比之下，通过序列和染色体改变测量，所有5名有影像学进展性疾病患者的cfTL变化均有限，范围从基线时的平均突变等位基因分数14.23%到开始治疗后的11.84%。图3B，除了cfTL的变化之夕卜，在应答者中观察到每个患者突变的平均变化数量也从3.6减少到1.1，而患有稳定或进展性疾病的患者在治疗期间观察到的突变数量没有显着变化。这些观察结果表明，在应答患者的早期时间点ctDNA水平和克隆异质性均显着降低，并且在无应答的患者中，肿瘤亚克隆的出现和生长可以比影像学进展更早地检测到。 酪氨酸激酶抑制剂启动后数小时内检测ctDNA变异 8例患者在基线和开始治疗后4-12小时的ctDNA(A)和cfDNA提取物(B)水平的变化。红色为新出现的ctDNA改变和具有这些改变的患者相应的cfDNA量。图4A，ctDNA水平的提高可以识別8种以前未在基线检测到的肿瘤衍生性改变，新检测到的克隆的突变等位基因片段范围为0.15%至1.70%，平均为0.57%，表明这些改变可能低于基线检测限并且由于ctDNA水平的增加而检测到。图4B，治疗后4-12小时，cfDNA的量在基线和时间点之间保持相对稳定，这表明ctDNA水平的变化是由于cfDNA内突变克隆的相对丰度发生了变化。这些观察结果表明，新的ctDNA变体的出现可能与治疗的早期效果有关。 ctDNA的变化和对治疗反应的预测 评估了治疗开始后早期时间点观察到的动态cfTL变化是否与临床结果的差异相关。图5A，早期cfTL水平呈双峰分布，较低组cfTL平均降低99.8%，较高组cfTL平均升高0.06%，cfTL降低＞98%且\u003c98%的患者分別被归类为ctDNA应答者和ctDNA无应答者。图5B，对于分析的患者，描绘了ctDNA评估时的cfTL（蓝色）和PFS（橙色）。影像学评估在右栏中表示为部分应答（PR），稳定疾病（SD），不可测量疾病（NM）或进行性疾病（PD）。患者CGPLLU244在ctDNA评估时具有＞100%的cfTL水平（*）。12例ctDNA完全应答（cfTL降低100%）的患者中有8例无进展生存超过1年，在6例影像学稳定的患者中，ctDNA分析发现4例患者有分子应答（平均PFS为11.3个月），2例患者无分子应答（平均PFS为2.6个月）。一名患者是影像学部分应答者但分子无应答者的PFS为3.9个月。重要的是，2例经RECIST诊断为不可测量疾病的患者被明确为分子应答者，平均PFS为13.7个月。使用ctDNA分析，可以更准确地对影像学上无法测量的疾病患者和首次影像学评估时病情稳定的患者进行分类。图5C，ctDNA应答者和无应答者的无进展存活期。图5D，基于初始影像学评估的无进展生存。图5E，应答时间评估由CT扫描（蓝色）或ctDNA分析（橙色）确定，用虚线表示评估的中位时间。图5C，D，E三图表明与ctDNA应答者相比，ctDNA无应答者中位无进展生存期显著缩短(1.6个月vs.13.7个月)，此外，与开始治疗后CT成像评估的平均47天中位时间相比，cfTL评估的19天中位时间更准确地预测了临床结果。 研究意义 本文开发的游离肿瘤负荷为评估系统性酪氨酸激酶抑制剂治疗期间ctDNA的纵向变化提供了一种新的方法，并满足了在影像学评估前实时、无创检测肿瘤对靶向治疗反应的临床需求，证明了液体活检在早期评估靶向治疗反应中的潜在价值，尤其是当CT检测无法有效判断患者客观缓解和实际疾病进展的时候。并且无创液体活检对于肿瘤特异性变化的强大识別功能，为多种治疗环境下不同类型癌症的广泛监控提供了可能，可以促进开发新疗法，改变癌症患者的治疗方式。后续研究空间：可以研究是否可以利用连续ctDNA监测来为非、卜细胞肺癌患者量身定制治疗策略。 例如， (1)在最早检测到\"分子耐药性\"时，检查切換治疗方素是否会提高患者的生存率： (2）随着靶向联合治疗的选择不断扩大，可以利用系列ctDNA监测设计临床试验，研究早期治疗从单一治疗升级到联合治疗是否能改善临床结果。 总之，本研究通过对患者血样中脱落至循环血液的肿瘤细胞ctDNA的检测，对胂瘤细胞的基因突变和染色体变化异常进行了分析，迖到了治疗期间肿瘤负荷实时追踪的目的。同时与CT影像结果进行对比，ctDNA检测可以提前约四周检测患者的治疗效果，其结果更加精确。 ","date":"2020-02-23","objectID":"/bioinfo-q-a-72/:1:0","tags":["AQ100","NSCLC","ctDNA"],"title":"【bioinfo】-Q\u0026A-72","uri":"/bioinfo-q-a-72/"},{"categories":["bioinfo"],"content":"相分离是什么？ 描述的是一种细胞里不同成分间相互碰撞、融合形成液滴，从而使一些成分被包裹在液滴内，一些成分被阻隔在液滴外的现象，类似于水油相混，或者可以想象成下雨天伞上的雨滴逐渐滴落的过程。这种现象在液体之间是常见的，但是，2009年，Brangwynne和Hyman关于线虫P颗粒的研究，发现P颗粒（一种蛋白质）并非像我们通常认为的是一种固体，而是像液滴一样，相互碰撞融合，剧烈摇晃后会分散成很小的液滴，而后又很快地融合形成大液滴。之后科学家发现细胞内的许多无膜细胞器——核仁、Cajal bodies、stress granules、miRISC，及突触的细胞骨架——都是特定的蛋白质/RNA的相变。 ","date":"2020-02-23","objectID":"/bioinfo-q-a-71/:1:0","tags":["AQ100","phase separation"],"title":"【bioinfo】-Q\u0026A-71","uri":"/bioinfo-q-a-71/"},{"categories":["bioinfo"],"content":"细胞内的相分离： 人们认为细胞内成分能够通过“相分离”的方式相互分开，实现多种生物学功能。“相分离”一旦发生异常，就可能造成疾病。 蛋白质或RNA分子间的物理作用力可以使他们相互分开或聚集。一旦分子达到一定浓度，他们就会发生相分离，相似的成分聚集在一起加速生物学反应（有点类似于相似相容），或者隔离无关的分子。 细胞膜上的信号传递 在神经细胞中，细胞间的信号传递时蛋白质能够在连接处的聚集和相分离是保证细胞间信号传递正常进行所必需的。 DNA折叠包装 在细胞核中，相分离帮助压缩折叠不使用的DNA并抑制其活性。一些可能与转录相关的蛋白被阻隔在外。 液滴成为障碍 在肌萎缩性脊髓侧索硬化症中，分离成液滴的蛋白质会逐渐凝结，变硬，形成有害的固体物质。 ","date":"2020-02-23","objectID":"/bioinfo-q-a-71/:1:1","tags":["AQ100","phase separation"],"title":"【bioinfo】-Q\u0026A-71","uri":"/bioinfo-q-a-71/"},{"categories":["bioinfo"],"content":"2. 发展历史、现状和趋势 德克萨斯大学西南医学院的结构生物学家 Michael Rosen 和生物化学家Steven McKnight在实验的试管中发现RNA和蛋白质分子间存在较弱的作用力，彼此相互靠近，形成液滴类的物质。加拿大多伦多儿童医院的结构生物学家Julie Forman-Kay团队发现，一种可能影响精子功能的蛋白质在人体细胞内形成液滴。已有多项研究发现动物蛋白质存在相分离现象。 2018年的现状 不完全统计（需要补充），2018年CNS上已发表十几篇文章。 其中3月份Nature上发表了一篇文章介绍了相分离领域的发展历史和研究进展（https://www.nature.com/articles/d41586-018-03070-2）。 4月份，Cell上一次性发表了4篇文章还有一篇评论文章，介绍了对称或非对称精氨酸二甲基化做为翻译后修饰和核转运蛋白做为分子伴侣抑制FUS蛋白等RNA结合蛋白（RBP）的相关的“相变”（FUS全称为Fused in sarcoma，是一种渐动人症ALS中关键致病蛋白，也是一种RNA结合蛋白）。 DOI:https://doi.org/10.1016/j.cell.2018.03.056 DOI:https://doi.org/10.1016/j.cell.2018.03.003 DOI:https://doi.org/10.1016/j.cell.2018.03.002 DOI:https://doi.org/10.1016/j.cell.2018.03.004 6月份，Cell上发表了一篇综述，详细地介绍了相分离的概念，在无膜器官的形成、信号转导、细胞骨架、超分子组装等生物过程中扮演的功能。 DOI: https://doi.org/10.1016/j.tcb.2018.02.004 7月份Sience上发表了3篇文章和1篇评论介绍了相分离与转录调控。 DOI: http://dx.doi.org/10.1126/science.aar3958 DOI: http://dx.doi.org/10.1126/science.aar2555 DOI: 10.1126/science.aar4199 DOI: 10.1126/science.aau4795 12月份Cell上又发表了一篇文章介绍了转录因子通过液-液相分离激活基因表达实现其功能。 https://doi.org/10.1016/j.cell.2018.10.042 ","date":"2020-02-23","objectID":"/bioinfo-q-a-71/:1:2","tags":["AQ100","phase separation"],"title":"【bioinfo】-Q\u0026A-71","uri":"/bioinfo-q-a-71/"},{"categories":["bioinfo"],"content":"3. 应用 随着相分离的研究逐渐增多，研究人员发现相分离在无膜器官的形成 ，信号转导、细胞骨架、超分子组装、基因的激活等扮演着功能，相分离异常可能导致疾病，如神经退行性疾病、肿瘤、衰老等。 神经退行性疾病 相分离与神经退行性疾病联系起来的研究还是较多的，如： 在肌萎缩侧索硬化（ALS）（一种运动神经元疾病）中观察到“相分离” ，发现FUS蛋白和hnRNPA1在ALS中形成液滴，液滴粘性逐渐变强，最终形成纤维状的固体，在ALS中异常沉积。 阿尔茨海默病患者脑内异常沉积的tau蛋白也存在“相分离”，“相分离”可能是tau蛋白聚集的初始触发因素。 肿瘤 相分离的异常可能促进某些癌症的发生。如分子病理学家Miguel Rivera和他的团队发现了一种与尤文氏肉瘤有关的蛋白。这种蛋白聚集在与肿瘤发生相关的基因组附近时可以激活致癌基因表达，而异常的“相分离”就可能促使这种蛋白在这些区域附近聚集。(DOI:10.1016/j.cell.2017.07.036). 保护作用 除了对细胞的损伤作用，相分离还具有保护作用。Hyman和Alberti发现酵母细胞在低pH的压力环境下一些重要蛋白会聚集成液滴启动保护机制。当pH回升后，这些液滴会分散开，细胞恢复正常的功能。 基因组失活 在人体细胞中，形成液滴更多的是一种组装策略。加州大学旧金山分校生物化学家Geeta Narlikar和她的团队发现，“相分离”帮助封存人体部分基因组，这些基因组永久不会被激活，主要发挥结构性作用（X染色体失活不知道是否和相分离相关）。 转录调控 2018年Science和Cell上发表的几篇文章都是和基因调控相关。 转录因子的低复杂度区域间的相互作用调控基因转录 原文：Imaging dynamic and selective low-complexitydomain interactions that control gene transcription 发表杂志：Chong et al., Science 361, 378 (2018) 发表日期：27 July 2018 DOI/html： http://dx.doi.org/10.1126/science.aar2555 许多真核生物的转录因子包含天然的、无序的、低复杂序列区域（ low-complexity sequence domains ，LCDs），但是这些LCD如何驱动转录激活还不清楚。这篇文章中研究者用活细胞单分子成像技术揭示了TF LCDs在外源性和内源性的基因组位点形成高度集中的相互作用中心。TF LCD hubs固定DNA的结合，招募RNA Pol II, 激活转录。hubs内LCD-LCD间的相互作用是高度动态的、并且选择性的结合辅因子，对己二酮的破坏敏感性也不同。在生理条件下，快速可逆的LCD-LCD相互作用发生在TF和RNA Pol II之间，没有检测到相分离。他们的发现可能揭示了转录调控的一种基本机制，同时也体现出了单分子成像技术在开发与疾病相关的基因调控相互作用的靶向药物中具有广阔的应用前景。 用到的技术和方法： 活细胞单分子成像技术 synthetic LacO (Lac operator) arrays合成乳糖操纵序列和内源GGAA微卫星基因座 CRISPR-Cas9基因编辑，诱变、基因激活、细胞转化实验以及各种高分辨率成像方法，包括荧光相关光谱、光漂白后的荧光恢复、晶格光片显微镜、三维DNA荧光原位杂交和活细胞单粒子跟踪。 从这些用到的技术中可以推测普通的实验室如果要开展这样的研究，可能需要有各种高分辨率的成像技术。 From hubs to phase separation: Activation occurs in a wide range of TFconcentrations 超级增强子通过相分离调控基因表达 超级增强子（super-enhancer，SE）是由连续排列的增强子串联形成的增强子簇，决定细胞特性和功能的大多数关键基因附近通常伴随着出现超级增强子。这篇文章表明转录共激活因子BRD4和MED1可以在超级增强子处发生相分离形成液滴，将转录机器聚集在超级增强子附近，实现转录过程的区室化反应，其中内在无序区域（intrinsically disordered regions，IDRs）在相分离过程中发挥关键作用，这项研究为超级增强子通过相分离调控基因表达的模型提供了实验证据，也对细胞命运决定和疾病发生过程中关键基因的表达调控过程提供了全新的视角和概念。 Phase separation of coactivators compartmentalizes and concentrates the transcription apparatus 转录因子在活化区域通过相分离激活基因表达调控 这篇文章报道了转录因子OCT4和GCN4的转录激活结构域通过与转录中介体复合物Mediator发生液-液相分离激活基因表达，这项研究为我们进一步理解数百种其它的转录因子的功能机理，以及发育和疾病过程中基因表达调控机制提供了新思路。 Transcription factors (TFs) form phase-separated condensates with Mediator 重塑染色质结构 11月29日，Cell杂志在线发表了Cliff Brangwynne课题组利用CasDrop体系的最新研究成果Liquid Nuclear Condensates Mechanically Sense and Restructure the Genome（DOI：https://doi.org/10.1016/j.cell.2018.10.057）。该研究表明，细胞核内的“液-液相分离”现象能够感知并重塑染色质结构。 药物 目前已经有通过相分离的手段治疗疾病的公司成立。如加州大学的细胞生物学家Ron Vale在今年年初成立了一家公司，主要通过破坏与神经退行性疾病（如运动神经元疾病、亨廷顿舞蹈病等）相关的RNA液滴进行药物研发。 另外一个相分离研究的研究者Taylor也打算成立一个公司，将使用一个他们研发的工具“光颗粒（Optogranule）”识别药物靶点，这个工具能够再现细胞中“相分离”相关病理表现和过程。这项技术可以使研究者在几小时内观察到培养皿里神经退行性变化的过程。 相关技术，实验开展有什么难点？ 相分离相关的技术有成像技术，首先必须有方法可以观察到这种相分离的过程；二是如何调控从而影响相分离过程的技术。 一个光控系统（OptoDroplets），通过改变光的剂量，调控活细胞内不同液体成分的聚集程度，使液滴出现或消失。 OptoDroplets Brangwynne团队又设计了CasDrop系统，可以定量、定位地研究多种蛋白的相分离现象。 CasDrop ","date":"2020-02-23","objectID":"/bioinfo-q-a-71/:1:3","tags":["AQ100","phase separation"],"title":"【bioinfo】-Q\u0026A-71","uri":"/bioinfo-q-a-71/"},{"categories":["bioinfo","zt"],"content":"Darwin II 当代电子乐兴起之时，曾有一段时间，业界内部就合成与数字的优劣高下争执不休。有人迷恋techno因模糊性之不可捉摸而产生的流变迷幻，有人力挺digital由准确性之无法游移而带来的冰冷销魂。两派各有一批死忠拥趸，不过对于大多数乐迷而言，这两者的好与坏实在是个伪命题。在我而言，Carl Cox和Paul van Dyk的区别真有那么本质吗？答案肯定为否，因为两者之间的界线其实是非常不清晰的，最终我们口中说出的那个好恶其实只取决于审美经验。 人在个体层面上的审美，却是这个世界上最难以标准化的事物之一。 但群体层面上就并非如此了，情况要复杂得多。研究者们一致认为如今的流行文化中有许多可供分析的规律，换而言之，一件作品（商品）能不能被最大众层面的欣赏所认同，原本就带着一些天生的因素。大脑核磁共振成像实验也证实，通过统计分析可以部分地推断青少年们心目中的热门曲目是怎么来的，因为其中有一些十分明显的“甜蜜点”能引起他们大脑中奖赏回路的反应，这是2011年来自美国埃默里大学的一项研究，他们对2007年～2010年间的排行榜歌曲和非排行榜歌曲做了从技术层面到销售成绩的各项考量。 换而言之，流行音乐是相应年龄层的人群通过社会协同力的作用一起遴选出来，被遴选的因素就是那些文化基因，即《自私的基因》中也提到过的那种 memes，定义做“在诸如语言、观念、信仰、行为方式等的传递过程中与基因在生物进化过程中所起的作用相类似的那个东西”。英国伦敦国王大学的Robert MacCallum 和Armand Leroi等人最近在《美国国家科学院院刊》上发表的论文《通过大众选择产生的音乐演化》，就描述了他们如何用“演化”方式来得到一段流行曲目的过程。 这个来自“生活科学系”的团队一开始是建立了一个叫做“达尔文曲调”的网站，在上面放了100段时长均为8秒钟的音乐，然后邀请“顾客”以百分制对它们打分，五分一档，最低分表示“我完全无法忍受它”，最高分表示“我完全无法抵抗地喜欢它”。项目进行一定时间段之后，研究者会对其中最受欢迎（亦即总分数最高）的十条进行重新编辑。把它们两两配对混合作为“父母曲调”，生出一些“子女曲调”出来。具体方式是抽取其中的一些音调小节来做重新搭配，用这种方式生成二十条新的音乐。然后用这二十条取代了原来十条最受欢迎的音乐和十条最不受欢迎的音乐，进入下一轮打分。 截止发论文时共有6931名“顾客”参与了打分，据研究者称他们的音乐已经经过2513代“演化”，这个实验迄今仍在继续，有兴趣的人可以登录http://darwintunes.org/去收听，或者参与打分（音乐试听打分亦系统附在文章末尾）。我可以确定的一点是——凭借自己曾经做过几年乐评的资历，并且听过数量相当可观的电子乐专辑——现在展现的33首曲目中有不少可听度还是相当高的，不简单，不肤浅，甚至不是一般音乐人随便搞搞就能搞出来的。 “达尔文曲调”的创建者们感慨，地球用了20亿年的时间，生成丰富多彩的生命，这是因为神奇的演化机制。而最近的五万年来，也通过同样的机制，生成浩瀚的文字、歌曲、影像、观念。无论有机体还是文化加工品，都是那些最顽固的突变，在生存方面做到了最好。 但回过来，还是有必要解释一下“适者生存”的涵义，其实在达尔文理论的主要表述中，这个“适者”强调的是和环境最为匹配的那些个体，而并非“强者”或“高级者”。在生物界做等级之分本就是无稽之谈，正如文化中被选择的那些，也未必是“优秀”，我们无法想象在历史的长卷轴中有多少天才和天才之作其实被埋进了灰尘之中，永远无人得见。 ","date":"2020-02-22","objectID":"/bioinfo-q-a-70/:1:0","tags":["AQ100","evolu"],"title":"【bioinfo】-Q\u0026A-70","uri":"/bioinfo-q-a-70/"},{"categories":["bioinfo","zt"],"content":"About Darwin 对自然选择学说的异议的复述–支持自然选择学说的一般的和特殊的情况的复述–一般相信物种不变的原因–自然选择学说可以引伸到什么程度–自然选择学说的采用对于博物学研究的影响–结束语。 因为全书是一篇绵长的争论，所以把主要的事实和推论简略地复述一遍，可能给予读者一些方便。 我不否认，有许多严重的异议可以提出来反对伴随着变异的生物由来学说，这一学说是以变异和自然选择为依据的。我曾努力使这些异议充分发挥它们的力量，比较复杂的器官和本能的完善化并不依靠超越于、甚至类似于人类理性的方法，而是依靠对于个体有利的无数轻微变异的累积，最初看来，没有什么比这更难使人相信的了。尽管如此，虽然在我们的想像中这好像是一个不可克服的大难点，可是如果我们承认下述的命题，这就不是一个真实的难点，这些命题是：体制的一切部分和本能至少呈现个体差异–生存斗争导致构造上或本能上有利偏差的保存–最后，在每一器官的完善化的状态中有诸级存在，每一级对于它的种类都是有利的。这些命题的正确性，我想，是无可争辩的。 毫无疑问，甚至猜想一下许多器官是通过什么样的中间级进而成善化了的，也有极端困难，特别对于已经大量绝灭了的、不连续的、衰败的生物群来说，更加如此；但是我们看到自然界里有那么多奇异的级进，所以当我们说任何器官或本能，或者整个构造不能通过许多级进的步骤而达到现在的状态时，应该极端的谨慎。必须承认，有特别困难的事例来反对自然选择学说，其中最奇妙的一个就是同一蚁群中有两三种工蚁即不育雌蚁的明确等级；但是，我已经试图阐明这些难点是怎样得到克服的。 物种在第一次杂交中的几乎普遍的不育性，与变种在杂交中的几乎普遍的能育性，形成极其明显的对比，关于这一点我必须请读者参阅第九章末所提出的事实的复述，这些事实，依我看来，决定性地示明了这种不育性不是特殊的秉赋，有如两个不同物种的树木不能嫁接在一起决不是特殊的秉赋一样；而只是基于杂交物种的生殖系统的差异所发生的偶然事情。我们在使同样两个物种进行互交–即一个物种先用作父本，后用作母本–的结果中所得到的大量差异里，看到上述结论的正确性。从二型和三型的植物的研究加以类推，也可以清楚地导致相同的结论，因为当诸类型非法地结合时，它们便产生少数种籽或不产生种籽，它们的后代也多少是不育的；而这些类型无疑是同一物种，彼此只在生殖器官和生殖机能上有所差异而已。 变种杂交的能育性及其混种后代的能育性虽然被如此众多的作者们确认是普遍的，但是自从高度权威该特纳和科尔路特举出若干事实以后，这就不能被认为是十分正确的了。被试验过的变种大多数是在家养状况下产生的；而且因为家养状况（我不是单指圈养而言）几乎一定有消除不育性的倾向，根据类推，这种不育性在亲种的杂交中会有影响；所以我们就不应该希望家养状况同样会在它们的变异了的后代杂交中诱起不育性。不育性的这种消除显然有从容许我们的家畜在各种不同环境中自由生育的同一原因而来的；而这又显然是从它们已经逐渐适应于生活条件的经常变化而来的。 物种在第一次杂交中的几乎普遍的不育性，与变种在杂交中的几乎普遍的能育性，形成极其明显的对比，关于这一点我必须请读者参阅第九章末所提出的事实的复述，这些事实，依我看来，决定性地示明了这种不育性不是特殊的秉赋，有如两个不同物种的树木不能嫁接在一起决不是特殊的秉赋一样；而只是基于杂交物种的生殖系统的差异所发生的偶然事情。我们在使同样两个物种进行互交–即一个物种先用作父本，后用作母本–的结果中所得到的大量差异里，看到上述结论的正确性。从二型和三型的植物的研究加以类推，也可以清楚地导致相同的结论，因为当诸类型非法地结合时，它们便产生少数种籽或不产生种籽，它们的后代也多少是不育的；而这些类型无疑是同一物种，彼此只在生殖器官和生殖机能上有所差异而已。 变种杂交的能育性及其混种后代的能育性虽然被如此众多的作者们确认是普遍的，但是自从高度权威该特纳和科尔路特举出若干事实以后，这就不能被认为是十分正确的了。被试验过的变种大多数是在家养状况下产生的；而且因为家养状况（我不是单指圈养而言）几乎一定有消除不育性的倾向，根据类推，这种不育性在亲种的杂交中会有影响；所以我们就不应该希望家养状况同样会在它们的变异了的后代杂交中诱起不育性。不育性的这种消除显然有从容许我们的家畜在各种不同环境中自由生育的同一原因而来的；而这又显然是从它们已经逐渐适应于生活条件的经常变化而来的。 有两类平行的事实似乎对于物种第一次杂交的不育性及其杂种后代的不育性提出许多说明。一方面，有很好的理由可以相信，生活条件的轻微变化会给予一切生物以活力和能育性。我们又知道同一变种的不同个体的杂交以及不同变种的杂交会增加它们后代的数目，并且一定会增加它们的大小和活力。这主要由于进行杂交的类型曾经暴露在多少不同的生活条件下；因为我曾经根据一系列辛劳的实验确定了，如果同一变种的一切个体在若干世代中都处于相同的条件下，那么从杂交而来的好处常常会大事减少或完全消失。这是事实的一面。另一方面，我们知道曾经长期暴露在近乎一致条件下的物种，当在大不相同的新条件之下圈养时，它们或者死亡，或者活着，即使保持完全的健康，也要变成不育的了。对长期暴露在变化不定的条件下的家养生物来说，这种情形并不发生，或者只以轻微的程度发生。因此，当我们看到两个不同物种杂交，由于受孕后不久或在很早的年龄死亡，而所产生的杂种数目稀少时，或者虽然活着而它们多少变得不育时，这种结果极可能是因为这些杂种似乎把两种不同的体制融合在一起，事实上已经遭受到生活条件中的巨大变化。谁能够以明确的方式来解释，比方说，象或狐狸在它的故乡受到圈养时为什么不生育，而家猪或猪在最不相同的条件下为什么还能大量地生育，于是他就能够对以下问题作出确切的答案，即两个不同的物种当杂交时以及它们的杂种后代为什么一般都是多少不育的，而两个家养的变种当杂交时以及它们的混种后代为什么都是完全能育的。 就地理的分布而言，伴随着变异的生物由来学说所遭遇的难点是极其严重的。同一物种的一切个体、同一属或甚至更高级的群的一切物种都是从共同的祖先传下来的；因此，它们现在不管在地球上怎样遥远的和隔离的地点被发现，它们一定是在连续世代的过程中从某一地点迁徙到一切其他地点的。这是怎样发生的，甚至往往连猜测也完全不可能。然而，我们既然有理由相信，某些物种曾经在极长的时间保持同一物种的类型（这时期如以年代来计算是极其长久的），所以不应过分强调同一物种的偶然的广泛散布；为什么这样说呢，因为在很长久的时期里总有良好的机会通过许多方法来进行广泛迁徙的。不连续或中断的分布常常可以由物种在中间地带的绝灭来解释。不能否认，我们对于在现代时期内曾经影响地球的各种气候变化和地理变化的全部范围还是很无知的；而这些变化则往往有利于迁徙。作为一个例证，我曾经企图示明冰期对于同一物种和近似物种在地球上的分布的影响曾是如何的有效。我们对于许多偶然的输送方法还是深刻无知的。至于生活在遥远而隔离的地区的同属的不同物种，因为变异的过程必然是缓慢地进行的，所以迁徒的一切方法在很长的时期里便成为可能；结果同属的物种的广泛散布的难点就在某种程度上减小了。 博物学的其他更加一般的部门将会大大地引起兴趣。博物学者所用的术语如亲缘关系、关系、模式的同一性、父性、形态学、适应的性状、残迹的和萎缩的器官等等，将不再是隐喻的，而会有它的鲜明的意义。当我们不再像未开化人把船看做是完全不可理解的东西那样地来看生物的时候；当我们把自然界的每一产品看成是都具有悠久历史的时候；当我们把每一种复杂的构造和本能看成是各各对于所有者都有用处的设计的综合，有如任何伟大的机械发明是无数工人的劳动、经验、理性以及甚至错误的综合的时候；当我们这样观察每一生物的时候，博物学的研究将变得–我根据经验来说–多么更加有趣呀！ 在变异的原因和法则、相关法则、使用和不使用的效果、外界条件的直接作用等等方面，将会开辟一片广大的、几乎未经前人踏过的研究领域。家养生物的研究在价值上将大大提高。人类培育出来一个新品种，比起在已经记载下来的无数物种中增添一个物种，将会成为一个更加重要、更加有趣的研究课题。我们的分类，就它们所能被安排的来说，将是按谱系进行的；那时它们才能真地显示出所谓“创造的计划”。当我们有一确定目标的时候，分类的规则无疑会变得更加简单。我们没有得到任何谱系或族徽；我们必须依据各种长久遗传下来的性状去发现和追踪自然谱系中的许多分歧的系统线。残迹器官将会确实无误地表明长久亡失的构造的性质。称做异常的、又可以富于幻想地称做活化石的物种和物种群，将帮助我们构成一张古代生物类型的图画。胚胎学往往会给我们揭露出每一大纲内原始类型的构造，不过多少有点模糊而已。 如果我们能够确定同一物种的一切个体以及大多数属的一切密切近似物种，曾经在不很遥远的时期内从第一个祖先传下来，并且从某一诞生地迁移出来；如果我们更好地知道迁移的许多方法，而且依据地质学现在对于以前的气候变化和地平面变化所提出的解释以及今后继续提出的解释，那么我们就确能以令人赞叹的方式追踪出全世界生物的过去迁移情况。甚至在现在，如果把大陆相对两边的海栖生物之间的差异加以比较，而且把大陆上各种生物与其迁移方法显然有关的性质加以比较，那么我们就能对古代的地理状况多少提出一些说明。 地质学这门高尚的科学，由于地质纪录的极端不完全而损失了光辉。埋藏着生物遗骸的地壳不应被看做是一个很充实的博物馆，它所收藏的只是偶然的、片段的、贫乏的物品而已。每一含有化石的巨大地质层的堆积应该被看做是由不常遇的有利条件来决定的，并且连续阶段之间的空白间隔应该被看做是极长久的。但是通过以前的和以后的生物类型的比较，我们就能多少可靠地","date":"2020-02-22","objectID":"/bioinfo-q-a-69/:1:0","tags":["AQ100","evolu"],"title":"【bioinfo】-Q\u0026A-69","uri":"/bioinfo-q-a-69/"},{"categories":["bioinfo","ngs"],"content":"illumina nextera Tn5 和ATAC seq adaptor 序列 在准备NGS文库的时候，会有用到转座酶Tn5，Nextera DNA Library Preparation Kit ，比如ATAC-seq就有用到这个Tn5。转座酶携带有特定的序列称为转座子Transposon。 下面是ATAC-seq的工作原理，想必听说过ATAC-seq的，对这个图都会再熟悉不过了。 Tn5是kit里面带有的，没什么大不同。ATAC-seq 的barcoded primers （adaptors）会有一些不同，接下来，看下图中的每段序列对应的sequnce都是什么。 下面图例，Nextera tn5用来给基因组DNA加adaptors。 搞懂illumina nextera Tn5 和ATAC seq adaptor 序列 放大tn5: 在tn5二聚体里面的双链的Oligo是Nextera Tn5 binding site，19个碱基，全部都是一样的。伸出来的部分是单链的序列，蓝色：Nextera tn5 read1 (5’-TCGTCGGCAGCGTC-3’)；红色：Nextera tn5 read2(5’-GTCTCGTGGGCTCGG-3') Nextera Tn5 binding site (19-bp Mosaic End (ME)): 5'- AGATGTGTATAAGAGACAG -3’ Nextera N/S5xx primer entry point (s5)／Tn5 Read 1: 5'- TCGTCGGCAGCGTC -3' Nextera N7xx primer entry point (s7)／ Tn5 Read 2: 5'- GTCTCGTGGGCTCGG -3' Illumina P5 primer 1: 5'- AATGATACGGCGACCACCGAGATCTACAC -3' Illumina P7 primer 2: 5'- CAAGCAGAAGACGGCATACGAGAT -3’ Tn5 Read 1 （包括ME）sequence: 5'- TCGTCGGCAGCGTC（AGATGTG，TATAAGAGACAG） -3’ （33bp） Tn5 Read 2 （包括ME）sequence: 5'- GTCTCGTGGGCTCGG（AGATGT，GTATAAGAGACAG ）-3’ （34bp） 下面的图片就是准备ATAC-seq时候需要用到的index primer （adaptor），和Nextera DNA library prep kit里的有一点类似，但是也很不同。Ad1_noMX是Forward 引物，没有index （barcode），所以只有一个。Reversed引物有24个Ad2.（1-24），所以有24组不同的index （barcode）序列。这个index序列是和Nextera一样的。我涂红色部分就是index序列的反向反义序列，每个index序列是不同的8个碱基，这个和Nextera的i7（部分一样，请自己对照）是一样的。 i5 sequence: ATAC-seq的Adaptor1 里没有barcode N/S502 : CTCTCTAT N/S503 : TATCCTCT N/S505 : GTAAGGAG N/S506 : ACTGCATA N/S507 : AAGGAGTA N/S508 : CTAAGCCT N/S510 : CGTCTAAT N/S511 : TCTCTCCG N/S513 : TCGACTAG N/S515 : TTCTAGCT N/S516 : CCTAGAGT N/S517 : GCGTAAGA N/S518 : CTATTAAG N/S520 : AAGGCTAT N/S521 : GAGCCTTA N/S522 : TTATGCGA i7 sequence: N701 : TCGCCTTA N702 : CTAGTACG N703 : TTCTGCCT N704 : GCTCAGGA N705 : AGGAGTCC N706 : CATGCCTA N707 : GTAGAGAG N710 : CAGCCTCG N711 : TGCCTCTT N712 : TCCTCTAC N714 : TCATGAGC N715 : CCTGAGAT N716 : TAGCGAGT N718 : GTAGCTCC N719 : TACTACGC N720 : AGGCTCCG N721 : GCAGCGTA N722 : CTGCGCAT N723 : GAGCGCTA N724 : CGCTCAGT N726 : GTCTTAGG N727 : ACTGATCG N728 : TAGCTGCA N729 : GACGTCGA 图片发自简书 1. 所以，ATAC-seq的这个Oligo designs （Adaptors）可以大概总结： 有两种Adaptors，分别为Adaptor1 （50bp） 和Adaptor2 （53bp）。 其中Adaptor1（5’ illumina Primer1 sequence （29bp）+ Tn5 Read1 sequence（14bp）（再延伸到ME里面7bp）3’），Adaptor2（5’ illumina Primer2 sequence（24bp）+ barcode sequence （8bp）+ Tn5 Read2 sequence （15bp）（再延伸到ME里面6bp）3’） 这样算来，ATAC-seq library的长度=左面（Adaptor1 长度 +剩余部分Tn5的ME（12 bp_TATAAGAGACAG））+ open chromatin 的DNA长度+右面（剩余部分Tn5的ME（13bp_GTATAAGAGACAG）+ Adaptor2 长度）=open chromatin 的DNA长度 + 128bp。 所以，在ATAC-seq的libraries中 mono nucleosome的ATAC-seq library长度大概是(单核小体146bp+核小体free region)+两端的adaptor及Tn5最里面部分ME序列长度（50bp+12bp+13bp+53bp）=274bp+free region，也就是bioanalyzer里面看到的第二个peak。图中显示大概是340bp左右。所以free region应该是330bp-274bp=56bp 。 那么会问，对不对呢？看下bioanalyzer的第一个peak，显示是182bp，这个peak代表的是nucleosome free region的ATAC-seq library，所以是nucleosome free region序列长度 + 两端的adaptor及Tn5部分ME序列长度（50bp+12bp+13bp+53bp）=182， 所以，不难得出同样的结果，nucleosome free region序列长度是54bp。差不多哦 以此类推，第三个peak代表de-nucleosome ， 500bp到550 bp之间，是不是等于两个核小体长度加上核小体空隙序列再加上两个adaptor， 2146bp + 255bp + 128bp= 530bp （为什么55bp也要乘2？答：多出来一个核小体当然就多出来一份核小体空隙） 综上所述，ATAC-seq library长度比genome DNA实际长度一定多出128bp。 nucleosome free region, mono-nucleosome, de-nucleosome and try-nucleosome 2. 下面一个问题，tagmentation时候，会出现gap？Nextera tagmentation on amplified cDNA (will create 9-bp gap）？ 所以需要在PCR第一步，需要5min的72摄氏度来填坑。还要注意，就是在tagmentation的时候会出现三种产物，上面的图只是其中一种。 ","date":"2020-02-22","objectID":"/bioinfo-q-a-68/:1:0","tags":["AQ100","illumina","ATAC-seq"],"title":"【bioinfo】-Q\u0026A-68","uri":"/bioinfo-q-a-68/"},{"categories":["bioinfo","ngs"],"content":"鉴定可重复的Peaks ATAC-Seq/ChIP-Seq通常需要2个会更多的生物学重复（十分珍贵或者稀有样本除外，但必须做至少2次技术重复）。理论上重复样本的peaks应该有高度的一致性，实际情况并不完全与预期一致。如何评价重复样本的重复性的好坏？如何得到一致性的peaks?这里介绍两种方法： 用Bedtools进行简单的overlap合并重复样本 IDR（Irreproducibility Discovery Rate）的方法获得高重复性的peaks ","date":"2020-02-22","objectID":"/bioinfo-q-a-67/:1:0","tags":["AQ100","peaks","atac-seq","chip-seq"],"title":"【bioinfo】-Q\u0026A-67","uri":"/bioinfo-q-a-67/"},{"categories":["bioinfo","ngs"],"content":"1. Overlapping peaks using bedtools 如何得到两个重复样本间一致性的peaks? 一种简单粗暴的方法就是用bedtools计算peaks的overlaps。 用法： bedtools intersect [OPTIONS] -a \u003cbed/gff/vcf/bam\u003e -b \u003cbed/gff/vcf/bam\u003e -a: 参数后加重复样本1（A） -b：参数后加重复样本2（B），也可以加多个样本 其他常用参数解释和图解如下： -wo：Write the original A and B entries plus the number of base pairs of overlap between the two features. -wa：Write the original entry in A for each overlap. -v：Only report those entries in A that have no overlaps with B 如果只有-a和-b参数，返回的是相对于A的overlaps。加上参数-wo返回A和B原始的记录加上overlap的记录。参数-wa返回每个overlap中A的原始记录。 鉴定可重复的Peaks 使用代码示例： bedtools intersect \\ -a macs2/Nanog-rep1_peaks.narrowPeak \\ -b macs2/Nanog-rep2_peaks.narrowPeak \\ -wo \u003e bedtools/Nanog-overlaps.bed ","date":"2020-02-22","objectID":"/bioinfo-q-a-67/:1:1","tags":["AQ100","peaks","atac-seq","chip-seq"],"title":"【bioinfo】-Q\u0026A-67","uri":"/bioinfo-q-a-67/"},{"categories":["bioinfo","ngs"],"content":"2. Irreproducibility Discovery Rate (IDR) 评估重复样本间peaks一致性的另一种方法是IDR。IDR是通过比较一对经过排序的regions/peaks 的列表，然后计算反映其重复性的值。 IDR在ENCODE和modENCODE项目中被广泛使用，也是ChIP-seq指南和标准中的一部分。ENCODE_ATAC_pipeline IDR的 优点： 避免了初始阈值的选择，解决了不同callers的不可比较性 IDR不依赖于阈值的选择，所有regions/peaks都被考虑在内。 它是依赖regions/peaks的排序，不要求对输入信号进行校准或标准化 IDR的详细说明参考: https://github.com/nboley/idr https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/06_handling-replicates.md#irreproducibility-discovery-rate-idr 使用IDR的注意事项： 建议使用IDR时，MACS2 call peaks的步骤参数设置不要过于严格，以便鉴定出更多的peaks。 使用IDR需要先对MACS2的结果文件narrowPeak根据-log10(p-value)进行排序。 # Call peaks macs2 callpeak -t sample.final.bam -n sample --shift -100 --extsize 200 --nomodel -B --SPMR -g hs --outdir Macs2_out 2\u003e sample.macs2.log #Sort peak by -log10(p-value) sort -k8,8nr NAME_OF_INPUT_peaks.narrowPeak \u003e macs/NAME_FOR_OUPUT_peaks.narrowPeak 使用IDR示例 idr --samples sample_Rep1_sorted_peaks.narrowPeak sample_Rep2_sorted_peaks.narrowPeak \\ --input-file-type narrowPeak \\ --rank p.value \\ --output-file sample-idr \\ --plot \\ --log-output-file sample.idr.log --samples:narrowPeak的输入文件（重复样本） --input-file-type：输入文件格式包括narrowPeak,broadPeak,bed --rank p.value：以p-value排序 --output-file: 输出文件路径 --plot：输出IDR度量值的结果 输出文件解读： 详细内容可参考：https://github.com/nboley/idr#output-file-format 输出文件包括： sample-idr sample-idr.log sample-idr.png （1）sample-idr sample-idr是common peaks的结果输出文件，格式与输入文件格式类似，只是多了几列信息。前10列是标准的narrowPeak格式文件，包含重复样本整合后的peaks信息。 第5列：包含缩放的 IDR 值 score int 如min(int(log2(-125IDR), 1000)，那么IDR=0，缩放的IDR就是1000；IDR=0.05, int(-125log2(0.05)) = 540；IDR=1.0, int(-125log2(1.0) = 0。 第11列和第12列：分别是local和global IDR值 col11: localIDR float -log10(Local IDR value) col12: globalIDR float -log10(Global IDR value) global IDR值是第5列中用于计算缩放的IDR值，类似于对p值进行多个假设校正以计算FDR；local IDR类似于属于不可重复噪声部分的峰值的后验概率。详细内容可阅读Measuring reproducibility of high-throughput experiments。 第13、14、15、16列：是重复样本1相关的信息。 col13: rep1_chromStart int col14: rep1_chromEnd int col15: rep1_signalValue float col16: rep1_summit int 第17-20列：是重复样本2相关的信息，和13-16四列信息类似。 其他列信息如下： col1: chrom string col2: chromStart int col3: chromEnd int col4: name string col6: strand [+-.] Use ‘.’ if no strand is assigned. col7: signalValue float col8: p-value float col9: q-value float col10: summit int wc -l *-idr 计算下common peaks的个数，接着可再计算下与总peaks的比率。 如果想看IDR\u003c0.05的，可以通过第5列信息过滤： awk '{if($5 \u003e= 540) print $0}' sample-idr | wc -l （2）sample-idr.log log文件会给出peaks通过IDR \u003c 0.05的比率，如下图所示 鉴定可重复的Peaks 3）sample-idr.png png文件包括4个图 Rep1 peak ranks vs Rep2 peak ranks, 没有通过特定IDR阈值的peaks显示为红色。 Rep1 log10 peak scores vs Rep2 log10 peak scores，没有通过特定IDR阈值的peaks显示为红色。 Peak rank vs IDR scores，箱线图展示了IDR值的分布，默认情况下，IDR值的阈值为-1E-6。 ","date":"2020-02-22","objectID":"/bioinfo-q-a-67/:1:2","tags":["AQ100","peaks","atac-seq","chip-seq"],"title":"【bioinfo】-Q\u0026A-67","uri":"/bioinfo-q-a-67/"},{"categories":["bioinfo","ngs"],"content":"bismark 识别甲基化位点-比对篇 bismark 软件根据序列的比对情况就可以识别甲基化位点，首先需要对基因组建立索引，建好索引之后，就可以开始比对了。 我用的软件自带的单端测序的数据集进行测试， 命令如下 bismark hg19_bismark_db/ test_data.fastq -o test 第一个参数为bismark_genome_preparation命令构建的基因组索引所在的目录，第二个参数为需要比对的序列， -o参数指定输出的目录 bismark的参数很多，通常情况下，采用默认参数就好。其他参数全部默认的情况下：bismark 比对的过程分为以下几步： ","date":"2020-02-22","objectID":"/bioinfo-q-a-66/:1:0","tags":["AQ100","bismark","methylation"],"title":"【bioinfo】-Q\u0026A-66","uri":"/bioinfo-q-a-66/"},{"categories":["bioinfo","ngs"],"content":"1 . 将输入序列进行C-\u003eT的转换 软件在运行过程中的log信息如下： Input file is in FastQ format Writing a C -\u003e T converted version of the input file test_data.fastq to test_data.fastq_C_to_T.fastq Created C -\u003e T converted version of the FastQ file test_data.fastq (10000 sequences in total) Input file is test_data.fastq_C_to_T.fastq (FastQ) ","date":"2020-02-22","objectID":"/bioinfo-q-a-66/:1:1","tags":["AQ100","bismark","methylation"],"title":"【bioinfo】-Q\u0026A-66","uri":"/bioinfo-q-a-66/"},{"categories":["bioinfo","ngs"],"content":"2 . 将C-\u003e 转换好的序列分别与 C-\u003eT 转换的基因组和G-\u003eA 转换的基因组进行比对 Now starting the Bowtie 2 aligner for CTreadCTgenome Using Bowtie 2 index: hg19_bismark_db/CT_conversion/BS_CT Using Bowtie 2 index: hg19_bismark_db/GA_conversion/BS_GA 我用的是 1.9.0 版本的bismark, 现在绝大多数的BS-seq的文库构建都是采用illumina提供的的标准protocol, 构建出来的文库都是链特异性的文库，所以从0.7.0版本之后的bismark, 默认只做两次比对，但是这个默认情况只适合链特异性文库，如果你的文库不是链特异性的，那么就需要添加–non_directional选项。 何为链特异性文库，就是说链是由方向性的。对于普通的文库，测序的插入片段都是双链，但是链特异性文库是单链。通过在反向互补时添加特定的标记，在双链合成后，将第二条链去除，最后用于测序的就只有一条链了。如果一个甲基化位点发生在基因组的正链上，那么这段区域在测序时插入序列就只有正链上的序列，如果发生在负链上，则只有负链作为插入序列。 在bismark中，将基因组的正链定义为top strand ， 简称OT, 负链定义为bottom strand, 简称OB; 亚硫酸氢盐处理后，正负链之间并不是完全的反向互补的，将OT链的反向互补链定义为CTOT, 将OB链的反向互补链定义为CTOB。 对于链特异性文库而言，由于插入序列为单链，只需要比对OT和OB两条链即可，大大减少了运算量，所以目前illumina的标准BS-seq protocol构建的文库都是链特异性文库，新版的bismark默认的运行方式也是针对链特异性文库的。 bismark 识别甲基化位点-比对篇 图中展示了bismark比对的过程， 包括了原始序列转换和比对两个过程： 原始序列转换包括两种方式： C-\u003eT 的转换 G-\u003eA 的转换 比对也包括两种基因组： C-\u003eT 转换的基因组 G-\u003eA 转换的基因组 所以每条reads 最多会有 2 X 2 = 4 种比对情况，对于链特异性的文库，只有C-\u003eT 转换，所以只有2种比对情况。 ","date":"2020-02-22","objectID":"/bioinfo-q-a-66/:1:2","tags":["AQ100","bismark","methylation"],"title":"【bioinfo】-Q\u0026A-66","uri":"/bioinfo-q-a-66/"},{"categories":["bioinfo"],"content":"数据库网站 API 知多少 ","date":"2020-02-22","objectID":"/bioinfo-q-a-65/:1:0","tags":["AQ100","API","DB"],"title":"【bioinfo】-Q\u0026A-65","uri":"/bioinfo-q-a-65/"},{"categories":["bioinfo"],"content":"API API 这个词在大多数人看来可能和 CNS 差不多，前者天天听说就是用不上，后者天天读就是发不了。 不过，通过今天的一个简短介绍，今后 API 这个东西你就用上了，因为在文章最后我将会展示一个最最基础且高频的 API 使用示例。 所谓 API(Application Programming Interface) 就是应用程序接口。这个应用程序可以类比于手机和电脑，这个接口就类似于数据线，如果我们想用数据线把东西在两个设备之前传输，就需要两者可以接受彼此的传输协议。 对一个应用程序来说，如果你想快速的和它交换数据，也需要采用应用程序可以识别的规则。对于一些成熟的应用程序和网站来说，通常都会提供自己的一套API供开发者友好的使用，一方面可以大大扩展应用程序的生态环境，另一方面也可以避免暴力的爬虫。 我们通过下图的「印象笔记 API」为例，如果你使用过印象笔记（Evernote）的话，会发现大量第三方应用都可以支持绑定印象笔记账户进行各种创建笔记推送笔记等操作。这里不是印象笔记去适配第三方应用，而是它提供了一个完善的 API，可以供其他开发者来使用。 ","date":"2020-02-22","objectID":"/bioinfo-q-a-65/:1:1","tags":["AQ100","API","DB"],"title":"【bioinfo】-Q\u0026A-65","uri":"/bioinfo-q-a-65/"},{"categories":["bioinfo"],"content":"REST API API 之后还有一个概念是 REST API。 REST(Representational State Transfer) 的中文翻译一般是「表现层状态转化」（这也太抽象了吧），这个架构是 Roy Thomas Fielding 在2000年的毕业论文里提到的，他同时还是HTTP协议（1.0版和1.1版）的主要设计者、Apache服务器软件的作者之一、Apache基金会的第一任主席。 关于究竟什么是「表现层状态转化」这里就跳过了，因为不跳过你也不会看（我也解释不清楚）。只需要了解，符合 REST 设计风格的 Web API 称为 RESTful API，有如下几个要点： 资源地址：URI，比如：http://example.com/resources。 传输的资源：Web服务接受与返回的互联网媒体类型，比如JSON，XML，YAML等。 对资源的操作：Web服务在该资源上所支持的一系列请求方法，比如：POST，GET，PUT 或 DELETE。 ","date":"2020-02-22","objectID":"/bioinfo-q-a-65/:1:2","tags":["AQ100","API","DB"],"title":"【bioinfo】-Q\u0026A-65","uri":"/bioinfo-q-a-65/"},{"categories":["bioinfo"],"content":"常用数据库 API NCBI NCBI 是啥就不介绍了，如果太多的功能没用过 PubMed 应该怎么也用过。在 NCBI 的开发文档中，有一个部分专门是讲 API 的。 NCBI 提供的 API 如下图所示，如果需要可以去看看。 EMBL-EBI EMBL-EBI 来自于欧洲，里面有很多很多数据库都是我们日常会使用的，只是你可以还不知道它们和 EBI 有关系的，例如存放了大量基因组及相关数据的 Ensembl ，包括大量蛋白序列和功能信息的数据库 UniPort，当然还有还有不逊色与 pubmed 的文献数据库 Europe PMC。 从个人的使用体验来说，一般能用EBI的时候我就尽量会绕过NCBI，因为整个一系列网站用起来都要更舒服些，文档查起来更顺手些，对一些有进阶需求的开发者会更友好些（如果你有二次开发的需求，经过对比不难理解我的感受）。 目前 EBI 比较知名的几个数据库都有很不错的 RESTful API 支持。 其中 Ensembl 支持 21 个 POST 和 98 个 GET 操作，可以在官方说明中查看；Uniport 数据库 和 Europe PMC 也有大量的操作支持。通过这些 API 你就可以接触到数据库中有的所有信息和 33 million 的文献。另外，EBI 还有一个 QuickGO 的网站也支持 RESTful API 。 他们的 API 完善到直接在 NAR 发了一篇文章。 可用的数据库和工具如下 ","date":"2020-02-22","objectID":"/bioinfo-q-a-65/:1:3","tags":["AQ100","API","DB"],"title":"【bioinfo】-Q\u0026A-65","uri":"/bioinfo-q-a-65/"},{"categories":["bioinfo"],"content":"使用 API 这里以 Ensembl 的一个基础 API 为例对使用方法进行简单的演示。如果我们在 Ensembl 的网站上查看一个基因，会是如下页面。在左侧我况圈出来的是和这个基因相关的所有信息，其中99%的信息都可以通过 API 获取到。 ","date":"2020-02-22","objectID":"/bioinfo-q-a-65/:1:4","tags":["AQ100","API","DB"],"title":"【bioinfo】-Q\u0026A-65","uri":"/bioinfo-q-a-65/"},{"categories":["bioinfo"],"content":"查看单基因信息 这里以最基础的单基因信息查询作为示例。Ensembl 的 RUSTful API 支持使用各种语言实现，既可以在 Unix 操作系统中使用 curl 和 wget 命令，也可以使用 python java perl 和 R 语言来操作。 如果要是用 wget 来查询一个基因的话，查询规则示例是http://rest.ensembl.org/lookup/id/AT4G34410?expand=1’。其实这就是一个简单的我们都能理解的「网址」，其中 id 后面是我们要查询的基因id，问号后面可以添加任意支持的参数。另外，还需要 header 信息’Content-type:application/json’ 来指定获取的资源类型。 运行命令如下： wget -q --header='Content-type:application/json' 'http://rest.ensembl.org/lookup/id/AT4G34410?expand=1' -O - 得到的内容会是一行 json 内容，这个信息大家看到都是崩溃的我就不直接放上来了。我们可以使用一些命令和操作稍微进行美化。 wget -q --header='Content-type:application/json' 'http://rest.ensembl.org/lookup/id/AT4G34410?expand=1' -O - | jq '.' - 通过 jq 这个命令，可以让输出变成标准的 json 格式。 为了更方面的处理 json 内容和进行后一步的分析，我们可以移步到 R 中，看看如何使用。 要在 R 使用 RUSTful API 并进行后续的 json 文件处理，首先需要加载两个包，httr 用来调取 GET 和 POST 等命令，jsonlite 用来处理 json 格式的文件。 httr 会把 GET 的结果保存为一个 response 类型的对象，其中包括了 url，状态码以及header等各种各样的信息，jsonlite 可以帮助我们根据需求提取 json 里的内容并输出为 list 对象。 简单的运行命令如下： # 加载 R 包 library(httr) library(jsonlite) # 指定 server server \u003c- \"http://rest.ensembl.org\" # 指定查询内容,为了方便展示这里 expand=0 ext \u003c- \"/lookup/id/ENSG00000157764?expand=0\" # 使用 httr 包的 GET 进行查询 r \u003c- GET(paste(server, ext, sep = \"\"), content_type(\"application/json\")) # 这里的 r 是一个response类型的对象。 # 将http错误转换为R错误方便debug stop_for_status(r) 到这里其实查询的步骤已经文章，对象 r 的结构如下： 接下来就是首先把这个对象中的内容转换为json然后在转换为table即可，命令非常简单。 list \u003c- fromJSON(toJSON(content(r))) tb \u003c- do.call(rbind,list) 如果需要稍微优雅一些，可以改写为一个函数，如果需要一次查找多个基因，可以使用 POST 方法。 你可能会好奇使用 API 的优势在哪里。 如果只是查找一个基因，API 的优势并不明显，如果只是偶尔查找几个基因，API 的优势也不明显。那什么使用就有优势了呢，类比于「印象笔记」以及和它相关的使用了「印象笔记 API」的第三方应用，不知道会不会给你一些启发。话不能说的太透，点到为止，更多的应用场景我们以后有机会再聊。 ","date":"2020-02-22","objectID":"/bioinfo-q-a-65/:1:5","tags":["AQ100","API","DB"],"title":"【bioinfo】-Q\u0026A-65","uri":"/bioinfo-q-a-65/"},{"categories":["bioinfo"],"content":"新冠病毒是源自实验室的？ 在各种各样的质疑新冠病毒可能源自实验室的文章，水准最高的是美国纯净和应用知识研究所（Institute for Pure and Applied Knowledge, IPAK）的建立者和CEO，Dr. James Lyons-Weiler在网上贴的两篇英文的技术贴，认为2019-nCoV有可能来源于实验室。这些菌株在实验室里连接了通用载体pShuttle-SN，而连接这个载体制备的菌株，主要是为了生产冠状病毒的疫苗。原文链接就不放了，两个帖子的主要内容是，Dr. James Lyons-Weiler将2019-nCoV和其他冠状病毒的基因组序列进行比对，发现2019-nCoV存在一段在其他冠毒里不存在的、长度为1,378 bp的插入片段（INS1378），将这段序列与pShuttle-SN重组载体序列进行比对，有67%的同一性（下图）。 因此，Dr. James Lyons-Weiler的观点是：新冠病毒来自实验室的重组病毒，该重组组病毒主要是为了生产疫苗（A recombined virus made in a laboratory for the purpose of creating a vaccine）。事实上，James并没有实锤他的观点是不是对的，因此他第二篇帖子的题目用了“中等强度的确认”（Moderately Strong Confirmation）。老外写东西，一般正方反方的观点都会列举，他自己总结的支持或反对这个论点的证据如下： A. 支持的证据：INS1378与pShuttle-SN之间的相似性；存在蝙蝠冠毒中的类SARS的Spike蛋白，或者与冠毒非常相似；自展值低。 B. 反对的证据：低序列相似性（指INS1378与pShuttle-SN之间，但仍然高度显著）；这些RNA病毒可能快速演化（例如在实验室条件下）。 C. 观点的可能性：高度可能。 D. 验证：检测中国实验室里的所有在研的冠毒（一例即可证明）；在野外分离一个菌株能够与2019-nCoV匹配（一例即可证伪）。 注意Dr. James Lyons-Weiler在（D）里描述的验证方法。事实上要实锤James的观点是正确的，比较困难，因为必须要检测到一株实验室里在研的、用来生产疫苗、并且与2019-nCoV高度相似的病毒菌株。如果找不到这样的菌株，既不能证明James的观点是对，也不能证明他的观点一定是错的。但是James也提出了证伪的方法，那就是找到一株在野外分离的菌株能够与2019-nCoV匹配，这样即可表明他的观点是错的。 ================================================ 这里我们先讲结论：James的计算分析有误，其结果不能支持新冠病毒源自实验室的猜想。下面我们开始用“简单的生物信息学分析”进行证明： 第一，我们需要先知道冠状病毒的突变速率。 查阅文献，2004年Zhao等人发表论文，推测SARS-CoV基因组的突变速率约是0.80 - 2.38 x 10^-3个碱基/位点/年，这个结果与其他RNA病毒有相同的数量级（https://www.ncbi.nlm.nih.gov/pubmed/15222897）。我们考虑上限，一个SARS-CoV基因组的突变率应当不超过3 x 10^-3个碱基/位点/年，2019-nCoV的基因组长度为29,903 bp（https://www.ncbi.nlm.nih.gov/nuccore/NC_045512），这样可以算出来2019-nCoV每年突变的碱基应该\u003c29,9033x 10^-3=~90 bp。由于计算方法不同，估算出来的突变速率可能不尽相同；病毒基因组的各个部分，可能进化速率也不一致。例如，2004年一篇Science上估算SARS-CoV的突变率为8.26 × 10^–6个碱基/位点/天（https://www.ncbi.nlm.nih.gov/pubmed/14752165），换算得到2019-nCoV每年突变碱基为90 bp（8.26 × 10^–6365*29,903），与我上面的分析一致。2004年另一篇论文估算SARS-CoV的突变率为5.7 × 10^–6个碱基/位点/天（https://www.ncbi.nlm.nih.gov/pubmed/15347429），换算之后得到2019-nCoV每年突变碱基为62 bp。另外，需要注意的是，目前的分析表明，2019-nCoV的进化速率比较低，有研究者估算2019-nCoV的突变率是2.067×10^-4个碱基/位点/年（http://virological.org/t/temporal-signal-and-the-evolutionary-rate-of-2019-n-cov-using-47-genomes-collected-by-feb-01-2020/379），换算之后大约是每年全基因组6个碱基突变，远比我假设的突变率要低。另外，也有学者使用不同的模型，估算2019-nCoV的突变速率约为0.42 x 10^-3 – 1.89 x 10^-3，这个数字也比我使用的要小。因此，我们估算2019-nCoV每年大约突变90个碱基位点，这个数字可以认为是上限。 第二，中科院病毒所石正丽研究员等人于1月23日在线提交了一篇预印本文章 标题为《Discovery of a novel coronavirus associated with the recent pneumonia outbreak in humans and its potential bat origin》（https://www.biorxiv.org/content/10.1101/2020.01.22.914952v2），其中很重要的一个分析就是发现2019-nCoV与从云南省的某种菊头蝠（Rhinolophus affinis）里分离得到的BatCoV RaTG13（https://www.ncbi.nlm.nih.gov/nuccore/MN996532.1，基因组长度29,855 bp）有96.2%的全基因组相似性。我们把2019-nCoV（核酸序列标识符NC_045512）与BatCoV RaTG13（核酸序列标识符MN996532）做双序列比对，在NCBI BLAST（https://blast.ncbi.nlm.nih.gov/Blast.cgi）点击“Global Align”，进入到双序列比对的页面. 两者同一性96%，有29,905-28,717=1,188对碱基差异，由于两者可以独立演化，全基因组突变速率3 x 10^-3个碱基/位点/年，2019-nCoV和BatCoV RaTG13每年大约分别全基因突变90 bp，因此大致可以估算两者的分歧时间大约是：1,188/(90*2)=6.6年。在石老师的文章里，他们先利用较短的RNA依赖的RNA聚合酶（RdRp）区域确定与2019-nCoV可能相似的蝙蝠来源的冠毒，根据结果对BatCoV RaTG13进行了全基因组测序。因此，第一，BatCoV RaTG13可能是实验室里目前找到的、与2019-nCoV最相似的病毒；第二，如果石老师的实验室发生泄漏，BatCoV RaTG13在自然界中独立演化成2019-nCoV，至少需要6.6年。第三，由于2019-nCoV需要演化6.6年，那么必须在野外找到大量的过渡性、相似度与2019-nCoV更高的菌株，才能证明实验室泄露是可能发生的。 第三，James宣称的INS1378是2019-nCoV独有的片段，这个分析是不对的。 我们根据James提供的序列（https://jameslyonsweiler.com/wp-content/uploads/2020/02/inserted-portion.txt），在https://blast.ncbi.nlm.nih.gov/Blast.cgi页面，点击“Nucleotide BLAST”选项，进入页面之后输入这段序列，“Program Selection”里选择“Somewhat similar sequences (blastn)”进行核酸序列的比对，“Algorithm parameters”的Max target sequences选择“250”，这样能看到更多的比对结果。然后点击BLAST找相似性序列，部分结果如下： 注意从下往上数的第3和第4个结果，分别是蝙蝠来源的类SARS-CoV，包括bat-SL-CoVZC45和bat-SL-CoVZXC21。我们点击“Bat SARS-like coronavirus isolate bat-SL-CoVZC45, complete genome”，部分比对结果如下： 可以发现INS1378在bat-SL-CoVZC45里有相似度较高的片段。在刚才的比对结果页面，使劲的往下翻，任意点击一个比方说SARS coronavirus PC4-13, complete genome， 因此INS1378在SARS-CoV PC4-13里也有相似性片段。所以结论是INS1378在冠状病毒里广泛存在相似片段，并不是仅在2019-nCoV或BatCoV RaTG13里独有。 第四，INS1378有没有可能来源于pShuttle-SN载体？ 根据James提供的pShuttle-SN载体的序列标识符（https://www.ncbi.nlm.nih.gov/nuccore/AY862402，长度5,607 bp），我","date":"2020-02-22","objectID":"/bioinfo-q-a-64/:1:0","tags":["AQ100","coronavirus"],"title":"【bioinfo】-Q\u0026A-64","uri":"/bioinfo-q-a-64/"},{"categories":["bioinfo"],"content":"Python计算Rank(秩) 在统计学中，有时候我们需要求一组数据的Rank，如非参检验、Spearman相关性等。Rank中文意思叫做顺序，更专业点的叫法是”秩”。这里介绍一下用Python求Rank。 先看一个简单的例子： \u003e\u003e\u003e a = [1.0, 5.6, 3.5, 9.7, 7.8] \u003e\u003e\u003e # rank_a = [1, 3, 2, 5, 4] ... \u003e\u003e\u003e rank_a = sorted(range(len(a)), key = a.__getitem__) \u003e\u003e\u003e rank_a [0, 2, 1, 4, 3] \u003e\u003e\u003e rank_a = [i + 1 for i in rank_a] \u003e\u003e\u003e rank_a [1, 3, 2, 5, 4] 上面的例子中，列表a中的元素是没有重复的，直接排序即可。如果有重复元素怎么办呢？最简单的办法是使用SciPy提供的rankdata()函数。 \u003e\u003e\u003e from scipy.stats import rankdata \u003e\u003e\u003e rankdata([0, 2, 3, 2]) array([ 1. , 2.5, 4. , 2.5]) \u003e\u003e\u003e rankdata([0, 2, 3, 2], method='min') array([ 1, 2, 4, 2]) \u003e\u003e\u003e rankdata([0, 2, 3, 2], method='max') array([ 1, 3, 4, 3]) \u003e\u003e\u003e rankdata([0, 2, 3, 2], method='dense') array([ 1, 2, 3, 2]) \u003e\u003e\u003e rankdata([0, 2, 3, 2], method='ordinal') array([ 1, 2, 4, 3]) rankdata()函数返回一个array对象，默认的方法是average，即相同元素的Rank值取算术平均数，同时rankdata()函数还提供了其他方法。 如果觉得安装SciPy库太麻烦，我们也可以自己实现。下面的代码计算重复元素的Rank使用的方法是average，返回一个列表。 def rank_simple(vector): return sorted(range(len(vector)), key=vector.__getitem__) def rankdata(vector): n = len(vector) ivec = rank_simple(vector) svec = [vector[rank] for rank in ivec] sumranks = 0 dupcount = 0 newvector = [0] * n for i in range(n): sumranks = sumranks + i dupcount = dupcount + 1 if i == n - 1 or svec[i] != svec[i + 1]: averank = sumranks / float(dupcount) + 1 for j in range(i - dupcount + 1, i + 1): newvector[ivec[j]] = averank sumranks = 0 dupcount = 0 ","date":"2020-02-22","objectID":"/bioinfo-q-a-63/:1:0","tags":["AQ100","python","rank"],"title":"【bioinfo】-Q\u0026A-63","uri":"/bioinfo-q-a-63/"},{"categories":["bioinfo","ngs"],"content":"T检验靠谱吗？ 对于实验生物学研究者来说，经常遇到的一个场景是，对照组测量3个值，实验组测量3个值，然后用T检验得出均值是否有显著性差异，然后做出结论。如下图所示： bio_t 那么T检验靠谱吗？本文采用模拟抽样的方法来探讨这件事情，由于本人统计学知识有限，还请各位读者批评指正。 我们通过构建两个随机总体，总体1的均值固定为1（模拟control），总体2的均值我们从依次取0.5到2.0（模拟treatment相对与control的变化），标准差我们取0.01、0.05、0.10（模拟测量误差1%，5%，10%）。总体数量为1000，每次随机抽取3个样本，抽样1000次，考察通过T检验得出正确结论的频率。代码如下： import numpy as np import pandas as pd import seaborn as sns from scipy import stats import matplotlib.pyplot as plt plt.xkcd() sns.set(style=\"white\", context=\"talk\") def norm_t(loc1, loc2, scale1, scale2, n): normSpace1 = stats.norm.rvs(loc = loc1, scale = scale1, size = 1000) normSpace2 = stats.norm.rvs(loc = loc2, scale = scale2, size = 1000) count = 0 for i in range(1000): sample1 = np.random.choice(normSpace1, n) sample2 = np.random.choice(normSpace2, n) t, p = stats.ttest_ind(sample1, sample2) if (p \u0026lt; 0.05 and (sample1.mean() \u0026gt; sample2.mean()) == (loc1 \u0026gt; loc2)): count = count + 1 return count / 1000 def plot(stds): df = pd.DataFrame() for std in stds: x = np.arange(0.5, 2.1, 0.1) y = [norm_t(loc1 = 1, loc2 = i, scale1 = std, scale2 = std, n = 3) for i in x] z = [std for i in x] df_std = pd.DataFrame([x, y, z]).T df_std.columns = [\"difference\", \"sensitivity\", \"std\"] if df.shape == (0, 0): df = df_std else: df = df.append(df_std) sns.pointplot(x = \"difference\", y = \"sensitivity\", hue = \"std\", data = df) plot([0.01, 0.05, 0.10]) std_sensitivity 通过上图，我们发现，当标准差我们取0.01（模拟测量误差1%）时，增大到1.1倍或者减小到0.9倍，正确率可以达到100%。而当标准差取0.05和0.10（模拟测量误差5%和10%），效果就不理想了，本来是有差异的，还是有很大几率通过T检验得出错误的结论。显而易见的是，随着标准差的增加，T检验的效果变差了。 那么当标准差取0.10时，随着抽样样本数的增加，T检验判断正确的频率会是怎么样的呢？请看如下代码： def plot2(diffs): df = pd.DataFrame() for diff in diffs: x = list(range(3, 60, 3)) y = [norm_t(loc1 = 1, loc2 =1.1, scale1 = 0.10, scale2 = 0.10, n = i) for i in x] z = [diff for i in x] df_diff = pd.DataFrame([x, y, z]).T df_diff.columns = [\"samle number\", \"sensitivity\", \"difference\"] if df.shape == (0, 0): df = df_diff else: df = df.append(df_diff) sns.pointplot(x = \"samle number\", y = \"sensitivity\", hue = \"difference\", data = df) plot2([0.5, 0.8, 1.2, 2.0]) n_sensitivity 通过上图，我们发现，即使标准差达到0.10，当样本数量达到30以上时，T检验的效果就非常好了。 那么如果两个总体没有差异，T检验得出有差异的错误结论的情况是什么样子的呢？我们构建两个均值为1容量为1000的总体，每次随机抽取3个样本，在不同标准差及样本数目的情况下，考察T检验得出正确结论的频率。请看代码： def norm_t2(loc, scale1, scale2, n): normSpace1 = stats.norm.rvs(loc = loc, scale = scale1, size = 1000) normSpace2 = stats.norm.rvs(loc = loc, scale = scale2, size = 1000) count = 0 for i in range(1000): sample1 = np.random.choice(normSpace1, n) sample2 = np.random.choice(normSpace2, n) t, p = stats.ttest_ind(sample1, sample2) if p \u0026gt; 0.05: count = count + 1 return count / 1000 def plot3(stds): stds = [0.1, 0.5, 1] df = pd.DataFrame() for std in stds: x = list(range(3, 60, 3)) y = [norm_t2(loc = 1, scale1 = std , scale2 = std, n = i) for i in x] z = [std for i in x] df_std = pd.DataFrame([x, y, z]).T df_std.columns = [\"samle number\", \"specificity\", \"std\"] if df.shape == (0, 0): df = df_std else: df = df.append(df_std) sns.pointplot(x = \"samle number\", y = \"specificity\", hue = \"std\", data = df) plt.ylim(0, 1.2) plot3([0.1, 0.5, 1]) specificity 通过上图，我们惊讶地发现，当两个总体没有差异时，不管标准差是多少和取样数目是多少，T检验都有非常好的表现，即得到差异不显著的的结论。 这里构建的总体都是正太总体，其实对于其他分布的总体，结论是一样的，这里就不展示了。 通过上面的探索，我们可以得到如下结论： 对于两个未知总体，通过T检验考察均值是否有显著差异，如果得出结论是差异不显著，那么进一步分析这些数据的标准差是否太大了，考虑是否增加抽样样本数做进一步分析。 对于两个未知总体，通过T检验考察均值是否有显著差异，如果得出结论是差异显著，那么请相信它吧！ 如果差异不显著，我们通过增大样本数量，使得差异显著；如果差异显著，那就是一个好结果嘛！ 哈哈，T检验是实验生物学家的利器啊！ ","date":"2020-02-22","objectID":"/bioinfo-q-a-62/:1:0","tags":["AQ100","T-test"],"title":"【bioinfo】-Q\u0026A-62","uri":"/bioinfo-q-a-62/"},{"categories":["bioinfo","ngs"],"content":"利用samtools mpileup和bcftools进行SNP calling # 我们现在有bwa.bam和bow.bam两个文件。 # Pileup的输出。wgsim模拟器生成的低质量reads会被samtools忽略。 # 用samtools对fasta文件进行索引。 samtools faidx ~/refs/852/NC.fa # 用samtools查询fasta文件。 samtools faidx ~/refs/852/NC.fa NC_002549:1-10 # 你可以罗列多个区间。 samtools faidx ~/refs/852/NC.fa NC_002549:1-10 NC_002549:100-110 # 探讨一下有参或者无参的输出。 # 查看帮助文档 samtools mpileup # 不加参考序列的pileup使用 #* -q最低的mapping质量，默认设置是0 #* -Q最低的碱基质量，默认设置是13 samtools mpileup -Q 0 bwa.bam | more # 有参考序列的pileup使用 samtools mpileup -f ~/refs/852/NC.fa -Q 0 bwa.bam | more Pileups以及覆盖度 # 首先安装bcftools来处理变异call（实在不知道怎么翻译合适）出来后的格式。 #* 一般把将SNP找出来并以一定格式存储起来的过程称为SNP calling cd ~/src curl -OL http://sourceforge.net/projects/samtools/files/samtools/1.1/bcftools-1.1.tar.bz2 tar jxvf bcftools-1.1.tar.bz2 cd bcftools-1.1 make ln -s ~/src/bcftools-1.1/bcftools ~/bin # 留意下bcftools和samtools用法方面的相似性。 bcftools # 使用Lecture8中的比对脚本。 bash compare.sh # 每次运行完的平均覆盖度是多少？ # NR是指可能与基因组大小不相等的数目或记录。 # 默认情况下，samtools depth只输出覆盖度不为0的区域。 samtools depth bwa.bam | awk '{ sum += $3 } END { print sum/NR } ' # 如何获知基因组的大小？ # 有很多方法，但没有一个特别好的。 # 表头@SQ包含序列长度。 samtools view -h bwa.bam | head | grep @SQ # 现在我们知道了染色体的大小了。 samtools depth bwa.bam | awk '{ sum += $3 } END { print sum/18959 } ' # 有参考序列或没参考序列的Pileups使用 # 查看使用方法 samtools mpileup # 不加参考序列的pileup使用 samtools mpileup -Q 0 bwa.bam | more # 有参考序列的pileup使用 samtools mpileup -f ~/refs/852/NC.fa -Q 0 bwa.bam | more # Samtools的文本式的基因组浏览器。 # 按下?获取帮助，q或者ESC来退出。 samtools tview bwa.bam # 为全基因组生成一个变异call出来后的存储格式文件。 samtools mpileup -Q 0 -f ~/refs/852/NC.fa -uv bwa.bam | more # 生成基因型，然后call变异。 # Samtools是为人类基因组设计的，似乎对病毒基因组支持的不是很完美。 samtools mpileup -Q 0 -ugf ~/refs/852/NC.fa bwa.bam | bcftools call -vm \u003e snps.vcf # 欢迎来到你的下一个文件格式。 samtools mpileup -Q 0 -f ~/refs/852/NC.fa -uv bwa.bam | grep -v \"##\" | cut -f 1,2,3,4,5 | head 升级版的脚本 # 对比两个比对软件的输出。 # 使用方法: bash compare.sh #在出错的地方停止运行。 set -ue # 数据文件名。 READ1=r1.fq READ2=r2.fq # 参考序列文件。两个比对软件需要分别对它进行索引。 REFS=~/refs/852/NC.fa # 从基因组中生成模拟reads。 # 编辑错误率并重新运行这个pipeline。 wgsim -N 10000 -e 0.1 $REFS $READ1 $READ2 \u003e mutations.txt # 将mutations文件转成GFF文件。 cat mutations.txt | awk -F '\\t' ' BEGIN { OFS=\"\\t\"; print \"##gff-version 2\" } { print $1, \"wgsim\", \"mutation\", $2, $2, \".\", \"+\", \".\", \"name \" $3 \"/\" $4 }' \u003e mutations.gff # 我们需要添加一个read组到mapping中。 GROUP='@RG\\tID:123\\tSM:liver\\tLB:library1' # 运行bwa并创建bwa.sam文件。 bwa mem -R $GROUP $REFS $READ1 $READ2 \u003e bwa.sam # 运行bowtie2并创建bow.sam文件。 bowtie2 -x $REFS -1 $READ1 -2 $READ2 \u003e bow.sam # 调整bowtie2 # bowtie2 -D 20 -R 3 -N 1 -L 20 -i S,1,0.50 -x $REFS -1 $READ1 -2 $READ2 \u003e bow.sam # 对每个sam文件，都转换成bam（sam的二进制）格式。 for name in *.sam; do samtools view -Sb $name \u003e tmp.bam samtools sort -f tmp.bam $name.bam done # 删除中间文件。 rm -f tmp.sam tmp.bam # 修改名字，使得他们不再含有两个后缀。 mv bwa.sam.bam bwa.bam mv bow.sam.bam bow.bam # 对数据进行索引。 for name in *.bamdosamtools index $namedone # 删除这个程序生成的所有文件。 # rm -f *.bam *.bai *fq *.txt *.sam *.gff ","date":"2020-02-22","objectID":"/bioinfo-q-a-61/:1:0","tags":["AQ100","bcftools","SNP"],"title":"【bioinfo】-Q\u0026A-61","uri":"/bioinfo-q-a-61/"},{"categories":["bioinfo","cg"],"content":"扫描探索基因全部区域SNV的功能影响 探索BRCA1基因全部可能的突变的功能 Accurate classification of BRCA1 variants with saturation genome editing 字面意思是探索了BRCA1基因上面的全部可能的突变位点的生物学意义，但事实上只是探索了96.5% of all possible single-nucleotide variants (SNVs) in 13 exons that encode functionally critical domains of BRCA1. 具体数目如下： 不过这个方法的确是很大的创新，只不过工作量太大，如果想真正的全基因组全部位点都探索一遍。 ","date":"2020-02-21","objectID":"/bioinfo-q-a-60/:1:0","tags":["AQ100","SNV"],"title":"【bioinfo】-Q\u0026A-60","uri":"/bioinfo-q-a-60/"},{"categories":["bioinfo","cg"],"content":"背景知识 BRCA1基因 BRCA1是一种人体肿瘤抑制基因，BRCA1失去功能的突变与易患早发型乳腺癌和卵巢癌有关。虽然已发现的BRCA1基因变异有数千种，但许多都被列为“意义未明的变异”，给患癌风险评估带来了巨大挑战。 variants of uncertain significance (VUS) 基因突变源于细胞分裂，但是并不是所有的变异都与疾病有关，它们被分成“良性”、“可能良性”“不确定重要性的变异”、“可能致病”和“致病性的”。 意义不明确的突变（即VUS），包括基因与以及发表的DNA基因有着不同序列的基因，并且既不能归入有害突变的类别、也不能归入无害突变的类别。 VUS报告解读的难点首先就是VUS非常难以分类。这是因为： 首先，是目前并无一致的报告内容和格式：有的报告了变异但是并无解释、有的使用了局部地区的指南。 其次，是我们需要更多的证据来帮助我们确定某些突变确实是与癌症相关的。 目前有2种实验方案来评价一个VUS，但是都太低效。 细胞系HAP1 特殊的细胞系HAP1。在这种细胞系里，一旦BRCA1蛋白失去其应有的功能，细胞就会死亡。 基于此，美国华盛顿大学的Jay Shendure及同事运用基因组编辑技术，对BRCA1基因功能至关重要的13个外显子上的近4000种单核苷酸变异 的功能进行了评估，并在2000万个人类单倍体 HAP1 细胞中进行了后续细胞存活率测定 。 saturation genome editing (SGE) 他们每次在2000万个细胞内，对一整段外显子进行基因编辑。随后，研究人员们先让这些细胞生长11天，再做后续的分析。如果由于某个特定突变导致BRCA1失去其功能，相应的细胞就会死亡，后续分析中也就更难找到这种特定突变的存在。 RNA score Function score 作者的计算结果提供登记后的下载：https://sge.gs.washington.edu/BRCA1/ 计算方法如下： we first calculated the log2ratio of the frequency of a SNV on day 11 to its frequency in the plasmid library. Second, positional biases in editing rates were modelled using day 5 SNV frequencies and subtracted Third, to enable comparisons between exons, we normalized function scores such that the median synonymous and nonsense SNV in each experiment matched global medians. Lastly, a small number of SNVs that could not confidently be scored were filtered out 可以简单理解，Function score 越小，代表该SNV对BRCA1基因的功能影响越大，所以细胞死的越快，说明该SNV是有害的 有害的SNV作者命名为non-functional，其实说的是正是因为这个SNV有害，所以导致了BRCA1基因的non-functional。 HAP1细胞系验证BRCA1突变的影响 首先根据Function score 对SNV进行分类，因为这4千个SNV的得分分布很有规律，如下： All nonsense SNVs scored below −1.25 (n = 138, median = −2.12), whereas 98.7% of synonymous SNVs more than 3 bp from splice junctions scored above −1.25 (n = 544, median = 0.00). 所以可以使用two-component Gaussian mixture model 来进行分类： 72.5% of SNVs as functional 21.1% as non-functional 6.4% as intermediate 值得注意的是SNVs disrupting canonical splice sites (the two intronic positions immediately flanking each exon) were mostly non-functional (89.5%) or intermediate (5.5%) 非常符合预期，因为那些发生在剪切位点的SNV通常我们认为非常有害，所以导致了BRCA1基因的功能缺失。 而那些NVs positioned 1–3 bp into the exon or 3–8 bp into the intron had variable effects. We defined SNVs in these regions that did not alter the amino acid sequence as ‘splice region’ variants, of which 22.9% were non-functional，有害程度不如 canonical splice sites ，所以造成BRCA1基因的功能缺失的比例也不高。 一切都是那么的符合期望！！！ 临床评估的高度相关性 但是，符合生物学的期望是远远不够的，还需要结合临床资料，如下图： 这个就不得了啦，因为跟ClinVar数据库进行了对比，而我们通常认为ClinVar对SNV的分类是专家们达成共识的！ 首先 Of 169 SNVs deemed ‘pathogenic’ in ClinVar that overlapped with our classifications, 162 were designated ‘non-functional’, two ‘functional’, and the remaining five ‘intermediate’. 也就是说专家们认为临床有害突变的那些位点，恰好是作者的SGE筛选到的那些导致BRCA1基因功能没掉了的non-functional的SNV。 同理，of 22 SNVs deemed ‘benign’ in ClinVar, 20 were designated ‘functional’, one ‘non-functional’, and one ‘intermediate’ 这个预测模型的AOC和AUC可以说是吊炸天了！！！ 正是因为在专家们明确致病还有明确是良性的突变分类上面大展身手，作者这个时候就飘了，可以来攻克那些意义不明确的突变（即VUS）啦！！！ 具体细节不用看了，总之作者认为的系统很牛气！ 所以作者很自豪的得出结论： 因为在临床数据库的高度一致性，作者肯定了其功能评分对变异分类的重要价值，并认为研究结果可直接应用于BRCA1基因筛查的解读。 其它确定VUS的方法 Prevalence of Variant Reclassification Following Hereditary Cancer Genetic Testing的文章，作者回顾145万人的遗传性癌症基因检测结果发现，近25%的“不确定重要性的基因突变”随后被重新分类——有些与癌症相关的可能性较低，有些与癌症相关的可能性较高。 典型的基因约包含27000个碱基对（A-T，G-C），这些大量的碱基对意味着无数的潜在变异。随着高通量肿瘤测序和胚系基因检测的广泛应用，如何应对临床意义不明确的基因突变，是大家面临的挑战之一。总体而言，24.9%的“不确定重要性的变异”被重新分类，其中大多数降级为良性。 这项研究提醒医生需要知道关于基因突变的知识更新有多快，重新分类很常见。同时，独立的商业型实验室需要定期检查基因突变数据，并提醒医生注意重新分类。即便从“不确定”重新分类为“良性”，对于病人来说也很重要，因为可以让他们安心。 ","date":"2020-02-21","objectID":"/bioinfo-q-a-60/:1:1","tags":["AQ100","SNV"],"title":"【bioinfo】-Q\u0026A-60","uri":"/bioinfo-q-a-60/"},{"categories":["bioinfo","cg"],"content":"肝癌复发的CpG甲基化信号特征 杂志是 JOURNAL OF CLINICAL ONCOLOGY 影响因子26.303 ， 文章是 CpG Methylation Signature Predicts Recurrence in Early-Stage Hepatocellular Carcinoma: Results From a Multicenter Study LASSO, Least Absolute Shrinkage and Selector Operation; SVM-RFE, Support Vector Machine-Recursive Feature Elimination; 前面我们讲解了一篇2013年多组学数据探索乳腺癌细胞系药物敏感性使用的也是两个机器学习算法，不过是LS-SVM和RF，但是也有借鉴意义。 课题设计 自己的450K甲基化芯片数据上传到了：GSE75041 本项目共纳入 576 patients with Early-stage hepatocellular carcinoma (E-HCC) ，其中 66 tumor samples were analyzed using the Illumina Methylation 450k Beadchip. internal cohort (n = 141) and two external cohorts (n = 191 and n =104). 也就是先小队列做450K拿到感兴趣的甲基化位点，然后扩大队列只测量感兴趣的甲基化位点证明自己拿到的位点是有临床价值的，整体课题设计如下： 项目纳入的病人来源： 347 E-HCC samples at the Sun Yat-sen University Cancer Center (SYSUCC) 295 samples at three independent centers as follows: 191 samples from the First Affiliated Hospital of Sun Yat-sen University 57 samples from Guangzhou Medical University Cancer Center (GZMUCC) 47 samples from the First Affiliated Hospital of Anhui Medical University (AHMUFH). 文章的introduction部分肯定是介绍 E-HCC疾病的重要性，还有甲基化信号的重要性。 当然，也不落俗套的在 The Cancer Genome Atlas (TCGA) database 数据库进行验证。 数据处理 首先，复发与否的66个肿瘤样本数据找差异甲基化位点，得到 a list of 2,550 differential CpGs 然后使用 LASSO algorithm to identify a set of 30 CpGs 接着使用 SVM-RFE algorithm and selected a set of 30 CpGs 两个算法有14个CpG位点的交集，如下图所示： 其中并集是46个，可以看热图如下： 继续使用 penalized Cox regression model ，最后缩小到3个甲基化位点： cg20657849, SCAN domain containing 3 (SCAND3) cg19406367, Src homology 3-domain growth factor receptor-bound 2-like interacting protein 1 (SGIP1) cg19931348 ,peptidase inhibitor 3 (PI3) 算法的效果如下； 同时也根据这3个甲基化位点，构建了风险模型公式：risk score = (0.104 × methylation level of SGIP1) + (−1.125 × methylation level of SCAND3) + (−0.085 × methylation level of PI3). 并且称之为： a methylation-based signature for patients with E-HCC (MSEH) 然后就可以去验证集里面去看看预测效果。 生存分析验证模型效果 在开头我们介绍的数据集里面，作者都使用了生存分析，很显著的发现这3个甲基化位点组成的a methylation-based signature for patients with E-HCC (MSEH) 具有很好的区分效果，如下图： 因为作者验证的数据集已经有3个了，所以在TCGA的验证作者只是放在附件。 In addition, the predictive value of MSEH was validated further in the TCGA data. MSEH successfully discriminated 125 patients with TNM stage I into high-risk and low-risk groups in terms of both RFS and OS (P , .001, P = .043, respectively; Data Supplement). 感兴趣的朋友也可以很容易去下载TCGA的肝癌的甲基化信号矩阵，来根据这3个甲基化位点组成的a methylation-based signature for patients with E-HCC (MSEH) 来进行验证。 ","date":"2020-02-21","objectID":"/bioinfo-q-a-59/:1:0","tags":["AQ100","CpG","HCC"],"title":"【bioinfo】-Q\u0026A-59","uri":"/bioinfo-q-a-59/"},{"categories":["bioinfo","cg"],"content":"多组学探索不同器官的小细胞癌症起源 文章是：Reprogramming normal human epithelial tissues to a common, lethal neuroendocrine cancer lineage 小细胞癌症里面最出名的应该是小细胞肺癌(SCLC)了，恶性度高,预后差,治疗上进展也比较少。小细胞肺癌大约占所有肺癌的15%,每年全国有十几万新发的小细胞肺癌患者,其中绝大多数患者诊断的时候就已经是晚期。所以针对它的研究，就有点类似于乳腺癌里面的TNBC一样。 有趣的是，大部分公众号解读这篇文章的标题都侧重于指出：Science:如何将健康细胞癌化?只需五个基因 一些名词： small cell neuroendocrine carcinoma (SCNC) reprogrammed prostate and lung SCNCs small cell prostate cancer (SCPC) small cell lung cancer (SCLC) euroendocrine prostate cancer (NEPC) poorly differentiated prostate adenocarcinoma (PrAd) large cell prostate carcinoma 很多不同器官的癌症会发展成具有很强侵略性的小细胞癌，也称为小细胞神经内分泌癌（SCNC）来抵制治疗。不同器官的癌症类型是否通过相同途径转变成SCNC细胞还不清楚。肺癌、前列腺癌、膀胱癌和其他组织的小细胞癌在名称上是相似的，但是临床医生通常把它们当作不同的实体来治疗，然而，在过去的几年里，研究者们逐渐开始认识到癌症有相似之处。 关键发现：前列腺和肺细胞在健康时有着非常不同的基因表达模式，但是当它们转化成小细胞癌时，几乎具有相同的模式。研究表明，不同类型的小细胞瘤的演变相似，即使它们来自不同的器官。 3种ngs组学测序数据 通过将带有五个基因的人类前列腺细胞(统称为PARCB)移植到小鼠体内，探索了癌症类型之间的潜在相似之处。当这些细胞在小鼠体内生长时，它们显示出人类小细胞神经内分泌癌的独特特征，基因如下； 不同基因的组合的分组就可以通过NGS手段来探索他们的差异。 GSE118204 包含另外3个GSE数据集，分别是RNA-seq，Whole Exome-seq，ATAC-seq gseinfo GSE118204Reprogramming normal human epithelial tissues to a common, lethal neuroendocrine cancer lineage (ATAC-seq)GSE118205Reprogramming normal human epithelial tissues to a common, lethal neuroendocrine cancer lineage (Whole Exome-seq)GSE118206Reprogramming normal human epithelial tissues to a common, lethal neuroendocrine cancer lineage (RNA-seq)GSE118207PARCB Project: Reprogramming normal human epithelial tissues to a common, lethal neuroendocrine cancer lineage 但是作者的分析结果主要集中于 RNA-seq和ATAC-seq，看了看应该是Whole Exome-seq数据是没有配对正常组织测序结果来辅助寻找somatic的mutation信息。 RNA-seq数据分析结果 转录组的分析流程是： 通过上面的分析流程得到表达量矩阵后，作者最重要的分析点是强调这些不同组别的细胞系的相关性，如下： 携带着PARCB的SCNC细胞（PARCB-SCNC细胞）与来自人体的小细胞前列腺癌（small cell prostate cancer, SCPC）细胞存非常相似,，如下图，SCLC和PARCB聚集在一起。 这些分析都需要比较强的背景知识，还有对公共数据的把控能力。 ATAC-seq数据分析结果 同样也是先看看其数据分析流程： 因为数据都是公布出来的，所以可以比较轻松的下载下来，走一波我的教程：https://www.jianshu.com/p/5bce43a537fd 看看能不能得到同样的分析结果图表。 主要也是根据信号值来进行PCA等看看不同组的相关性如何，如下图： 文章关于ATAC-seq数据独特的分析点不多，就： 联合分析 对于RNA-seq和ATAC-seq数据的联合分析，作者做得并不多，流程描述如下： ","date":"2020-02-21","objectID":"/bioinfo-q-a-58/:1:0","tags":["AQ100","small cell"],"title":"【bioinfo】-Q\u0026A-58","uri":"/bioinfo-q-a-58/"},{"categories":["bioinfo","cg"],"content":"乳腺癌的类器官研究 本研究是乳腺癌领域的第一个类器官研究 A Living Biobank of Breast Cancer Organoids Captures Disease Heterogeneity. 研究者收集了 超过150例乳腺癌患者样品，然后声称其团队成功的制作了超过100个类器官。 From 155 tumors, we established 95 BC organoid lines that readily expanded. 而且NGS数据分析结果表明类器官比较好的保留其配对肿瘤样品的CNV和SNV特征。 分析流程很常规，就是想办法提供organoids的成功率，并且从各个角度来证明： histology whole genome DNA sequencing (WGS) RNA sequencing (RNA-seq) drug testing 全基因组分析 上游分析得到somatic的SNVs流程我在生信技能树多次介绍过，这里作者采取的是其实验室内部数据分析流程，但是大同小异。数据上传到了 EGAS00001002158 需要申请授权才能下载。 数据分析流程详细描述如下： 全基因组测序数据得到的CNV信息，有两个匹配比较好的organoids如下： 事实上这样的展现方式并不好，需要仔细看两个CNV图的相似性，如果仔细看，其实很多地方并不匹配。 其它的配对的类器官就不值一提，所以作者仅仅是挑选部分基因来看organoids及其primary肿瘤的CNV的匹配情况，如下： 即使是作者只挑选部分基因来展示CNV的匹配性，而且作者也声称匹配性很好，可是他并没有给什么统计学指标证明匹配很好。 对SNV也是如此，挑选部分基因秀，如下： 可以肯定的是organoids的SNV不可能百分百与其primary肿瘤的somatic SNV一致，所以作者比较的是突变的总数，以及突变的特征频谱，如下： 从DNA变异情况看organoids不同培养时期的情况 同样，首先是CNV情况： 可以看到是类似的，可以得出结果organoids保留了其肿瘤的分子特性。 然后看SNV的，首先是突变数量和6突变频谱如下： 然后看96突变频谱： 最后作者的结论就是organoids保留了其肿瘤的分子特性，而且培养时间影响不大。 转录组数据分析 首先看作者的转录组数据处理方法： 转录组表达量矩阵的利用率比较低，基本上就看了看相关性，还不如PCA图来的直观，而且也就是跟TCGA的乳腺癌糅合在一起进行聚类，如下； ","date":"2020-02-21","objectID":"/bioinfo-q-a-57/:1:0","tags":["AQ100","organoid"],"title":"【bioinfo】-Q\u0026A-57","uri":"/bioinfo-q-a-57/"},{"categories":["bioinfo","cg"],"content":"多时间点取样转录组数据 时间序列表达矩阵揭示肿瘤转移的动态过程 肝癌很可怕，尤其是转移后，很多关于其转移前后对比的研究，但是缺乏中间过程数据，特别是转移临界点。 作者通过肝癌模型，在不同时间点取样做芯片转录组，试图分析 non-metastatic (or normal) and pre-metastatic (or critical) 这两种状态区别。顺利找到了临界点及其相关调控网络，而且还重点分析了其中一个网络的最重要的节点基因：CALML3 To discover early warning signals of pulmonary metastasis in HCC, we analysed time-series gene expression data in the spontaneous pulmonary metastasis mouse HCCLM3-RFP model with our novel dynamic network biomarker (DNB) method. 构建了 xenograft HCCLM3-RFP mice ， 20只小鼠分成4组，即4个时间点(W2, W3, W4, W5)取样。 找差异基因 使用的是传统的T检验，对任意两组的组合找差异，最后合并成13,247 个差异基因列表，并且绘制热图如下： 时间序列基因集 使用的是R包Mfuzz把差异分析得到的13,247 个统计学显著差异基因根据表达模式分成了6组，如下： 这6组基因集特性是： Genes in Clusters 1 and 2 were continuously and monotonically downregulated and upregulated from the second to fourth weeks after orthotropic implantation, respectively. Genes in Clusters 3 and 4 were significantly downregulated and upregulated only during the second and third weeks, respectively, whereas genes in Clusters 5 and 6 were significantly downregulated and upregulated only during the third and fourth weeks, respectively. 所以作者合理的得出第3周这个时间点是肿瘤转移的关键时刻。 而且顺理成章的可以对这些基因集做各种数据库的功能富集分析 临界点理论 关于 dynamical network biomarkers 同样的一个方法， dynamical network biomarkers ，使用了十几次 ，都是在探索各种生命活动的临界值。 而且只需要表达矩阵，性价比很高 ","date":"2020-02-21","objectID":"/bioinfo-q-a-56/:1:0","tags":["AQ100","sc"],"title":"【bioinfo】-Q\u0026A-56","uri":"/bioinfo-q-a-56/"},{"categories":["bioinfo","cg"],"content":"pan-cancer 泛癌研究之拷贝数变异 发表于 September 2013 Pan-cancer patterns of somatic copy number alteration 对拷贝数的分类整理 We identified a total of 202,244 SCNAs, a median of 39 per cancer sample, comprising 6 categories: focal SCNAs that were shorter than the chromosome arm (median of 11 amplifications and 12 deletions per sample); arm-level SCNAs that were chromosome-arm length or longer (median of 3 amplifications and 5 deletions per sample); copy-neutral loss-of-heterozygosity (LOH) events in which one allele was deleted and the other was amplified coextensively (median of 1 per sample); whole-genome duplications (WGDs; in 37% of cancers). By amplifications and deletions, we refer to copy number gains and losses, respectively, of any length and amplitude. 使用 ABSOLUTE分析肿瘤纯度 统计学显著的拷贝数区域 把经过肿瘤纯度矫正后的拷贝数情况输入到GISTIC软件，参数包括:- a noise threshold of 0.3, a broad length cutoff of 0.5 chromosome arms, a confidence level of 95% and a copy-ratio cap of 1.5. 泛癌研究之使用MutSigCV看肿瘤突变异质性 Mutational heterogeneity in cancer and the search for new cancer-associated genes 作者团队主要是开发了一款算法软件：MutSigCV We apply MutSigCV to exome sequences from 3,083 tumour–normal pairs and discover extraordinary variation in mutation frequency and spectrum within cancer types, which sheds light on mutational processes and disease aetiology, and in mutation frequency across the genome, which is strongly correlated with DNA replication timing and also with transcriptional activity. 泛癌研究之肿瘤驱动突变 Comprehensive identification of mutational cancer driver genes across 12 tumor types 作者提供数据分析得到 291个高置信度的肿瘤驱动突变基因 acting on 3,205 tumors from 12 different cancer types. 其实主要是测试4种软件： MuSiC OncodriveFM OncodriveCLUST[ ActiveDriver 泛癌研究之肿瘤突变全景 Mutational landscape and significance across 12 major cancer types ","date":"2020-02-21","objectID":"/bioinfo-q-a-55/:1:0","tags":["AQ100","pan-cancer"],"title":"【bioinfo】-Q\u0026A-55","uri":"/bioinfo-q-a-55/"},{"categories":["bioinfo","cg"],"content":"探索FGFR3-TACC3基因融合机制 FGFR3-TACC3基因融合机制探究 A metabolic function of FGFR3-TACC3gene fusions in cancer, 美国哥伦比亚大学医学中心（CUMC）的研究人员发现两个相邻基因的融合能够导致线粒体过度运转和增加细胞疯狂生长所需的燃料数量，从而导致癌症产生。他们也发现在人癌细胞和一种脑癌类型的小鼠模型中，靶向这个新鉴定出的癌症通路的药物能够阻止肿瘤生长。 全文的重点应该是实验探索及验证FGFR3-TACC3基因融合机制。 FGFR3-TACC3基因融合事件 作者在以前的GBM研究（2012年发表在Science期刊上的一项研究）中就发现了约有3%的FGFR3-TACC3基因融合现象，而且同时期很多其它癌症也发现了同样的融合事件。虽然FGFR3-TACC3基因融合表现出原癌基因的特性，会影响FGFR抑制剂的效果，但是它的下游调控机制研究的并不清楚。 题外话：有趣的是我分析了一个台湾人的OSCC cohort的转录组数据，也发现了这个FGFR3-TACC3基因融合现象。 论文共同通信作者、CUMC癌症遗传学研究所神经病学教授、病理学与细胞生物学教授Antonio Iavarone博士说，“**这可能是人类癌症中唯一最为常见的基因融合。**我们想要确定FGFR3-TACC3融合如何诱导和维持癌症，这样我们就可能鉴定出药物治疗的新靶标。” 线粒体活性 长期以来，人们已在癌症中观察到线粒体变化，但是仅在近期才发现线粒体活性和细胞代谢与某些癌症存在关联。然而，基因突变改变线粒体活性和促进肿瘤生长的机制是未知的。 在当前的这项研究中，这些研究人员比较了携带着FGFR3-TACC3和未携带着FGFR3-TACC3的癌细胞中的上千个基因的活性。他们发现这种融合极大地增加线粒体的数量和增加它们的活性。鉴于癌细胞需要大量的能量才能快速地分裂和生长，当线粒体的活性增加时，这些癌细胞就能够茁壮生长。 通过采用多种实验技术，这些研究人员确定这种基因融合启动了一系列增强线粒体活性的事件。 首先，FGFR3-TACC3激活一种被称作PIN4的蛋白。一旦遭受激活，PIN4迁移到过氧化物酶体中。 作为一种细胞器，过氧化物酶体将脂肪降解为增加线粒体活性的物质。受到激活的PIN4触发产生的过氧化物酶体数量增加了4～5倍，从而释放大量的氧化剂。 最后，这些氧化剂诱导PGC1α产生。作为线粒体代谢的一种关键的调控物，PGC1α增加线粒体的活性和能量产生。 说明了mitochondrial respiration可以作为有FGFR3-TACC3基因融合发生的那部分癌症患者的治疗靶点。 表达芯片数据分析 作者通过实验手段构造了含有FGFR3-TACC3融合基因的astrocyte细胞系，看它们经过了FGFR tyrosine kinase (TK, PD173074) or vehicle处理后的基因表达区别，还有一个比较特殊的组是 kinase-dead F3–T3 (F3–T3(K508M)) ，这个虽然FGFR3-TACC3也融合，但是有一个突变位点，导致其表达的产物是不具备激酶活性的。 分组如下： F3T3_1 FGFR3-TACC3 treated with vehicle F3T3_2 FGFR3-TACC3 treated with vehicle F3T3_3 FGFR3-TACC3 treated with vehicle F3T3_4 FGFR3-TACC3 treated with vehicle F3T3_5 FGFR3-TACC3 treated with vehicle F3T3_KD_1 Empty vector treated with vehicle F3T3_KD_2 Empty vector treated with vehicle F3T3_KD_3 Empty vector treated with vehicle F3T3_PD_1 FGFR3-TACC3 treated with the FGFR inhibitor PD173074 for 12h F3T3_PD_2 FGFR3-TACC3 treated with the FGFR inhibitor PD173074 for 12h F3T3_PD_3 FGFR3-TACC3 treated with the FGFR inhibitor PD173074 for 12h F3T3_PD_4 FGFR3-TACC3 treated with the FGFR inhibitor PD173074 for 12h F3T3_PD_5 FGFR3-TACC3 treated with the FGFR inhibitor PD173074 for 12h VECTOR_1 FGFR3-TACC3-K508M treated with vehicle VECTOR_2 FGFR3-TACC3-K508M treated with vehicle VECTOR_3 FGFR3-TACC3-K508M treated with vehicle 表达芯片数据可以下载，E-MTAB-6037 ， 用的是 Illumina HumanHT-12 V4.0 expression beadchip 既然有4个组，那么就可以按照自己的想法来两两组合的比较，找差异，看变化，注释，讲生物学故事。 差异热图如下： 化合物PD173074是辉瑞公司研发的一个化合物.现在,已知它是FGFR1的强抑制剂. 比较了FGFR3-TACC3基因融合细胞系被药物处理前后的全局基因表达变化，发现它们GO富集分析主要集中在： mitotic activity, oxidative phosphorylation and mitochondrial biogenesis 。 TCGA公共数据分析 从TCGA里面下载了GBM的表达数据，进行了Mann–Whitney–Wilcoxon (MWW) test statistics (ee-MWW) 分析，因为534例GBM患者里面只有9例样本是有FGFR3-TACC3基因融合现象的，然后作者也纳入了仅有的10例正常脑部组织，对差异基因做热图并且GO注释如下： 其中，上图中有FGFR3-TACC3基因融合的9个样本标记为红色。 同时也分析了TCGA数据库的其它癌症的FGFR3-TACC3基因融合样本与其它样本的区别，同样是ee-MWW分析方法。都发现了F3–T3 fusion gene correlated with mitochondrial activities 然后又用了 regularized gradient boosting machine 算法来检测FGFR3-TACC3基因融合造成的基因表达变化模式相关的转录因子，发现跟 PPARGC1A and ESRRG 类似。 而且有FGFR3-TACC3基因融合现象的样本里面的 PPARGC1A and ESRRG 表达量的确增高了。 补充材料里面还利用了TCGA数据，绘制其它图。 MWW富集分析方法 Mann-Whitney-Wilcoxon秩和检验 Wilcoxon-Matt-Whitney test (or Wilcoxon rank sum test, orMann-Whitney U-test) 用于比较两个并不满足正态分布群组的均值比较：这是一个非参数检验（non-parametrical test）。其与应用于独立样本的t-test相当。 代码公开： A collection of the R procedures to perform ee-MWW is available at http://github.com/miccec/yaGST. The RGBM package is available from CRAN at https://cran.r-project.org/web/packages/RGBM/index.html. 衍生阅读-FGFR-TACC融合基因 《Science》在2009年首次报道胶质瘤中存在FGFR-TACC融合基因，该融合基因过度表达的GBM具有高度侵袭性。因此，FGFR-TACC可能确立一种新的GBM亚型，或成为潜在的治疗靶点。法国巴黎Sorbonne大学总医院Anna Luisa Di Stefano等在2019年1月《Clin Cancer Res》上发表对FGFR3-TACC3融合基因在IDH野生型胶质瘤中的表达特点及作用的研究结果。 该项研究收集795例胶质瘤患者标本，包括584例GBM，85例II-III级IDH野生型胶质瘤，126例II-III级IDH突变型胶质瘤，开展FGFR3-TACC3融合基因检测。85例II-III级IDH野生型胶质瘤中，3例存在FGFR3-TACC3融合基因，而在II-III级IDH突变的胶质瘤中均未检测出该融合基因。在584例GBM中，17例存在FGFR3-TACC3融合基因 ","date":"2020-02-21","objectID":"/bioinfo-q-a-54/:1:0","tags":["AQ100","gene fusion"],"title":"【bioinfo】-Q\u0026A-54","uri":"/bioinfo-q-a-54/"},{"categories":["bioinfo","cg"],"content":"多靶点自体免疫细胞技术 过继性T细胞治疗(adoptive T-cell therapy,ACT) 文章是 Immune recognition of somatic mutations leading to complete durable regression in metastatic breast cancer 发表于 Nature Medicine (2018) 重点在实验设计环节，但是现在的大文章或多或少都引入多组学数据，本文也不例外，实验纳入的唯一一个病人既做了全外显子又做了转录组测序，还有单细胞测序。不过数据公开的是 PRJNA342632 for exome data and PRJNA243084 for RNA-seq data 背景知识 肿瘤免疫疗法 近年来，肿瘤免疫疗法已成为继手术、放疗和化疗之后的第四种肿瘤治疗手段。 肿瘤免疫治疗，主要包括 免疫疫苗 免疫检查点抑制剂治疗 过继性免疫细胞治疗 细胞因子治疗 其中以CTLA4、PD1/PDL1抑制剂为代表的免疫检查点抑制剂，以其显著的临床疗效而备受瞩目。 而本文的研究属于肿瘤免疫治疗的过继性T细胞疗法（ACT）领域，之前以CART为主，最近出现了另外一种疗法——TIL（Tumor Infiltrating T cell，肿瘤浸润淋巴细胞），表现也十分惊艳，Rosenburg博士及其团队就是这一领域的代表。 肿瘤浸润淋巴细胞(TILs) 肿瘤浸润性淋巴细胞（tumor infiltrating lymphocyte, TIL）指的是从肿瘤组织中分离出的浸润淋巴细胞。 1986年，Rosenberg研究组首先报道了TIL细胞。TIL细胞表型具有异质性。一般来说，在TIL中，绝大多数细胞是CD3阳性的。在不同肿瘤来源的TIL细胞中，CD4+ T细胞、CD8+ T细胞的比例有差异，但大多数情况下以CD8+T细胞为主。 不同患者不同肿瘤类型对免疫疗法的反应不可预测，是因为免疫成分的异质性以及肿瘤浸润淋巴细胞（TILs）在单个肿瘤内和患者之间的多样化表型。 并不是所有的肿瘤浸润T细胞都是针对肿瘤抗原的，并且发现检测CD39的表达可以简单的量化或分离Bystander 即“旁观者”T细胞。 技术历史 早在2014年的时候Rosenburg博士的团队就将其一部分研究结果发表在Science期刊（Tran E et al, Science 2014）上，当时他们的做法是：把一名晚期胆管癌女患者的肺转移肿瘤病灶拿来做全基外显子测序，找到了26个非同义突变，并为每一个突变构建了一段短基因，将这些短基因几个一组地串联成短基因串（Tandem Minigene, TMG），然后将这些短基因串转入抗原递呈细胞（指树突状细胞DC）并与肿瘤浸润淋巴细胞（TIL）共同培养，以查看患者的TIL中是否存在可以特异性识别肿瘤突变的T细胞。不出所料，这位患者的TIL可以识别肿瘤的一个突变。研究者将这个有识别功能的T细胞体外大量扩增后再回输给患者，患者肝部的转移灶长期稳定状态达1年以上。Rosenburg博士的团队通过这个研究，证明了晚期癌症患者的肿瘤组织中确实是存在可以对抗肿瘤突变的淋巴细胞的、即便是在晚期胆管癌这样凶险又难治的瘤种。 但是从实体瘤中收集浸润性T细胞确实比较有挑战性，而与之相比，抽取患者的外周血则容易得多，所以2016年Steve Rosenberg小组发表在《自然-医药》杂志上的文章《Prospective identification of neoantigen-specific lymphocytes in the peripheral blood of melanoma patients》即是从晚期恶性黑色素瘤患者的外周免疫细胞中可根据PD-1受体表达找到针对肿瘤变异新抗原的活性杀伤T细胞。这样找到的T细胞在体外增殖后和肿瘤浸润淋巴细胞（TIL）一样可以识别患者自身肿瘤。 但是恶性黑色素瘤是一种突变比较多的肿瘤，尽管外周血抗肿瘤细胞比例低，但是仍然能够分离出来；而其他突变较少的肿瘤在外周血中是否同样存在这样的T细胞就存疑了。 多组学测序 虽然作者本文只探索了一个病人，但是它上传了很多数据在，对这个病人测了： FrTu (118×) OCT (120×) normal blood (116×) 也是常规的肿瘤外显子数据分析流程，其实就是GATK best-practices 流程加上 varscan2，再使用 ‘allele-specific copy-number analysis of tumors’ (ASCAT) 和Sequenza 来分析肿瘤纯度和倍性，然后得到的somatic 变异过滤如下： tumor and normal read counts of 6 or greater, variant-allele frequency (VAF) ≥ 5% tumor-variant reads ≥ 3 其RNA-seq测序也是走的STAR比对加上GATK best-practices 流程来找变异。 最后使用 PyClone 进行克隆进化分析。 somatic变异 这里过滤后剩下 62 nonsynonymous somatic 变异位点 TIL识别的两个基因突变 通过与前面文章类似的方法，构建TMG来挑选病人那些可以特异性识别这些突变的TIL细胞。本次使用使用了pulsed peptide pools (PPs 1–6) or transfected mRNAs (tandem minigenes (TMGs) 1–6) 得到的结果如图： The reactive F13 TIL recognized mutant ECM29 proteasome adaptor and scaffold (ECPAS; also known as KIAA0368) Individual peptide screens of the TIL fragments showed F8 and F12 recognized the solute carrier family 3 member 2 (SLC3A2) protein 单细胞测序识别两个基因突变 挑选那些高表达T cell receptor (TCR)-β variable (TRBV) region or high expression levels of 4-1BB (CD137, a marker of T cell activation)的T细胞做单细胞测序，找到了跟mutant (mut)-SLC3A2 or mutKIAA0368对接的TRBV 然后TIL回输之后， FACS-sorted TRBV28+ cells showed specific recognition of PP6 and TMG6，如下图 又对应到了两个突变： calcium-dependent secretion activator 2 (CADPS2; p.Arg1266His) cathepsin B (CTSB; p.Asp159His) 整个实验比较幸运，对这个病人来说，发现了 11 TCR clonotypes recognized the four neoantigens (SLC3A2, KIAA0368, CADPS2 and CTSB) ","date":"2020-02-21","objectID":"/bioinfo-q-a-53/:1:0","tags":["AQ100","ACT"],"title":"【bioinfo】-Q\u0026A-53","uri":"/bioinfo-q-a-53/"},{"categories":["bioinfo","cg"],"content":"PDAC-organoids ","date":"2020-02-21","objectID":"/bioinfo-q-a-52/:1:0","tags":["AQ100","PDAC","sc"],"title":"【bioinfo】-Q\u0026A-52","uri":"/bioinfo-q-a-52/"},{"categories":["bioinfo","cg"],"content":"胰腺癌的类器官可以辅佐治疗决策 ","date":"2020-02-21","objectID":"/bioinfo-q-a-52/:1:1","tags":["AQ100","PDAC","sc"],"title":"【bioinfo】-Q\u0026A-52","uri":"/bioinfo-q-a-52/"},{"categories":["bioinfo","cg"],"content":"PDAC背景知识 胰腺癌生长快而且转移率高，是一种非常致命的恶性疾病。2016年美国癌症协会的数据显示，胰腺癌患者的5年生存率在7-8%之间。虽然手术可以根治这种疾病，但胰腺癌在确诊时只有10–20%是可切除的，其它患者只能接受化疗。 2月8日在Nature Communications上发表的GWAS研究纳入了21,536人，发现位于人类染色体1（位置1p36.33）、7（位置7p12）、8（位置8q21.11）、17（位置17q12）和18（位置18q21.32）上的新鉴定的遗传变异可增加胰腺癌风险。这些基因组中每个拷贝的存在都会增加胰腺癌风险15％-25％。 关于胰腺癌发生的缘起假说目前主要集中在两个学说，一个是最早由肿瘤遗传学传奇人物Alfred G Knudson提出的肿瘤的“二次打击学说”，其后由诸多胰腺癌研究领域的科学家完善并确定提出的“Kras-CDKN2A-P53-SMAD4”成次序改变和逐步积累的描述胰腺肿瘤由PanINs发展至PDAC的学说体系。自此，古老的基于病理形态的学科体系与新型的基于基因分子生物分型的学科体系变得不再各自孤立：近20年间的系列研究在胰腺癌中比较有代表性地强调了胰腺癌病理形态改变和分子生物学改变的平行相关性。而2017年的一项来自dana farber和哈弗医学院的最新研究更是在356例胰腺癌样本中较为全面和完整地的探索四个关键驱动基因改变与胰腺癌预后的相关性（四大驱动基因中，KRAS和CDKN2A与临床预后紧密相关；与此同时，驱动基因的突变个数越多，预后越差） TCGA数据分析PDAC分成两个大类： The Basal-like, Squamous or Quasi-mesenchymal, subtype identifies PDAC patients with poor prognosis and is characterized by basal markers such as cytokeratins. The Classical or Pancreatic Progenitor subtype is characterized by differentiated ductal markers and identifies patients with a better prognosis. ","date":"2020-02-21","objectID":"/bioinfo-q-a-52/:1:2","tags":["AQ100","PDAC","sc"],"title":"【bioinfo】-Q\u0026A-52","uri":"/bioinfo-q-a-52/"},{"categories":["bioinfo","cg"],"content":"实验设计 本研究是从PDAC病人的肿瘤部分取样做3D培养： 总共是138个病人，里面取了 159个样品，包括 primary tumors (hT) metastases (hM) 78 个样本是specimens were isolated from surgical resections 60 个样本是fine needle biopsies of primary or metastatic lesions (hF) 20个样本是 metastatic disease following rapid autopsies 1个样本是a video-assisted thoracoscopic surgical (VATS) resection of a lung metastasis. WGS数据部分 作者在这里对13个病人的原始肿瘤样品以及培养好的organoids样品配对测了WGS数据，主要是看somatic mutation的overlap情况，如下： 可以看到的是大部分病人的overlap情况非常棒，说明了 organoids可以比较完美的保留其来源的primary tumor的突变等肿瘤特征，虽然有两个overlap情况很差，但是作者找到了原因，是因为其primary tumor样品的肿瘤纯度太低了。 WES数据部分 总共有66个PDAC的PDO都做了WES测序，但是作者没有公布测序数据也没有写清楚数据量，只是给了CNV分析结果 其中有两个PDO仍然是比较明显的2倍体，并不是癌症通常表现着的非整倍体。就是上图中的hT83和hF43，值得一提的是hF43的indel频率异常, 超出平均值的8倍. 如果只看一些PADC相关的重要的基因的拷贝数变化，如图 当然了，肿瘤外显子数据必不可少的的突变全景图如下： RNA-seq数据部分 RNA sequencing was performed on 44 PDAC-confirmed PDOs and 11 hN organoid cultures. 同样的，原始数据已经测序描述信息都没有，根据表达情况进行PCA可以比较明显的区分不同的PDO，如下： 表达矩阵最重要就是分类咯，首先看TCGA的那两个大类的marker基因的分类，如下； 很清晰的分出来两类，然后看看NMF算法分类： 而且可以看到这两个分类虽然定义的基因集不一样，但是分类的overlap情况非常棒！！！ 有了分类， 就可以找差异基因，定位到通路哦，GSEA或者富集分析均可： 作者还放了使用NMF进行聚类的细节问题，如下图： 所以作者最后选取了2个分类作为最优分类. ","date":"2020-02-21","objectID":"/bioinfo-q-a-52/:1:3","tags":["AQ100","PDAC","sc"],"title":"【bioinfo】-Q\u0026A-52","uri":"/bioinfo-q-a-52/"},{"categories":["bioinfo","cg"],"content":"探索EMT的中间态 文章是：Identification of the tumour transition states occurring during EMT. Nature ; PMID: 29670281 整个文章基于两种老鼠模型： a genetic mouse model of skin squamous cell carcinoma (SCC) K8CreER/Pic3caH1047R/p53fl/fl and MMTV-PyMT breast tumours ","date":"2020-02-21","objectID":"/bioinfo-q-a-51/:1:0","tags":["AQ100","EMT"],"title":"【bioinfo】-Q\u0026A-51","uri":"/bioinfo-q-a-51/"},{"categories":["bioinfo","cg"],"content":"摘要 在癌症中，上皮-间充质转化（EMT）与肿瘤干细胞的转移和对治疗的抗性有关。最近有人提出，EMT不是一个二元的过程，而是通过不同的中间状态发生。然而这个设想没有直接的体内证据。本次研究中，我们在皮肤和乳腺原发肿瘤中筛选出大量的细胞表面标志物，并鉴定出不同EMT阶段相关的多个肿瘤亚群的存在：从完全上皮化到完全间充质细胞状态以及中间混合状态。虽然所有的EMT亚群呈现相似的肿瘤增殖细胞能力，但它们在细胞可塑性、侵袭性及转移潜能等方面均表现出差异。他们的转录和表观遗传表现识别潜在的基因调控网络、转录因子和信号通路，控制不同的EMT过渡状态。最后，这些肿瘤亚群分布在不同的位置，对EMT过渡状态有不同的调节作用。 ","date":"2020-02-21","objectID":"/bioinfo-q-a-51/:1:1","tags":["AQ100","EMT"],"title":"【bioinfo】-Q\u0026A-51","uri":"/bioinfo-q-a-51/"},{"categories":["bioinfo","cg"],"content":"EMT 背景知识 EMT，全称epithelial–mesenchymal transition，又称翻译为上皮间质转换，指的是上皮细胞在一些因素的作用下,失去极性及细胞间紧密连接和黏附连接, 获得了浸润性和游走迁移能力, 变成具备间质细胞形态和特性的细胞的改变。这种行为是可逆的。 EMT的概念最早是1982年由Green-berg和Hay提出。然而，长久以来，科学界对于EMT在肿瘤转移过程中的作用一直存在争议，主要是因为无法在体内观察EMT过程 。 胚胎发育与癌症发展中的细胞可塑性变化有着惊人的相似性，而这种可塑性变化受到上皮间质转化epithelial-mesenchymal transition （EMT）过程的调节。胚胎发育时期，上皮状态和间充质状态的细胞能够自由转化。 上皮间质转化（EMT）使得细胞具备转移和浸润特性。 其反向过程，间质上皮转化mesenchymal-epithelialtransition （MET）赋予了细胞极性变化并失去移动能力。 EMT会促发癌细胞从病灶分离，转移到其它部位，而MET导致癌细胞停留，并在停留处引起新的肿瘤。 在很长一段时间内，许多科学家都认为EMT过程对于肿瘤转移是一个必须条件，EMT过程能够剥夺细胞与邻近细胞紧密结合的能力，使细胞能够在全身范围内迁移。科学家们认为是EMT给了癌细胞“双腿”让它们能够脱离原位肿瘤，转移到其他部位形成肿瘤转移灶。 一、 首先介绍下，EMT发生常见的标志分子。 1.表达减少：E- cadherin，Cytokeratin，ZO-1。 2.表达增多：N- cadherin，Vinmentin，Snail1，Snail2，Twi st，MMP-2，MMP-3，MMP-9。 3.活性增加：ILK，Rho。 二．参与EMT过程控制的常见信号通路有： 1.TGF-β信号通路。 2.Wnt信号通路。 3.Notch信号通路。 4.SMAD信号通路。 5.PI3K-AKT-MTOR信号通路。 三. EMT过程有着复杂的调节网络： 表观遗传的调节 转录调节 选择性剪接 蛋白质的稳定 亚细胞定位 这些调节方式多样性使得EMT的调节往往不是线性的。此前，EMT调节过程中关于E-cadherin的转录，EMT转录因子SNAI1，SNAI2， ZEB1，ZEB1和 TWIST1等研究较多。 ","date":"2020-02-21","objectID":"/bioinfo-q-a-51/:1:2","tags":["AQ100","EMT"],"title":"【bioinfo】-Q\u0026A-51","uri":"/bioinfo-q-a-51/"},{"categories":["bioinfo","cg"],"content":"上皮细胞黏附分子（EpCAM） 与普通血细胞相比,CTCs具有某些特殊的生物标志物,包括CTCs表面的上皮细胞粘附分子(Epithelial cell adhesion molecule,EpCAM) 不同文献报道不一致： 在咽癌中Ep-CAM高表达与淋巴结转移密切相关，Ep-CAM表达越高，淋巴结转移发生频率越高 在头颈部鳞状细胞癌中，Ep-CAM在转移灶中表达比原发灶更高 在胃癌骨髓转移灶中的播散性肿瘤细胞Ep-CAM的表达较原发灶降低 免疫组织化学中的细胞角蛋白(Cytokeratin, CK) : ","date":"2020-02-21","objectID":"/bioinfo-q-a-51/:1:3","tags":["AQ100","EMT"],"title":"【bioinfo】-Q\u0026A-51","uri":"/bioinfo-q-a-51/"},{"categories":["bioinfo","cg"],"content":"存在不同的EMT中间态 2017年的CELL文章做了scRNA-seq of human SCCs，Single-Cell Transcriptomic Analysis of Primary and Metastatic Tumor Ecosystems in Head and Neck Cancer 发现了EMT的过渡状态： 数据下载 单细胞针对的是 scRNAseq of YFP+ Epcam+ and Epcam- skin squamous cell carcinoma cells使用的是 SMART-seq建库方法，384孔板，共383个单细胞数据。 GSE110587 (RNA-seq and ATAC-seq) GSE110357 (scRNA-seq) 其实bulk测序包括： GSE110584Identification of the tumour transition states occurring during EMT [ATAC-seq]GSE110585Identification of the tumour transition states occurring during EMT [RNA-seq]GSE110586Identification of the tumour transition states occurring during EMT [p63 overexpression RNA-seq] 作者在GEO里面同时上传了自己分析好的表达矩阵，所以可以下载表达矩阵模仿一下作者的下游分析，比如如何找marker及分类。 单细胞把marker重新分类 PCA分析可以看到第一主成分就是用来区分E和M的，解释度高达 21%，而构成这些解释的基因可以可视化看它们的贡献度。 把EMT相关基因可以分成3个状态 Epithelial, hybrid and mesenchymal ： pure epithelial genes Esrp1 and Ovol1 hybrid epithelial genes Krt5 and Trp63 hybrid mesenchymal genes Prrx1, Snai1, Zeb1, Zeb2, Pdgfra and Col3a1 pure mesenchymal genes Aspn and Mmp19 单细胞转录组聚类结果 这5个cluster非常重要，是全文的重点， 实验摸索EMT过程的5个形态 癌症基础知识背景不强，这些实验没有看懂，大概应该是有着不同CD分子marker的那些细胞群体表现很不一样吧。 默认知识点： epithelial YFP+Epcam+ and mesenchymal-like YFP+Epcam− tumour cells (TCs)8 CD61 (also known as Itgb3) CD51 (also known as Itgav) CD106 (also known as Vcam1) 使用ATAC-seq数据来探索不同EMT中间态 Transcription factor motifs enriched in the ATAC-seq peaks that were upregulated between the indicated subpopulations as determined by Homer analysis using known or de novo motif search (asterisk) or using JASPAR motif matrix (hash symbol). Transcription factor motifs enriched in the ATAC-seq peaks that were upregulated between the indicated tumour subpopulations as determined by Homer analysis using known or de novo motif search (asterisk). Green, core transcription factors; pink, epithelial transcription factors; yellow, mesenchymal transcription factors. c–j, Analysis based on ATAC-seq results from different subpopulations derived from one tumour. ","date":"2020-02-21","objectID":"/bioinfo-q-a-51/:1:4","tags":["AQ100","EMT"],"title":"【bioinfo】-Q\u0026A-51","uri":"/bioinfo-q-a-51/"},{"categories":["bioinfo","cg"],"content":"单细胞转录组探索CRC病人的一致性 Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors. Nat Genet 2017 May;49(5):708-718. PMID: 28319088 单细胞转录组，使用的是GPL11154Illumina HiSeq 2000 (Homo sapiens) ，数据都上传到了：GSE81861 ；BioProject：PRJNA323703；SRA：ERP016958 既有病人的单细胞转录组数据，同时也有细胞系的数据做验证。 1,591 single cells from 11 colorectal cancer patients，包括 969肿瘤部位细胞以及 622 癌旁细胞。严格过滤后只剩下：375 tumor cells and 215 normal mucosa cells -630 single cells from 7 cell lines，过滤后剩下561个 83 A549 cells, 65 H1437 cells, 55 HCT116 cells, 23 IMR90 cells, 96 K562 cells, 134 GM12878 cells (38 from batch 1, 96 from batch 2) 174 H1 cells (96 from batch 1, 78 from batch 2). 上游测序数据没有必要重新下载分析了，可以直接使用作者上传的表达矩阵： Supplementary fileSizeDownloadFile type/resourceGSE81861_CRC_NM_all_cells_COUNT.csv.gz3.2 Mb(ftp)(http)CSVGSE81861_CRC_NM_all_cells_FPKM.csv.gz4.7 Mb(ftp)(http)CSVGSE81861_CRC_NM_epithelial_cells_COUNT.csv.gz2.5 Mb(ftp)(http)CSVGSE81861_CRC_NM_epithelial_cells_FPKM.csv.gz4.0 Mb(ftp)(http)CSVGSE81861_CRC_tumor_all_cells_COUNT.csv.gz4.3 Mb(ftp)(http)CSVGSE81861_CRC_tumor_all_cells_FPKM.csv.gz7.9 Mb(ftp)(http)CSVGSE81861_CRC_tumor_epithelial_cells_COUNT.csv.gz3.6 Mb(ftp)(http)CSVGSE81861_CRC_tumor_epithelial_cells_FPKM.csv.gz6.5 Mb(ftp)(http)CSVGSE81861_Cell_Line_COUNT.csv.gz13.1 Mb(ftp)(http)CSVGSE81861_Cell_Line_FPKM.csv.gz28.9 Mb(ftp)(http)CSVGSE81861_GEO_EGA_ID_match.csv.gz14.4 Kb(ftp)(http)CSV 作者认为全文最重要的是开发了一个挖掘细胞类型的算法：reference component analysis (RCA) 优于其它现有的算法。可以把cancer-associated fibroblasts (CAFs)继续分成两个类别。对比的算法包括： hierarchical clustering using all expressed genes (All-HC) hierarchical clustering using principal-component analysis (PCA)-based feature selection (HiLoadG-HC) BackSPIN RaceID2 Seurat three additional methods based on selection of genes with highly variable expression (VarG-HC, VarG-PCAproj-HC and VarG-tSNEproj-HC). 使用 adjusted Rand index (ARI) 指标来评价各个聚类算法的优劣。结果发现自己开发的RCA表现超常！！！ 背景知识 肿瘤异质性很重要，单细胞转录组测序很厉害，以前的研究根据单细胞转录组表达矩阵进行分类的算法不够好，所以他们开发reference component analysis (RCA) ， 而且 Colorectal cancer (CRC) 疾病非常严重，需要探索。 根据细胞系单细胞表达数据探索算法 630个细胞的表达数据，过滤后剩下561个，这里使用Fragments per kilobase per million reads (FPKM)来进行表达定量。因为其上游处理走的是TOPHAT2+CUFFLINKS流程。 单细胞过滤策略 rate of exonic reads (ROER) 需要大于5% number of detected genes (NODG) 需要大于1000， 基因的FPKM ≥1才能算被检测到了。 Exonic reads (ER) 要大于0.1Million 管家基因: TFRC, ACTB, RPLP0, PGK1, GAPDH, LDHA, NONO, B2M, GUSB and PPIH. RCA算法细节 首先从 BioGPS数据库里面下载两个数据集： HumanU133A/GNF1H Gene Atlas and the Primary Cell Atlas ，从中挑选 A total of 4,717 genes were selected as features for GNF1H and 5,209 genes were selected for the Primary Cell Atlas. 还使用了 WGCNA 算法。 还使用了一些其它公共数据：TCGA, GSE14333, the PRECOG database, and GSE33113, GSE37892 and GSE39582 来验证单细胞转录组得到的基因集（The ‘fibroblast-like’ signature ）是否能显著的区分CRC病人的生存情况。 需要了解一些细胞类型的 known markers epithelial cells (VIL1, KRT20, CLDN7, CDH1) endothelial cells (Endo; ENG) fibroblasts (Fibro; SPARC, COL14A, COL3A1, DCN) B cells (CD38, MZB1, DERL3) T cells (TRBC2, CD3D, CD3E, CD3G) myeloid cells (ITGAX, CD68, CD14, CCL3) mast cells (KIT, TPSB2) 做成了一个R包供使用：RCA R package, https://github.com/GIS-SP-Group/RCA. ","date":"2020-02-20","objectID":"/bioinfo-q-a-50/:1:0","tags":["AQ100","CRC","sc"],"title":"【bioinfo】-Q\u0026A-50","uri":"/bioinfo-q-a-50/"},{"categories":["bioinfo","cg"],"content":"在KRAS-TRP53基因驱动的LADC Ect2-Dependent rRNA Synthesis Is Required for KRAS-TRP53-Driven Lung Adenocarcinoma , 里面太多陌生的名词，如下： nucleolar transcription factor upstream binding factor 1 (UBF1) guanine nucleotide exchange factor (GEF) epithelial cell transforming sequence 2 (Ect2) - oncogene rRNA synthesis rDNA promoters lung adenocarcinoma (LADC) KRAS-TRP53-Driven Lung Adenocarcinoma CD24+/ITGB4+/NOTCH3hi (3+) lung epithelial cells Madin-Darby canine kidney (MDCK) epithelial cells Lentiviral short hairpin RNA (shRNA)-mediated knockdown (KD) mouse-specific Ect2 shRNAs cytoplasmic Rho GTPases Ect2 nuclear localization signal [NLS] H358 and H23 cells anti-rheumatoid agent auranofin (ANF) 太多了，我都懒得继续看了。 不过，这样的大文章已经不可避免的利用公共数据了，比如TCGA。对我来说，这反而是非常简单的了，我就来试着解读一下。 前面的4张figures都是实验环节，只有第5张比较合我心意。 TCGA表达量看共表达情况 Co-occurrence analysis of the TCGA LADC dataset (n = 517) for expression of ribosomal processing genes and Rho family GEFs. Significant co-occurrences shown in red and exclusivity in blue. TCGA查询某两个基因的表达相关性 这里作者并没有选取全部的LADC数据，而是选取其中的有KRAS基因突变的样本，所以需要同步下载WES数据的MAF文件，查询突变的那19个样本ID，再去表达矩阵里面查询并且作图。 对共表达结果热图进行统计 这个很简单，就是数一数上面的热图，对每个基因统计一下有多少个显著的 ribosomal processing genes 。 统计结果再过滤 只留下KRAS基因突变的样本，后再进行统计分析。 生存分析 这个有很多在线工具可以做了： ","date":"2020-02-20","objectID":"/bioinfo-q-a-49/:1:0","tags":["AQ100","KRAS"],"title":"【bioinfo】-Q\u0026A-49","uri":"/bioinfo-q-a-49/"},{"categories":["bioinfo","ngs"],"content":"PRC复合物抑制/激活的基因干扰了单细胞的基因表达 Flipping between Polycomb repressed and active transcriptional states introduces noise in gene expression 背景知识 Polycomb repressive complexes (PRCs) 是非常著名的组蛋白修饰复合物，一般来说是抑制基因表达的。但是如果某基因同时被PRC复合物和RNA polymerase II (RNAPII)结合，也可以被激活转录。但其中机理不明。 PRC1, which monoubiquitinylates histone 2 A lysine 119 (H2Aub1) via the ubiquitin ligase RING1A/B; PRC2, which catalyzes dimethylation and trimethylation of H3K27 (H3K27me2/3) via the histone methyltransferase (HMT) EZH1/2. Embryonic stem cells (ESCs) 能自我更新并且具有分化成其它细胞类型的潜力，并且认为其干细胞特性由表观调控保持。一般经由干细胞marker挑选，比如Oct4，需要很明确的证明其不表达分化marker，比如Gata4 and Gata6。可以对这两个marker基因集合做热图，如下： RNAPII的修饰决定着转录过程，主要是其碳末端的磷酸化修饰。具体已知结论如下： Phosphorylation of S5 residues (S5p) correlates with initiation, capping, and H3K4 HMT recruitment. S2 phosphorylation (S2p) correlates with elongation, splicing, polyadenylation, and H3K36 HMT recruitment. Phosphorylation of RNAPII on S5, but not on S2, is associated with Polycomb repression and poised transcription factories, while active factories are associated with phosphorylation on both residues. S7 phosphorylation (S7p) marks the transition between S5p and S2p, but its mechanistic role is unclear presently. 如果把PRC复合物和RNAPII的修饰结合起来，可以把基因分成两类： (1) repressed genes associated with PRCs and unproductive RNAPII (phosphorylated at S5 but lacking S2p; PRC-repressed) (2) expressed genes bound by PRCs and active RNAPII (both S5p and S2p; PRC-active) 当然，这些基因都被H3K4me3 and H3K27me3共同结合，被称作二价状态。 单细胞转录组测序 测的是血清+ leukemia-inhibitory factor (LIF)培养的小鼠OS25 ESCs 细胞，用的是 Fluidigm C1进行单细胞获取，建库用的是SMARTer试剂盒。 单细胞过滤： (1) the total number of reads mapping to exons for the cell was lower than half a million (2) the percentage of reads mapping to mitochondrial-encoded RNAs was higher than 10%. 最后剩下90个单细胞进入后续分析，这些细胞都超过80%的比对率，而且超过60%的reads是落在外显子区域的。 基因过滤： 过滤那些RPM小于10的低表达量基因，因为实在是没有办法区分它们的生物学差异和技术差异。 把单细胞表达矩阵的基因平均表达量跟Brookes et al.5 的bulk转录组测序数据结果比较，相关性非常好。 分析 Cell-to-cell variation 细胞之间的基因表达差异来自于3大因素： tochastic gene expression itself technical noise confounding expression heterogeneity due to biological processes such as the cell cycle. 作者首先重构这些细胞的细胞周期状态，分析到细胞周期对细胞之间的表达差异贡献才1.2% ，并且矫正该影响。 为了矫正技术误差，作者去除了那些低表达量基因，平均reads数小于10的那些，最后剩下一万一多基因。 最后作者用DM (distance to median)来衡量基因在细胞群里的表达变异情况。 DM这个指标非常给力，超脱了基因长度以及基因表达量的限制，如下： 结合公共ChIP-seq 数据 分析公共数据 GSE34520 ，把基因根据 PRC marks and RNAPII states进行分类 (1) “Active” genes (n = 4483) without PRC marks (H3K27me3 or H2Aub1) but with active RNAPII (S5pS7pS2p) 这些基因大多数管家基因，所以表达量较为稳定 (2) “PRC-active” genes (labeled as “PRCa”; n = 945) with PRC marks (H3K27me3 or H3K27me3 plus H2Aub1), and active RNAPII.这些基因大多数信号通路 (3) “PRCr” genes (n = 954) have both PRC marks (H3K27me3 and H2Aub1), unproductive RNAPII (S5p only and not recognized by antibody 8WG16) and not expressed in bulk mRNA data by Brookes et al. (bulk mRNA FPKM \u003c1). 经由 two-tailed Wilcoxon rank sum 检验，发现 “PRC-active” 基因集 统计学显著的在单细胞水平有着更高的表达变异程度，相比 “Active” genes 。 数据包括： GSM850467RNAPII S5P ChIPSeqGSM850468RNAPII S7P ChIPSeqGSM850469RNAPII 8WG16 ChIPSeqGSM850470RNAPII S2P ChIPSeqGSM850471H2Aub1 ChIPSeqGSM850472H3K36me3 ChIPSeqGSM850473Control MockIPGSM850474Ring1B ChIPSeqGSM850475RNAPII S5P Repeat ChIPSeqGSM850476OS25 cells mRNA-Seq 结合公共单细胞转录组数据 Single cell RNA-sequencing of pluripotent states unlocks modular transcriptional variation. Cell Stem Cell 17, 471–485. 结合Hi-C的3D基因组数据 有一个公共数据：GOTHiC (Genome Organization Through Hi-C) Bioconductor package . 参考文献：Schoenfelder, S. et al. Polycomb repressive complex PRC1 spatially constrains the mouse embryonic stem cell genome. Nat. Genet. 47, 1179–1186 (2015). 定义某个基因是否是某些组蛋白修饰marker的阳性 Genes were defined as positive for H3K9me3 at their promoter or gene body when an enriched region was overlapping with a 2 kb window around the TSS or between the TSS and TES, respectively. 基因表达差异的衡量 Gene expression variation can be quantified by CV or DM, which is a measure of noise independent of gene expression levels and gene length. coefficient of variation (CV) 衡量基因","date":"2020-02-20","objectID":"/bioinfo-q-a-48/:1:0","tags":["AQ100","PRC","sc"],"title":"【bioinfo】-Q\u0026A-48","uri":"/bioinfo-q-a-48/"},{"categories":["bioinfo","cg"],"content":"单细胞转录组探索头颈癌症的转移癌和原位癌区别 Single-Cell Transcriptomic Analysis of Primary and Metastatic Tumor Ecosystems in Head and Neck Cancer 测序如下； We profiled transcriptomes of ∼6,000 single cells from 18 head and neck squamous cell carcinoma (HNSCC) patients, including five matched pairs of primary tumors and lymph node metastases. 同时也对这些病人测了whole-exome sequencing (WES) and targeted genotyping (SNaPshot) data，但是这些数据公布在 phs001474.v1.p1 ，不是很方便下载。 单细胞转录组建库用的Smart-seq2方法，所有的数据公布在 GSE103322 ， 仅仅是表达矩阵都有近100Mb了。 实验验证用的是细胞系 Oral cavity HNSCC cell lines (Cal-27, SCC9, SCC4, SCC25, and JHU-006; all derived from male patients) 做了RNA-seq 数据。 肿瘤内异质性是肿瘤学的主要挑战。在新兴的技术中，scRNA-seq有助于确定与肿瘤生物学，诊断和治疗有关的发育等级，抗药性程序和免疫渗透模式。在这里，研究者应用这种方法来表征原发性HNSCC肿瘤和匹配的LN转移瘤。 名词介绍 头颈部鳞状细胞癌（HNSCC） 淋巴结转移（LN） 癌症基因组图谱（TCGA） 癌相关成纤维细胞（CAF） 细胞外基质（ECM） 循环肿瘤细胞（CTC） 单细胞RNA测序（scRNAseq） 肿瘤微环境（TME） 全外显子组测序（WES）和靶向基因分型（SNaPshot） Epithelial-to-mesenchymal transition (EMT) PNI = perineural invasion; LVI = lymphovascular invasion; ECE = extracapsular extension 背景介绍 HNSCC 头颈癌是最常见的十大癌症之一，每年有50万患者深受其害，其中，超过80%的患者为口腔鳞状细胞癌(OSCC)。尽管目前有手术、化疗、放疗等治疗手段，但5年存活率仅有50%，仍是存活率最低的癌症之一，且近30年没有改善。所以探寻新的治疗方式抑制OSCC生长和转移尤为重要。 头颈部鳞状细胞癌（HNSCC）是一种与酒精和烟草暴露密切相关的具有异质性的上皮肿瘤，患者往往在晚期出现的淋巴结转移（LN)。 单细胞转录组数据分析CNV跟WES的对比 首先把所有病人的近6000个细胞根据表达模式区分成恶性与否，分成两组进行CNV聚类，可以看到恶性细胞的CNV模式跟从WES数据分析得到的CNV模式比较类似，说明了单细胞转录组数据分析CNV是靠谱的。当然，本身该课题组前面的几篇文章就提到了这个方法以及证实了其可靠性。 病人MEEI5的CNV情况 MEEI5 是一个69岁的女性，对来源于她的所有单细胞的转录组数据分析得到的CNV信息进行聚类可以看到比较清晰的patter，其中恶性与否比较容易区分，而且对于恶性细胞也可以看出原位癌和转移癌的区别。 首先区分肿瘤细胞的恶性与否 用Smart-seq2建库方法得到的单细胞转录组数据经过QC后，留下了来自18名患者的5,902个细胞，首先可以分成2215个恶性细胞和3363个非恶性细胞。 首先，研究者根据跨染色体间隔的平均表达谱推断每个单细胞中的大规模染色体拷贝数变异（CNV）。这些推断的CNVs与WES一致，通过推断的CNVs将恶性细胞从正常核型的非恶性细胞中分离出来。 其次，研究者通过其上皮来源鉴别恶性细胞，其不同于TME中的基质和免疫细胞。研究者发现在具有上皮标志物表达的细胞和具有异常核型的细胞之间具有显著的一致性。 最后，研究者通过它们的全局表达模式将细胞划分到初始类。基于CNV和上皮标志物分析，绝大多数细胞均被分到具有一致恶性或非恶性分类类中去。 非恶性细胞的聚类没有个体差异 如果只对已经被区分出来的三千多个非恶性肿瘤细胞进行聚类，采取SC3算法，效果如下图，虽然有14个类别，但是根据已知标记基因的表达，可以注释为B细胞，巨噬细胞，树突状细胞，肥大细胞，内皮细胞，成纤维细胞和肌细胞这八个值得探究的类别。 值得注意的是，每个类含有来自不同患者的细胞，表明TME(这三千多个非恶性细胞就是肿瘤微环境)中的细胞类型和表达状态在HNSCC肿瘤中基本一致，并且没有患者特异性亚群或批处理效应，尽管它们的比例是不同的。 而且由于研究者的数据集中T细胞和成纤维细胞，即数量相对较多，研究者通过更精确的聚类发现了T细胞和成纤维细胞的多样性。如下： 单独查看成纤维细胞CAF rv1,500成纤维细胞分成两个大类，一个小类别。 第一个类表达肌成纤维细胞的经典标记，包括α平滑肌肌动蛋白（ACTA2）和肌球蛋白轻链蛋白（MYLK，MYL9）。肌成纤维细胞是TME的成熟组分，并与伤口愈合和挛缩有关。 第二个类表达与癌相关成纤维细胞（CAF）相关的受体，配体和细胞外基质（ECM）基因，包括成纤维细胞活化蛋白（FAP），podoplanin（PDPN）和结缔组织生长因子（CTGF）。 第三个类基本不包括肌成纤维细胞和CAF的标记物，并可能代表处于静止状态的成纤维细胞。 其中还可以把CAFs（第二个类）分为具有立即早期应答基因（例如JUN，FOS），间充质标志物（例如VIM，THY1），配体和受体（例如FGF7）差异表达的两种类型（CAF1和CAF2），TGFBR2 / 3）和ECM蛋白质（例如MMP11，CAV1）。这种瘤内CAF异质性与TMF中涉及复杂结构和旁分泌相互作用的观点一致。 单独查看T细胞 主要T细胞类（rv1000个T细胞）可以分为四个亚群，研究者注释为 调节性T细胞（Treg） 常规CD4 + T辅助细胞（CD4 + Tconv） 两种细胞毒性CD8 + T细胞群（CD8 + T和CD8 + Texhausted） 细胞毒素亚型在共抑制性受体（例如PD1，CTLA4）和与T细胞功能障碍和衰竭相关的其他基因的表达方面不同，**并由此定义HNSCC中推定的T细胞耗竭程序。**耗竭CD8 + T细胞的部分在研究者的队列患者中显著变化。这些T细胞表达状态可以为理解和预测检查点免疫疗法的反应提供帮助。 恶性细胞聚类完全取决于患者个体 与非恶性细胞相比，2215恶性细胞根据其起源的肿瘤聚类。超过2000个基因优先在个体肿瘤中表达。 差异表达的基因在肿瘤之间不同的CNV内富集。 最后，其他差异表达的基因与应激（例如JUNB，FOSL1）或免疫激活（例如IDO1，STAT1，TNF）有关，可能对不同的TME有反应。因此，肿瘤间恶性细胞表达异质性反映了研究者队列中肿瘤之间遗传学，亚型和TME的差异。 恶性细胞的基因特征 这里重点分析那些含有恶性细胞转录组最多数量的10对肿瘤样本。比如下面的病人MEEI25，一个76岁的女性： 研究者使用非负矩阵分解来揭示在恶性细胞亚群中得到优先共同表达的一系列基因。例如，对于MEEI25恶性细胞，研究者定义了6个不同的基因特征。对10个肿瘤样本中的每一个都应用该方法，共定义了60个基因特征。 接下来，研究者使用层次聚类来将这些60个特征提取成元特征，这些元特征反映了在多个肿瘤内变化的常见表达程序。来自不同肿瘤的特征之间的高一致性表明它们反映了肿瘤内表达异质性的共同模式。 LN转移与原发性肿瘤比较 研究者将LN转移与原发性肿瘤（只有5个病人是取了配对样本）进行了比较。尽管WES和推测的CNV显示了原发性和匹配的LN样本之间的存在一些基因组差异，但是可能是由于所研究的个体数量较少，他们没有鉴别出任何一致的区别。 LN中恶性细胞的表达谱也与相应的原发肿瘤大致匹配。在每个配对样本中，都有较少的差异表达基因是显著差异的，但是它们在整个群体（cohort）中不一致。 研究者还观察到淋巴结和原发性肿瘤间质和免疫细胞的特征和表现的总体一致性，虽然有一些重要的区别！ EMT的部分状态或p-EMT EMT程序被广泛认为是耐药，侵袭和转移的潜在驱动因素，是一个连续和变化的过程。因此，研究者仔细检查了ECM计划中EMT的特征。除ECM基因如基质金属蛋白酶，层粘连蛋白和整联蛋白外，该程序还包括EMT标志物波形蛋白（VIM）和整联蛋白α-5（ITGA5）。此外，该方案中得分最高的基因之一是转化生长因子（TGF）-b诱导（TGFBI），暗示经典的EMT调节剂TGF-b。 虽然该程序具有经典EMT的关键特征，但缺乏其他标志。 首先，虽然特征伴随着某些上皮基因的表达降低，但是上皮标记物的总体表达还是明显地保持下来。 其次，研究者没有检测到经典EMT TF，ZEB1 / 2，TWIST1 / 2和SNAIL1的表达。只有SNAIL2被检测到（在70％的HNSCC细胞中），尽管其表达与肿瘤的程序相关，但与肿瘤内个体细胞的程序并不相关。最近的研究表明SNAIL2比其他EMT TFs早。 SNAIL2也涉及伤口愈合中的p-EMT应答。 因此，研究者建议这里确定的体内程序反映了一个EMT的部分状态或p-EMT。 上图的分析结果表明，这个p-EMT程序不同于源自细胞系和肿瘤模型","date":"2020-02-20","objectID":"/bioinfo-q-a-47/:1:0","tags":["AQ100","sc"],"title":"【bioinfo】-Q\u0026A-47","uri":"/bioinfo-q-a-47/"},{"categories":["bioinfo","cg"],"content":"时间序列单细胞转录组数据分析 Reconstruction of developmental landscapes by optimal-transport analysis of single-cell gene expression sheds light on cellular reprogramming. 包含了六万多个单细胞转录组数据，持续追踪了MEF细胞系诱导为IPSC细胞的动态变化过程，并且从发育的角度分析了这些数据 We demonstrate the power of WADDINGTON-OT by applying the approach to study 65,781 scRNA-seq profiles collected at 10 time points over 16 days during reprogramming of fibroblasts to iPSCs. ","date":"2020-02-20","objectID":"/bioinfo-q-a-46/:1:0","tags":["AQ100","sc"],"title":"【bioinfo】-Q\u0026A-46","uri":"/bioinfo-q-a-46/"},{"categories":["bioinfo","cg"],"content":"背景介绍 Waddington提出的发育景观 上世纪50年代，胚胎发育生物学家Conrad Hal Waddington提出的发育景观假说认为，分化成熟的细胞变回多能干细胞是个不可能发生的事件。但是日本京都大学教授山中伸弥于2006年却发现并验证，这种细胞可以发育成为身体各种组织细胞。iPS细胞的发现成就了目前轰轰烈烈的干细胞研究领域，山中伸弥教授也因此获得2012年诺贝尔生理或医学奖。 iPS (诱导多潜能干细胞)重编程实验的涌现使人们重新重视了上个世纪50年代胚胎发育生物学家Waddington提出的发育景观。虽然它只是一个隐喻,但其形象地描述了细胞的自发的层次分叉过程并隐含了细胞类型之间转换的可能性,从而作为一个整体框架最近被广泛应用来解释细胞发育和重编程。 详见：https://zhuanlan.zhihu.com/p/25333058 Waddington 在两个时期提出的假说： initially (1936) illustrated by railroad cars on switching tracks (A) later (1957) by marbles rolling in a landscape (B), with trajectories shaped by hills and valleys. 最优传输理论 最优传输理论(Optimal Transport)，也叫Monge-Kantorovich Problem。最早由法国数学家Monge提出，二战期间由俄国数学家Kantorovich推广后开始迅速发展，Kantorovich也因他在这个领域做出的贡献得了1975年的经济学诺贝尔奖。 Monge最早提出的问题可以理解为，**有一堆土在地点A，现在我们要将这堆土转移到地点B，但是我们运土是要费体力的，怎么搬这些土可以让我们的体力消耗降到最小。**现在我们量化这个问题，将土在地点A的分布称之为\"Initial Distribution\"，在地点B的分布称为\"Final Distribution\"，我们称消费的体力为Cost，通过一个\"Cost Function\"计算得出，每种搬运方案为一个\"Mapping\"。我们现在要在所有Mapping中寻找Cost最低的那一个，这就是最优传输理论要解决的问题。 可能看完这些，有的小伙伴还是不太懂搬运方案和Mapping是怎样一回事。这里解释一下，比如在地点A和地点B的时候，土堆的形状都要形成一个标准正态分布 N(0, 1)，我们\"将A土堆中间的土先搬过去形成B土堆的尾巴\"和\"将A土堆的土直接放到B土堆对应位置\"所消耗的体力大部分情况下是不一样的，这就是两种不同的方案对应着不同的Cost。 这几年，由最优传输理论衍生出来的\"Martingale Optimal Transport\"在金融数学有不少应用，有不少人在研究。简单的说就是给这些\"Mapping\"加了个限制，要求他们必须是\"Martingale\"。 发育生物学家感兴趣的基本问题 如下： What classes of cells are present at each stage? For the cells in each class, what was their origin at earlier stages, what are their potential fates at later stages, and what is the actual outcome of a given cell? To what extent are events along a path synchronous or asynchronous? What are the genetic regulatory programs that control each path? What are the intercellular interactions between classes of cells? How deterministic or stochastic is the process—that is: if, and how early, does it become determined that a particular cell or an entire cell class is destined to a specific fate? For a given origin and target fate, is there only a single path to the target, or are there multiple developmental paths? To what extent is the process cell-intrinsic, driven by intracellular mechanisms that do not require ongoing external inputs, or externally regulated, being affected by other contemporaneous cells? For artificial processes such as induced reprogramming, there are additional questions: What off-target cell classes arise? To what extent do cells activate normal developmental programs vs. unnatural hybrid programs? How can the efficiency of reprogramming be improved? 然后列举一些前人在探索这些问题方面的研究成果，指出他们做的还不够。而单细胞转录组测序技术非常强大，适合解决这个问题。 单细胞转录组在探索发育轨迹这方面也有过一些应用了，主要的算法集中于3个： k-nearest neighbor graphs binary trees diffusion maps 他们的缺陷很明显，有3个： 首先为那些稳定的生物学过程设计的，比如cell cycle or adult stem cell differentiation 其次，单细胞本身也是多种生物学状态的叠加，比如cell proliferation and death就会影响那些算法的表现。 最后，大部分模型的假设限制很大，比如one-dimensional trajectories and zero-dimensional branch points 所以作者把Optimal Transport (OT)的算法，应用到了时间序列的单细胞转录组数据来探索发育的过程。当然，表现很好的啦，揭示了重编程的分子机理。 几大发现如下： (1) identifying alternative cell fates, including senescence, apoptosis, neural identity, and placental identity; (2) quantifying the portion of cells in each state at each time point; (3) inferring the probable origin(s) and fate(s) of each cell and cell class at each time point; (4) identifying early molecular markers associated with eventual fates; (5) using trajectory information to identify transcription factors (TFs) associated with the activation of different expression programs. 单细胞转录组数据处理 首先得到表达矩阵 因为是 10X Genomics数据，所以直接用官方工具CELLRANGER 即可，过滤后得到65,781 cells and G = 16, 339 genes 的表达矩阵 然后降维 先过滤掉那些在所有细胞表达没什么变化的基因，这一步利用的是R包SEURAT的MeanVarPlot函数，剩下2076个基因。 然后使用 diffusion component embedding进行降维处理，这一步利用的是R包 DESTINY。 分析了top100 diffusion components的，发现只有top20是显著的富集到 developmental processes ，所以作者只选取了top 20 diffusion components 可视化 现在剩下了20*65781的矩阵，首先使用R语言的FNN包里面的 fast k-NN algorithm ，然后利用ForceAtlas2算法计算 force-directed layout on the k-NN graph 单细胞聚类 同样的剩下了20*65781的矩阵，使用了 Louvain-Jaccard community detection 算法，默认参数分成33类 最优传输算法 主要就是考量 proliferation score和growth rat","date":"2020-02-20","objectID":"/bioinfo-q-a-46/:1:1","tags":["AQ100","sc"],"title":"【bioinfo】-Q\u0026A-46","uri":"/bioinfo-q-a-46/"},{"categories":["bioinfo","cg"],"content":"高通量药物筛选对Rhabdoid tumors High-Throughput Drug Screening Identifies Pazopanib and Clofilium Tosylate as Promising Treatments for Malignant Rhabdoid Tumors ","date":"2020-02-20","objectID":"/bioinfo-q-a-45/:1:0","tags":["AQ100"],"title":"【bioinfo】-Q\u0026A-45","uri":"/bioinfo-q-a-45/"},{"categories":["bioinfo","cg"],"content":"细胞系背景知识 重点关注Rhabdoid tumors (RTs) ，所以挑选了两种细胞系： SMARCB1-positive cell lines，包括 I2A 和 (I2A + SMARCB1) SMARCB1-negative cell lines (G401 and G402) 有意思的是 pazopanib 这个药物在这两个细胞系表现有统计学显著的区别。 还引入了另外5个人类Rhabdoid tumors (RTs) 细胞系： KD (Versteege et al., 1998) 2004 (Versteege et al., 1998) DEV (Giraudon et al., 1993) Wa2 (Handgretinger et al., 1990) LM (Versteege et al., 1998). 还有4个细胞系作为对照： A673 (Ewing sarcoma) DAOY (medulloblastoma) A549 (SMARCA4-deficient lung carcinoma; obtained from the ATCC [CRL-1598, HTB-186, and CCL-185, respectively]) SK-N-BE(2)C (neuroblastoma) (Barnes et al., 1981). ","date":"2020-02-20","objectID":"/bioinfo-q-a-45/:1:1","tags":["AQ100"],"title":"【bioinfo】-Q\u0026A-45","uri":"/bioinfo-q-a-45/"},{"categories":["bioinfo","cg"],"content":"药物筛选背景知识 药物筛选用384孔板，共纳入了1200种FDA批准的药物，以DAPI染色来判断药效。这1200种药物可以买到：Prestwick Chemical Library V2 (Prestwick Chemical), a collection of 1,200 off-patent drugs already approved by the FDA 重点挑选那些能显著抑制SMARCB1缺陷型细胞系生长的药物。 计算了药物的 robust Z [RZ] score来作为评价标准。(初筛) ","date":"2020-02-20","objectID":"/bioinfo-q-a-45/:1:2","tags":["AQ100"],"title":"【bioinfo】-Q\u0026A-45","uri":"/bioinfo-q-a-45/"},{"categories":["bioinfo","cg"],"content":"总共挑选了10个药物 compounds showing a RZ score \u003c−5 in at least one RT cell line (I2A or G401 cells) and showing no activity in I2A+ cells (RZ score \u003e−2), which comprised 5 drugs (5-fluorouracil, luteolin, rimexolone, amethopterin [R,S], and methotrexate); compounds with some weak activity in I2A+ cells (−5 \u003c RZ score \u003c−2) and showing a strong effect in at least one RT cell line (RZ score \u003c−10) and a differential between I2A+ and I2A exceeding 2, leading to the selection of an additional 5 compounds (CfT, podophyllotoxin, ciclopiroxethanolamine, thioguanosine, and vatalanib). 详情如表格：Table 1. RZ Scores ，当然因为这些药物有希望，所以就又测了48小时的药物处理IC50 (μM) 只有6个药物满足在两个SMARCB1缺陷型细胞系都表现 (IC50) \u003c10 μM ，其中四个都是anti-mitotic类别的，所以抛弃。 最后剩下的，值得期待的药物是： one antiarrhythmic agent (clofilium tosylate [CfT]) broad TKi’s such as vatalanib, ponatinib, and pazopanib 其中CfT是potassium channel 的抑制剂 对于TKi’s药物，挑选了9个FDA批准的药物比较发现pazopanib最显著，后面的研究就替换掉了 vatalanib。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-45/:1:3","tags":["AQ100"],"title":"【bioinfo】-Q\u0026A-45","uri":"/bioinfo-q-a-45/"},{"categories":["bioinfo","cg"],"content":"药物机制研究 因为TKi’s药物就是作用于 tyrosine kinase receptors (RTKs) ，所以作者用现成的商业的试剂盒： Proteome Profiler human phospho-RTK array 来探索 I2A, DEV, G401, and KD 这4种细胞系的 49个 RTKs的磷酸化情况。发现只有其中2个在药物pazopanib处理前后有区别： 首先是 platelet-derived growth factor receptors(PDGFRs) : 然后是 fibroblast growth factor receptor 2 (FGFR2) 还有Pazopanib和CfT的联合用药的体外细胞系实验。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-45/:1:4","tags":["AQ100"],"title":"【bioinfo】-Q\u0026A-45","uri":"/bioinfo-q-a-45/"},{"categories":["bioinfo","cg"],"content":"表达芯片及RNA-Seq数据 在两个细胞系 (DEV and G401 ) 处理CfT 前后测转录组表达数据，共4*3=12个样本。 在I2A SMARCB1-def细胞系添加SMARCB1处理的时间序列，共(0,2,4,7,14day)*3=15个样本。 数据公布在GEO: GSE98277 : GSE102467 I2A microarray gene expression data CfT-treated G401 and DEV RNA-seq data 仅仅是找了差异，然后根据阈值筛选到有统计学显著的差异基因做GO富集看看而已。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-45/:1:5","tags":["AQ100"],"title":"【bioinfo】-Q\u0026A-45","uri":"/bioinfo-q-a-45/"},{"categories":["bioinfo","cg"],"content":"PDX模型验证 制作了两个PDX模型： RT-001-HAM (liver tumor; Nicolle et al., 2016) IC-pPDX-6 (soft tissue; Curie Institute). pazopanib showed actual growth delay on two extra-cranial RT PDXs as a single agent. ","date":"2020-02-20","objectID":"/bioinfo-q-a-45/:1:6","tags":["AQ100"],"title":"【bioinfo】-Q\u0026A-45","uri":"/bioinfo-q-a-45/"},{"categories":["bioinfo","ngs"],"content":"用LC-MS来找HCC的代谢标记物 ","date":"2020-02-20","objectID":"/bioinfo-q-a-44/:1:0","tags":["AQ100","metabonomics"],"title":"【bioinfo】-Q\u0026A-44","uri":"/bioinfo-q-a-44/"},{"categories":["bioinfo","ngs"],"content":"代谢组学简介 代谢组学的概念来源于代谢组，代谢组是指某一生物或细胞在一特定生理时期内所有的低分子量代谢产物，代谢组学则是对某一生物或细胞在一特定生理时期内所有低分子量代谢产物同时进行定性和定量分析的一门新学科。 **代谢物水平整合了来自内源性物质（基因）和外源性物质（营养、药物、环境）的信息。**对一组代谢物进行并行定量采集可以直接获得细胞和生物系统的生化状态。代谢轮廓分析与生物表型相关，可以用于生物标志物的发现和路径分析。代谢组学需要敏感和快速的分析方法，以及阐述了生物信息学处理/分析的数据。 代谢组学使用的分析策略有三种： 非靶向代谢组学 半靶向代谢组学 靶向代谢组学 ","date":"2020-02-20","objectID":"/bioinfo-q-a-44/:1:1","tags":["AQ100","metabonomics"],"title":"【bioinfo】-Q\u0026A-44","uri":"/bioinfo-q-a-44/"},{"categories":["bioinfo","ngs"],"content":"LC-MS背景介绍 液质联用(LC/MS): LC为液相色谱仪；MS为一种能够生成离子，在气态中根据质荷比的不同将其分离并进行检测的仪器。*LC/MS以液相色谱作为分离系统，质谱作为检测系统，*因而兼具有液相色谱高分离度与质谱高灵敏度的特点。分析的样品在质谱部分和流动相分离，被离子化后，经质谱的质量分析器将离子碎片按质量数分开，经检测器得到质谱图。 LC-MS/MS越来越广泛应用于药物、食品、环境、法医、临床等各个领域。尤其在临床检测上适，用范围远远超过放射性免疫检测和化学检测范围，是其他方法无可比拟的。 质谱本身也有一个分离作用，就是按照质量的分离，如果液相分离了一次，那LC－MS就分离了两次，而LC-MS/MS就分离了三次，LC-MS3就分离了四次….（3级以上是离子阱质谱的特点）。 质谱定量中已经被广泛接受的方式是MS/MS定量。这种定量常通过三级四极杆或离子阱质谱实现。要求使用MS/MS的原因是：许多化合物有同样的质量。当使用第一个维度即单级质谱MS去定量时，也会缺乏特异性，尤其是对于像血液那样的复杂的基质。第二个维度的MS（即MS/MS）在大多数情况下，能够提供唯一的断裂。合并特异的母离子质量和唯一的碎片离子信息，可以选择性地监测被定量的化合物。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-44/:1:2","tags":["AQ100","metabonomics"],"title":"【bioinfo】-Q\u0026A-44","uri":"/bioinfo-q-a-44/"},{"categories":["bioinfo","ngs"],"content":"技术进步 3min方法测定400多种代谢物 科罗拉多大学丹佛分校Angelo D’Alessandro教授课题组2017年发表在Rapid Communication in Mass Spectrometry上的一篇文章，题为A three-minute method for high-throughput quantitative metabolomics and quantitative tracing experiments of central carbon and nitrogen pathways。Angelo D’Alessandro教授课题组基于Vanquish-Q Exactive 技术建立了3min方法测定400多种代谢物的方法，覆盖到糖酵解途径、磷酸戊糖途径、三羧酸循环、鸟氨酸循环、氨基酸代谢途径、嘌呤代谢及其嘧啶代谢等多种和癌症相关性较强的代谢途径，且适用于体液、血浆、组织、细胞等复杂基质，极大的提高了复杂基质中代谢物研究通量，并实际应用于潜在标记物发现、代谢流分析、发病机理研究等领域，助力于精准医学研究、转化医学及其临床代谢组研究工作。 pseudotargeted metabolomics 伪靶向代谢组学 既可以保证检测到足够多的化合物，又可以保证其定量的准确性 工作流程： 使用高分辨质谱获得化合物的二级质谱。采用DDA扫描（又称作auto-MS/MS）在非靶向的情况下，获取化合物的二级质谱。 挑选离子对，以供下一步MRM分析。通常用仪器自带软件，去寻找母离子→子离子离子对，在这一步需要仔细查看所选择的离子对，因为离子对的挑选直接影响下一步的MRM分析。 使用三重四级杆质谱对第二步挑选的离子对进行扫描，积分峰面积。 数据分析。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-44/:1:3","tags":["AQ100","metabonomics"],"title":"【bioinfo】-Q\u0026A-44","uri":"/bioinfo-q-a-44/"},{"categories":["bioinfo","ngs"],"content":"文章的实验设计 文章的团队从2008年9月到2014年5月，共招募了1448人，分别是下面6种： normal controls (healthy volunteers, NC) patients with chronic hepatitis B (CHB) infections liver cirrhosis (Cir) HCC gastric cancer (GSC) intrahepatic cholangiocarcinoma (ICC) 确定仅仅由2个代谢物组成的panel 对数据进行下面的分析： Ultimately, eight metabolites were retained: phenylalanyl-tryptophan (Phe-Trp); glycocholate (GCA); taurocholate; lysophosphatidyle-thanolamines 18:2, 20:5, and 22:4; choline; and taurine. Subsequently, a binary logistic regression analysis and an optimized algorithm of the forward stepwise (Wald) method were employed to construct the best model using these eight potential metabolite bio- markers. Finally, the combination of Phe-Trp and GCA was defined as the ideal biomarker panel to distinguish patients with HCC from subjects without HCC. 评价panel的表现 也就是一些最基础的统计分析，把代谢组学数据结合病人的临床信息进行数据统计即可。 代谢组数据分析 这篇文章使用的是 SIMCA-P （http://umetrics.com/products/simca），该软件是由Umetrics公司在1987研究开发，目前是一款公认的多元变量统计分析软件，被绝大多数代谢组服务提供商所采用。SIMCA-P虽然是一款强大的多元变量统计分析软件，但也有不足之处： SIMCA-P是一款商业软件，需要收费（但有30天免费试用），windows版本的。对于想使用免费软件的老师来说，不那么友好； 代谢组数据的分析除了多元变量统计分析，还有原始数据前处理（pre-processing）、数据处理（processing）、单变量统计分析等，很显然SIMCA-P并不能满足我的所有愿望 在《Metabolomics-Fundamentals and Applications》这本书的第四章节《Processing and Visualization of Metabolomics Data Using R》中，作者列出了一些代谢组数据处理、统计分析与可视化的开源免费软件工具！代表性的如下： MetaboAnalyst是2009年公布的一款代谢物数据分析软件 XCMS Online（https://xcmsonline.scripps.edu）是XCMS的网页版本 XCMS是2006年发布的、基于R语言的用于LC-MS数据处理分析的软件 检测到表现差异的代谢物非常多 DMG, N,N-dimethylglycine; GPC, Glycerophosphate choline; DHC, dihydrocholesterol; Phe-Phe, PhenylalanylPhenylalanine; Phe-Trp, Phenylalanyltryptophan; DMHC, dimethylheptanoylcarnitine; ANDS, androsterone sulfate; DHTS, dihydrotestosterone sulfate; TCA, taurocholate; GCA, glycocholate; GCDCA, glycochenodeoxycholate; TCDCA, taurochenodeoxycholate.; GCDCS, glycoursodeoxycholate sulfate; ACN, acetylcarnitine; LPC, lysophosphatidylcholine; LPE, lysophosphatidylethanolamine; SM, shpingomyelin; PC, phosphatidylcholine; FFA, free fatty acid; MG, Monoacylglycerol, FAAD, fatty amide. ","date":"2020-02-20","objectID":"/bioinfo-q-a-44/:1:4","tags":["AQ100","metabonomics"],"title":"【bioinfo】-Q\u0026A-44","uri":"/bioinfo-q-a-44/"},{"categories":["bioinfo","ngs"],"content":"TET2突变是如何引起超甲基化 癌症病人体内会检测到不正常的甲基化现象。 TET2可以氧化5mC成为5hmC，进而通过其它机制形成5fC和5caC。 很多血液肿瘤病人的TET2基因突变了，同时会显示出全局的5hmC水平下降。 有趣的是，全局的5hmC水平下降同样发生在很多实体肿瘤病人身上，但是那些病人很少有TET2突变发生。 那么，TET2突变，或者全局的5hmC水平下降，是如何导致启动子区域的CG岛的甲基化水平上升的呢？ 有其它文献报道 hypermethylation和**oxidative stress (OS)**有关系 作者认为 oxidative stress (OS) 在其中起了关键的作用。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-43/:1:0","tags":["AQ100","methylation"],"title":"【bioinfo】-Q\u0026A-43","uri":"/bioinfo-q-a-43/"},{"categories":["bioinfo","ngs"],"content":"关键结论 We now demonstrate TET2 forms ‘‘Yin-Yang’’ complexes with DNMTs and is targeted to chromatin during OS. TET2 actively removes abnormal DNAm induced by OS in promoter CGIs as well as enhancers by converting unwanted 5mC to 5hmC. Long-term reduction of TET2 caused even more DNA hypermethylation on these gene promoters and enhancers. ","date":"2020-02-20","objectID":"/bioinfo-q-a-43/:1:1","tags":["AQ100","methylation"],"title":"【bioinfo】-Q\u0026A-43","uri":"/bioinfo-q-a-43/"},{"categories":["bioinfo","ngs"],"content":"数据 作者用了 Agilent-026652 Whole Human Genome Microarray 4x44K v2 和 Illumina HumanMethylation450 BeadChip 来联合表达量和甲基化进行分析。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-43/:1:2","tags":["AQ100","methylation"],"title":"【bioinfo】-Q\u0026A-43","uri":"/bioinfo-q-a-43/"},{"categories":["bioinfo","ngs"],"content":"数据分析要点及结论 主要是集中在 Figure 7. TET2 Protects against Abnormal DNAm 图1 把TET2基因使用LentiCRISPR病毒KO掉前后的A2780细胞系，选取那些表达量下调非常显著的基因集。然后再根据它们这些基因的甲基化芯片的promoter CGI 探针的 β值来分成3类：DNAm of unmethylated (b \u003c 0.25) and intermediately methylated (0.25 \u003c b \u003c 0.75) ，分析发现它们的甲基化程度显著上升。 图2 还是针对那些TET2基因敲除后表达下降的基因，热图展现它们的甲基化芯片的promoter CGI 探针的 β值，共2947个探针。 图3 把TET2基因敲除后那些超甲基化的1406个基因跟以前发表的bivalent genes in hESCs, and cancer specific hypermethylated genes.基因集用韦恩图展现交叉情况。 图4 把TET2基因敲除后那些超甲基化的1406个基因进行GO富集分析 图5 把TET2基因敲除前后细胞表达量的变化以及它们对应的promoter CGI 探针的 β值变化的散点图 同时也分析了增强子区域： 2,107 hypermethylated enhancer regions identified by Rasmussen et al. (2015) to similar subgroups based on their basal methylation levels and found a very similar pattern for gains of DNAm in their TET2 KO scenario ","date":"2020-02-20","objectID":"/bioinfo-q-a-43/:1:3","tags":["AQ100","methylation"],"title":"【bioinfo】-Q\u0026A-43","uri":"/bioinfo-q-a-43/"},{"categories":["bioinfo","ngs"],"content":"用米氏方程解决单细胞转录组dropout现象 米氏方程（Michaelis-Menten equation）: v=Vmax × [S] /（Km+[S]) 在假定存在一个稳态反应条件下推导出来的，其中 Km 值称为米氏常数，Vmax是酶被底物饱和时的反应速度，[S]为底物浓度。 Km值的物理意义为反应速度（v）达到1/2Vmax时的底物浓度（即Km=[S]），单位一般为mol/L，只由酶的性质决定，而与酶的浓度无关。可用Km的值鉴别不同的酶。 今天要介绍的这篇文章提出了一个算法，R包是：M3Drop ， 文章是：Modelling dropouts for feature selection in scRNASeq experiments ","date":"2020-02-20","objectID":"/bioinfo-q-a-42/:1:0","tags":["AQ100","dropout","sc"],"title":"【bioinfo】-Q\u0026A-42","uri":"/bioinfo-q-a-42/"},{"categories":["bioinfo","ngs"],"content":"挑选重要基因 目前已有的寻找单细胞转录组测序数据中的重要基因（feature selection）的方法都不够好，比如 scLVM 主要是根据先验基因集，比如cell-cycle or apoptosis来区分细胞。与此相反，基于 highly variable genes (HVG) 的方法挑选到的变化量大的那些基因很可能是技术带来的误差。而且低表达量基因的变动往往大于高表达量基因，而且所谓的表达变化大也并没有很好的生物学解释。 一个比较好理解的概念是差异基因，但是需要预先把细胞群体分组后进行比较才能得到，而很多时候细胞太相似了，没办法很好的分开。像PCA或者t-SNE这样的降维方法也可以用来挑选重要基因，但它们也受制于系统误差或者批次误差等等。 dropout是scRNASeq数据的一大特点，就是很多基因在某些细胞根本就不表达，但是在另外的细胞却高表达。这篇文章作者对全长转录本数据和基于UMI的表达量数据分别提出了对应的解决方案，Michaelis-Menten equation 和 depth adjusted negative binomial (DANB) 。 单细胞转录组数据里面的dropouts可以达到50%，但是通常认为这个dropouts是因为在文库构建的过程中，有部分基因没有被成功的反转录，是一个酶促反应。 所以作者用Michaelis-Menten 来建模。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-42/:1:1","tags":["AQ100","dropout","sc"],"title":"【bioinfo】-Q\u0026A-42","uri":"/bioinfo-q-a-42/"},{"categories":["bioinfo","ngs"],"content":"比较9种 feature selection 方法 使用它们分别对基因排序，算法如下： bythemagnitudeoftheirloadingsinprincipalcomponentanalysis(PCA)bythestrengthoftheirmostnegativegene-genecorrelation(Cor)bytheirrelativeGiniindex(Gini)M3Dropdropouts-meanexpressioncurve(M3Drop)thesquaredcoefficientofvariation(CV2)meanexpressionrelationship(HVG)thedispersion-meanexpressionrelationshipfitbyDANB(NBDisp)thedropouts-meanexpressionrelationshipfitbyDANB(NBDrop). 这些算法都不需要预先对样本进行分类，是无监督的算法。 differentially variable (DV)genes highly variable (HV) genes differentially expressed (DE) genes 单细胞转录组数据的batch effects比较严重，所以 feature selection 过程的一个主要目的就是降低技术误差的影响，集中在有生物学意义的差异上面。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-42/:1:2","tags":["AQ100","dropout","sc"],"title":"【bioinfo】-Q\u0026A-42","uri":"/bioinfo-q-a-42/"},{"categories":["bioinfo","ngs"],"content":"公共数据集 作者比较了 5个公共数据集，都是小鼠的胚胎细胞，含有17~255个细胞的测序数据，包括zygote to blastocyst. Tung et al. (2017) [12] considered iPSCs from three different individuals and performed three replicates of UMI-tagged scRNASeq and three replicates of bulk RNASeq for each. (GSE77288 ). For Kolodziejczyk et al. (2015)，we considered ESCs grown under two conditions: alternative 2i and serum for which there were three replicates of scRNASeq and two replicates of bulk RNASeq.( E-MTAB-2600 ) 对bulk转录组数据用了3种方法找差异基因，分别是 DESeq2,edgeR,limma-voom，只有3种方法都是 5% FDR的差异基因才认为是阳性标准基因集，那些3种方法都在 20% FDR的非差异基因认为是阴性金标准。 1,915 positives, and 8,398 negatives for the iPSCs 709 positives and 11,278 negatives for the ESCs 有了这些基因，就可以计算ROC 细胞转录组数据文章一般分成下面两大类： 第一类是：deep sequencing of full-transcripts for a relatively small number of cells 第二类是：high-cell number, low-depth sequencing of 3’ or 5’ ends of transcripts tagged with unique molecular identifiers ","date":"2020-02-20","objectID":"/bioinfo-q-a-42/:1:3","tags":["AQ100","dropout","sc"],"title":"【bioinfo】-Q\u0026A-42","uri":"/bioinfo-q-a-42/"},{"categories":["bioinfo","immune"],"content":"探究为何一个TNBC对gefitinib过于敏感 A Targetable EGFR-Dependent Tumor-Initiating Program in Breast Cancer ","date":"2020-02-20","objectID":"/bioinfo-q-a-41/:1:0","tags":["EGFR","AQ100"],"title":"【bioinfo】-Q\u0026A-41","uri":"/bioinfo-q-a-41/"},{"categories":["bioinfo","immune"],"content":"背景知识 epidermalgrowth factor receptor (EGFR) EGFR inhibition by gefitinib triple-negative breast cancer (TNBC) patient-derived xenografts (PDXs) Deep single-cell RNAsequencing of 3,500 cells ","date":"2020-02-20","objectID":"/bioinfo-q-a-41/:1:1","tags":["EGFR","AQ100"],"title":"【bioinfo】-Q\u0026A-41","uri":"/bioinfo-q-a-41/"},{"categories":["bioinfo","immune"],"content":"实验设计 作者制作了一批TNBCs (15/18)的PDX模型，然后用这些模型来测试其对 EGFR inhibitor gefitinib 敏感情况。前人报道该药物在TNBC病人里面有效率是38.7%，与他们的实验想符合(6/18), 但是其中有一个人的反映比较特殊，就是 GCRC1735， 一个70岁的老奶奶，该药物治疗效果出奇的好。实验表明是正中靶点，降低了pEGFR，同时下调了pERK通路，激活了凋亡通路。基因检测表明该老奶奶有一个 pathogenic BRCA1 mutation (p.C1225Sfs) 和a somatic TP53 alteration (p.R249T) ，而EGFR基因上面既没有突变也没有拷贝数变异，EGFR 这个通路相关的基因也没有太大的异常，没办法解释该病人为何会对gefitinib如此敏感，值得探究。 ","date":"2020-02-20","objectID":"/bioinfo-q-a-41/:1:2","tags":["EGFR","AQ100"],"title":"【bioinfo】-Q\u0026A-41","uri":"/bioinfo-q-a-41/"},{"categories":["bioinfo","immune"],"content":"单细胞转录组测序 因为bulk测序无法解决问题 To understand functional properties associated with heterogeneous EGFR expression in an unbiased manner, single cell RNA-seq was performed on freshly dissociated cells from the PDX (3,483 cells, with an average of 40,564 unique molecular identifiers (UMIs) and 5,146 genes detected per cell) 数据都在SRA数据库里面，如下： https://trace.ncbi.nlm.nih.gov/Traces/study/?acc=SRP100090 https://trace.ncbi.nlm.nih.gov/Traces/study/?acc=SRP110989 其中单细胞测序是对一个70岁的老奶奶做的，所有的数据都在SRP110989里面，共3500个细胞，分析结果如下： ","date":"2020-02-20","objectID":"/bioinfo-q-a-41/:1:3","tags":["EGFR","AQ100"],"title":"【bioinfo】-Q\u0026A-41","uri":"/bioinfo-q-a-41/"},{"categories":["bioinfo","immune"],"content":"Cells partitioned into six subpopulations a mesenchymal/stem (M/S) cluster ，表现为 EGFR 和mesenchymal相关基因高表达 the nuclear/mitochondrial cluster，表现为 nuclear 和 mitochondrial基因定位 a proliferative cluster，表现为细胞周期相关基因高表达 the antigen presentation cluster，表现为抗原呈递相关基因高表达。 the basal cluster ，包括 (KRT6A/B, KRT17, KRT14, and KRT5) 等markers A transitional cluster ， 差异基因太少 subpopulation-specific markers 用 diffuse t-SNE 进行分组后，找到 marker 基因 pathway analysis 对找到的marker基因进行注释 分析了5个公共数据： 上面得到的各个cluster 的 gene list需要跟公共数据进行对比注释 BRCA1 and familial breast cancers (GSE49481)(Larsen et al., 2014) pre/post-chemotherapy (GSE32072)(Gonzalez-Angulo et al., 2012) FACS normal mammary cell (GSE16997)(Lim et al., 2009) (GSE37223)(Kannan et al., 2013) FACS normal mammary cells single-cell qPCR (GSE70554)(Lawson et al., 2015). 主要是看差异表达，还有用 GOBO 算法看 signature scores ​ 使用 Monocle 进行 trajectory 推断 这个是算法问题，可以先略过，直接看结论。 乳腺癌表达分型 拿到了乳腺癌患者的表达矩阵，就可以根据ssp2003 , ssp2006 and pam50来对其进行分类 Breast cancers were divided into luminal A, luminal B, HER2+ and basal-like subtypes using the ssp2003 , ssp2006 and pam50 classi ers, via the ‘genefu’ R package (http://www.bioconductor.org/packages/release/bioc/html/genefu.html). 乳腺癌整合生存分析网页工具 比较出名的是：http://kmplot.com/analysis/ The Kaplan Meier plotter is capable to assess the effect of 54,675 genes on survival using 10,461 cancer samples. These include 5,143 breast, 1,816 ovarian, 2,437 lung and 1,065 gastric cancer patients with a mean follow-up of 69 / 40 / 49 / 33 months. Primary purpose of the tool is a meta-analysis based biomarker assessment. 还有：http://co.bmc.lu.se/gobo/ CharacteristicsNumber of tumorsAll tumors1881ER+ tumors1225ER- tumors395Untreated tumors927TAM treated tumors326 ","date":"2020-02-20","objectID":"/bioinfo-q-a-41/:1:4","tags":["EGFR","AQ100"],"title":"【bioinfo】-Q\u0026A-41","uri":"/bioinfo-q-a-41/"},{"categories":["bioinfo","ngs"],"content":"深入了解snp-calling流程II 操作：排序及标记重复 1、排序（SortSam） 对sam文件进行排序并生成bam文件，将sam文件中同一染色体对应的条目按照坐标顺序从小到大进行排序 GATK4的排序功能是通过picard SortSam工具实现的。虽然samtools sort工具也可以实现该功能，但是在GATK流程中还是推荐用picard实现，因为SortSam会在输出文件的头信息部分添加一个SO标签用于说明文件已经被成功排序，且这个标签是必须的，GATK需要检查这个标签以保证后续分析可以正常进行 https://software.broadinstitute.org/gatk/documentation/tooldocs/current/picard_sam_SortSam.php # 使用GATK命令 $ gatk SortSam -I mapping/T.chr17.sam -O preprocess/T.chr17.sort.bam -R database/chr17.fa -SO coordinate --CREATE_INDEX # 使用picard命令 $ java -jar picard.jar SortSam \\ I=input.bam \\ O=sorted.bam \\ SORT_ORDER=coordinate 如何检查是否成功排序？ $ samtools view -H /path/to/my.bam @HD VN:1.0 GO:none SO:coordinate @SQ SN:1 LN:247249719 @SQ SN:2 LN:242951149 @SQ SN:3 LN:199501827 @SQ SN:4 LN:191273063 @SQ SN:5 LN:180857866 @SQ SN:6 LN:170899992 @SQ SN:7 LN:158821424 @SQ SN:8 LN:146274826 @SQ SN:9 LN:140273252 @SQ SN:10 LN:135374737 @SQ SN:11 LN:134452384 @SQ SN:12 LN:132349534 @SQ SN:13 LN:114142980 @SQ SN:14 LN:106368585 @SQ SN:15 LN:100338915 @SQ SN:16 LN:88827254 @SQ SN:17 LN:78774742 @SQ SN:18 LN:76117153 @SQ SN:19 LN:63811651 @SQ SN:20 LN:62435964 @SQ SN:21 LN:46944323 @SQ SN:22 LN:49691432 @SQ SN:X LN:154913754 @SQ SN:Y LN:57772954 @SQ SN:MT LN:16571 @SQ SN:NT_113887 LN:3994 若随后的比对记录中的contig那一列的顺序与头文件的顺序一致，且在头信息中包含SO:coordinate这个标签，则说明，该文件是排序过的 2、标记重复（Markduplicates） 标记文库中的重复 https://software.broadinstitute.org/gatk/documentation/tooldocs/current/picard_sam_markduplicates_MarkDuplicates.php gatk MarkDuplicates -I preprocess/T.chr17.sort.bam -O preprocess/T.chr17.markdup.bam -M preprocess/T.chr17.metrics --CREATE_INDEX 质量值校正 检测碱基质量分数中的系统错误，需要用到 GATK4 中的 BaseRecalibrator 工具 碱基质量分数重校准（Base quality score recalibration，BQSR)，就是利用机器学习的方式调整原始碱基的质量分数。它分为两个步骤: 利用已有的snp数据库，建立相关性模型，产生重校准表( recalibration table) 根据这个模型对原始碱基进行调整，只会调整非已知SNP区域。 注：如果不是人类基因组，并且也缺少相应的已知SNP数据库，可以通过严格SNP筛选过程（例如结合GATK和samtools）建立一个snp数据库。 注意：Base Recalibration是以read group为单位进行的，因此当一个BAM文件中包含了多个read group时，BaseRecalibrator会对每个read group分别建立校正模型 1、建立较正模型 质量值校正，这一步需要用到variants的known-sites，所以需要先准备好已知的snp，indel的VCF文件： # 下载known-site的VCF文件，到Ensembl上下载 $ wget -c -P Ref/mouse/mm10/vcf ftp://ftp.ensembl.org/pub/release-93/variation/vcf/mus_musculus/mus_musculus.vcf.gz \u003edownload.log \u0026 $ cd Ref/mouse/mm10/vcf \u0026\u0026 gunzip mus_musculus.vcf.gz \u0026\u0026 mv mus_musculus.vcf dbsnp_150.mm10.vcf # 建好vcf文件的索引，需要用到GATK工具集中的IndexFeatureFile，该命令会在指定的vcf文件的相同路径下生成一个以\".idx\"为后缀的文件 $ gatk IndexFeatureFile -F dbsnp_150.mm10.vcf # 建立较正模型 $ gatk BaseRecalibrator -R Ref/mouse/mm10/bwa/mm10.fa -I PharmacogenomicsDB/mouse/SAM/ERR118300.enriched.markdup.bam -O \\ PharmacogenomicsDB/mouse/SAM/ERR118300.recal.table --known-sites Ref/mouse/mm10/vcf/dbsnp_150.mm10.vcf 2、质量值校准 # 质量校正 $ gatk ApplyBQSR -R Ref/mouse/mm10/bwa/mm10.fa -I PharmacogenomicsDB/mouse/SAM/ERR118300.enriched.markdup.bam -bqsr \\ PharmacogenomicsDB/mouse/SAM/ERR118300.recal.table -O PharmacogenomicsDB/mouse/SAM/ERR118300.recal.bam ","date":"2020-02-19","objectID":"/bioinfo-q-a-40/:1:0","tags":["AQ100","call-snp"],"title":"【bioinfo】-Q\u0026A-40","uri":"/bioinfo-q-a-40/"},{"categories":["bioinfo","ngs"],"content":"深入了解snp-calling流程I ","date":"2020-02-19","objectID":"/bioinfo-q-a-39/:1:0","tags":["AQ100","call-snp"],"title":"【bioinfo】-Q\u0026A-39","uri":"/bioinfo-q-a-39/"},{"categories":["bioinfo","ngs"],"content":"GATK4流程 ","date":"2020-02-19","objectID":"/bioinfo-q-a-39/:2:0","tags":["AQ100","call-snp"],"title":"【bioinfo】-Q\u0026A-39","uri":"/bioinfo-q-a-39/"},{"categories":["bioinfo","ngs"],"content":"准备配套数据 要明确你的参考基因组版本了！！！ b36/b37/hg18/hg19/hg38，记住b37和hg19并不是完全一样的，有些微区别哦！！！ 下载hg19 这个下载地址非常多，常用的就是NCBI，ensembl和UCSC了，但是这里推荐用这个脚本下载（下载源为UCSC）： # 一个个地下载hg19的染色体 for i in $(seq 1 22) X Y M; do echo $i; wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/chromosomes/chr${i}.fa.gz; done gunzip *.gz # 用cat按照染色体的顺序拼接起来，因为GATK后面的一些步骤对染色体顺序要求非常变态，如果下载整个hg19，很难保证染色体顺序是1-22，X,Y,M for i in $(seq 1 22) X Y M; do cat chr${i}.fa \u003e\u003e hg19.fasta; done rm -fr chr*.fasta BWA: Map to Reference 建立参考序列索引 $ bwa index -a bwtsw ref.fa 参数-a用于指定建立索引的算法： bwtsw 适用于\u003e10M is 适用于参考序列\u003c2G (默认-a is) 可以不指定-a参数，bwa index会根据基因组大小来自动选择合适的索引方法 序列比对 $ bwa mem ref.fa sample_1.fq sample_2.fq -R '@RG\\tID:sample\\tLB:sample\\tSM:sample\\tPL:ILLUMINA' \\ 2\u003esample_map.log | samtools sort -@ 20 -O bam -o sample.sorted.bam 1\u003esample_sort.log 2\u003e\u00261 -R 选项为必须选项，用于定义头文件中的SAM/BAM文件中的read group和sample信息 The file must have a proper bam header with read groups. Each read group must contain the platform (PL) and sample (SM) tags. For the platform value, we currently support 454, LS454, Illumina, Solid, ABI_Solid, and CG (all case-insensitive) The GATK requires several read group fields to be present in input files and will fail with errors if this requirement is not satisfied ID：输入reads集的ID号； LB： reads集的文库名； SM：样本名称； PL：测序平台 查看SAM/BAM文件中的read group和sample信息： $ samtools view -H /path/to/my.bam | grep '^@RG' @RG ID:0 PL:solid PU:Solid0044_20080829_1_Pilot1_Ceph_12414_B_lib_1_2Kb_MP_Pilot1_Ceph_12414_B_lib_1_2Kb_MP LB:Lib1 PI:2750 DT:2008-08-28T20:00:00-0400 SM:NA12414 CN:bcm @RG ID:1 PL:solid PU:0083_BCM_20080719_1_Pilot1_Ceph_12414_B_lib_1_2Kb_MP_Pilot1_Ceph_12414_B_lib_1_2Kb_MP LB:Lib1 PI:2750 DT:2008-07-18T20:00:00-0400 SM:NA12414 CN:bcm @RG ID:2 PL:LS454 PU:R_2008_10_02_06_06_12_FLX01080312_retry LB:HL#01_NA11881 PI:0 SM:NA11881 CN:454MSC @RG ID:3 PL:LS454 PU:R_2008_10_02_06_07_08_rig19_retry LB:HL#01_NA11881 PI:0 SM:NA11881 CN:454MSC @RG ID:4 PL:LS454 PU:R_2008_10_02_17_50_32_FLX03080339_retry LB:HL#01_NA11881 PI:0 SM:NA11881 CN:454MSC ... read group信息不仅会加在头信息部分，也会在比对结果的每条记录里添加一个 RG:Z:* 标签 $ samtools view /path/to/my.bam | grep '^@RG' EAS139_44:2:61:681:18781 35 1 1 0 51M = 9 59 TAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAA B\u003c\u003e;==?=?\u003c==?=?=\u003e\u003e?\u003e\u003e\u003c=\u003c?=?8\u003c=?\u003e?\u003c:=?\u003e?\u003c==?=\u003e:;\u003c?:= RG:Z:4 MF:i:18 Aq:i:0 NM:i:0 UQ:i:0 H0:i:85 H1:i:31 EAS139_44:7:84:1300:7601 35 1 1 0 51M = 12 62 TAACCCTAAGCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAA G\u003c\u003e;==?=?\u0026=\u003e?=?\u003c==?\u003e?\u003c\u003e\u003e?=?\u003c==?\u003e?\u003c==?\u003e?1==@\u003e?;\u003c=\u003e\u003c; RG:Z:3 MF:i:18 Aq:i:0 NM:i:1 UQ:i:5 H0:i:0 H1:i:85 EAS139_44:8:59:118:13881 35 1 1 0 51M = 2 52 TAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAA @\u003c\u003e;\u003c=?=?==\u003e?\u003e?\u003c==?=\u003e\u003c=\u003e?-?;=\u003e?:\u003e\u003c==?7?;\u003c\u003e?5?\u003c\u003c=\u003e:; RG:Z:1 MF:i:18 Aq:i:0 NM:i:0 UQ:i:0 H0:i:85 H1:i:31 EAS139_46:3:75:1326:2391 35 1 1 0 51M = 12 62 TAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAA @\u003c\u003e==\u003e?\u003e@???B\u003eA\u003e?\u003eA?A\u003e??A?@\u003e?@A?@;??A\u003e@7\u003e?\u003e\u003e@:\u003e=@;@ RG:Z:0 MF:i:18 Aq:i:0 NM:i:0 UQ:i:0 H0:i:85 H1:i:31 ... 若原始SAM/BAM文件没有read group和sample信息，可以通过AddOrReplaceReadGroups添加这部分信息 $ java -jar picard.jar AddOrReplaceReadGroups \\ I=input.bam \\ O=output.bam \\ RGID=4 \\ RGLB=lib1 \\ RGPL=illumina \\ RGPU=unit1 \\ RGSM=20 ","date":"2020-02-19","objectID":"/bioinfo-q-a-39/:2:1","tags":["AQ100","call-snp"],"title":"【bioinfo】-Q\u0026A-39","uri":"/bioinfo-q-a-39/"},{"categories":["bioinfo","ngs"],"content":"前期处理 在进行本部分的操作之前先要做好以下两部的准备工作 创建GATK索引。用Samtools为参考序列创建一个索引，这是为方便GATK能够快速地获取fasta上的任何序列做准备 $ samtools faidx database/chr17.fa # 该命令会在chr17.fa所在目录下创建一个chr17.fai索引文件 生成.dict文件 $ gatk CreateSequenceDictionary -R database/chr17.fa -O database/chr17.dict GATK4的调用语法： gatk [--java-options \"-Xmx4G\"] ToolName [GATK args] 去除PCR重复 duplicates的产生原因 PCR duplicates（PCR重复） PCR扩增时，同一个DNA片段会产生多个相同的拷贝，第4步测序的时候，这些来源于同！一！个！拷贝的DNA片段会结合到Fellowcell的不同位置上，生成完全相同的测序cluster，然后被测序出来，这些相同的序列就是duplicate Cluster duplicates 生成测序cluster的时候，某一个cluster中的DNA序列可能搭到旁边的另一个cluster的生成位点上，又再重新长成一个相同的cluster，这也是序列duplicate的另一个来源，这个现象在Illumina HiSeq4000之后的Flowcell中会有这类Cluster duplicates Optical duplicates（光学重复） 某些cluster在测序的时候，捕获的荧光亮点由于光波的衍射，导致形状出现重影（如同近视散光一样），导致它可能会被当成两个荧光点来处理。这也会被读出为两条完全相同的reads Sister duplicates 它是文库分子的两条互补链同时都与Flowcell上的引物结合分别形成了各自的cluster被测序，最后产生的这对reads是完全反向互补的。比对到参考基因组时，也分别在正负链的相同位置上，在有些分析中也会被认为是一种duplicates。 用泊松分布解释 NGS 测序数据的 duplication 问题 我曾经有这样的疑惑，为什么文库构建过程中的 PCR 将每个文库分子都扩增了上千倍，以 PCR 10个循环为例 210= 1024 ，但是实际测序数据中 duplication 率并不高（低于20%） 有一篇文章从统计概率的角度详细探讨了一下 duplication 率的影响因素 PCR 的过程中不同长度的文库分子被扩增的效率不同（GC 太高或 AT 含量太高都会影响扩增效率），PCR 更倾向于扩增短片段的文库分子，这里先不考虑文库片段扩增效率的差异，把问题简化一下，假设所有文库分子扩增效率都相同。PCR duplicate 的主要来源是同一个文库分子的不同拷贝都在 flowcell 上生成了可以被测序的 cluster ，导致同一个分子的序列被测序仪读取多次。那么为何在每个分子都有上千个拷贝的情况下，实际却很少出现同一分子的多个拷贝被测序的情况呢？主要原因就是文库中 unique 分子的数量比被 flowcell 上引物捕获的分子数量多很多，直白点说就是 flowcell 上用于捕获文库分子的引物数量太少了，两者不在同一个数量级，导致很少出现同一个文库分子的多个拷贝被 flowcell 上引物捕获生成 cluster。 假设文库中所有分子与引物的结合都是随机的，简化一下就相当于，一个箱子中有 n 种颜色的球（文库中的 n 种 unique 分子），每种颜色有 1000 个（PCR 扩增的，随 cycle 数变化），从这个箱子中随机拿出来 k 个球（最终测序得到 k 条 reads），其中出现相同颜色的球就是 duplicate，那么 duplication 率就可以根据有多少种颜色的球被取出 0,1,2,3…… 次的概率计算，可以近似用泊松分布模型来描述。 以人全基因组重测序 30X 为例，PE150 需要约 3x108条 reads ，文库中 unique 分子数其实可以通过上机文库的浓度和体积（外加 PCR 循环数）计算出来，这里用近似值 3.5x1010 个 unique 分子。每个 unique 分子期望被测序的次数是 3x108/3.5x1010 = 0.0085 ，每个 unique 分子被测 0,1,2,3… 次的概率如下图： x \u003c- seq(0,10,1) xnames \u003c- as.character(x) xlab \u003c- “一个文库分子的所有拷贝被测序的次数” ylab \u003c- “概率” barplot(dpois(x,lambda = 0.0085), names.arg = xnames, xlab = xlab, ylab = ylab) 由于 unique 分子数量太多，被测 0 次的概率远高于 1 和 2 次，我们去除 0 次的看一下： unique 分子被测序 1 次的概率远大于 2次及以上，即便一个 unique 分子被测序 2 次，我们去除 duplicate 时候还会保留其中一条 reads。 如果降低文库中 unique 分子数量到 4.5x109个，PCR 循环数增加以便浓度达到跟上面模拟的情况相同，测序 reads 数还是 3x108 条，每个 unique 分子预期被测序的次数是 3x108/4.5x109 = 0.067 。 unique 分子数量减少，被测序 2次的概率增大，duplication 率显然也会增高。 到这里已经可以很明白的看出 duplication 率主要与文库中 unique 分子数量有关，所以建库过程中最大化 unique 分子数是降低 duplication 率的关键。文库中 unique 分子数越多，说明建库起始量越高，需要 PCR 的循环数越少，而文库中 unique 分子数越少，说明建库起始量越低，需要 PCR 的循环数越多，因此提高建库起始量是关键。 PCR bias的影响 DNA在打断的那一步会发生一些损失， 主要表现是会引发一些碱基发生颠换变换（嘌呤-变嘧啶或者嘧啶变嘌呤） ， 带来假的变异。 PCR过程会扩大这个信号， 导致最后的检测结果中混入了假的结果； PCR反应过程中也会带来新的碱基错误。 发生在前几轮的PCR扩增发生的错误会在后续的PCR过程中扩大， 同样带来假的变异； 对于真实的变异， PCR反应可能会对包含某一个碱基的DNA模版扩增更加剧烈（这个现象称为PCR Bias） 。 因此， 如果反应体系是对含有reference allele的模板扩增偏向强烈， 那么变异碱基的信息会变小， 从而会导致假阴。 探究samtools和picard去除read duplicates的方法 1、samtools samtools 去除 duplicates 使用 rmdup $ samtools rmdup [-sS] \u003cinput.srt.bam\u003e \u003cout.bam\u003e 只需要开始-s的标签， 就可以对单端测序进行去除PCR重复。其实对单端测序去除PCR重复很简单的，因为比对flag情况只有0,4,16，只需要它们比对到染色体的起始终止坐标一致即可，flag很容易一致。 但是对于双端测序就有点复杂了~ In the paired-end mode, this command ONLY works with FR orientation and requires ISIZE is correctly set. It does not work for unpaired reads (e.g. two ends mapped to different chromosomes or orphan reads). 很明显可以看出，去除PCR重复不仅仅需要它们比对到染色体的起始终止坐标一致，尤其是flag，在双端测序里面一大堆的flag情况，所以我们的94741坐标的5个reads，一个都没有去除！ 这样的话，双端测序数据，用samtools rmdup效果就很差，所以很多人建议用picard工具的MarkDuplicates 功能 2、picard picard对于单端或者双端测序数据并没有区分参数，可以用同一个命令！ 对应单端测序，picard的处理结果与samtools rmdup没有差别，不过这个java软件的缺点就是奇慢无比 ","date":"2020-02-19","objectID":"/bioinfo-q-a-39/:2:2","tags":["AQ100","call-snp"],"title":"【bioinfo】-Q\u0026A-39","uri":"/bioinfo-q-a-39/"},{"categories":["bioinfo","ngs"],"content":"第38题 当转录组普遍变化时RNA-Seq怎么进行分析(2)？ Hello 大家好！ 我们又见面了！ 当出现这种所谓特殊情况的时候，可以使用Housekeeping gene的办法来进行相对定量，这种办法在一定程度上能够解决我们遇到的问题。但其实这种办法有一个非常强的先验假设：housekeeping gene的表达量不怎么发生变化。其实housekeeping gene list有几千个，这几千个基因有一定程度上的变化是有可能的。 有什么办法能够在RNA-Seq中对gene的定量起到“一锤定音”的作用呢？答案就是我们今天为大家介绍的spike-in方法，即在RNA-Seq建库的过程中掺入一些预先知道序列信息以及序列绝对数量的内参。这样在进行RNA-Seq测序的时候就可以通过不同样本之间内参（spike-in）的量来做一条标准曲线，就可以非常准确地对不同样本之间的表达量进行矫正。在这种操作下，可以一定程度上认为是一种绝对定量。 那么，有没有比较常用的spike-in类型呢？嘿嘿嘿～这是当然的啦！这个就是大名鼎鼎的ERCC Control RNA. ","date":"2020-02-19","objectID":"/bioinfo-q-a-38/:1:0","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-38","uri":"/bioinfo-q-a-38/"},{"categories":["bioinfo","ngs"],"content":"1. 什么是ERCC ? ERCC = External RNA Controls Consortium ERCC就是一个专门为了定制一套spike-in RNA而成立的组织，这个组织早在2003年的时候就已经宣告成立。主要的工作就是设计了一套非常好用的spike-in RNA，方便microarray，以及RNA-Seq进行内参定量。 ERCC 官方网站 https://www.nist.gov/programs-projects/external-rna-controls-consortium ","date":"2020-02-19","objectID":"/bioinfo-q-a-38/:1:1","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-38","uri":"/bioinfo-q-a-38/"},{"categories":["bioinfo","ngs"],"content":"2. ERCC control RNA具体是什么？ 目前常用的ERCC版本内包含了176条RNA序列，这些RNA序列是从一些物种的DNA转录得到的，编号从ERCC-00001到ERCC-00176，所有对应的编号的序列全部可以从网上直接搜索下载。 目前，已经有非常成熟的商业化的ERCC序列，其中的176条RNA组成的一个库（pool）也是经过特殊设计的。不是简单的等量混合，而是不同的pool会对176条序列分成很多小库（subpool），然后通过不同的比例对这些subpool进行混合，然后形成不同的配比比例。在购买商业化的ERCC序列时，一定要注意下载对应版本的绝对定量信息。当然，有些商业化的ERCC里面也不是包含全部176条标准序列。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-38/:1:2","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-38","uri":"/bioinfo-q-a-38/"},{"categories":["bioinfo","ngs"],"content":"3. ERCC control在不同样本之间的表现是否良好？ 目前的实验数据表明，ERCC spike-in的掺入效果还是非常不错的。这里引用了Thermo商品中的一张数据图。 图3 ERCC绝对量与RPKM的关系 (https://www.thermofisher.com/order/catalog/product/4456740) 图3表明，在RNA-Seq中增加ERCC的绝对量是可以获得FPKM的绝对量的增加，并且两者成非常好的线性关系。这也是我们能够对RNA-Seq样本进行掺入内参的一个基本前提。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-38/:1:3","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-38","uri":"/bioinfo-q-a-38/"},{"categories":["bioinfo","ngs"],"content":"4. R里面可以使用哪个包来进行相关的操作？ 说了这么多，那么如果真的有一套带有ERCC spike-in的RNA-Seq数据，我们应该怎么分析呢？其实在2014年的时候Nature Biotech上面发表了一篇文章，专门描述了怎么对数据进行分析，还顺手publish了一个R包，并且我认真阅读并实战过这个R包，从文档到结果都很靠谱。 这个R包的名称是 RUVSeq，链接为： https://bioconductor.org/packages/release/bioc/html/RUVSeq.html 如果大家真的有需求，就直接follow这篇文章来进行学习就可以了。图5就是给大家展示一下使用ERCC spike-in矫正以后的结果。 图5 矫正与不矫正基因表达量的boxplot ","date":"2020-02-19","objectID":"/bioinfo-q-a-38/:1:4","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-38","uri":"/bioinfo-q-a-38/"},{"categories":["bioinfo","ngs"],"content":"第37题 当样本转录组普遍变化时RNA-Seq怎么进行分析(1)？ Hello 大家好！我们又见面了！ RNA-Seq使用RPKM/FPKM/TPM指标定量时的2个基本假设： 1是绝大多数的gene表达量不变； 2是高表达量的gene表达量不发生改变； 可是在一些比较特殊的样本体系下，这两个基本假设有可能不能同时符合。比如针对很多癌症样本，经常会出现一些很重要的高表达gene发生普遍的上调或者下调，从而导致整个样本不符合RNA-Seq正常定量的基本假设。那么这个时候，如果继续使用常规的寻找差异表达的方法来对基因进行定量以及分析，就可能会出现偏差，而出现偏差的具体原因已经在之前的第36题为大家详细解释过了。我们今天主要讨论的是怎么矫正的问题。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-37/:1:0","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-37","uri":"/bioinfo-q-a-37/"},{"categories":["bioinfo","ngs"],"content":"1. 当样本转录本不符合常规假设时，RNA-Seq定量矫正的常用方法 其实，矫正的思路很简单，就是在变化的样本中寻找不变的量。那么在不同的样本中，什么可以认为是不变的量呢？在RNA-Seq中一般是2种操作办法，第1种是认为持家基因（Housekeeping gene）的表达量在样本中是基本不变的；第2种是需要在RNA-Seq建库的过程中就掺入一些预先知道浓度和具体分子量的spike-in作为内参，然后使用内参进行矫正。我们今天来为大家介绍第1种办法。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-37/:1:1","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-37","uri":"/bioinfo-q-a-37/"},{"categories":["bioinfo","ngs"],"content":"2. 什么是持家基因（Housekeeping gene）？ 持家基因，也有人翻译成管家基因，对应的英文就是Housekeeping gene，是指在生物体内所有细胞中都表达，并且为维持细胞基本生命活动所需而时刻都在表达的高度保守的基因。一般在不同的细胞中，我们都认为Housekeeping gene一般情况下表达量不发生很大的改变。比如在做qPCR的时候，经常选用GAPDH或者是TUBB这两个gene作为内参就是非常经典的Housekeeping gene。关于Housekeeping gene更详细的说明，可以参考Wiki百科的资料：Wiki: Housekeeping gene ","date":"2020-02-19","objectID":"/bioinfo-q-a-37/:1:2","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-37","uri":"/bioinfo-q-a-37/"},{"categories":["bioinfo","ngs"],"content":"3. Human常用的Housekeeping gene 怎么确定？ 因为我做的课题主要都是以人为研究对象，因此我在这里为大家介绍一下human中常用housekeeping gene是怎么确定的。目前大家用的比较多的一个human housekeeping gene list 来源于下面这篇文章，是2013年发表在 Cell系列的 Trends in Genetics 部分的一篇文章。 文章链接： https://www.cell.com/trends/genetics/fulltext/S0168-9525(13)00089-9 这篇文章中主要搜集了非常多的RNA-Seq数据，以及microarray数据，并把这些数据进行统一的分析与整理，最终得到了一个作者认为比较可靠的housekeeping gene的list。目前这个list中大约包含了3000多个gene。这个gene list的下载地址我也给分享给大家 在我们得到了这样1个housekeeping gene list以后，就可以在分析的过程中认为这些gene的表达量是不怎么发生变化的，即使发生了一定的变化，也只是个别的发生了一定程度的改变，而不是这3000多个gene整体大幅度发生改变。在这个假设的基础上，我们就可以用这3000多个gene做1根标准曲线，然后就可以根据线性回归的结果对不同样本之间原来的RPKM/FPKM/TPM进行矫正，从而得到一个通过housekeeping gene矫正过后的定量结果，通常情况下，这个定量的结果会更加稳定和准确，即能够完成我们的定量任务。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-37/:1:3","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-37","uri":"/bioinfo-q-a-37/"},{"categories":["bioinfo","ngs"],"content":"4. 问题和提问 那么今天的问题是，请下载Housekeeping gene list，并查看文件内容，请思考使用housekeeping gene矫正有什么缺陷？ (1)存在假基因(pseudogene)，会引发基因组 DNA 的扩增； (2)表达值太高或太低； (3)不稳定表达于不同类型的细胞和组织(如正常细胞和癌细胞)中，而且其表达量存在显著性差异； (4)表达水平与细胞周期及细胞是否活化有关； (5)其稳定的表达水平与目标基因存异； (6)受内源性或外源性因素的影响。 内参基因的选取过程也是利用 qPCR 定义持家基因的过程。通常选取几个到十几个候选内参基因，通过扩增得到它们在不同组织中的 qPCR 表达数据后，主要利用 geNorm[37]和 NormFinder[38] 两种软件来检测候选基因表达水平的稳定性，选取稳定表达 的基因作为持家基因，即内参基因。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-37/:1:4","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-37","uri":"/bioinfo-q-a-37/"},{"categories":["bioinfo","ngs"],"content":"第36题 RNA-Seq 数据的定量基本假设以及TPM Hello 大家好！ 我们在BBQ35中为大家介绍了RPKM和FPKM的原理以及计算方法，我们也说FPKM/RPKM有一个比较明显的缺点，就是不能够保证不同样本之间FPKM的总和是一个定值。因此才会引出我们今天的介绍内容TPM。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-36/:1:0","tags":["AQ100","RNA-Seq","TPM"],"title":"【bioinfo】-Q\u0026A-36","uri":"/bioinfo-q-a-36/"},{"categories":["bioinfo","ngs"],"content":"1. TPM的介绍 TPM = Transcripts Per Million， 简单来说就是为了解决FPKM 总和不一致的情况。具体计算的方法如下： 1. 先计算每一个gene的FPKM 2. 计算所有gene的FPKM总和sum(FPKM) 3. 最终gene的TPM = gene的FPKM / sum(FPKM) * 10^6 再简单一点说明，gene的TPM就是其FPKM百分数再乘以106，因此一个样本的TPM的总和一定是106. 这样做的好处就是能够把所有样本的TPM总和统一，都变成10^6。目前很多公共数据的数据都是以TPM的方式提供，比如非常著名的GTEx数据库，提供了超过10000个人组织RNA-Seq的测序表达量矩阵，其中的表达量定量方式就选择了TPM。 GTEx项目主页 （https://gtexportal.org/home/） ","date":"2020-02-19","objectID":"/bioinfo-q-a-36/:1:1","tags":["AQ100","RNA-Seq","TPM"],"title":"【bioinfo】-Q\u0026A-36","uri":"/bioinfo-q-a-36/"},{"categories":["bioinfo","ngs"],"content":"2. RPKM/FPKM/TPM什么情况下会定量失败？ 说了半天，其实大家一定要先搞明白一个问题，无论是RPKM还是FPKM，亦或是TPM，本质上都是gene 表达水平的相对定量结果。 这个结论非常重要！！！这个结论非常重要！！！这个结论非常重要！！！ 也正是因为RNA-Seq的相对定量结果，会有2种情况导致RNA-Seq定量失败； 2.1 第1种情况：gene表达量发生普遍变化。 我给大家举一个非常简单的例子，比如我有两个样本分别叫做A和B，其中B的每一个gene表达量都只有对应样本A中的gene表达量的一半，那么结果就是如果使用RNA-Seq对这两个样本进行定量，那么定量的结果会是一样的，也就是两者计算的RPKM/FPKM/TPM会是一样的。 通过上面的例子，我们可以作出一些推论：当两个样品中的绝大多数gene都发生相同方向的倍增或者倍减关系的时候，RNA-Seq会定量失效。这个非常重要！比如在很多癌症样本与正常组织样本的比较中，癌症样本很多时候会出现很多gene的普遍升高或者普遍降低，这个时候就需要其他特殊的办法来解决这样的问题，具体的方法后面我们会介绍。不过这种现象一般比较少见，几种常见需要考虑这个问题的情况：某些特殊表达细胞体系；很多癌症的miRNA-Seq 等。 2.2 第2种情况，超高表达量的gene表达量发生变化 思考一下这种情况：有两类细胞，分别是cell1和cell2，真实的情况是geneA本身是一个表达量很高的gene，同时在cell2中，geneA的表达量继续升高数倍，同时其他gene的表达量几乎不变。这个时候我们对这两种情况进行RNA-Seq建库测序，结果就会是发现其他gene普遍下调，而不仅仅是geneA的上调。如图3所示，最后建库的时候，会测到非常多的geneA的reads，其他gene的reads就会相对减少，所以会造成其他gene RPKM/FPKM/TPM下降的假象。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-36/:1:2","tags":["AQ100","RNA-Seq","TPM"],"title":"【bioinfo】-Q\u0026A-36","uri":"/bioinfo-q-a-36/"},{"categories":["bioinfo","ngs"],"content":"3. 提问与总结 一般在RNA-Seq分析的过程中，我们都必须默认两个基本假设： 1是绝大多数的gene表达量不变； 2是高表达量的gene表达量不发生改变； 如果没有这2个基本假设，那么后续的找差异gene基本上是无从谈起，即便找到了所谓的差异表达gene也基本上是个错误的结论。 那么今天我们的问题是：既然RNA-Seq是相对定量的一个实验，那么有没有办法通过什么办法让其能够变成绝对定量的方法？使其真的遇到绝大多数的gene表达量变化或者是高表达量的gene表达量变化的时候能够继续成功定量？ 谢晓亮老师在2012年出来了有一种绝对定量的方法，在文库扩增之前的每一个RNA片段加上一个标签（UID），那么同一个片段扩增出来的都带有同种标签。利用UID过滤数据，将相同的产物进行合并，既可以去掉PCR中的重复，而且也可以达到定量的目的. Digital RNA sequencing minimizes sequence-dependent bias and amplification noise with optimized single-molecule barcodes（PNAS. 2012, 109(4):1347-52） 此外我认为还是通过实验的qRCR然后绘制标准曲线去定量，两个方法各有千秋，原理都不一样。还是看看趋势能否一致。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-36/:1:3","tags":["AQ100","RNA-Seq","TPM"],"title":"【bioinfo】-Q\u0026A-36","uri":"/bioinfo-q-a-36/"},{"categories":["bioinfo","ngs"],"content":"第35题 RNA-Seq 数据的定量之RPKM和FPKM Hello大家好！好久不见了！ 根据之前的规划，我们将用接下来的几期问题来探索一下RNA-Seq定量的问题，也就是要探索一下我们常说的RPKM，FPKM，TPM，raw count 和RSEM，前面4个指标都比较直观，方便理解，最后一个RSEM需要涉及到一些机器学习的知识，我们尽量给大家把比较复杂的问题简单化，方便大家的入门。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-35/:1:0","tags":["AQ100","RNA-Seq","RPKM","FPKM"],"title":"【bioinfo】-Q\u0026A-35","uri":"/bioinfo-q-a-35/"},{"categories":["bioinfo","ngs"],"content":"RNA-Seq定量过程中的比较问题 RNA-Seq的基本假设是什么？简单来说就是 细胞/组织/个体 的两种不同状态进行比较，比较的目的就是寻找差异表达gene，然后从差异表达gene来推断造成生理状态不同的原因。 而我们的RNA-Seq一般情况下是针对mRNA以及带polyA的lncRNA进行建库测序分析的。那么理论上把测序的FASTQ文件mapping到参考基因组上，再结合参考基因组的GTF/GFF文件就可以找到全基因组的每一个gene上mapping到了多少个reads count。 拿到了reads count以后，我们就会尝试着想要比较gene之间的表达量的关系，但是这时候往往会面临两个问题，举个例子： 问题1: 比如我有gene3，有1000条测序reads，gene4有2000条测序reads，那么我能否说gene4就一定比gene3的表达量高？（图1 gene3 与 gene4） 问题2: 比如我有gene1，有1000条测序reads，我的另一个处理条件下gene2有2000条测序reads，我能否就说geneA在处理条件下表达量降低了？（图1 gene1与gene2） 在面临这些比较问题的时候，我们就需要对mapping到gene的reads count进行矫正，至少根据问题1我们知道应该在矫正的时候考虑过gene长度的问题；根据问题2，我们大概应该能够猜想到，矫正的时候应该需要考虑整体测序量的问题。到此，RPKM和FPKM这两个指标就应运而生了。 图1 ( Manuel Garber et al., Nature Methods, 2011 ) ","date":"2020-02-19","objectID":"/bioinfo-q-a-35/:1:1","tags":["AQ100","RNA-Seq","RPKM","FPKM"],"title":"【bioinfo】-Q\u0026A-35","uri":"/bioinfo-q-a-35/"},{"categories":["bioinfo","ngs"],"content":"什么是RPKM与FPKM？ RPKM = Reads Per Kilobase per Million mapped reads 假设回贴到geneA 的 reads count为 CountA，geneA的exon总长度为Len(A) Kbp，总的测序量为D兆reads，那么： geneA RPKM = CountA / Len(A) / D * 10^9 那么什么是FPKM呢？先来看一下FPKM的定义： FPKM = Fragments Per Kilobase per Million mapped reads 大家可以比较清楚看出来，RPKM中的R指的是Reads，FPKM中的F是指Fragments，Reads都比较好理解，就是我们的测序短的片段，那么fragment是什么呢？这是以为我们现在测序一般来说都是测双端测序（paired-end sequencing），那么在mapping回参考基因组的时候就会有两条reads，分别是read1和read2，分别来源于建库打断的5’ 端和3’端。那么这2条reads就可以在参考基因组上确定1个小的片段，这个片段就叫fragment（图2所示）。 图2 （Frances S. Turner） 所以，如果是现在最常用的双端测序，1个gene的FPKM应该等于RPKM / 2。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-35/:1:2","tags":["AQ100","RNA-Seq","RPKM","FPKM"],"title":"【bioinfo】-Q\u0026A-35","uri":"/bioinfo-q-a-35/"},{"categories":["bioinfo","ngs"],"content":"RPKM / FPKM有什么优缺点？ 因为现在使用Illumina测序平台，绝大多数的测序都是使用双端测序，那么基本上我们一般对gene进行定量都是使用FPKM来进行。FPKM的优点大家都很了解了，能够矫正掉gene长度以及测序深度对gene表达定量的影响，那么FPKM的缺点大家是否熟悉呢？ 一个比较容易被人提及的问题是对于不同批次测序的结果，所有gene的FPKM的总和不是一个固定的值。比如WT测的所有gene的FPKM总和可能是10000，treat组测到的FPKM总和可能是15000，这样对于WT和treat组之间的差异表达gene的寻找就有可能出现问题，这个时候就需要用到我们常用的另一种矫正方法TPM。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-35/:1:3","tags":["AQ100","RNA-Seq","RPKM","FPKM"],"title":"【bioinfo】-Q\u0026A-35","uri":"/bioinfo-q-a-35/"},{"categories":["bioinfo","ngs"],"content":"第34题 做RNA-Seq的数据分析逻辑是怎样的？ Hello 大家好！我们又见面了！ ","date":"2020-02-19","objectID":"/bioinfo-q-a-34/:1:0","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-34","uri":"/bioinfo-q-a-34/"},{"categories":["bioinfo","ngs"],"content":"为什么要做RNA-Seq？ 先来谈谈为什么要做RNA-Seq。假设我们没有RNA-Seq技术，当我们看到经过某1个条件/刺激/处理以后，我们的研究对象，细胞，植株，亦或是可爱的小白鼠有了一些变化。这个时候我们通过观察和实验得到了1个判断： 当对A进行B刺激的时候会出现表型C。 当有了这个判断以后，正常的推理思路是，表型的出现很大可能是由于研究对象的蛋白含量的变化引起的。而蛋白的含量最直接的控制就来自于gene表达的变化。如果我们能够有办法测量A在进行B刺激以后全部的gene表达变化的gene list D，理应能够得到下一个判断： 当对A进行B刺激的时候会出现表型C，而这个表型C造成的原因很有可能是来自于D这些基因的变化。 但是这里有个问题，这个刺激需要是一种比较稳定的条件，比如对细胞系进行稳定敲除（knock out）一个gene；再比对用药物持续对植株进行喷洒等等。而不能是，我向细胞盘吐了口唾液，然后立即建库去测RNA-Seq。这是因此，我们在推断表型C造成的原因的时候，认为是gene的表达造成的，而从信号响应，到最终的gene表达的变化是需要时间的。因此，刺激以后，过一段时间以后才会出现变化，一般这个时间间隔是以小时为单位计算的。 因此，当我们认为表型C和刺激B之间是由于gene list D影响的，那么我们就要做RNA-Seq。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-34/:1:1","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-34","uri":"/bioinfo-q-a-34/"},{"categories":["bioinfo","ngs"],"content":"为什么能做RNA-Seq？ 那么，我们为什么能做RNA-Seq？貌似是一个很简单的问题，其实不然，这是几十年技术的积累。让RNA-Seq能够走进“寻常百姓家“的原因有很多，能轻而易举想到的：测序费用的降低；基因组的公布/相关物种基因组的公布；分子生物学技术的成熟等等。 想象一下，如果有一天我们突然不能做RNA-Seq了，那么我们再去想做我们判断的检验就可要1个gene挨着1个gene的去做qRT-PCR了！或者是做价格和准确不不如测序的micro array检测。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-34/:1:2","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-34","uri":"/bioinfo-q-a-34/"},{"categories":["bioinfo","ngs"],"content":"拿到数据以后我们应该做点什么？ 还是回到我们之前的判断： 当对A进行B刺激的时候会出现表型C，而这个表型C造成的原因很有可能是来自于D这些基因的变化 核心问题是找到这个gene list D，而这个问题的本质就是去寻找对A进行B刺激前后的差异。那么差异又可以分成几个方向去寻找： 方向1. 表达量的差异； 方向2. 可变剪切的差异； 方向3. 修饰的差异； 方向4. 其他可能存在调控机制的差异； 针对不同的方向去寻找差异，方法也是不同的，比如方向1,2,3的分析方法就有非常大的不同。而选定方向以后，寻找差异的思路又可以扩展开： 1. 差异与whole genome相比是否有一定的分布倾向性？ 2. 差异是个例还是具有普遍性？（更换细胞系是否能重复？） 3. 差异与表型是否有统计学相关性？ ... ... 当我们确定了方向与寻找差异思路以后，最后一步就是去展示分析结果，说直白些就是数据可视化。好的图表可以让人一眼就看出差异所在，不用文字就知道作者要表达的意思。数据可视化这方面，有非常多的工具可以使用比如R就非常方便。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-34/:1:3","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-34","uri":"/bioinfo-q-a-34/"},{"categories":["bioinfo","ngs"],"content":"第33题 什么是链特异性的RNA-Seq？ Hello 大家好！我们又见面了。 最近，我们一直在围绕着RNA-Seq的相关技术在进行讨论，我们聊过了polyA+与rRNA-的建库策略问题，我们也聊过了测序深度与测序仪通量的问题，那么今天我们来聊一下链特异性RNA-Seq的建库问题。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-33/:1:0","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-33","uri":"/bioinfo-q-a-33/"},{"categories":["bioinfo","ngs"],"content":"1.什么是链特异性建库与链非特异性建库RNA-Seq 图1-1 链特异性建库与非特异性建库示意图 （Zhao et al., BMC Genomics，2015） 在RNA-Seq建库的时候，第一步都是进行RNA到cDNA的反转录，在反转录以后，普通的RNA-Seq就直接使用random primer进行第2条链合成，随后加adapter。这样构建出来的RNA-Seq库进行测序以后是分不清这个序列是来自于genome的那条链的，因为被测序的有可能是gene的foward strand 也有可能是reverse strand。 而链特异性的RNA-Seq建库是通过一定的建库策略，让RNA在反转录和加adapter的过程以后还能够保存链的信息的建库策略。如图1-2所示，红色的reads表示mapping到了genome的foward strand，蓝色的reads表示mapping到了genome的reverse strand。对于这个gene来说，它本身存在于foward strand，链特意建库的F图就完全能够说明这个现象；但是G图是普通的RNA-Seq建库，也就是不区分链的信息，因此在这个foward strand gene附近的reads有mapping到foward strand的，也有mapping到reverse strand的情况。 图1-2 F为链特异性建库，G为非特异性建库（Dmitri Parkhomchuk et al., NAR, 2009） ","date":"2020-02-19","objectID":"/bioinfo-q-a-33/:1:1","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-33","uri":"/bioinfo-q-a-33/"},{"categories":["bioinfo","ngs"],"content":"2.链特异性建库的优势与劣势 那么链特异性RNA-Seq的优势在于哪里呢？是在于它能够处理一些gene overlap比较复杂的情况。我们都知道，几乎所有高等生物的gene在genome中的分布都是非均匀的，而且一般都是没有链的偏好性。换句话说，两个gene重叠，一个在foward strand，一个在reverse strand是很常见的显现，如图2-1所示。 图2-1 genome两条链都存在gene的情况（Joshua Z Levin et al., Nature Methods, 2010） 如果是普通的RNA-Seq，是分不清这些overlap区域的reads到底来自于哪一个gene，这就给定表达量带来了非常大的麻烦。但是链特异性的RNA-Seq就不会，如果只是foward strand的gene表达那么reads就只会mapping到对应的链上。 所以，用链特异性的建库方法，是能够更加准确进行gene定量的。 至于链特异性建库的劣势，大概有2点吧：1个是贵，1个是操作复杂对于珍贵样品（比如人体组织样品）一旦建库不成功就game over了。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-33/:1:2","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-33","uri":"/bioinfo-q-a-33/"},{"categories":["bioinfo","ngs"],"content":"3.链特异性建库的方法有几种，最常用的是哪种? 至于链特异性的建库方法，现在有若干种，但是最常用的其实是2种，1种是RNA ligation methods；1种是dUTP method。 3.1 RNA ligation method 图3-1 RNA ligation methods（Joshua Z Levin et al., Nature Methods, 2010） 这种方法的本质上就是对mRNA先加上adatper再进行反转录，这样所有的就能保存序列信息都是5’ adapter -\u003e gene -\u003e 3’ adapter的顺序。因此能够进行链特异性建库。 3.2 dUTP methods 图3-2 dUTP method （Joshua Z Levin et al., Nature Methods, 2010） 这种方法是在合成第2条cDNA链的时候，把dTTP换成dUTP，这样DNA中原来T的位置就全都变成了U，随后两边加上adapter序列。到这里，是存在两种情况的。 第1种情况：5' adapter -\u003e gene -\u003e 3' adapter 第2种情况：5' adapter -\u003e gene 反向互补 -\u003e 3' adapter 但是，无论是这2中情况中的哪一种，gene的反相互链中都原来的T都被替换成了U，这时候我们使用USER酶就可以特异性降解带有U的那条链。因此这时候就只能保存第1种情况了。因此也就可以进行链特异性的测序。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-33/:1:3","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-33","uri":"/bioinfo-q-a-33/"},{"categories":["bioinfo","ngs"],"content":"4.提问环节 4.1 第1个问题是我刚学生信的时候的一个疑问， 对于普通的RNA-Seq建库来说，衡量gene表达量，对于foward gene来说，如果有互补链的reads，在计算FPKM的时候需不需要把互补链的reads都去掉？如果是链特异性的RNA-Seq建库呢？为什么？ 个人认为，如果是普通的RNA-seq的建库，它没有区分正链负链是无法把互补链的reads去掉的。因为分不清楚，而且在进行FPKM计算的时候，结果可能会偏高！如果是链特异的RNA-seq建库的话，肯定是需要去掉互补链的。两个gene重叠，一个在foward strand，一个在reverse strand是很常见的显现，在计算的时候，算一条链就行了。 4.2 第2个问题，请结合我们的Bioconductor教程来进行。请尝试分析human genome gene 的overlap的情况。 library(GenomicRanges) ## 包的导入 if (!requireNamespace(\"BiocManager\", quietly = TRUE)) install.packages(\"BiocManager\") BiocManager::install(\"EnsDb.Hsapiens.v75\", version = \"3.8\") ###到这一步是进行人类参考基因组的下载 library(EnsDb.Hsapiens.v75 ) ##参考基因组的导入 ensembl.hg38 =EnsDb.Hsapiens.v7 ##赋值一下 ensembl.hg38.gene=genes(ensembl.hg38)##进行把人类基因取出来 length(ensembl.hg38.gene)##看一下长度 [1] 64102 reduce(ensembl.hg38.gene) ##利用reduce函数看一下结果 length(reduce(ensembl.hg38.gene)) [1] 53110 ","date":"2020-02-19","objectID":"/bioinfo-q-a-33/:1:4","tags":["RNA-Seq","AQ100"],"title":"【bioinfo】-Q\u0026A-33","uri":"/bioinfo-q-a-33/"},{"categories":["bioinfo","ngs"],"content":"第32题 1个RNA-Seq样本到底要测多少序列？ 我们讨论了到底选择哪种策略进行建库，主要就是polyA + 和 rRNA-这两种方式。在选定建库策略以后，我们自然会问一个问题，如果我们去做RNA-Seq每个重复到底要测多少测序量呢？ ","date":"2020-02-19","objectID":"/bioinfo-q-a-32/:1:0","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-32","uri":"/bioinfo-q-a-32/"},{"categories":["bioinfo","ngs"],"content":"先聊聊测序价格 我们这里讨论的问题，都是以Illumina公司的二代测序为准。目前市面上公司能够提供测序服务的，大多数是Illumina的HiSeq平台，HiSeq X平台，NextSeq平台以及通量最高的NovaSeq平台。以上这些平台，在平时实验中我们都是进行双端150bp的测序模式，也就是我们常说的paired-end 150bp，所以一对reads的通量是150bp X 2 = 300bp 注：下问中提到所有测序仪参数全部来自于Illumina官网！ 1.1 HiSeq系列 HiSeq系列的参数如图1-1所示，最常用的是HiSeq2500与HiSeq4000。HiSeq系列目前已经逐渐被边缘化或者是定制化，主要是用来做定制测序双端 250 bp的测序，或者单端50bp的测序。根据定制的模式不同，价格也不同。平均下来，价格大约是100~ 120 RMB / 1Gbp 图1-1 HiSeq系列平台参数 1.2 HiSeq X Ten测序仪 这个型号的测序仪是目前市场上的主力，1个flowcell可以有8条lane，每条lane可以产生100~120Gbp的测序数据，包lane的价格大约在8000RMB ~ 10000RMB左右，平均下来的价格是80 ~ 100RMB / Gbp 图1-2 Illumina HiSeq X Ten测序仪 1.3 测序最快的NextSeq系列 NextSeq采用了最新的双色荧光系统，而不是Illumina以前的四色荧光系统，因此运行速度大大提升，大约1天左右的时间就可以完成上机测序（HiSeq大约是3到4天），这个测序仪只有在我们对样本和实验比较着急的时候才会使用。价格也会比HiSeq系列高若干倍。不过，NextSeq的出现，给我们提了个醒，Illumina以后会通过逐渐优化测序仪站稳医院临床快速检测的脚跟。 1.4 通量最高，最便宜的NovaSeq系列 NovaSeq系列测序仪没有lane的概念，是一个完整的flowcell，运行一次可以产生6Tbp左右的数据。如果你想测个几百个样品，那么NovaSeq绝对是你的首选。现在市场价大约可以压缩到40~50RMB/Gbp ","date":"2020-02-19","objectID":"/bioinfo-q-a-32/:1:1","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-32","uri":"/bioinfo-q-a-32/"},{"categories":["bioinfo","ngs"],"content":"对于human来说RNA-Seq需要测多深？ 这个问题之前已经有人专门研究过，实验方案就是先把样品测很深比如50M pair（1M = 10^6），然后去随机抽取若干序列，比如每隔10M做一次抽样，再去计算每一次抽样结果的FPKM值，最后看基因的FPKM在多少测序量的时候能够稳定。根据图2-1所示，大约到了30M reads 的时候就可以稳定找出差异表达基因。 图2-1 探索测序量与差异表达基因的关系 （Yuwen Liu et al., 2014, Bioinformatics） 同时，ENCODE计划里面也公布了RNA-Seq的数据测序标准，在ENCODE的标准中原文如下： \\1. Replicate number: Experiments should be performed with two or more biological replicates. \\2. Sequencing depth: 30M pair-end reads of length \u003e 30NT, of which 20-25M are mappable to the genome or known transcriptome. 简单翻译一下，就是要求生物学重复不少于2个，如果是估算表达量的情况下30M paried end reads就差不多了，同时最好能够保证其中的20~25M的paried reads都能回贴到参考转录组中。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-32/:1:2","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-32","uri":"/bioinfo-q-a-32/"},{"categories":["bioinfo","ngs"],"content":"提问环节 3.1 对于human来说，genome大约为3Gbp，可以转录的区域大约是30%左右的genome，但是gene的exon只有不到whole genome的10%，在这种情况下我们需要测30M paired-end reads才可以比较好的衡量差异表达基因。如果换一个物种，我们又该怎么去判断如何定测序量呢？ 3.2 算算账吧，如果一个样本测30M paired-end reads，那么以目前的市场价格，测序需要花多少钱？还可以算算一个常规的RNA-Seq实验的测序经费是多少？ 但是因为还需要生物学重复。对于临床的样本和普通的细胞样本来说的话是不一样的。 如果是普通的细胞系的话3-4个重复，咱们按3个重复计算一个样品的话是540x3=1620RMB 。但是对于临床的肿瘤样品来说的话，是需要6-8个重复（因为肿瘤的差异比较大）。按6个计算，一般要一个肿瘤样本，一个癌旁样本，这样就是540x6x2=6480 RMB ","date":"2020-02-19","objectID":"/bioinfo-q-a-32/:1:3","tags":["AQ100","RNA-Seq"],"title":"【bioinfo】-Q\u0026A-32","uri":"/bioinfo-q-a-32/"},{"categories":["bioinfo","ngs"],"content":"第31题 RNA-Seq建库用哪种策略？ Hello 大家好！ 我们又见面了！ 我们将与大家一同讨论与转录组建库，基因的差异表达分析等相关的内容。 今天我们讨论的是RNA-Seq建库策略问题。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-31/:1:0","tags":["AQ100","RNA-seq"],"title":"【bioinfo】-Q\u0026A-31","uri":"/bioinfo-q-a-31/"},{"categories":["bioinfo","ngs"],"content":"什么是RNA-Seq建库 RNA-Seq建库简单来说，就是把我们想要进行转录组测序的样品（一盘细胞，若干片叶子等）提取RNA，并给RNA（主要是mRNA）序列加上adapter（接头）的过程。最终的目的是为了让转录组的片段两边都连上已知的adapter序列，方便之后的测序。结构如图1-1所示，图中所示的文库片段就是我们这里说的转录组片段。 在整个实验过程中，有几个关键的问题值得思考。 第1方面，最终拿去测序仪进行测序的一定都是DNA片段，因此我们需要对实验提取到的RNA序列进行反转录成cDNA，然后再进行连接adapter。不过这个问题不算难，因为只要有RNA的序列，就可以使用random primer进行随机反转录，获得对应的cDNA片段。而在cDNA片段上链接adapter就是标准的DNA连接反应，非常简单。 第2方面，细胞中含量最多的是rRNA，其次是tRNA，mRNA与lncRNA只占大约5%左右甚至更低，而我们真正关心的往往就是mRNA与lncRNA代表的基因表达量。那么怎么对mRNA或者是lncRNA进行富集呢？这就是我们今天要跟大家强调的富集策略问题。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-31/:1:1","tags":["AQ100","RNA-seq"],"title":"【bioinfo】-Q\u0026A-31","uri":"/bioinfo-q-a-31/"},{"categories":["bioinfo","ngs"],"content":"PolyA + 与 rRNA -两种富集策略 一般来说，我们做RNA-Seq的假设是基于： 某一个条件影响了表型 --\u003e 假设，表型是由蛋白的变化引起的 --\u003e 假设，蛋白的变化大概率是由对应gene表达量的改变引起的 --\u003e 因此，需要对gene进行定量 --\u003e 最终，进行RNA-Seq 1 polyA + 建库策略 也正是因为上述的推理过程，我们才需要去做RNA-Seq对全转录组进行gene的定量分析。在绝大多数情况下，我们关心的gene都是protein coding gene或者是与其结构非常详细的lncRNA（long non-coding RNA）这些gene在形成成熟的mRNA以后，往往都会在3’末端带有polyA 尾巴，如图2-1所示。同时，成熟的tRNA，rRNA，miRNA等等都不带有经典的polyA尾巴。 因此，如果我们使用一段 带有能与A配对的T的磁珠就可以与对应的带有polyA尾巴的RNA结合，随后再经过随机打断，反转录，加adapter就可以完成建库，这样的建库策略叫做polyA + 或者 polyA positive。核心是对带有polyA尾巴的RNA进行富集。 2 rRNA -建库策略 那么polyA positive策略有个比较大的问题就是，会丢掉很多不带有polyA尾巴的RNA序列，比如tRNA，比如有些lncRNA以及一些特殊的mRNA。同时，我们知道细胞中含量占绝大多数的是序列重复的rRNA，如果我们把rRNA去除之后也就可以顺利进行建库测序。这个过程是对rRNA进行若干次的消化，使得rRNA都被降解而其他类型的RNA不受影响。随后再进行随机打断，反转录，加adapter。这种RNA-Seq的建库策略为rRNA - 或称为 rRNA minus。这种策略的核心是尽可能多的去除rRNA。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-31/:1:2","tags":["AQ100","RNA-seq"],"title":"【bioinfo】-Q\u0026A-31","uri":"/bioinfo-q-a-31/"},{"categories":["bioinfo","ngs"],"content":"提问环节 今天的提问，偏生物细节，不过也都是我们必须要掌握的内容。 问题1：请查阅资料，给出正常人类细胞中rRNA，tRNA，mRNA的大致比例； 一个典型人类细胞的RNA含量 一个典型哺乳动物细胞中RNA的分布 问题2：是不是所有人类的protein coding gene的mRNA都带有polyA尾巴？如果不是请举例； 并不是，组蛋白的mRNA就没有polyA尾巴。polyA对mRNA起到稳定作用 即使其不被降解.组蛋白mRNA3’端是一茎环结构 所以组蛋白mRNA降解机制也与其他mRNA不同. 问题3：如果一个实验想要探索与可变剪切相关的内容，应该选择polyA +的建库策略还是选择rRNA - 的建库策略？为什么？ 采取第一个polyA+建库策略。因为研究可变剪接的话，最后得到的都是成熟的mRNA.那么它都具有polyA,在这种情况下利用带T的磁珠进行特异性富集，将mRNA进行富集。然后建库就可以。 问题4：rRNA minus与polyA positive这两种建库策略，哪种最终比对到参考基因组的比例会高一些？为什么？（提示，可以从建库组成，已知参考基因组的组成等方面思考） rRNA minus只是去掉了rRNA,其他的RNA没有去掉，比如说mRNA,lncRNA等等。在mapping回基因组的时候，reads的数量会多。从已知的参考基因组上来看，虽然hg38和hg19差别不大，hg38的mapping结果估计会比hg19高一些。 ","date":"2020-02-19","objectID":"/bioinfo-q-a-31/:1:3","tags":["AQ100","RNA-seq"],"title":"【bioinfo】-Q\u0026A-31","uri":"/bioinfo-q-a-31/"},{"categories":["bioinfo","ngs"],"content":"第30题 IGVTools使用的一些小技巧 闲话少说，Let’s go！ 目录 1. IGV Tools支持的文件类型与绘图方式； 2. 提供RNA-Seq的mapping测试数据； 3. IGV Tools设置Reads的排序方式； 4. IGV Tools画Sashimi plot； 5. 使用IGV Tools浏览公共数据； 6. 视频教程部分 ","date":"2020-02-18","objectID":"/bioinfo-q-a-30/:1:0","tags":["IGVTools","AQ100"],"title":"【bioinfo】-Q\u0026A-30","uri":"/bioinfo-q-a-30/"},{"categories":["bioinfo","ngs"],"content":"1. IGV Tools支持的文件类型与绘图方式 我们之前已经介绍过IGV Tools可以对多种数据进行可视化，那么IGV Tools支持的数据类型有哪些呢？根据官方手册的介绍IGVTools主要支持下列数据类型： 表1-1 IGV Tools支持的数据格式与数据内容 （http://software.broadinstitute.org/software/igv/DefaultDisplay） 通过表1-1我们知道，通过IGV Tools我们可以载入FASTA文件作为参考序列；可以载入BAM文件读取比对信息；可以载入BED（一般是各种peak的注释信号）还可以载入GFF/GTF的基因注释文件；当然还有一些特殊格式比如mutation的数据等等。对于这些数据，IGV Tools会用哪些方式来进行可视化呢？ 表1-2 数据类型可视化标准 （http://software.broadinstitute.org/software/igv/DefaultDisplay） 根据表1-2所示，对于不同数据类型，IGV Tools有自己的可视化方式。大家其实不必完全记住这些内容，有一个大概的印象即可，关键是要会用这个工具。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-30/:1:1","tags":["IGVTools","AQ100"],"title":"【bioinfo】-Q\u0026A-30","uri":"/bioinfo-q-a-30/"},{"categories":["bioinfo","ngs"],"content":"2. 提供RNA-Seq的mapping测试数据 为了方便大家学习，我为大家准备了一点RNA-Seq的mapping好的BAM文件与BAM-index文件。我们接下来的分析也都以这套数据为例进行操作。 链接：https://pan.baidu.com/s/1nORmpD9DU6yK4zzmWan_lw 密码：orbz ","date":"2020-02-18","objectID":"/bioinfo-q-a-30/:1:2","tags":["IGVTools","AQ100"],"title":"【bioinfo】-Q\u0026A-30","uri":"/bioinfo-q-a-30/"},{"categories":["bioinfo","ngs"],"content":"3. IGV Tools设置Reads的排序方式 我们向IGV Tools提供的BAM文件必须是按参考基因组坐标排序过的，且需要提供BAM文件的index 文件（bai 文件），但是对于IGV Tools来说，当我们zoom in一段区域以后，比如缩放到TP53这个基因区域，我们是可以对这个区域里面的reads进行各种方式排序与分组的。 图3-1显示的是 TP53基因，reads按比对到参考基因组位置排序的可视化图； 图3-1 TP53基因， reads按比对到参考基因组位置排序（默认） 图3-2 TP53基因，reads按照 start location进行排序 图3-2是不是会比图3-1整齐很多呢？这是因为使用了start location进行排序（视频会有介绍），一般在绘制publish的图时，都需要进行对齐操作好让结果比较美观。常用的还有若干种排序方式： 图3-3 常见的排序方式 ","date":"2020-02-18","objectID":"/bioinfo-q-a-30/:1:3","tags":["IGVTools","AQ100"],"title":"【bioinfo】-Q\u0026A-30","uri":"/bioinfo-q-a-30/"},{"categories":["bioinfo","ngs"],"content":"4. sashimi plot sashimi plot是对可变剪切的一种可视化方式，类似图4-1，它可以标记处有多少跨越intron的reads，方便我们观察可变剪切，比如skip exon的reads数目的变化。 图4-1 sashimi plot 例子（http://software.broadinstitute.org/software/igv/Sashimi） 在IGV Tools里面可以非常容易生成类似的图，只需要轻轻一点！~ 说句题外话，大家知道为什么这种图叫sashimi plot吗？ sashimi其实就是我们经常说的刺身，大家不觉得这种一个小峰，一个小junction很像刺身吗？ ","date":"2020-02-18","objectID":"/bioinfo-q-a-30/:1:4","tags":["IGVTools","AQ100"],"title":"【bioinfo】-Q\u0026A-30","uri":"/bioinfo-q-a-30/"},{"categories":["bioinfo","ngs"],"content":"5. 使用IGV Tools浏览公共数据 IGV Tools里可以方便我们下载各种公共数据，比如ENCODE数据，比如TCGA的数据，完全傻瓜操作，就是轻轻一点公共数据立马下载下来，并且自动可视化，是不是挺方便的？ H3K4me3的是最常用的定位active promoter region的一个信号。简单来说，就是有H3K4me3 peak出现的地方一般认为是转录比较活跃的区域，尤其是promoter区域。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-30/:1:5","tags":["IGVTools","AQ100"],"title":"【bioinfo】-Q\u0026A-30","uri":"/bioinfo-q-a-30/"},{"categories":["bioinfo","ngs"],"content":"第29题 如何使用IGVTools对mapping结果进行可视化？ Hello 大家好，我们又见面了！ 目录 1. 前言 2. IGV Tools的简介； 3. IGV Tools的下载与安装； 4. IGV Tools的可视化初探（indel, mutation, etc） ","date":"2020-02-18","objectID":"/bioinfo-q-a-29/:1:0","tags":["AQ100","IGV","mapping"],"title":"【bioinfo】-Q\u0026A-29","uri":"/bioinfo-q-a-29/"},{"categories":["bioinfo","ngs"],"content":"1. 前言 我们为大家介绍了如何使用samtools tview对BAM文件在命令行中进行可视化的操作。但是有的时候我们需要在论文里对回贴（mapping）数据进行可视化. 这篇文章我们先来教大家下载安装并使用IGVTools对测序数据进行可视化；下一篇我们会教大家怎么用IGVTools来进行RNA-Seq数据的可视化。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-29/:1:1","tags":["AQ100","IGV","mapping"],"title":"【bioinfo】-Q\u0026A-29","uri":"/bioinfo-q-a-29/"},{"categories":["bioinfo","ngs"],"content":"2. IGV Tools的简介 IGV Tools =Integrative Genomics Viewer Tools 简单翻译一下就是基因组数据可视化工具，主要的功能就是对高通量测序数据的mapping结果进行可视化。IGV Tools是基于Java开发的，开发者是Broad Institute（伯德研究所），这个研究所可以算是当前生物医学领域最为牛的研究所之一，在他们的带动下推出了一系列的生物信息学工具，IGVTools，GATK都是他们搞出来的。 在IGV Tools中，可以对sorted BAM，BED，GTF/GFF，bigwig/wig，bedgraph等数据进行可视化，基本上是我们平时最常用可视化工具。无论是全基因组测序，RNA-Seq，ChIP-Seq等等都可以进行可视化。 IGV Tools的官方主页： https://software.broadinstitute.org/software/igv/home ","date":"2020-02-18","objectID":"/bioinfo-q-a-29/:1:2","tags":["AQ100","IGV","mapping"],"title":"【bioinfo】-Q\u0026A-29","uri":"/bioinfo-q-a-29/"},{"categories":["bioinfo","ngs"],"content":"3. IGV Tools的下载与安装 IGV Tools是基于Java环境运行的，因此没有装Java的同学可能第一次安装这个软件之前需要先安装一遍，不过需要注意的是，根据IGV的安装说明，需要使用Java8，最新版的Java9还不能支持。 3.1 Java 8 的下载与安装 下载地址https://java.com/zh_CN/download/ 在这个页面里下载Java并安装就算是搞定了Java环境。 3.2 下载IGV Tools IGV Tools也有不同的版本我们一般选择最新版即可，目前的最新版是2.4版本。 下载地址 https://software.broadinstitute.org/software/igv/download 如果是Mac就选择下载1.Mac App，如果是Windows系统就选择2.Windows Zip，我们这里的演示环境为Windows就直接下载 对应版本即可。 3.3 第1次运行IGV 在Mac中直接下载的文件就是个App直接双击就能运行。在Windows中，解压缩以后我们需要运行的是igv.bat。 双击igv.bat以后，第1次运行软件会自动下载注释需要的文件。需要注意的是，IGV每次使用的时候都需要在联网的环境下启动。 稍等片刻，就可以看到IGV的图形界面，到这里算是安装好了IGV Tools! 4. IGV Tools的可视化初探 4.1 基本介绍 最下方的注释信息为RefSeq Genes； 中间的空白部分是载入数据以后的可视化部分； 最上面的Human hg19 是选择参考基因组信息，需要与你载入的文件保持一致； 中间的空白栏是一个快速地搜索栏，可以搜索一个基因，比如TP53，可以是一个具体的坐标比如 chr1:10000-12000 然后点击Go就可以直接访问到该位置； 其他的地方的按钮，大家可以多点一点，多试一试自己探索一下功能。 4.2 载入1个mapping的结果 需要注意的是，IGV Tools需要使用按坐标sort好的BAM文件并配合相应的BAM index才可以，而sort的办法我们上一个问题中刚刚给大家示范过，在这里就不再重复，直接给大家sort BAM 以及相应的index。 # BAM文件及BAM index文件 链接：https://pan.baidu.com/s/1YOv2FBwmPVKm2EG7TYl0jg 密码：m32y BAM index文件的后缀名为bai，前缀需要与BAM文件保持一致，一般的命名规范为： 如果BAM文件名为：sorted.bam 那么bai文件名就应该是：sorted.bam.bai 且这两个文件应该放在同一个文件夹中。 在IGV中，选择 File -\u003e Load From File -\u003e 选择你下载好的sorted.bam文件，然后就会出现如图的界面。左边栏已经出现了2个track，分别是上面的coverage和下面比对情况，因为我们没有选择具体的genome region因此还不能显示详细信息。 我们在搜索栏里面写 chr1:12000-12500并点击Go以后， 图4 选择了某一个区域以后的的情况。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-29/:1:3","tags":["AQ100","IGV","mapping"],"title":"【bioinfo】-Q\u0026A-29","uri":"/bioinfo-q-a-29/"},{"categories":["bioinfo","ngs"],"content":"第28题 如何使用samtools tview在命令行下对BAM文件进行可视化？ Hello 大家好！ 我们又见面了！ 今天我们来讨论一下，怎么在命令行模式下对BAM文件进行快速地比对信息，也就算是命令行模式下的一种可视化了，虽然这种可视化没啥图形~ 当然，如果你把BAM文件使用本地的工具也可以进行非常好的可是吧，比如使用IGV Tools。这个IGV Tools是一个我们最常用的可视化工具，我们在以后会进行详细地讨论，今天就只聊一聊命令行里这个的这个小工具—— samtools tview ","date":"2020-02-18","objectID":"/bioinfo-q-a-28/:1:0","tags":["AQ100","samtools","BAM"],"title":"【bioinfo】-Q\u0026A-28","uri":"/bioinfo-q-a-28/"},{"categories":["bioinfo","ngs"],"content":"1. 一些基本概念 其实，我们之前已经在第22题提醒过大家使用samtools tview这个工具了。它可以sort好的BAM文件进行可视化，并提供随机访问功能。 测试文件 # SAM测试文件的baidu盘下载地址 链接：https://pan.baidu.com/s/15gVVYPRu3VbF_uKbJUUGrA 密码：2drn 什么叫随机访问呢？ 简单来说就是访问染色体任何1个位置的比对情况，速度差不多，而不受染色体先后顺序的影响。比如，我们比对时染色体是chr1，chr2，chr3…按顺序排列的，如果按顺序访问chr3的数据，就必须先读chr1，chr2的数据；而一点我们对BAM文件进行了sort，同时建立了BAM文件的index，那么就可以直接访问chr3的数据。 BAM文件怎么排序及建立index？ 这个也很容易，使用samtools sort就好！我们在第22题的时候已经为大家简单介绍了。 大家需要注意，samtools sort是可以按reads的名称或reads的mapping结果进行排序的，我们这里一定要注意，需要按照mapping的结果进行排序，也就是mapping到染色体5’端的reads在前，靠3’端的reads在后。 在sort完以后，需要使用smtools index进行建立index，BAM index的名字为BAM文件名后加.bai # 对SAM文件转换成BAM文件 samtools view -hb ./test.sam \u003e test.bam # 对BAM文件按mapping结果进行排序 samtools sort -O BAM -T test_sort.bam.temp -o test_sort.bam test.bam # 对BAM文件建立index samtools index test_sort.bam test_sort.bam.bai ","date":"2020-02-18","objectID":"/bioinfo-q-a-28/:1:1","tags":["AQ100","samtools","BAM"],"title":"【bioinfo】-Q\u0026A-28","uri":"/bioinfo-q-a-28/"},{"categories":["bioinfo","ngs"],"content":"2. 用一用samtools tview # samtools tview 用法 samtools tview test_sort.bam ref.fa # 注意，ref.fa文件mapping的时候使用的基因组的FASTA文件 使用上述命令，可以打开samtools tview的交互模式。需要注意，这里有一个坑，就是用conda安装的samtools不能使用交互模式，需要自己安装一下,按？！ 里面的功能主要是方便我们快速定位，比如我们可以按“g”进行快速定位，如我们定位到chr1:12500位置。 此外，在samtools tview中，“.”代表和ref.fa内容完全一样；“，”表示比对到ref.fa的互补链；写了字母就代表mismatch。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-28/:1:2","tags":["AQ100","samtools","BAM"],"title":"【bioinfo】-Q\u0026A-28","uri":"/bioinfo-q-a-28/"},{"categories":["bioinfo","ngs"],"content":"3. 今天的问题 请你下载我们给出的SAM文件，并使用samtools 进行排序，然后使用samtools 查看chr1:13417附近的位置，你会发现在附近有1条reads出现了1个G-\u003eA的mutation。那么通过这1条reads是否能说明这个点是否真的位1个mutation？ 请你在samtools tview的交互模式下，查看帮助文档，并熟悉相关操作。（使用conda安装的samtools可能不能正常使用samtools tview的交互功能） 注意：使用的参考基因组序列信息的下载地址 # hg19 1号染色体的FASTA下载地址 http://hgdownload.soe.ucsc.edu/goldenPath/hg19/chromosomes/chr1.fa.gz # 下载后请解压缩 gzip -d chr1.fa.gz ","date":"2020-02-18","objectID":"/bioinfo-q-a-28/:1:3","tags":["AQ100","samtools","BAM"],"title":"【bioinfo】-Q\u0026A-28","uri":"/bioinfo-q-a-28/"},{"categories":["bioinfo","ngs"],"content":"第27题 GENCODE与Ensembl GTF/GFF到底哪里不同？怎么下载？ ","date":"2020-02-18","objectID":"/bioinfo-q-a-27/:1:0","tags":["AQ100","RefSeq","GTF"],"title":"【bioinfo】-Q\u0026A-27","uri":"/bioinfo-q-a-27/"},{"categories":["bioinfo","ngs"],"content":"1. 基因注释的不同版本问题 RefSeq Gene注释，对gene的不同转录本进行注释，1个转录本对应1个编号成为RefSeq id，例如对于可以翻译成蛋白的转录本，都会以NM_开头如NM_015658；对于不能翻译的转录本，都会以NR_开头如NR_027055； **Ensembl注释；**对gene的不同转录本进行注释，以ENSG开头的表示Ensembl gene_id如ENSG00000227232，以ENST开头的表示Ensembl transcript id如ENST00000438504 **UCSC gene注释；**对gene的不同转录本进行注释，一般是类似uc004cpf这样的名称。 但是，RefSeq有一些注释不够完整，或者说有一些可能存在的，有用的gene转录本，所以有的时候我们会推荐大家使用Ensembl或者GENCODE的注释，那么我们今天的问题来了——Ensembl和GENCODE的GTF/GFF注释有什么不同？ ","date":"2020-02-18","objectID":"/bioinfo-q-a-27/:1:1","tags":["AQ100","RefSeq","GTF"],"title":"【bioinfo】-Q\u0026A-27","uri":"/bioinfo-q-a-27/"},{"categories":["bioinfo","ngs"],"content":"2. GENCODE上下载GTF/GFF 先说说GENCODE是什么吧，根据GENCODE的官方说明文档，GENCODE的目的是为了建立一个公用可信的gene注释体系，其缩写的对应关系为： The GENCODE Project = Encyclopædia of genes and gene variants 好了，让我们先访问以下GENCODE的官方网站：https://www.gencodegenes.org/ 其实，大家可以发现GENCODE的网站上，只提供了Human和Mouse两个物种的注释信息，但这两个物种也是平时研究的时候最关心最常用的两个物种。每个物种有若干个版本，我们一般下载最新版本就好了。下面以Human的数据下载为例为大家进行讲解。 大家可以看出来，GENCODE已经对数据做了非常好的整理，不但提供了各种类型数据的下载，而且在下方的Metadata部分，还解释了每一种数据的元数据。也就是不但告诉我们注释的结果，还告诉了我们为什么这么注释，真的很良心！ 在这里，我们就为大家下载了最常用的gene annotation也就是第1个文件Comprehensive gene annotation 的 GTF格式。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-27/:1:2","tags":["AQ100","RefSeq","GTF"],"title":"【bioinfo】-Q\u0026A-27","uri":"/bioinfo-q-a-27/"},{"categories":["bioinfo","ngs"],"content":"3. GENCODE与Ensembl GTF/GFF有什么不同？ 我们先来看一下这两者的数据内容： 从Ensembl下载下来的GTF文件； #!genome-build GRCh37.p13 #!genome-version GRCh37 #!genome-date 2009-02 #!genome-build-accession NCBI:GCA_000001405.14 #!genebuild-last-updated 2013-09 1 ensembl_havana gene 11869 14412 . + . gene_id \"ENSG00000223972\"; gene_version \"4\"; gene_name \"DDX11L1\"; gene_source \"ensembl_havana\"; gene_biotype \"pseudogene\"; 1 havana transcript 11869 14409 . + . gene_id \"ENSG00000223972\"; gene_version \"4\"; transcript_id \"ENST00000456328\"; transcript_version \"2\"; gene_name \"DDX11L1\"; gene_source \"ensembl_havana\"; gene_biotype \"pseudogene\"; transcript_name \"DDX11L1-002\"; transcript_source \"havana\"; transcript_biotype \"processed_transcript\"; havana_transcript \"OTTHUMT00000362751\"; havana_transcript_version \"1\"; tag \"basic\"; 1 havana exon 11869 12227 . + . gene_id \"ENSG00000223972\"; gene_version \"4\"; transcript_id \"ENST00000456328\"; transcript_version \"2\"; exon_number \"1\"; gene_name \"DDX11L1\"; gene_source \"ensembl_havana\"; gene_biotype \"pseudogene\"; transcript_name \"DDX11L1-002\"; transcript_source \"havana\"; transcript_biotype \"processed_transcript\"; havana_transcript \"OTTHUMT00000362751\"; havana_transcript_version \"1\"; exon_id \"ENSE00002234944\"; exon_version \"1\"; tag \"basic\"; 1 havana exon 12613 12721 . + . gene_id \"ENSG00000223972\"; gene_version \"4\"; transcript_id \"ENST00000456328\"; transcript_version \"2\"; exon_number \"2\"; gene_name \"DDX11L1\"; gene_source \"ensembl_havana\"; gene_biotype \"pseudogene\"; transcript_name \"DDX11L1-002\"; transcript_source \"havana\"; transcript_biotype \"processed_transcript\"; havana_transcript \"OTTHUMT00000362751\"; havana_transcript_version \"1\"; exon_id \"ENSE00003582793\"; exon_version \"1\"; tag \"basic\"; 1 havana exon 13221 14409 . + . gene_id \"ENSG00000223972\"; gene_version \"4\"; transcript_id \"ENST00000456328\"; transcript_version \"2\"; exon_number \"3\"; gene_name \"DDX11L1\"; gene_source \"ensembl_havana\"; gene_biotype \"pseudogene\"; transcript_name \"DDX11L1-002\"; transcript_source \"havana\"; transcript_biotype \"processed_transcript\"; havana_transcript \"OTTHUMT00000362751\"; havana_transcript_version \"1\"; exon_id \"ENSE00002312635\"; exon_version \"1\"; tag \"basic\"; 刚刚下载下来的GENCODE的GTF文件； ##description: evidence-based annotation of the human genome (GRCh38), version 28 (Ensembl 92) ##provider: GENCODE ##contact: gencode-help@ebi.ac.uk ##format: gtf ##date: 2018-03-23 chr1 HAVANA gene 11869 14409 . + . gene_id \"ENSG00000223972.5\"; gene_type \"transcribed_unprocessed_pseudogene\"; gene_name \"DDX11L1\"; level 2; havana_gene \"OTTHUMG00000000961.2\"; chr1 HAVANA transcript 11869 14409 . + . gene_id \"ENSG00000223972.5\"; transcript_id \"ENST00000456328.2\"; gene_type \"transcribed_unprocessed_pseudogene\"; gene_name \"DDX11L1\"; transcript_type \"processed_transcript\"; transcript_name \"RP11-34P13.1-002\"; level 2; transcript_support_level \"1\"; tag \"basic\"; havana_gene \"OTTHUMG00000000961.2\"; havana_transcript \"OTTHUMT00000362751.1\"; chr1 HAVANA exon 11869 12227 . + . gene_id \"ENSG00000223972.5\"; transcript_id \"ENST00000456328.2\"; gene_type \"transcribed_unprocessed_pseudogene\"; gene_name \"DDX11L1\"; transcript_type \"processed_transcript\"; transcript_name \"RP11-34P13.1-002\"; exon_number 1; exon_id \"ENSE00002234944.1\"; level 2; transcript_support_level \"1\"; tag \"basic\"; havana_gene \"OTTHUMG00000000961.2\"; havana_transcript \"OTTHUMT00000362751.1\"; chr1 HAVANA exon 12613 12721 . + . gene_id \"ENSG00000223972.5\"; transcript_id \"ENST00000456328.2\"; gene_type \"transcribed_unprocessed_pseudogene\"; gene_name \"DDX11L1\"; transcript_type \"processed_transcript\"; transcript_name \"RP11-34P13.1-002\"; exon_number 2; exon_id \"ENSE00003582793.1\"; level 2; transcript_support_level \"1\"; tag \"basic\"; havana_gene \"OTTHUMG00000000961.2\"; havana_transcript \"OTTHUMT00000362751.1\"; chr1 HAVANA exon 13221 14409 . + . gene_id \"ENSG00000223972.5\"; transcript_id \"ENST00000456328.2\"; gene_type \"transcribed_unprocessed_pseudogene\"; gene_name \"DDX11L1\"; transcript_type \"processed_transcript\"; transcript_name \"RP11-34P","date":"2020-02-18","objectID":"/bioinfo-q-a-27/:1:3","tags":["AQ100","RefSeq","GTF"],"title":"【bioinfo】-Q\u0026A-27","uri":"/bioinfo-q-a-27/"},{"categories":["bioinfo","ngs"],"content":"第26题 什么是RefSeq Gene? 怎么给NCBI反馈问题？ Hello 大家好，我们又见面了！ 昨天我们给大家介绍了怎么下载GTF/GFF文件，并让大家尝试使用2种方法分别从UCSC genome browser上下载RefSeq Gene GTF（hg19版本）；以及Ensembl网上下载Ensembl Gene GTF（hg19版本），还在最后的提问环节让大家比较了一下这两者的不同。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-26/:1:0","tags":["AQ100","RefSeq"],"title":"【bioinfo】-Q\u0026A-26","uri":"/bioinfo-q-a-26/"},{"categories":["bioinfo","ngs"],"content":"1. 常用的Gene注释 其实，常用的gene注释有不同的来源，这个来源一般是某一个组织通过一定的方法来确定下来的参考gene的相关注释信息。比如常用的有： RefSeq Gene注释，对gene的不同转录本进行注释，1个转录本对应1个编号成为RefSeq id，例如对于可以翻译成蛋白的转录本，都会以NM_开头如NM_015658；对于不能翻译的转录本，都会以NR_开头如NR_027055； **Ensembl注释；**对gene的不同转录本进行注释，以ENSG开头的表示Ensembl gene_id如ENSG00000227232，以ENST开头的表示Ensembl transcript id如ENST00000438504 **UCSC gene注释；**对gene的不同转录本进行注释，一般是类似uc004cpf这样的名称。 针对1个参考基因组版本，比如human的hg19参考基因组版本，会有来自各种不同组织，不同方法的基因注释。这些基因注释各有优劣，没有绝对的好与绝对的坏，只有掌握他们的注释规则，才能找到最适合我们课题的基因注释。所以，我们今天先来介绍一下RefSeq Gene的注释规则与原理。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-26/:1:1","tags":["AQ100","RefSeq"],"title":"【bioinfo】-Q\u0026A-26","uri":"/bioinfo-q-a-26/"},{"categories":["bioinfo","ngs"],"content":"2. RefSeq 计划与RefSeq gene RefSeq = The NCBI Reference Sequence 这个计划是由NCBI提出的，意图是为所有常见生物提供非冗余，人工选择过的参考序列。一个物种的RefSeq注释通常包含：参考基因组，参考转录组，参考蛋白序列，参考SNP信息，参考CNV信息等等。 RefSeq基本上我们最常用的一个gene注释版本了，因为经过了人工挑选，挑选出来的gene或者是转录本都十分可靠。在RefSeq的官方说明文档中，这么写了一句话 “It is a unique resource because it provides a large, multi-species, curated sequence database.” 这个curated是什么意思，大家可以查查字典~ 从RefSeq的官方网站上可以下载到N个物种的参考序列信息，从无核到有核，从原核到真核，从低等到高等应有尽有。不过呢，这里面还是human的信息注释得最为全面，并且在RefSeq的主页上做了单独的页面链接 页面中的Human Genome Resource and Download就可以进入Human资源的专题页面，如图2-1，图2-2所示。 图2-1 Human Genome Resource and Download页面上半部分 图2-2 Human Genome Resource and Download页面的download部分 页面的下半部分就是download的信息，其中提供了两个版本的资源，GRCh38 = hg38， GRCh37 = hg19。不过，我们注意一下，这里的基因注释文件为GFF3.0版本，和GTF（GFF2.0版本）略有不同，但里面的信息等价，也可以作为参考文件提供给比对软件。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-26/:1:2","tags":["AQ100","RefSeq"],"title":"【bioinfo】-Q\u0026A-26","uri":"/bioinfo-q-a-26/"},{"categories":["bioinfo","ngs"],"content":"3. 提问环节 \\1. 请点开RefSeq的官方主页，随便点一点里面的内容，探索一下每个链接对应的内容是什么； \\2. 尝试下载hg19的GFF3文件，并简单比较GFF3与GTF文件的不同。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-26/:1:3","tags":["AQ100","RefSeq"],"title":"【bioinfo】-Q\u0026A-26","uri":"/bioinfo-q-a-26/"},{"categories":["bioinfo","ngs"],"content":"第25题 GTF/GFF的注释是怎么来的，应该从哪里下载？ Hello everyone! 我们又见面了！ 我们昨天刚刚回答了GTF/GFF文件到底是什么的问题，那么我们今天尝试回答GTF/GFF文件是怎么来的，从哪里能够下载。 根据BBQ24问的介绍，我们知道了GTF是GFF的2.0版本。（以后我们把这两者到简称为GTF文件好了！）主要记录的内容是基因组上基因的结构，包括哪里是exon，哪里是intron，哪里是CDS，哪里是start codon，哪里是stop codon. 在提问的环节，我们也设置了问题让大家去吐槽GTF文件糟糕的的文件结构（希望大家能吐得开心！）。 今天我们来为大家介绍GTF文件是怎么来的。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-25/:1:0","tags":["AQ100","GTF","GFF"],"title":"【bioinfo】-Q\u0026A-25","uri":"/bioinfo-q-a-25/"},{"categories":["bioinfo","ngs"],"content":"1. 什么是参考GTF/GFF文件 针对一些已经通过测序计划，拼装好基因组序列信息的物种，一般会同时提供其转录组的注释信息，也就是我们所说的GTF/GFF文件。常用的模式生物，比如human（人），mouse（小鼠），rat（大鼠），chicken（鸡），lizard（蜥蜴），Arabidopsis thaliana（拟南芥）等等都已经有非常好的 全基因组参考序列（FASTA文件），以及转录组注释信息（GTF或GFF文件）。 因此，直接到能够提供下载地址的网站上下载就好了。 图1给大家展示了已经公布参考基因组哺乳动物的系统发生树，大家可以看看人类和哪种动物演化距离最近。 图1 已经公布参考基因组的哺乳动物系统发生树（http://asia.ensembl.org/info/about/speciestree.html） 多说一句，这个下载下来的FASTA文件就是我们所谓的参考基因组，需要用这个文件去构建mapping的index；下载下来的GTF文件是转录组注释信息，一般在计算表达量的时候需要提供。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-25/:1:1","tags":["AQ100","GTF","GFF"],"title":"【bioinfo】-Q\u0026A-25","uri":"/bioinfo-q-a-25/"},{"categories":["bioinfo","ngs"],"content":"2. 什么是拼装转录本 在进行转录组分析的过程中，我们经常会听到一句话叫“用XX软件拼装转录本”，这句话是什么意思呢？不都有参考转录组了，还要拼个啥转录组？ 第1个方面，对于无参考基因组，无参考转录组的物种来说，往往需要通过RNA-Seq的数据自己拼出参考转录组，然后再进行下游的数据分析。所以，对于无参分析来说，往往需要自己拼装转录本，生成自己的参考转录组信息，也包括注释信息（GTF文件）。 第2个方面，对于有非常好注释的基因组，例如human来说。不同的细胞条件可能不同，一些永生化的细胞系往往都具有“癌症”的特征，这些细胞的转录组，基因组或多或少都有结构的变异，以及转录本的差异。 举个例子，有一个geneA，在参考转录组中注释的是从chr1:1000 ~ 15000进行转录，但是在另外的细胞系中有可能就是从chr1:980 ~ 15050进行转录。这种转录起始和终点的不同是很常见的现象。 因此，有时候为了比较严谨地进行下游序列分析，是需要根据已知的参考转录组以及测序数据对其进行一个修饰。 常用的软件是cufflinks，stringtie等等。 不过，对于有参考转录组的物种，一般情况下，我还是建议不要去自己拼转录本，也不要去做什么所谓的修正，意义不大。除非你研究的体系非常特殊。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-25/:1:2","tags":["AQ100","GTF","GFF"],"title":"【bioinfo】-Q\u0026A-25","uri":"/bioinfo-q-a-25/"},{"categories":["bioinfo","ngs"],"content":"3. 从哪里下载参考转录组GTF/GFF文件呢？ 关于下载GTF/GFF文件的内容，给大家介绍2个最常用的网站： 1个是UCSC genome browser (UCSC Genome Browser-网址链接） 1个是Ensembl（Ensembl 网址链接） 注意：对于植物的Ensembl网站（Ensembl Plants） 3.1 从UCSC genome browser下载human的GTF文件 1. 打开UCSC genome browser网站 2. 在Tools里选择 Table Browser 3. 打开Table Browser以后，设置相关的需要内容（图3.1） 4. 点击get output即可下载 # hg19 = human genome 19是常用的human参考基因组版本号； # RefSeq gene是全部经过人工检查过的gene注释文件； 图3.1 打开Table Browser以后，设置相关的需要内容 3.2 Ensembl下载human的GTF文件 在下载之前我必须跟大家提个醒。 * 对于动物相关的信息都请访问Ensembl的动物站：http://www.ensembl.org/index.html * 对于植物相关的信息都请访问Ensembl的植物站：http://plants.ensembl.org/index.html 我们在这里还是以下载human hg19版本的GTF文件为例，操作步骤如下： 【博主用的全是最新的CRCh38】 1. 登陆Ensembl网站，并跳转到hg19版本界面 2. 继续选择跳转到hg19版本界面 3. 在hg19版本的Ensembl界面中选择download 4. 在download页面中选择Download a sequence or region 5. 在左边栏选择 FTP download 然后选择下载 GTF文件 6. 选择注释好的GTF进行下载 ","date":"2020-02-18","objectID":"/bioinfo-q-a-25/:1:3","tags":["AQ100","GTF","GFF"],"title":"【bioinfo】-Q\u0026A-25","uri":"/bioinfo-q-a-25/"},{"categories":["bioinfo","ngs"],"content":"4. 提问环节 1. 请按照文中教程分别从UCSC Genome Browser，以及Ensembl网站上下载hg19的转录组注释的GTF格式文件。 2. 下载这两个文件解压缩以后的大小是否有差异，差异大不大？ 两个网站下载的GTF⽂件大小差异较大，解压之后 hg19_RefSeq_GTF_UCSC⽂件126M， Homo_sapiens.GRCh37.87.chr.gtf⽂件大小是1.2G。 3. 解压并使用Linux less命令打开这两个文件，观察这两个文件的transcript_id以及gene_id是否相同，再找找看有哪些其他地方的不同。 两个⽂件的transcript_id以及gene_id均不相同，Ensembl网站下载的gtf⽂文件transcript_id以及 gene_id均以ENSG和ENSG开头，全称是Ensembl Transcript ID和Ensembl Gene ID，而UCSC网站下载的gtf文件transcript_id以及gene_id均以NM开头,在NCBI数据库中代表mRNA; 除此之外，UCSC 的注释信息非常简练，⽽Ensemble⽹站中的gtf文件注释信息相比于UCSC更加全面，但也存在冗余，NCBI 数据库中的基因注释被验证的比例更大， 所以在⽐对策略上可以选择先使用UCSC的GTF文件筛选目标基因， 再利用Ensemble数据库的GTF⽂件找到更加详细的注释。 # Ensembl gtf文件: 1 havana exon 12613 12721 . + . gene_id \"ENSG00000 223972\"; gene_version \"4\"; transcript_id \"ENST00000456328\"; transcript_version \"2\" ; exon_number \"2\"; gene_name \"DDX11L1\"; gene_source \"ensembl_havana\"; gene_biotype \"pseudogene\"; transcript_name \"DDX11L1-002\"; transcript_source \"havana\"; transcri pt_biotype \"processed_transcript\"; havana_transcript \"OTTHUMT00000362751\"; havana_ transcript_version \"1\"; exon_id \"ENSE00003582793\"; exon_version \"1\"; tag \"basic\"; # UCSC gtf⽂件: chr1 hg19_ncbiRefSeq exon 66999929 67000051 0.000000 + . gene_id \"NM_001308203.1\"; transcript_id \"NM_001308203.1\"; ","date":"2020-02-18","objectID":"/bioinfo-q-a-25/:1:4","tags":["AQ100","GTF","GFF"],"title":"【bioinfo】-Q\u0026A-25","uri":"/bioinfo-q-a-25/"},{"categories":["bioinfo","ngs"],"content":"第24题 GFF，GTF到底是什么？ Hello大家好！我们又见面了！ 在第23问的时候，我们开始学习了转录组相关的生物信息学。在转录组分析的过程中，往往需要基因注释文件，通常是GFF或者是GTF文件，那么这两个文件的内容是什么？有什么特点呢？这是我们今天要探索的问题。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-24/:1:0","tags":["AQ100","reference"],"title":"【bioinfo】-Q\u0026A-24","uri":"/bioinfo-q-a-24/"},{"categories":["bioinfo","ngs"],"content":"1. 我们为什么需要基因注释文件？ 通过对外显子（exon）的可变剪切，同1个基因可以形成多种蛋白（https://en.wikipedia.org/wiki/Alternative_splicing） 我们的gene在基因组上的结构不是连续的，而是exon-intron-exon（exon=外显子，intron=内含子）分隔开的。 基因要表达，首先会先发生转录过程，转录出包含intron的pre-mRNA序列，然后再进行可变剪切，加5’帽子，3’ PolyA尾巴等一系列复杂的加工过程才会形成成熟的mRNA。 在进行转录组序列比对，尤其是mRNA序列比对的时候，经常需要处理跨越两个exon之间的reads，所以在进行序列比对的时候往往需要对基因组有一个注释，**告诉比对软件哪个位置是gene的exon，哪个地方是gene的intron，这个就是我们所说的基因注释信息。**所以，它里面核心内容就是一大堆gene在基因组上的坐标，以及这个gene本身的一些属性。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-24/:1:1","tags":["AQ100","reference"],"title":"【bioinfo】-Q\u0026A-24","uri":"/bioinfo-q-a-24/"},{"categories":["bioinfo","ngs"],"content":"2. GTF与GFF都是基因注释文件 GTF = General Transfer Format GFF = General Feature Format GFF有若干个版本，简单来说，GTF是GFF文件的其中一个版本，我们一般认为GTF文件就是GFF 2.0版本的内容。一个标准的GTF/GFF2.0文件需要包括9列内容，一个简单的示意图如下： 图2 1个标准的GTF格式文件，文件不包括前面的行号 这9列分别是什么呢？ 我试着为大家翻译ensembl网站的说明文件（GFF/GTF File Format）。 # 所有的列必须用TAB分隔，总共有9列内容，第9列是补充列； # 补充列的内容可以为空，但是前面8列必须有内容，如果想表达空的概念，则需要用\".\"； # 第1列 seqname 染色体的名称，需要与genome FASTA文件中的染色体名对应，别一个用\"chr1\"一个用\"Chr1\"； # 第2列 source 注释来自哪里，比如图2表示来自NCBI RefSeq数据库； # 第3列 feature 此行的注释类型，一般有exon，CDS，stop_codon, start_codon等等； # 第4，5列 start，end 此行注释的起始和终止位置，标准的GTF/GFF都是以1为染色体的起点（1-based system）; 注意！无论这个gene是正链还是负链，start的坐标都小于end坐标； # 第6列 score 一般存放打分值，比如拼装的可信度之类。下载的官方注释文件一般为0.0 # 第7列 strand 正链基因标记为 \"+\", 负链基因标记为 \"-\"; # 第8列 frame 只可能是0,1,2这3个值,表示与CDS中codon的相对位置； 0表示，这个region的第1bp就是正好是codon 三连密码子的第1个碱基； 1表示，这个region的第2bp就是正好是codon 三连密码子的第1个碱基； 2表示，这个region的第3bp就是正好是codon 三连密码子的第1个碱基； # 第9列 attribute 一般会记录 gene_id 与transcript_id; 这一列是可选列，可以增加很多内容。在程序处理过程中，相同的attribute会合并在一起处理。 比如，所有gene_id=SGIP1的行都会先汇总在一起，表示1个基因。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-24/:1:2","tags":["AQ100","reference"],"title":"【bioinfo】-Q\u0026A-24","uri":"/bioinfo-q-a-24/"},{"categories":["bioinfo","ngs"],"content":"3. 提出问题 既然是这样，我们今天就思考2个小问题，1个比较偏理论，1个是比较具体。 1. 你认为GTF/GFF的文件格式设计合理吗？为什么？ 并不是非常合理，这种格式虽然包括了注释所需要的全部信息，但是同一个基因不同的elements并不在一行，在mapping的时候需要用循环一行一行去判断该element是否是同属于一个基因，比较耗费十佳你和内存，如果不选择GTF文件，合适选择下图所示的“all files from selected table”文件，这种文件的注释信息的组合方式与GTF不同，是以一个基因为一行，包括了这个基因中的各个elements，这样的助释放阀使得比对过程更加便捷 all files from selected table ⽂文件内容示例例: #bin name chrom strand txStart txEnd cdsStart cdsEnd exonCount ex onStarts exonEnds score name2 cdsStartStat cdsEndStat exonFrames 1251 NM_004261.4chr1 - 87328127 87380048 87329156 87379794 5 87328127,87333735,87346344,87368963,87379710, 87329288,87333785,87346408,87369 131,87380048, 0 SELENOF cmpl cmpl 0,1,0,0,0, 2. 如果告知，transcript_id为NM001308203.1，gene_id为SGIP1, 在转录本上的坐标为101，那么对应基因组的坐标是多少？请写出答案与简要程序思路。注释信息如下： chr1 hg19_ncbiRefSeq exon 66999252 66999355 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq start_codon 67000042 67000044 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67000042 67000051 0.000000 + 0 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 66999929 67000051 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67091530 67091593 0.000000 + 2 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67091530 67091593 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67098753 67098777 0.000000 + 1 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67098753 67098777 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67105460 67105516 0.000000 + 0 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67105460 67105516 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67108493 67108547 0.000000 + 0 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67108493 67108547 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67109227 67109402 0.000000 + 2 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67109227 67109402 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67136678 67136702 0.000000 + 0 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67136678 67136702 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67137627 67137678 0.000000 + 2 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67137627 67137678 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67138964 67139049 0.000000 + 1 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67138964 67139049 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67142687 67142779 0.000000 + 2 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67142687 67142779 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67145361 67145435 0.000000 + 2 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67145361 67145435 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67154831 67154958 0.000000 + 2 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67154831 67154958 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67155873 67155999 0.000000 + 0 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67155873 67155999 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67160122 67160187 0.000000 + 2 gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq exon 67160122 67160187 0.000000 + . gene_id \"SGIP1\"; transcript_id \"NM_001308203.1\"; chr1 hg19_ncbiRefSeq CDS 67184977 67185088 0.000000 + 2 gene_id \"SGIP1\"","date":"2020-02-18","objectID":"/bioinfo-q-a-24/:1:3","tags":["AQ100","reference"],"title":"【bioinfo】-Q\u0026A-24","uri":"/bioinfo-q-a-24/"},{"categories":["bioinfo","ngs"],"content":"第23题 转录组的比对与基因组的比对有何不同？ Hello大家好！我们今天又见面了！ 我们通过前期的22个问题，从数据的简单质控，到测序数据的mapping，再到mapping后的SAM文件都有了一个比较清楚的认识。那么说了半天的mapping问题，一直都是在以DNA进行举例，RNA的比对我们都还没有谈。那么今天我们就来简单谈谈RNA序列的mapping，尤其是真核生物的RNA序列比对。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-23/:1:0","tags":["AQ100","mapping"],"title":"【bioinfo】-Q\u0026A-23","uri":"/bioinfo-q-a-23/"},{"categories":["bioinfo","ngs"],"content":"1. RNA与DNA结构的不同 一般来说，DNA的mapping比较容易，因为DNA在基因上是连续的，直接回贴到基因组就可以找到相应的定位。 就比如我们常用的Whole Genome Sequence（WGS）即全基因组测序； 或者是我们所说的ChIP-Seq即染色体免疫共沉淀测序都是直接对DNA进行建库测序，其测序结果都是FASTQ文件，直接用bowtie2，bwa比对到基因组就可以拿到标准的SAM文件。 但是RNA就不一样了，真核生物的RNA需要经过复杂的加工过程。在细胞中RNA层面的调控至少可以分成2个大的阶段 co-transcription（转录的同时） post-transcription（转录以后） 其中的调控机制也有很多。 对我们mapping影响最大的因素是：真核生物转录出来的初步的mRNA都是带有intron（内含子）的，随后都需要在co-transcription（转录的同时） 或post-transcription（转录以后）阶段通过： alternative splicing（可变剪切）剪切掉intron； polyA尾巴； 加5’的帽子结构。 这3个步骤，将不成熟的mRNA变为最终成熟的mRNA再转运出核，行使功能。 图1 通过可变剪切同1个基因可以形成多种蛋白（https://en.wikipedia.org/wiki/Alternative_splicing） 而我们在进行RNA-Seq建库的时候，一般情况下都是使用oligo dT针对带polyA尾巴的成熟mRNA进行富集，然后再进行反转录获得cDNA，之后再使用cDNA进行建库测序。所以，我们最终得到的测序结果是与成熟mRNA序列保持一致的，只包含了exon的序列。 而exon在基因中间是有intron分割的，因此在回贴回基因组的时候，回遇到跨越intron的reads回贴。所以这个问题不能使用原来针对DNA的mapping策略进行mapping。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-23/:1:1","tags":["AQ100","mapping"],"title":"【bioinfo】-Q\u0026A-23","uri":"/bioinfo-q-a-23/"},{"categories":["bioinfo","ngs"],"content":"2. RNA比对的常用软件 目前大家最常用的转录组比对软件有下面几个： tophat2，应用最广泛的比对软件，但是速度很慢，已经基本被淘汰了，大约需要4~5G内存就能运行； hisat2，tophat2的原班人马搞得新一代转录组比对软件，比对速度大大提高，我强烈推荐，大约需要4~5G内存就能运行； STAR，非常适合于大量数据的并行计算，速度非常快，对于同时有参考基因组和参考转录组的物种，比对的准确率很高，不过index很大，至少需要30G以上内存才能运行。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-23/:1:2","tags":["AQ100","mapping"],"title":"【bioinfo】-Q\u0026A-23","uri":"/bioinfo-q-a-23/"},{"categories":["bioinfo","ngs"],"content":"3. 提出问题 问题1： 如果你有一套标准的polyA捕获得到的RNA-Seq测序数据，对reads进行了前处理工作与质量控制工作，但是你的比对策略为：先尝试mapping，把能mapping到基因组上的reads都先mapping；然后把不能进行mapping的reads进行一定规则的拆分，再进行第二轮mapping，从而解决跨intron区域的问题（以上为tophat的mapping策略）。请问，这样mapping的最大问题是什么？（提示，需要知道一些假基因的概念！） 先解释一下假基因，假基因（Pseudogenes）是指一类染色体上的基因片段。假基因的序列通常与对应的基因相似，但至少是丧失了一部分功能，基因不能表达或其编码的蛋白质没有功能； 这种基因在基因组上的分布非常普遍，那么在假基因普遍存在的情况下上述比对策略就会受到假基因的干扰，会有很多基因比对到假基因上 问题2： 在human中，是不是所有的蛋白基因（protein coding gene）都含有intron？ 并不是，SRY基因是人体Y染色体上的一段基因，该基因是决定男性睾丸发育的主要基因，存在于Y染色体的短臂末端上，该基因只有一个exon 问题3： 在human中，是不是所有的蛋白基因的成熟mRNA都有polyA尾巴？ 并不是，组蛋白mRNA末端就没有polyA尾巴 ","date":"2020-02-18","objectID":"/bioinfo-q-a-23/:1:3","tags":["AQ100","mapping"],"title":"【bioinfo】-Q\u0026A-23","uri":"/bioinfo-q-a-23/"},{"categories":["bioinfo","ngs"],"content":"第22题 都有了SAM文件，为什么还需要BAM文件？ Hello 大家好！ 前面的若干问题，我们一直在围绕着SAM文件的记录格式做了详细地讨论，我相信大家通过我们的问题，跟随我们学习的思路已经掌握了SAM文件作为标准的比对格式的合理性以及相关特点。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-22/:1:0","tags":["AQ100","SAM","BAM","samtools"],"title":"【bioinfo】-Q\u0026A-22","uri":"/bioinfo-q-a-22/"},{"categories":["bioinfo","ngs"],"content":"1. 背景介绍和数据下载 SAM文件不但记录了reads详细的mapping信息，还记录了reads的原始信息，内容很是全面。这样很好，但也存在很多问题： 比如我的原始FASTQ文件是100G，那么我的SAM文件一定是大于100G的，也就是占用了更多空间； mapping的结果是没有排序，无论是按reads 的 name排序还是按在基因组上的位置排序，都没有。所以默认的SAM输出文件是乱序的，处理很不方便； mapping的结果不能进行随机访问，什么是随机访问呢？举个例子就是说对于一个SAM文件我不能快速地访问比如chr1 10000 - 200000 这个区域的所有reads 的mapping情况。 基于以上这3个问题，BAM文件就出现了，并且完美解决了上面3个问题。为了方便我们今天的展示和说明，我为大家准备了1个很小的SAM文件，大约只有4MB，请大家下载下来并完成我们的相关问题。 # SAM测试文件的baidu盘下载地址 链接：https://pan.baidu.com/s/15gVVYPRu3VbF_uKbJUUGrA 密码：2drn 同时，我们今天要使用的工具是Linux下的samtools，请没有Linux的老铁去安装Linux（我们马上就会有教程出来）；请没有安装samtools软件的老铁使用conda安装需要软件，教程可以移步(用Anaconda快速搭建生物信息学分析平台) ","date":"2020-02-18","objectID":"/bioinfo-q-a-22/:1:1","tags":["AQ100","SAM","BAM","samtools"],"title":"【bioinfo】-Q\u0026A-22","uri":"/bioinfo-q-a-22/"},{"categories":["bioinfo","ngs"],"content":"2. 思路讲解 BAM文件是SAM文件的一种压缩格式，也是最常用的一种比对结果的压缩格式。它一般可以将SAM文件压缩到只有原来的20~30%大小，并且使用非常方便。 同时，对于BAM文件，我们一般还会进行排序，根据不同的需要，我们排序的方法一般有2种：第1种是按照mapping到的参考基因组的坐标上下游顺序来排序，是samtools的默认排序方法；第2种是按照reads name进行排序，需要增加一个-n参数。 对于一个已经排序好的BAM文件，我们通常会建立索引文件，后缀名一般是在BAM文件名的后面多个“.bai“。有了BAM以及索引文件的出现，我们就可以随机访问任意一段染色体区域的BAM文件。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-22/:1:2","tags":["AQ100","SAM","BAM","samtools"],"title":"【bioinfo】-Q\u0026A-22","uri":"/bioinfo-q-a-22/"},{"categories":["bioinfo","ngs"],"content":"3. 提出问题 那么我们今天的问题也很简单，就是使用samtools工具对我们的测试数据test.sam文件进行操作。具体要求如下： 1. 使用samtools view 命令查看test.sam的header，请记录各条染色体的长度；同时告知这个test.sam文件是使用哪种mapping软件进行mapping的？ 看header中的@PG ID，显示使用的mapping软件是bowtie2，header中显示各条染⾊体的长度如下图: 2. 使用samtools view命令将test.sam文件转换成test.bam文件，并保留header区域，写出命令并记录test.sam，test.bam的文件大小。 使用的命令如下:( -b:输出文件为bam格式; -h,输出中包含header信息) samtools view -b -h test.sam \u003e test.bam 结果显示test.sam⽂件大小是3.9M，而test.bam文件则是660K，bam⽂文件会小很多; 3. 使用less命令分别查看test.sam，test.bam文件，为什么bam文件会输出乱码？使用samtools view命令再试试看？ less命令可以正常查看sam文件，但是不能正常查看bam⽂文件，因为bam文件是二进制文件，所以需要使用 samtools view test.bam来查看bam文件。 4. 使用samtools sort命令对test.bam文件进行排序，输出文件名为test_sort.bam，并记录文件大小。 首先解释一下samtools sort命令: sort命令的使用: samtools sort [-l level] [-m maxMem] [-o out.bam] [-O format] [-n] [-T tmpprefix] [-@ threads] [in.sam|in.bam] 参数: -l INT 设置输出文件压缩等级。0-9，0是不压缩，9是压缩等级最高。不设置此参数时，使用默认压缩等级; -m INT 设置每个线程运行时的内存大小，可以使用K，M和G表示内存大⼩。 n 设置按照read名称进行排序; -o FILE 设置最终排序后的输出文件名; -T PREFIX 设置临时文件的前缀; -O FORMAT 设置最终输出的文件格式，可以是bam，sam或者cram，默认为bam; -@ INT 设置排序和压缩是的线程数量，默认是单线程。 对test.bam进行排序，不压缩，默认线程，设置最终输出名称为test_sort.bam， 默认临时文件前缀，默认输出bam文件，默认单线程; 使⽤用命令如下: samtools sort -o test_sort.bam test.bam 结果显示 test.bam 660K; test_sort.bam 660K 也就是排序之后的bam⽂件⼤小不变。 5. 使用samtools index 对test_sort.bam建立index，写出命令并记录其文件大小。 samtools index [-bc] [-m INT] \u003cin.bam\u003e [out.index] 参数: -b 创建bai索引⽂献(默认); -c 创建csi索引⽂献; -m INT 创建csi索引⽂献，最小间隔值2^INT; \u003e samtools index test_sort.bam \u003e ls -hs 结果: test_sort.bam.bai 4.0K 6. 使用samtools tview使用下面的命令查看chr1:160000-160100区域的比对情况，并截图 samtools tview -p chr1:160000-160100 test_sort.bam ","date":"2020-02-18","objectID":"/bioinfo-q-a-22/:1:3","tags":["AQ100","SAM","BAM","samtools"],"title":"【bioinfo】-Q\u0026A-22","uri":"/bioinfo-q-a-22/"},{"categories":["bioinfo","ngs"],"content":"4. 参考资料 [资料1]：本次主要是对samtools的一个应用，我建议大家直接看samtools的说明文档，比如对于view功能，直接在命令行敲击samtools view，再按回车就能出现说明文档。 [资料2]：samtools manual page ","date":"2020-02-18","objectID":"/bioinfo-q-a-22/:1:4","tags":["AQ100","SAM","BAM","samtools"],"title":"【bioinfo】-Q\u0026A-22","uri":"/bioinfo-q-a-22/"},{"categories":["bioinfo","ngs"],"content":"第21题 SAM/BAM中的附加标记信息 Hello大家好！我们今天又见面了！ 今天是第21题，我们接着之前的题目，继续学习与SAM/BAM有关的内容。今天要学习的内容是SAM/BAM文件的附加信息。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-21/:1:0","tags":["AQ100","SAM","BAM"],"title":"【bioinfo】-Q\u0026A-21","uri":"/bioinfo-q-a-21/"},{"categories":["bioinfo","ngs"],"content":"1. 基础导引部分 我们先给大家举个例子，这是一个human 的全基因组测序比对的SAM文件的11列以后的信息。第11列之前学习过了是reads的质量值，那么后面的若干标记比如MD:Z:145等等这些符号是什么意思呢？ 图1 SAM文件的11列以后的信息截图 我把上面图中的部分行的信息放到这里，供大家查阅（11列以后的内容要一直向右拖拽）。 ST-E00126:128:HJFLHCCXX:2:1206:8105:9730 99 chr1 11670 1 145M = 11898 315 AGGTGAAGCCCTGGAGATTCTTATTAGTGATTTGGGCTGGGGCCTGGCCATGTGTATTTTTTTAAATTTCCACTGATGATTTTGCTGCATGGCCGGTGTTGAGAATGACTGCGCAAATTTGCCGGATTTCCTTTGCTGTTCCTGC KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKFKKKKKKKKKKKKKKKKKKKFFKKKKKKKKKKFKKKKKKKKKKKKKKKFAK MD:Z:145 PG:Z:MarkDuplicates XG:i:0 NM:i:0 XM:i:0 XN:i:0 XO:i:0 AS:i:0 XS:i:0 YS:i:0 YT:Z:CP ST-E00126:128:HJFLHCCXX:2:2107:22820:18520 99 chr1 11682 1 145M = 11920 325 GGAGATTCTTATTAGTGATTTCGGCTGGTGCCTGGCCATGTGTATTTTTTTAAATTTCCACTGATGATTTTGCTGCATGGCCGGTGTTGAGAATGACTGCGCAAATTTGCCGGATTTCCTTTGCTGTTCCTGCATGTAGTTTAAA KKKKAAKKAFFKKKKKKFKFKKKFKKKKKKKKKKFKFKKKKKKKKKKKKKKFKFFKKKKKKFAAKAKKKKKKKKKKKKFFKKKFFFKKFKFFKKKKKKKKFFFFFKKKKKKK7\u003cFFKKKKKKAFK\u003cF\u003c\u003c7\u003cAA,,7AA\u003c7F7AA\u003c MD:Z:21G6G116 PG:Z:MarkDuplicates XG:i:0 NM:i:2 XM:i:2 XN:i:0 XO:i:0 AS:i:-12 XS:i:-12 YS:i:-6 YT:Z:CP ST-E00126:128:HJFLHCCXX:2:1210:9110:60026 163 chr1 11703 1 87M = 11840 282 GGGCTGGGGCCTGGCCATGTGTATTTTTTTAAATTTCCACTGATGATTTTGCTGCATGGCCGGTGTTGAGAATGACTGTGCAAATTT 7FKAFKFKFFFKKF\u003cFKKKFKKKFKK7F\u003cKFFKFKKKKKKKFFFF,FKKKKKKKFFKKKKK(7\u003c,AAK\u003cF7AAFKKFKFKFF\u003cA\u003c7\u003c MD:Z:78C8 PG:Z:MarkDuplicates XG:i:0 NM:i:1 XM:i:1 XN:i:0 XO:i:0 AS:i:-5 XS:i:-5 YS:i:-33 YT:Z:CP ST-E00126:128:HJFLHCCXX:2:2101:7425:68324 99 chr1 11708 1 145M = 11923 302 GGGGCCTGGCCATGTGTATTTTTTTAAATTTCCACTGATGATTTTGCTGCATGGCCGGTGTTGAGAATGACTGCGCAAATTTGCCGGATTTCCTTTGCTGTTCCTGCATGTAGTTTAAACGAGATTGCCAGCACCGGGTATCATT KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK\u003cFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKAKKKKK\u003cFKKKKFKKKKKKKKK7\u003cAKFFAFKFF\u003cKKKKKFKK\u003cFK\u003c7F,AFKFFA MD:Z:145 PG:Z:MarkDuplicates XG:i:0 NM:i:0 XM:i:0 XN:i:0 XO:i:0 AS:i:0 XS:i:0 YS:i:0 YT:Z:CP ST-E00126:128:HJFLHCCXX:2:2210:15382:54752 163 chr1 11714 1 87M = 11866 297 TGGCCATGTGTATTTTTTTAAATTTCCACTGATGATTTTGCTGCATGGCCGGTGTTGAGAATGACTGCGCAAATTTGCCGGATTTCC KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK MD:Z:87 PG:Z:MarkDuplicates XG:i:0 NM:i:0 XM:i:0 XN:i:0 XO:i:0 AS:i:0 XS:i:0 YS:i:-5 YT:Z:CP 一般呢，我们都把11列以后的内容称为可选择区域（optional fields），这个区域所有的格式都必须是TAG:TYPE:VALUE的形式，比如MD:Z:145就是一个符合规范的可选区域的值。 根据SAM格式官方文档的信息，我们需要记住以下内容： 1. 所有的TAG都是2个字母，一般情况下都是大写字母。并且TAG在1行的比对结果中只能出现1次。 2. 所有的TYPE都是单字母，大小写敏感，它是用来定义后面VALUE的类型； 3. VALUE可长可短，但是需要和之前的TYPE相呼应。 关于TYPE不同字母对应的不同数据类型，把SAM的官方文档贴一下，共大家参考。其中，最常用的就是i（带符号的数字）；Z（可直接输出字符串，可以包含空格）； 图2 TYPE的字母与不同数据类型之间的对应关系 ","date":"2020-02-18","objectID":"/bioinfo-q-a-21/:1:1","tags":["AQ100","SAM","BAM"],"title":"【bioinfo】-Q\u0026A-21","uri":"/bioinfo-q-a-21/"},{"categories":["bioinfo","ngs"],"content":"2.常用的TAG 那么常用的TAG都有哪些，都代表什么含义呢？要知道，不同的比对软件可能会在SAM文件的后面加上不同的TAG，所以我们在查询TAG含义的时候一定要从所用比对软件的官方文档中去查找。而SAM文件的header部分又包含了@PG字符段可以帮助我们还原比对软件的参数设置，因此我们拿到一个SAM文件就可以通过查阅文档的方式了解TAG的基本信息。 # 使用samtools可以查看sam文件的header部分 samtools view -H test.sam 比如，我们这里的@PG内容如下 @PG ID:bowtie2-5DEB9F7A PN:bowtie2 VN:2.2.5 CL:\"/home/biotools/bowtie2-2.2.5/bowtie2-align-s --wrapper basic-0 -p 4 --phred33 -x /lustre/user/reference/hg19/hg19_combine -S ./tmp.data/fastq/genome-sequence.sam -1 ./tmp.data/fastq/genome-sequence_L3_1_trim5.fastq -2 ./tmp.data/fastq/genome-sequence_L3_2_trim5_92.fastq\" 我们就知道这个test.sam文件使用了bowtie2这个比对软件进行了比对，因此我们在查询TAG信息的时候，我们就需要翻阅bowtie2的文档。 ","date":"2020-02-18","objectID":"/bioinfo-q-a-21/:1:2","tags":["AQ100","SAM","BAM"],"title":"【bioinfo】-Q\u0026A-21","uri":"/bioinfo-q-a-21/"},{"categories":["bioinfo","ngs"],"content":"3. 提问环节 我们今天的问题很简单，请根据bowtie2的官方文档，解释下面的比对信息： ST-E00126:128:HJFLHCCXX:2:2107:22820:18520 99 chr1 11682 1 145M = 11920 325 GGAGATTCTTATTAGTGATTTCGGCTGGTGCCTGGCCATGTGTATTTTTTTAAATTTCCACTGATGATTTTGCTGCATGGCCGGTGTTGAGAATGACTGCGCAAATTTGCCGGATTTCCTTTGCTGTTCCTGCATGTAGTTTAAA KKKKAAKKAFFKKKKKKFKFKKKFKKKKKKKKKKFKFKKKKKKKKKKKKKKFKFFKKKKKKFAAKAKKKKKKKKKKKKFFKKKFFFKKFKFFKKKKKKKKFFFFFKKKKKKK7\u003cFFKKKKKKAFK\u003cF\u003c\u003c7\u003cAA,,7AA\u003c7F7AA\u003c MD:Z:21G6G116 XG:i:0 NM:i:2 XM:i:2 XN:i:0 XO:i:0 AS:i:-12 XS:i:-12 YS:i:-6 YT:Z:CP 1. ST-E00126:128:HJFLHCCXX:2:2107:22820:18520 \u003e 序列名称，比对片段的编号，通常包括测序平台的信息 2. 99 \u003e Flag值 3. chr1 \u003e 回帖到的染色体名称 4. 11682 \u003e 比对到染色体上的具体位置(比对到正链最左边bp的位置点) 5. 1 \u003e 比对的质量值，叫做MAPQ，MAPQ=-10 * log10{mapping出错的概率} 6. 145M \u003e CIGAR值，描述具体的⽐对情况 7. = \u003e pair reads中与该序列配对的read所mapping到的参考序列，如果没有mapping到同一条参考序列上，则⽤用“*”代替。 8. 11920 \u003e pair reads中与该序列配对的read所mapping到的参考序列的具体位置 9. 325 \u003e 通过分析pair reads mapping到同一条参考序列上位置的推断得到fragment的长度 10. GGAGA....TTAAA \u003e read序列信息 11. KKKKA....F7AA\u003c \u003e read序列测序每一bp的质量量值 12. MD:Z:21G6G116 \u003e MD:Z:表示在比对过程中有mismatch的情况，后面字符串表示mismatch的具体位置 13. XG:i:0 \u003e XG:i有gap的存在，后面数字表示gap的总长度(read和reference上的都计算在内) 14. NM:i:2 \u003e 编辑距离，为了将read map到reference上，对read进行单核苷酸编辑(替换、插⼊入以及删除)的最小长度 15. XM:i:2 \u003e mismatche的具体数⽬ 16. XN:i:0 \u003e 序列覆盖区的参考基因组上不不确定的base数 17. XO:i:0 \u003e gap的具体数目 18. AS:i:-12 \u003e 比对分数，允许负值，局部比对最终可以大于0，但是全局比对中不会 19. XS:i:-12 \u003e ⽐对过程中出现的⽐最终报告分数(AS:i:-12)⾼的⽐对值，同样允许负值，局部比对最终可以大于0，但是 全局比对中不会。当一条序列能够同时比对到多个位点，且出现连续局部相似度极⾼的情况下会出现这种情况。 20. YS:i:-6 \u003e 与该序列配对的pair read的⽐对分数 21. YT:Z:CP \u003e YT:Z:代表pair-read的比对情况，“UU”代表没有配对的read; \"CP\"代表序列为pair reads之一，pair align cordantly;\"DP\"表序列为pair reads之一，pair align discordantly;\"UP\"代表序列为pair reads之一，但是pair没有⽐对到参考基因组上。 参考资料： Bowtie 2-官方使用手册-SAM output部分 ","date":"2020-02-18","objectID":"/bioinfo-q-a-21/:1:3","tags":["AQ100","SAM","BAM"],"title":"【bioinfo】-Q\u0026A-21","uri":"/bioinfo-q-a-21/"},{"categories":["bioinfo","ngs"],"content":"第20题 SAM/BAM中的其它重要信息列 Hello大家好！今天我们又见面了！ 今天我们来继续探索SAM/BAM文件的信息列。 我们之前已经说过，1个标准的SAM文件包含前面的11列标准信息列和若干标识符信息列（如表1所示），其中前面的6列我们已经为大家解释清楚。那么今天我们来继续探索剩下的7到11列。 表1 SAM格式的标准11列信息介绍 第7列，一般情况下是指Pair read的另一半的比对的参考基因组； 第8列，一般情况下是指Pair read的另一半的比对的参考基因组的坐标； 第9列，可以简单理解为这1对read比对到基因组上以后，上游第1个碱基到下游最后1个碱基的距离。如果用负号表示是下游的序列；如果是正数表示为上游的序列；如果是0表示只是单端比对上； 第10列，进行比对read的序列信息； 第11列，进行比对read的质量信息； 对于我们今天的简单讲解，其实还涉及到很多概念，就比如在SAM官方文档中，对template，segment，read的各自定义就很让人挠头，我也是用了很长的时间才弄懂学会的。大家有兴趣的可以看一下图2我的截图，看看里面的定义。 那么我们今天的问题如下： 1. 图1中第20行，第9列记录了TLEN值，请你根据今天的文章与图1中的信息，列出算式计算TLEN值。 TLEN是Template的观测长度length 第二十行关键内容如下： 第四列：11123 # mapping的位置开端 第六列：145M # CIGAR 第八列：10946 # pair reads中与该序列配对的read所mapping到参考序列的具体位置 第九列：-322 # 通过分析pair reads mapping到同一条参考序列上位置的推断得到fragment的长度 image-20200215120747953 -(11123-10946+145) = -322 2. 如果使用FASTA文件作为input，第11列的质量值是否还有意义？为什么？ 没有意义，因为fasta⽂文件信息不不包含read的质量量值，11列列的质量量值本身是测序质量量值，所以没有参考意义。 3. 有没有可能通过SAM文件，提取里面的序列信息并转换成FASTQ格式的文件？如果可能，请你写出程序思路。 samtools view -b -h -S filter_MAPQ20.sam \u003e filter_MAPQ20.bam samtools bam2fq filter_MAPQ20.bam \u003e filter_MAPQ20.fastq # [M::bam2fq_mainloop] processed 629 reads 该问题参考资料-bam to fq ","date":"2020-02-17","objectID":"/bioinfo-q-a-20/:1:0","tags":["AQ100","SAM","BAM"],"title":"【bioinfo】-Q\u0026A-20","uri":"/bioinfo-q-a-20/"},{"categories":["bioinfo","ngs"],"content":"第19题 SAM/BAM中的CIGAR值 Hello大家好！我们又见面了！ 今天我们来和大家一起继续学习SAM/BAM文件的文件结构与特性。 我们之前学习到了从SAM文件是用来存储序列mapping结果的标准格式，BAM文件是SAM文件的压缩格式，二者在信息层面是等价的。 SAM/BAM文件的前面5列，分别记录了，各位可以对照下图1中的内容对应一下。 1. 序列的名称； 2. FLAG值； 3. 比对到的染色体； 4. 比对到的染色体的具体位置； 5. 比对的质量值， 也叫MAPQ； 图1 全基因组测序的比对数据 那么第6列信息到底是什么呢？它其实是比对的一个简单描述，有一个很好听的名字叫CIGAR值（对滴，就是雪茄烟的那个单词）。 CIGAR = Concise Idiosyncratic Gapped Alignment Report 我们先来简单理解一下CIGAR值。 例子1：如图1第37行，CIGAR = 56M1I30M； 它的含义就是：这条序列与参考基因组相比； 前56bp能够match上； 中间有1bp的insertion（相比于参考基因组有1bp的插入）； 最后是30bp的match 例子2：如图1第50行，CIGAR=145M， 含义就是：这条序列与参考基因组比对的结果是145bp完全match上。 那么常用的CIGAR标记符号都有哪些呢？根据SAM格式的官方文档如图2所示。 表1 常用的CIGAR符号 目前，我们只需要了解到前面7个，后面的=，X已经很不常用了，大家可以先忽略一下。 我们今天就是让大家去理解CIGAR值到底是什么，因此我们今天的问题就是： 1. M,I,D,N分别是什么意思？如果1条序列的CIGAR=150M， 那么是不是可以说这150bp的区域中没有mismatch（错配）的现象？ M:序列列匹配或错配 I:参考序列上的插入 D:参考序列上的缺失 N:参考序列上的跳跃区 150M不能说150bp区域区域中没有错配，因为M表示完全匹配; 但是⽆论reads与序列的正确匹配或是错误匹配该位置都显示为M 。 2. 如果1条序列来自于成熟的mRNA，在mapping到基因组的时候会有什么问题？如果这条序列中间正好跨过了200bp的intron，前后各有75bp mapping到了exon上，那么这条序列的CIGAR值应该怎么写？ - 错配，intron,跳跃区; - CIGAR:75M200N75M 3. 根据下图提示，请理解clip的含义，无论是softclip还是hardclip。 引自http://bioinformatics.cvr.ac.uk/blog/tag/cigar-string/ 以r003序列为例，两个比对结果中序列剪切之后进行比对，那么所对应的CIGAR分别是5S6M和6H14N5M; 最终bam文件中序列分别是11bp和25bp, 这说明，在read进行softclip后，reads的原始信息在BAM文件中依然保留; 但是hardclip中，reads只在BAM文件中保留了切除以后的序列将直接被删除。 ","date":"2020-02-17","objectID":"/bioinfo-q-a-19/:1:0","tags":["AQ100","SAM","BAM"],"title":"【bioinfo】-Q\u0026A-19","uri":"/bioinfo-q-a-19/"},{"categories":["bioinfo","ngs"],"content":"第18题 高通量比对的质量MAPQ Hello 大家好！ 我们又见面了！ 今天我们接着昨天的内容，为大家介绍一下比对的质量MAPQ。 FASTQ格式的第4行记录的是每一个碱基的测序质量信息，也叫phred值。1个FASTQ记录的例子如下： @HWI-ST1350:124:C1C2TACXX:3:1101:1223:2042 CTTTTCGAGTCAGACACATGACAGCCGGCAGCAACTGGAATGGCAGCAATT + BBCFFFFFGHHHHJJIJJIIJJJJIJJJGIJIIJJIJIGIIJJGIIIJIIG 我们在mapping的时候，会遇到一个问题，比如就用我们上面给大家展示的FASTQ序列举例。 如果这条序列（readA）最终可以比对到： 1号染色体的100000这个位置，但其中包含了1个mismatch（错配）； 或者是2号染色体的200000这个位置，但是有2个错配。 那readA到底是比对到第1个位置还是第2个位置呢？ 这个时候就需要1个度量值来帮我们做判断，选择1个最好的作为最终的比对结果（当然研究一些比较特殊问题的时候需要把相似的比对结果都输出出来），这个度量值就是MAPQ。 ","date":"2020-02-17","objectID":"/bioinfo-q-a-18/:1:0","tags":["AQ100","MAPQ"],"title":"【bioinfo】-Q\u0026A-18","uri":"/bioinfo-q-a-18/"},{"categories":["bioinfo","ngs"],"content":"那么MAPQ是什么意思呢？ 根据SAM文件的官方定义： MAPQ: Mapping Quality. It equals -10 log10 Pr{mapping position is wrong}, rounded to the nearest integer. A value 255 indicates that the mapping quality is not available. 简单翻译一下：MAPQ是mapping的质量值，计算方法与FASTQ的质量值类似， MAPQ=-10 * log10{mapping出错的概率} 当MAPQ=255的时候，代表MAPQ没有意义，就是一个占位符。 ","date":"2020-02-17","objectID":"/bioinfo-q-a-18/:1:1","tags":["AQ100","MAPQ"],"title":"【bioinfo】-Q\u0026A-18","uri":"/bioinfo-q-a-18/"},{"categories":["bioinfo","ngs"],"content":"那么怎么计算MAPQ呢？ 到了这里，可能又会有同学问了，虽然我们知道了MAPQ的含义，但是里面有一个mapping出错的概率，我应该怎么计算呢？这是一个非常容易问到的问题！ 而我的回答是： 根据mapping的情况，然后结合碱基的测序质量值进行评估。 核心思想是， 低质量的碱基如果进行了mismatch（错配），那么很有可能是测序错误导致的，不应该罚太多分； 低质量的碱基如果与参考基因组完美match（匹配），那么也很有可能是测序错误导致的，不应该加太多分。 以我们下面的图1内容为例，第5列是MAPQ值，一般在后续分析的时候，我们都需要把MAPQ质量过低的reads去掉，一般的cutoff是MAPQ≥10，严格一些的比如去寻找somatic mutation的时候需要MAPQ≥30. 图1 标准的SAM文件截图 好了，说了这么多，我们今天的思考如下： 1. 如果mapping的时候输入的是FASTA文件，那么MAPQ还有意义吗？为什么？ 没有意义。FASTA不包含测序质量信息，因此最后的MAPQ无法计算，也没有意义，常⽤用255代替。 2. 不同的比对软件比如bwa与bowtie2，计算出来的MAPQ意义相同吗？为什么？ BWA与Bowtie2的核心算法相同，但是比对策略和最终判断输出结果的评价体系不同。 MAPQ虽然代表的均是mapping的质量值，但是不同算法软件之间的MAPQ不能同时比较。 简单来说，我们不能认为BWA中MAPQ=42就要好于Bowtie2的MAPQ=40，反之亦然！ 3. 请写出samtools view 命令 获得MAPQ 大于等于20的sam文件，假设原始的sam文件名为raw.sam，过滤后的sam文件名为filter_MAPQ20.sam samtools view -S -q 20 ./raw.sam \u003e ./filter_MAPQ20.sam # -S input is sam file; # -q INT minimum mapping quality ; image-20200215010334720 ","date":"2020-02-17","objectID":"/bioinfo-q-a-18/:1:2","tags":["AQ100","MAPQ"],"title":"【bioinfo】-Q\u0026A-18","uri":"/bioinfo-q-a-18/"},{"categories":["bioinfo","ngs"],"content":"第17题 高通量测序的回贴问题 II (SAM文件与BAM文件) Hello大家好！ 我们今天又见面了！ 我们从第16题开始，正式接触了高通量测序mapping的内容，可能有的朋友又忘记了mapping的定义，我们再来回顾一下这个概念。 ***“比对“对应的单词是alignment，***往往特指低通量的序列之间的比较。比如10条序列，进行多序列比对就是我们常说的 multiple alignment问题；如果是2条序列的比对，我们经常称其为pairwise alignment. ***“回贴”通常对应的单词应该是mapping，***一般指高通量的数据去寻找基因组的位置。比如我们进行测序以后，有10^6对read pair，要去寻找他们在基因组上的位置，这个时候就是一个典型的mapping问题。 我们再把思路理清楚，在进行mapping的时候， 输入文件应该包含： 测序结果（通常是FASTQ或者是FASTQ的压缩文件） 之前建立好的参考基因组的index文件（不同的mapping软件建立的方法大同小异，但一般都是提前构建） 输出文件应该包括： 比对的结果文件（一般是SAM文件格式或者是BAM文件格式） 比对的情况报告 今天我们就要谈一谈SAM/BAM文件格式。 首先先说二者之间的关系，BAM文件是SAM文件的压缩格式，压缩以后可以节省空间，排好序的BAM文件还可以提供随机访问功能，性能优良。但是BAM文件和SAM文件储存的内容是完全一样的。我们以后还要单独再说BAM文件的操作方法，今天我们把重点放在文件中的内容上。 SAM文件的全称是：**Sequence Alignment Map，**它设计之初就是为了存储mapping结果的。 一个标准的SAM文件由2部分组成： 第1部分是以“@”开头的头部，在文件的最前面； \u0010第2部分就是紧跟在头部后面的比对结果文件。 我们先来看一个例子（图1）。 图1 SAM文件的内容 在Linux中，访问sam文件最好用的工具是samtools，常用的操作如下： # 假设SAM文件的文件名是 test.sam # 1.只查看头部 samtools view -H test.sam # 2.只查看内容，不查看头部 samtools view test.sam # 3.查看头部内容 samtools view -h test.sam # 4.查看帮助文档 samtools view 另外，通常情况下，1行SAM文件的内容包含有多列，标准的SAM文件会包含11列内容，其中每一列的内容代表的意思与简单的描述如下。我们今天主要关注的是前面4列内容。 图2 标准SAM文件中的11列内容代表的含义 图3 SAM文件中的前4列内容 说了这么多，那么我们今天的问题如下： 1. SAM文件的头部内容中常见的标志符号有@HD，@SQ，@PG，请问这三者后面跟随的信息分别是什么意思？ - 这三者都属于注释信息; - @HD:说明符合标准的版本、对比结果是否进行了排序 - @SQ:参考序列列说明 - @PG:得到的文件都经过了哪些处理理，⽐比如mapping的详细程序等等; 2. 图3是SAM文件内容的前4列（最前面的序号是我加上去的，不包含在SAM文件中），那么请你解释一下这4列分别代表什么意思？其中的FLAG是第几列，是什么意思？ - QNAME:比对片段的编号；以及read name，通常包括测序平台的信息； - FALG:比对情况的代表值，也叫做位标识，每一个数字代表一种比对情况，这里的值是符合情况的数字相加总和； - flag取值: 1(1) 该read是成对的paired reads中的⼀一个 2(10) paired reads中每个都正确⽐比对到参考序列列上 4(100) 该read没比对到参考序列上 8(1000) 与该read成对的matepair read没有比对到参考序列上 16(10000) 该read其反向互补序列能够比对到参考序列 32(100000) 与该read成对的matepair read其反向互补序列能够比对到参考序列 64(1000000) 在paired reads中，该read是与参考序列比对的第一条 128(10000000) 在paired reads中，该read是与参考序列比对的第二条 256(100000000) 该read是次优的比对结果 512(1000000000) 该read没有通过质量控制 1024(10000000000) 由于PCR或测序错误产生的重复reads 2048(100000000000) 补充匹配的read 3. 如果1条序列的FLAG=83 （图3标号38的行）请解释其比对含义。 使⽤用Explain SAM Flags⼯工具，结果如下: FLAG = 1+2+16+64=83 ，不不同数字对应的解释如上。即当FLAG=83时，这代表着: (1)序列列是双端测序的结果; (2)mapping的结果正常; (3)reads mapping到了了genome的负链上; (4)此reads为reads1 ","date":"2020-02-17","objectID":"/bioinfo-q-a-17/:1:0","tags":["AQ100","BAM","SAM","mapping"],"title":"【bioinfo】-Q\u0026A-17","uri":"/bioinfo-q-a-17/"},{"categories":["bioinfo","ngs"],"content":"第16题 高通量测序的回贴问题 I Hello大家好！我们又见面了！ 在这之前，我们一直在讨论怎么去做FASTQ文件的质控，怎么trim，怎么cutadapt；还为大家介绍了从双序列比对的最根本的原理及算法；再到后来学习了低通量的找相似序列的办法BLAST以及基因组快速定位的办法BLAT。那么从今天开始以后的若干问都是与高通量测序结果的回贴（mapping）问题有关。 首先来看一下技术路线图： 从FASTQ到SAM路线图 我们的核心任务是从FASTQ文件开始，经过中间的质控，最终找到序列在基因组上的定位。 那么，我们之前的算法和方法能不能高效完成这个问题呢，答案是不行的！因为这次我们的输入常常是10^7 甚至更多的reads，而且是要在全基因组上寻找定位，比如人的基因组有3Gbp大！所以如果不优化算法，估计mapping这个问题就要等到地老天荒。关于mapping的算法问题，我之前录过1期视频，专门推导了为什么应用BWT算法就可以完成我们这项艰巨的任务。 踏踏实实做技术：BWA，Bowtie，Bowtie2的比对算法推导 谈完了算法，我们再谈谈比对软件。目前市面上针对DNA测序的结果mapping的比对软件有很多。针对2代测序优化过的，最常用的有Bowtie，Bowtie2，BWA这三款；针对3代测序优化的比对软件有BLASR，LAST，BWA-MEM等等。因为目前二代测序占据了90%以上的市场份额，因此我们前期主要讨论的内容是二代测序的比对问题，也就是Bowtie，Bowtie2，BWA这三款软件。 其实，看过我上面BWT推导的朋友应该能够知道，这三个软件本质上的算法是没有区别的，有区别的地方都是小修小改。所以上，理解了其中的1个，其他的也都很好理解。我们会发现，这些算法的最基础的要点就是都要有1个index。 那么什么是index呢？简单来说就是若干个文件，方便我们快速地访问及搜索基因组。上面我说的这些比对软件都需要建立index。 一般建立index的输入文件为参考基因组序列（FASTA格式）和1个我们指定的index-name；输出为若干个以index-name为开头的index文件。比如我们使用Bowtie2，以human reference genome建立index的命令为： # build-index by Bowtie2 \u003e bowtie2-build hg19_only_chromosome.fa hg19_only_chromosome \u0026 # 解释 #### bowtie2-build为建立index的命令，安装bowtie2以后就可以用； #### hg19_only_chromosome.fa 为human genome的参考基因组，FASTA格式； #### hg19_only_chromosome 为建立index需要指定的名称； 最终建立index输出结果如图2： 使用bowtie2建立的human genome index 1. 为什么FASTQ文件的快速比对需要建立index？ 主要是为了加快比对速度，Index简单来说就是若干个文件，方便程序快速地访问及搜索基因组； 在Index的帮助下，比对软件可以把序列比对的问题的时间复杂度降低 2. 如果我从1个网站上下载的是1个物种的参考转录组的序列，其中包含了A,U,C,G碱基，我的FASTQ为该物种转录组测序的结果，用A,G,T,C，4种碱基来表示。那么需不需要在建立index之前把参考转录组中的U全部都换成T？ 需要转化，因为比对程序并不能将U直接识别为T 3. 请在Linux环境下，下载human genome 19参考基因组的1号染色体序列；并使用bowtie 建立index。 weget -c -o ./test http://hgdownload.soe.ucsc.edu/goldenPath/hg19/chromosomes/ch r1.fa.gz \u0026 # -o，将⽂文件下载到指定⽬目录中 # -c，断点传续 # \u0026,后台运⾏行行 下载得到的⽂文件为 chr1.fa.gz，压缩格式，解压⽂文件 gzip -d ./test/chr1.fa.gz 解压得到chr1.fa，下⼀一步建⽴立Index bowtie2-build ./test/chr1.fa ./test/chr1_bowtie2_index \u0026 得到 chr1_bowtie2_index.bt2 ，注意，调⽤用index时使⽤用的名字为 chr1_bowtie2_index 我用的是整合在一起的hg19_genome.fa，以下是命令和生成结果 bowtie2-build hg19_genome.fa hg19_genome_bowtie2_index \u0026 ","date":"2020-02-17","objectID":"/bioinfo-q-a-16/:1:0","tags":["AQ100","mapping"],"title":"【bioinfo】-Q\u0026A-16","uri":"/bioinfo-q-a-16/"},{"categories":["bioinfo","ngs"],"content":"第15题 知道了BLAST，可是你知道BLAT吗？ Hello大家好！ 我们又见面了！又是新的一周，又是元气满满的一天！ 今天我们讨论讨论低通量比对的最后一次问题，来为大家介绍一下BLAT。 可能看到BLAT这个名字，你可能会懵逼，不是BLAST吗？怎么少了个S？？？我们来为大家解释一下这个问题。 BLAST = Basic Local Alignment Search Tool； BLAT = BLAST-like alignment tool； 从名字上，我们可以知道结论，BLAST是为了寻找1条SeqA的相似序列。一般输入的是1条FASTA序列，使用的参考序列是所有常见生物，包括微生物在内的非冗余数据库。特点是可以找到所有已知序列生物的相似序列。 优点是全，缺点是有的时候输出冗余。 比如，有时我只需要在某一种我想要的物种的基因组上进行快速的序列定位，结果BLAST却把所有的相似序列都找出来了。从时间上，还有从输出的冗余程度来说，这都不是最优解。所以BLAT工具应运而生！ BLAT的功能，简单来说就是我有1条序列SeqA，我想知道SeqA在某一种基因组中的定位（比如human genome）的工具。 在线的BLAT工具地址是Human BLAT Search； 或者可以通过打开UCSC genome browser –\u003e tools –\u003e BLAT的方式打开； 在UCSC genome browser中打开BLAT,点开BLAT以后的页面如下： 第1行是你要选择的基因组的参数，比如我们这里常用的就是人的参考基因组hg19版本。 下面的白框可以用来输入序列，用标准的FASTA格式就行。之后点submit就大功告成！ 我们今天的问题比较具体，也是我实际分析数据的时候遇到的1个问题。 假设，我们有1个小RNA的测序结果，这些RNA的平均长度小于200bp；我们在比对到小RNA的序列库的候，发现有一个非常奇怪的现象。有2条miRNA的序列mapping到了非常多的reads数目，但是剩下的1800种miRNA总共才mapping到了10000条reads. \u003e 具体数目如下： hsa-mir-7641-2 2000000 hsa-mir-7641-1 50000 通过miRBase检索，我们得到序列如下： \u003ehsa-mir-7641-2 GUUUGAUCUCGGAAGCUAAGCAGGGUCGGGCCUGGUUAGUACUUGGAUGGGAG \u003e\u003ehsa-mir-7641-1 UCUCGUUUGAUCUCGGAAGCUAAGCAGGGUUGGGCCUGGUUAGUACUUGGAUGGGAAACUU 请尝试使用BLAT，Pairwise alignment等工具探索并解释原因。 双序列比对（Pairwise alignment）请使用下面的工具： EMBOSS Water \u003c Pairwise Sequence Alignment \u003c EMBL-EBI 首先我们通过blat检索来看⼀一下这两条序列分别定位于染色体上的什什么位置，通过blat可得: hsa-mir-7641-2 和 hsa-mir-7641-1比对到了了5SRNA中间的⼀一段序列上 对5SRNA序列与两条目的序列分别做局部双序列比对: hsa-mir-7641-1与5SRNA比对结果: hsa-mir-7641-2与5SRNA⽐比对结果: 两条目标序列局部双序列比对结果: 从上述比对结果可以看出: 1.这2条目标序列与5SRNA中的一段序列高度重合; 2.这2条目标序列重合的区域⾼度相似; 结合前面的问题中提到本次实验属于小RNA的测序， 那么建库过程中核糖体RNA不可能完全去除，最终导致了之前的比对结果 ","date":"2020-02-17","objectID":"/bioinfo-q-a-15/:1:0","tags":["BLAT","blast","AQ100"],"title":"【bioinfo】-Q\u0026A-15","uri":"/bioinfo-q-a-15/"},{"categories":["bioinfo","ngs"],"content":"第14题 你应该知道的BLAST Hello,大家好！ 从第13问开始，我们开启了序列比对之旅。 之前的第13题本质上是为了让大家学习双序列比对（pairwise alignment），接下来，我们不会去讲多序列比对（multiple alignment）的算法问题，因为多序列比对的不同算法各种各样，但很多时候的思路都是把多序列比对，分解成若干个双序列比对的问题，然后再进行最后的结果整合。所以，我们把pairwise alignment的原理与算法搞定了，就已经很OK了~ 今天我们带大家思考1个问题，就是为什么要开发BLAST算法？ 我们在第13问中学习到的是pairwise alignment的两种算法，全局比对算法与局部比对算法，无论哪种算法，得到的都是2条序列比对的最优解，当然某些时候最优解有可能有多个。那所有的序列比对问题是不是都可以用这种算法来解决了呢？ 我们来算这么1笔账。 图1 常用的搜索核酸库里面大约有47M条序列 假设我有1条序列 SeqA = 100bp（这个不是很长哟~），我想找到这条序列的相似序列。目前已知的非冗余核酸序列库，序列有47193206条，按平均长度在0.1Mbp左右。如果我们想要找到SeqA的相似序列，使用局部比对算法，那么至少就需要100bp × 0.1Mbp × 47193206条 次比较运算等于471930 × 10^9，现在服务器最快的CPU，单核心1秒可以大约运行3×10^9次，假设我们的服务器有20个核心，那么 —— 完成任务大约需要的时间 = 471930 × 10^9 ÷ 3 × 10^9 ÷ 20 = 7860秒 大约是130分钟； 如果我们的SeqA = 1000bp（这个也不是很长哟~ ）那么时间就变成了1300分钟； 我们就为了找个相似性，就要花2个小时？这个肯定不划算吧？ 所以，有了这个需求以后，一帮大佬就搞出个优化算法叫BLAST（Basic Local Alignment Search Tool）把上面这个任务的运行时间缩短到了1分钟以内。 我们今天的问题，也是请大家去观看北京大学-生物信息学导论里面的视频： 生物信息学：导论与方法(北京大学) - BLAST 在看完视频以后，请大家回答问题： 1. BLAST提高搜索速度的核心算法的名称是什么？ 启发式算法 ​2. BLAST结果中 P-value 与 E-value分别是什么意思？P-value可以大于1吗？E-value可以大于1吗？ 在BLAST结果中每一条匹配序列都会有匹配的score值和E值; S值表示两序列的相似度，分值越高表明它们之间相似的程度越大; E值是可靠性的评价，它表明在随机的情况下出现这种相似度的序列的条数。 -------------------- S值越大越好，最大是100%; E值越小越好，注意E值有可能大于1! 3. 如果想要降低BLAST的假阳性，你通常需要做什么？ - Word size的选择，BLAST算法将⽬目标序列列分割成一系列具有字段长度的小的序列进行数据库搜索，因此当此值越小得到的搜索结果越多，假阳性也就越多。 - 根据序列长度调整E值，如果检索序列较短可适当提高E值，反之可降低E值。 - 空位罚分的选择，严谨的罚分会让相似度高的序列错过，而松弛的罚分会使检索结果过多。 - 序列检索前将低复杂度的序列先去除，尤其是DNA序列列中的重复片段。 4. 假设给你一条序列，运行结果中序列相似度最高的来自于哪个物种？ \u003eProtein Sequence MVRAPCCEKMGLKKGPWTPEEDQILISYIQSNGHG NWRALPKLAGLLRCGKSCRLRWTNYLRPDIKRGNF TREEEDSIIQLHEMLGNRWSAIAARLPGRTDNEIK NVWHTHLKKRLKNYQPPQSSKRHSKNKDSKAPCTS QIALKSSNNFSNIKEDGPGLGSGPNSPQLSSSEMS TVTADSLAVTMDISNSNDQIDSSENFIPEIDESFW TDGLSTSGGGEELQVQFPFHDMKQENVEKDVGAKL EDDMDFWYSVFIKSGDLLELPEF # 使用网站 BLAST：http://blast.ncbi.nlm.nih.gov # 参数设置： Database: Non-redundant protein sequences (nr) Algorithm: blastp Word size: 3 Matrix: BLOSUM62 Gap Costs: Existence: 11 Extension: 1 其他参数默认 运⾏结果: 由图中结果可知，序列相似度最高的物种是Solanum lycopersicum，番茄。 ","date":"2020-02-17","objectID":"/bioinfo-q-a-14/:1:0","tags":["AQ100","blast"],"title":"【bioinfo】-Q\u0026A-14","uri":"/bioinfo-q-a-14/"},{"categories":["bioinfo","ngs"],"content":"第13题 从双序列比对开始学起 Hello 大家好！ 经过我们之前的12个问题，我们对Illumina 测序的原理，测序的储存模式，测序数据的质控已经有了一个比较清楚的认识。那么我们今天就开始用接下来的若干次提问来学习与比对有关的知识。 比对其实应该对应的单词是alignment，但往往特指低通量的序列之间的比较。 比如10条序列，进行多序列比对就是我们常说的 multiple alignment问题； 如果是2条序列的比对，我们经常称其为pairwise alignment. 回贴通常对应的单词应该是mapping， 一般指高通量的数据去寻找基因组的位置。 比如我们进行测序以后，有10M对read pair，要去寻找他们在基因组上的位置，这个时候就是一个典型的mapping问题。 alignment与mapping其实是密切相关的概念，所有的mapping软件其实都是从低通量的办法逐步改进而得到的。 今天我们的问题是，请各位学习一下北京大学高歌老师的《生物信息学：导论与方法》中的双序列比对（pairwise alignment）的相关算法。主要是Needleman-Wunsch算法（全局比对）和Smith-Waterman算法（局部比对）相关的内容，然后回答下面的问题。 每个视频长度都不长，希望大家认真看完！今天的内容是以后的基础，如果学不好，以后的高楼盖得再高，也有轰然倒塌的那一天！ 课程视频的链接如下： 生物信息学：导论与方法(北京大学)-序列比对中的基本概念 生物信息学：导论与方法(北京大学)-利用动态规划进行全局序列比对 生物信息学：导论与方法(北京大学)-从全局比对到局部比对 今天的问题： 如果我们假设比对的 scoring matrix 如下图1所示，同时gap的罚分d= -5 图1 序列比对的scoring matrix 假设我们的 seq1 = AAGT，seq2=AGCT；那么我们进行双序列比对，需要填写下面的表格。 1. 使用Needleman-Wunsch算法（全局比对），那么表1应该怎么填写？最终的比对结果是什么？ ​ 最终比对结果为： 2. 使用Smith-Waterman算法（局部比对），那么表1应该怎么填写？最终的比对结果是什么？ 注意:在进⾏行行局部⽐比对回溯的时候，需要从第1个⾮非零的碱基开始，沿对⻆角线⽅方向到第1个遇到0的结果为⽌止。因 此本题中，局部⽐比对的结果有3个: 第1个结果是(浅蓝⾊色): A A 第2个结果是(⻩黄⾊色): AAG A-G 第3个结果是(深蓝⾊色): T T 3. 请思考，为什么有的时候需要全局比对，有的时候需要局部比对？ 全局⽐比对，是从头到尾对序列列的每⼀一个碱基都进⾏行行⽐比对，找到最优解; 局部⽐比对，是为了了找到两条序列列中最相似的部分，可以有多个结果; 全局⽐比对能找到2条序列列⽐比对的最优解，⽤用处很⼤自不不必说，单独说说局部⽐比对的相关意义与必要性。 随着越来越多的序列列信息的产⽣生，⼈人们发现对于: 1.某些蛋⽩白序列列虽然整体相差很⼤大，但是对于某些特殊的功能域却有着极⾼高的相似性; 2.⽽且在不不同物种中序列列和功能都相当保守，这在全局⽐比对中是很难发现的; 3.另一⽅面随着70年年代内含⼦子的发现⽐比对算法必须要能够处理理由于内含⼦导致的⼤大⽚片段的差异 ","date":"2020-02-17","objectID":"/bioinfo-q-a-13/:1:0","tags":["AQ100","alignment"],"title":"【bioinfo】-Q\u0026A-13","uri":"/bioinfo-q-a-13/"},{"categories":["bioinfo","ngs"],"content":"第12题 trim与cutadapt 先用哪个？ Hello大家好！我们又见面了！ 上一次我们说到了cutadapt软件的使用问题，其中我们着重强调了1个参数-m，不知道大家还有没有印象。今天我们问题就是要使用-m参数和另一个工具联合的一个妙用。不过在这之前，我们还得先介绍1个工具箱叫fastx_toolkit. fastx_toolkit是一个系列内容的软件包，其中主要的内容是对比对前的fastq文件做质控。比如切掉一些不要的内容（fastx_trimmer），比如FASTQ与FASTA格式的转换（fastq_to_fasta），比如分单链测序的index（fastx_barcode_splitter）等等。我们今天主要是给大家说一下fastx_trimmer的用处。 fastx_trimmer主要是切掉一些fastq中你不想要的序列，比如有些序列5’端有若干bp的质量不好的或者碱基不稳定的部分；或者是5’端有一些用来去重复（duplicate）的random barcode（如图1所示）；还可能是3’端一些质量不好的碱基。 图1 前面10bp序列含有random barcode因此在比对之前需去掉。 这里我再给大家1张图，就是之前我们展示过的Human普通的RNA-Seq测序的adapter分布图（图2）。 图2-1 Human普通的RNA-Seq测序的adapter分布图 在实际数据分析与处理的过程中，会有下面几个要求： fastq文件中的adapter肯定是需要去掉的； 一些头部的random barcode也是需要去掉的； 在进行一些特殊的分析的时候，还需要保证所有的输入序列长度完全一致，不能长不能短，必须整整齐齐在一起（比如RNA-Seq的可变剪切分析经常有这个要求）。 那么我们今天的问题就是—— ","date":"2020-02-17","objectID":"/bioinfo-q-a-12/:1:0","tags":["AQ100","adapter"],"title":"【bioinfo】-Q\u0026A-12","uri":"/bioinfo-q-a-12/"},{"categories":["bioinfo","ngs"],"content":"假设你有一个RNA-Seq测序文件需要进行可变剪切分析，你需要达到的要求是： 1. 处理过后的fastq文件中不包含adapter序列； 2. 处理过后的fastq文件中的开头10bp是random barcode也需要去； 3. 最后得到的序列长度完全一致（不满足上述要求的扔掉）； 假设我们的输入文件是：input.fastq 假设我们的操作系统是：Linux Ubuntu 其中的adapter序列是：AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT 请参考cutadapt与fastx_trimmer这两个软件的使用说明，设计处理路线图。如果有可能，请给出相应的参数。 为了了达到最终⽬目的，处理理过程主要分为3步: 第1步: 使⽤用fastqc获得序列列3'端adapter以及5'端random barcode的信息; 第2步: 使⽤用cutadapt去掉3'端的adapter，务必注意需要使⽤用-m参数，只保留留⼀一定⻓长度以上的序列列; 第3步: 使⽤用fastx_trimmer去除5'端不不想要random barcode，同时截取相同⻓长度的序列列，保证最后得到的序列列⻓长度完全⼀一致。 参考代码及参数如下: # step 1, FastQC fastqc -q -t 3 -o ./FastQC_result ./input.fastq # step 2, cut adapter cutadapt -25 -m 125 \\ -a AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT \\ -o input_cutadapt.fq.gz input.fastq \u0026 # step 3, trim zcat input_cutadapt.fq.gz | fastx_trimmer \\ -f 11 -l 125 -z -o ./input_cutadapt_trim11_125.fq.gz # 经过上述3个步骤，可以获得⻓长度统⼀一为115bp的序列! ","date":"2020-02-17","objectID":"/bioinfo-q-a-12/:1:1","tags":["AQ100","adapter"],"title":"【bioinfo】-Q\u0026A-12","uri":"/bioinfo-q-a-12/"},{"categories":["bioinfo","ngs"],"content":"第11题 使用cutadapt去除adapter Hello大家好！我们又见面了！ 通过前面的生物信息学10个基础问题，我相信大家对测序的基本原理，FASTA与FASTQ格式以及FastQC的质控报告都有了一个清楚的认识。那么接下来，我们就要进一步学习，学习如何把原始的FASTQ测序结果一步一步的准备成可以用来比对（mapping）的质控过后的FASTQ。 我们知道，测序结果中可能会有若干条序列存在adapter的信息，而adapter的信息一般是不在基因组上存在的。所以，在比对之前如果不把adapter去干净，我相信你会得到1个非常非常低的mapping rate。 img 图1 RNA-Seq建库的结果，如果不去adapter接下来根本比对不上！ 通常情况下，**我们都是使用cutadapt这个软件进行adapter（接头）序列的去除。cutadapt这个软件不但支持单端序列，还支持双端序列的切除，同时还支持gz格式的自动压缩与解压缩。**1个常用的切除命令类似： # 在linux 命令行模式下 cutadapt -a ADAPTER_FWD -A ADAPTER_REV -o out.1.fastq -p out.2.fastq reads.1.fastq reads.2.fastq # -a是第1个文件的adapter序列 # -A是第2个文件的adapter序列 # -o是第1个输出文件 # -p是第2个输出文件 # reads.1.fastq 是第1个输入文件，也就是双端测序中的read-1 # reads.2.fastq 是第2个输入文件，也就是双端测序中的read-2 那么我们今天需要思考的问题，与切除adapter的具体内容有关。 1. cutadapt中-a/-A 参数与-g/-G参数分别代表什么意思？Illumina测序过程中，一般不会用到哪个参数？ -a 后⾯面跟⼀一段核苷酸序列列，代表单端测序中3'端需要去掉的adapter; -A 代表双端测序中，read2的3'端需要去掉的adapter; 注意:如果是双端测序数据，-a针对read1起作⽤用; -g 后⾯面也分别是⼀一段核苷酸序列列，代表单端测序中5'端adapter序列列; -G 的⽤用法可以类⽐比-a/-A，是针对reads2的5'端的adapter; 通常情况下，Illumina测序过程中5'端不不会测出adapter序列列，所以-G/-g⼀一般不不会被⽤用到。 2. cutadapt可以过滤一些非常短的reads，请解释其中-m 参数是什么意思？为什么要过滤一些非常短的reads？ -m 后⾯面跟着是⼀一个数字; 意思是当每条read切完adapter后如果序列列⻓长度低于这个数字就会被舍弃， 因为如果序列列⻓长度过短，则这条read不不宜被⽤用于后续的mapping。 3. 请说明用哪个参数来设置相关的cutoff，并简要说明cutadapt对read质量判断的策略与方法。 img 图2 一般3’端的序列质量不够好，即使去掉adapter以后还是需要把低质量的序列再去除1次，从而保证后续的mapping质量。 使⽤用-q命令可以再在cut adapter时将测序质量量值差的序列列去掉，设定⼀一个质量量值，低于该分数的bp将被 切掉，具体命令是: \u003e cutadapt -q 10 -o output.fastq input.fastq 需要注意的是,-q后⾯面的数字表示质量量值的低阈值，如果FASTQ⽂文件质量量值采⽤用pherd33标准，则不不⽤用备注; 但如果FASTQ⽂文件采⽤用phred64标准，则需要在代码中添加 “--quality-base=64”。 -------------------- cutadapt 去除3'端低质量量序列列的核⼼心算法 -------------------- phred = -10 × log10(Error Probability) 假设我们有13bp的序列列，其序列列和phred值分别为: A,T,G,C,C,G,T,A,C,C,G,G,T,T,A 42, 42, 41, 41, 40, 26, 27, 8, 7, 11, 4, 2, 3 假设我们的-q参数选择10，⾸首先先对所有序列列的质量量值减去这个-q后⾯面的参数，结果: 32, 32, 31, 31, 30, 16, 17, -2, -3, 1, -6, -8, -7 随后从3'⽅方向向5'⽅方向进⾏行行累加，结果如下: 164, 132, 100, 69, 38, 8, -8, -25, -23, -20, -21, -15, -7 则从3'到5'遇到累加结果的第1位⼤大于0的位置即为保留留的第1位; 所以最终保留留cut的结果为: A,T,G,C,C,G,T,A--cut here--C,C,G,G,T,T,A 这样做的好处是可以得到⽐比较稳定的⾼高测序质量量值，防⽌因为3'端某个质量量值突然提⾼高⽽而终⽌去除。 fastx_trimmer -i test_data_2.fastq -o test_data_2_trim.fastq -f 1 -l 85 cutadapt 1.16官方文档-Trim低质量区域的算法说明 ","date":"2020-02-16","objectID":"/bioinfo-q-a-11/:1:0","tags":["AQ100","FastQC","cutadapt"],"title":"【bioinfo】-Q\u0026A-「11」","uri":"/bioinfo-q-a-11/"},{"categories":["bioinfo","ngs"],"content":"第10题 读懂FastQC报告之adapter与kmer Hello大家好！ 我们又见面了！今天是我们的FastQC中最后1次提问啦！今天，我们要聊得是adapter与kmer的问题。 我们在第5题 测序建库的adapter 的时候讨论过adapter的问题，我们知道adapter的最主要的作用是为了能够与flowcell连接，方便进行桥式PCR。那么我们的fastq文件中到底含不含adapter呢？FastQC报告就能告诉我们。 同时呢，我们今天还会讨论kmer的问题，相关的报告FastQC也会输出出来。 Part I adapter部分 img 图 1-1 1个正常的adapter报告 img 图 1-2 1个RNA-Seq的adapter报告 Part II kmer部分 img 图 2-1 正常的RNA-Seq建库kmer统计 img 图 2-2 加入random barcode的RNA-Seq建库kmer统计 img 图 2-3 kmer的统计显著性分析 ","date":"2020-02-16","objectID":"/bioinfo-q-a-10/:1:0","tags":["AQ100","FastQC","adapter","kmer"],"title":"【bioinfo】-Q\u0026A-「10」","uri":"/bioinfo-q-a-10/"},{"categories":["bioinfo","ngs"],"content":"关于adapter的问题： 1. Illumina的通用adapter序列是什么？图1-1与图1-2中的各种不同颜色的图例是什么意思？ Illumina Paired End Adapters(cannot be used for multiplexing) Top adapter 5' ACACTCTTTCCCTACACGACGCTCTTCCGATC*T 3' Bottom adapter 5' P-GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG 3' **来源** http://bioinformatics.cvr.ac.uk/blog/illumina-adapter-and-primer-sequences/ 不同颜色的图例代表不同的测序通用的adapter； 如果在当时fastqc分析的时候-a选项没有内容，则默认使用图例中的通用adapter序列进行统计。 2. 图1-1与图1-2中的横坐标与纵坐标分别是什么意思？ 横坐标代表reads中的位置，纵坐标代表adapter序列含量的百分比 3. 图1-1与图1-2中最显著的差异是什么？如果两者都是RNA-Seq的数据，哪个可以继续下游分析，哪个不能够进行下游分析？为什么？ 图1-1，结果表明少量的序列3’ 端检测到了少部分的adapter序列，且测序时使用的是红色图例所代表的的adapter； 图1-2，结果表明测序时使用的是红色图例代表的adapter；除了前20bp，reads后半段序列有很高的比例都是adapter，建库可能存在问题。 ","date":"2020-02-16","objectID":"/bioinfo-q-a-10/:1:1","tags":["AQ100","FastQC","adapter","kmer"],"title":"【bioinfo】-Q\u0026A-「10」","uri":"/bioinfo-q-a-10/"},{"categories":["bioinfo","ngs"],"content":"关于kmer的问题： 如果某k个bp的短序列在reads中大量出现，其频率高于统计期望的话，fastqc将其记为over-represented k-mer。默认的k = 5，可以用**-k –kmers选项来调节，范围是2-10。出现频率总体上3倍于期望或是在某位置上5倍于期望的k-mer被认为是over-represented。fastqc除了列出所有over-represented k-mers，还会把前6个的per base distribution画出来**。 当有出现频率总体上3倍于期望或是在某位置上5倍于期望的k-mer时，报”黄色!”；当有出现频率在某位置上10倍于期望的k-mer时报”红色×”。本图所显示的结果来自于表格中前六个序列。 1. kmer就是一定长度的序列，比如AATTCCGG就可以叫做8-mer。那么图2-1余图2-2中的横坐标什么意思？纵坐标什么意思？ 横坐标代表短序列的长度，纵坐标代表某长度的短序列在所有reads中所出现的频率百分比 2. 图2-1与图2-2中哪个kmer问题比较严重？为什么？ 图2-2 的问题更严重，因为该图中kmer的出现位置集中且数量较多，可能是加入了random barcode，出现了duplication问题 3. 图2-2中是在reads的5’端加入了约10bp左右的随机序列，结合 第9题 读懂FastQC报告中的duplicate问题 这样做的目的是什么？ 一般在进行RNA-seq测序时，是不会进行remove duplication； 但是一些比较特殊的建库流程，比如单细胞RNA-seq测序时，PCR扩增轮数较多，可能出现大量的duplication； 对于这些建库方法，通常需要添加random barcode，然后需要根据random barcode进行remove duplication 思考题： 图2-3是FastQC生成的kmer是否显著的统计报告。其中的每一列是什么意思？这个统计显著性检验计算的p-value是使用什么方法计算的？ 第一列：kmer内容 第二列：kmer在序列中某一位置出现的观测数量 第三列：二项分布统计检验P-value 第四列：kmer在某一位置的观察值与理论值的比值 第五列：观察值与理论值比值最高值出现的位置 ","date":"2020-02-16","objectID":"/bioinfo-q-a-10/:1:2","tags":["AQ100","FastQC","adapter","kmer"],"title":"【bioinfo】-Q\u0026A-「10」","uri":"/bioinfo-q-a-10/"},{"categories":["bioinfo","ngs"],"content":"第9题 读懂FastQC报告中的duplicate问题 Hello大家好！ 我们又见面了！本周我们预计会把前10个问题提出来，结束我们的测序原理与FastQC部分。 今天我们来详细聊聊duplicate问题。 duplicate的产生主要是因为Illumina建库的过程中，一般会需要使用PCR来帮助扩增插入序列的浓度。 在扩增的过程中，如果PCR扩增轮数过大，就会出现duplicate的问题，即产生一模一样的若干条序列。 FastQC中“Sequence Duplication Levels”图是用来刻画duplicate情况的。 img图1 duplicate结果图 那么我们今天的问题如下： 1. 图1中的横坐标是什么意思，纵坐标是什么意思？ 横坐标代表序列重复水平，纵坐标代表重复水平序列占所有序列的百分比 2. 图1中的红线和蓝线分别代表什么意思？ 红线：代表去duplicate之后序列理论重复性分布（服从possion distribution或者binomial distribution）\u0010情况 蓝线：代表全部的序列重复性分布情况 3. 图1中的duplicate是全部序列的duplicate的情况吗？还是随机筛选了一部分？为什么要这样做？ 是选择的每一个文件里面前100, 000条序列作为样本进行的计算，因为样本本身很大，前100, 000已经能够代表样本的重复性。 4. 如果让你写程序，判断1个fastq文件中duplicate的比例，你的大概思路是什么？ # Python风格的伪代码 # 第1步，对序列进行排序 sort the FASTQ file by the sequence, and names as sorted_file; # 第2步，对排序的序列统计是否为duplicate total_num = 1 duplication_num = 0 reads_1 = sorted_file.readline() for reads_2 in sorted_file: if reads_1 == reads_2 duplication_num += 1 else: reads_1 = reads_2 total_num += 1 print(total_num) print(duplication_num) 额外的思考题： 既然谈到了duplicate的问题，那就存在remove duplicate的问题，什么情况下应该去duplicate，什么情况下不去除？ 最好的去除办法是什么？（仅需要思考一下，以后我们会有专题讨论这个问题） DNA-seq中，序列如果是随机打断，需要考虑deduplication；酶切样本一般不需要考虑这个问题； RNA-seq中，一般不考虑deduplication（有paper专门讨论过这个问题）； 但鞋包测序需要建库过程中添加random barcode，且必须考虑deduplication FastQC官方说明文档-Duplicate Sequences ","date":"2020-02-16","objectID":"/bioinfo-q-a-9/:1:0","tags":["AQ100","FastQC","duplicate"],"title":"【bioinfo】-Q\u0026A-「9」","uri":"/bioinfo-q-a-9/"},{"categories":["bioinfo","ngs"],"content":"第8题 读懂FastQC报告 Part III Hello 大家好！ 我们又见面了！ 最近总搞FastQC报告的研读，是不是都看烦了？没关系，我们再搞最后2次，就进入下一个主题啦！昨天的问题中，我们告诉大家FastQC的报告中最重要的几张图都在下面用红框框出来了。今天我们来研读2张图。 img 第1张图是：Per sequence GC content img 图1-1 human 全基因组测序FastQC 结果图 img 图1-2 human 全基因组测序FastQC 结果图 第2张图是：Sequence Length Distribution img 图2-1 刚下机以后的fastq数据进行FastQC 结果图 相关的问题与思考： 1. 图1-1 与 图1-2 中的横坐标是什么意思？ 纵坐标是什么意思？ 横轴是0-100%；纵轴是拥有相对GC含量的序列所对应的数量 2. 图1-1中是human全基因组测序，结合昨天的问题，那么peak的中间大约应该在多少？ 上一次的问题中GC总体比例大约在42%左右，所以如果这是human全基因组测序，那么peak在横坐标对应42的位置比较好 3. 图1-2与图1-1有哪些显著的不同？造成这些不同的原因有可能是什么？遇到这个问题，我们通常应该做些什么？ 图1-1有一个peak，并且与热力学理论值（蓝线）基本吻合 图1-2有两个peak，并且其中一个peak与蓝线相差很多，当红色的线出现双峰，基本上是混入了其他物种的DNA序列 遇到这个问题，首先进行mapping，统计有多大比例reads map到了目标参考基因组上，如果比例非常低说明污染严重，数据不可用 如果大部分reads都map成功，剩余一部分可以通过blast检查是混入了哪些污染物，过滤掉这些reads就可以，不影响后续的分析 4. 图2-1的横坐标是什么意思？纵坐标是什么意思？ 横坐标代表序列长度，纵坐标代表长度为某一bp的序列所对应的数量 5. 图2-1是刚下机的fastq数据进行FastQC 结果图，有什么特点？为什么会出现这样的结果？如果对刚下机的fastq数据进行cut adapter，图2-1还会是这样的结果吗？为什么？ 测序仪成功下机的数据都是整齐的一定长度的序列，比如最常用的illumina X Ten 是双端150bp； 测序过程当中产生的不足150bp的序列在下机时已经被过滤掉了； 如果进行cut adapter，序列的长度将不一致，因为reads中包含信息的insert的长度并不完全一致，150bp的测序长度是否已经包含了adapter的序列是未知的，因此cut adapter之后的reads长度不同 （这里应该说的是3’ adapter） 能力扩展题： 请想办法，计算Human genome 19（hg19）每一条染色体的GC含量。 # 思路1 - UCSC或者Emble下载Human genome 19（hg19）染色体序列； - 直接把下载的序列使用FASTQQC检测序列“质量” - report中Sequence content across all bases会显示GC结果 # 思路2 - UCSC或Emble下载Human genome 19（hg19）染色体序列； - 写Python程序一次读取序列内容； - 统计每一条染色体的GC含量； - 具体的代码及方法可以参考知乎Live ","date":"2020-02-16","objectID":"/bioinfo-q-a-8/:1:0","tags":["AQ100","FastQC"],"title":"【bioinfo】-Q\u0026A-「8」","uri":"/bioinfo-q-a-8/"},{"categories":["bioinfo","ngs"],"content":"读懂FastQC报告 Part II Hello 大家好！ 今天我们接着昨天的话题来继续进行与FastQC结果有关的提问。 我们昨天主要是针对FastQC结果中的boxplot进行了相关的探索，boxplot一般是认为FastQC几张必看的质控图之一。一般情况下FastQC的结果会包含下面几个图，而我们主要会看下图圈出来的几个。 img 接下来的几天我们就把这些图来一个一个讨论清楚。 我们昨天讨论了“Per base sequence quality”，今天先来讨论 “Per base sequence content” img图1 img图2 问题： 1. 图1与图2中横坐标是什么意思？纵坐标是什么意思？ 横轴代表1到150bp；纵轴代表ATCG在该bp的百分比 2. 图1是1个正常的DNA 全基因组测序结果，为什么前面的几bp线是波动的？后面的线是平衡的？ 根据Wason-Crick配对原则，A和T应该相等，G和C应该相等 但是一般测序的时候，刚开始测序仪状态不稳定，很可能出现不平衡的情况 像这种情况 如果测序的得分很高，可以不进行trim开始部分的序列信息 如果测序得分很低，需要进行trim开始部分的序列信息 3. 图2是1个特殊RNA建库的测序结果，4条线出现波动更可能是什么原因造成的？ RNA是单链核苷酸，GC或AT的含量并没有直接的关系 4条线的波动是由于模板中ATCG的量不同导致的（就是所谓GC不平衡） 4. 在图1中你能不能看出一个恒定的量？（提示，同一物种间相同，不同物种间一般不同）如果能看出来，这个量是什么？数值大约是多少？ GC含量在同一物种中是一个恒定值。 图1中GC总体比例大约在42%（目测） ","date":"2020-02-16","objectID":"/bioinfo-q-a-7/:1:0","tags":["AQ100","fastq","QC"],"title":"【bioinfo】-Q\u0026A-「7」","uri":"/bioinfo-q-a-7/"},{"categories":["bioinfo","ngs"],"content":"读懂FastQC报告 Part I Hello 大家好！ 通过前面的5个问题，我相信大家对Illumina测序，测序的储存文件格式，一些简单的建库原理已经有了一个初步的认识。那么接下来，我们就要用我们学到的知识去解决一些问题啦。 在实际操作和处理过程中，我们拿到的Illumina测序数据应该是.fastq.gz格式，其中gz表示的是使用gzip进行压缩，fastq表示使用fastq格式进行存储。获得数据的第一步，通常就是使用FastQC软件进行质控。 FastQC会对每一个输入的fastq.gz文件生成1个html网页和一个zip的压缩包。压缩包里是网页中包含的图片信息，因此我们只需要看网页里面整理好的内容就好。 今天的问题围绕着FastQC的质控图来展开，请看下面2张图。 img 图1 - 1个Illumina测序结果， reads1 的 per-base quality boxplot img 图2 - 1个Illumina测序结果， reads2 的 per-base quality boxplot 问题如下： 图中的横坐标表示什么意思？ 横轴是测序序列的第1个碱基到第150个碱基 图中的纵坐标表示什么意思？ 总左边表示每一bp所对应的测序质量值 前面讲过将该碱基判断错误概率值P取log10之后再乘以-10 得到的结果再加上Phred值对应ASCII表所得到的的值就是该碱基测序的质量值 Q = -10*log10(error P) 即20表示1%的错误率，30表示0.1%的错误率 图中的蓝色线是什么意思？ 蓝色的细线是各个位置的质量值的平均值的连线 图中的box 下面的bar ， 上面的bar，箱体的下沿，箱体的上沿，箱体内部的横线分别代表什么意思？ 每1个boxplot，都是该位置的所有序列的测序质量的一个统计 上面的bar是90%分位数 下面的bar是10%分位数 箱子的中间的横线是50%分位数 箱体上缘是75%分位数 箱体下缘是25%分位数 分位数解释： ​ 如果一组数的25%分位数是a，意味着a超过了这组数中25%数字的大小 图1与图2最主要的区别在哪里？结合我们之前的问题，为什么会出现这种情况？ 相比于reads 1的测序结果，reads 2的测序质量均匀性差，准确率低 主要原因： reads 2 的测序是在 reads 1 150 bp 测序完成后 forward strands再通过1次桥式PCR合成reverse strands 这之后再进行荧光测序 测序质量差的主要原因是因为长时间测序结束后，合成酶的活性降低，导致合成时加不上一些碱基，最终同步性变差，主要属于phasing错误. ","date":"2020-02-16","objectID":"/bioinfo-q-a-6/:1:0","tags":["AQ100","fastq","QC"],"title":"【bioinfo】-Q\u0026A-「6」","uri":"/bioinfo-q-a-6/"},{"categories":["bioinfo","ngs"],"content":"测序建库的adapter Hello大家好！ 上周我们已经把Illumina测序的基础内容基本搞清了，那么本周的问题我们主要是为围绕着测序后续的质控与建库细节来进行。 今天我们提出的问题是Illumina目前常用的双端测序建库办法中，会在打断的序列前后加上adapter，请问： adapter是什么意思？adapter与primer有什么区别？ adapter在中文是适配器或者接口的意思，在前面的内容中已经提到将测序序列打碎成片断后要将末端补平然后添加adapter，用于与flowcell上的oligo匹配固定并为后续桥式PCR做准备，而前面提到的Index与adapter之间的位置关系一般为adapter1-Index-fragment-adapter2，adapter2通过与oligo互补连接在flowcell上，在进行完桥式PCR之后进行测序时，添加primer，这一段primer的序列是与Index互补的而非adapter1，所以最终拿到的测序结果应该是Index+fragment+adapter2或者Index+部分fragment 比如最终的测序结果是 AATTCCGGATCGATCG…，那么adapter的序列可能出现在哪一端，还是两端都有可能出现？为什么？ 一般出现在3’端，在上面第1题中已经说到，最终的测序结果应该是Index+fragment+adapter2或者Index+部分fragment，也就是说测序的方向是从5’到3’，adapter只可能出现在3’端。 参考资料： a) 加adapter的示意图 b) Illumina测序视频 生物信息学100个基础问题 —— 第3题 Illumina测序技术细节探究 ","date":"2020-02-16","objectID":"/bioinfo-q-a-5/:1:0","tags":["AQ100","adapter"],"title":"【bioinfo】-Q\u0026A-「5」","uri":"/bioinfo-q-a-5/"},{"categories":["bioinfo","ngs"],"content":"Illumina测序技术细节探究 II 我们接着第2个问题，第3个问题接着问。既然我们已经知道的Illumina测序的基本概念，基本过程；也知道了Illumina测序的主要特点。那么还是要有个细节的探索。 Illumina目前主流的测序仪都有哪几种型号？各自大概的通量是多少？（也就是1个run能跑出多少数据） 目前主流的测序仪及其通量主要是Hiseq2500（50-1000Gb）、Hiseq3000（125-750Gb）、Hiseq4000（125-1500Gb）、Hiseq X Five（900-1800Gb）和Hiseq X Ten（900-1800Gb） Illumina目前的测序技术，最核心的就是边合成边测序，即我们常说的 Sequencing by synthesis （SBS），那么为什么能够实现SBS？ 经过桥式PCR之后同一段序列已经成簇，下一段就是开始进行测序，这一步比较简单，就是加入primer，然后添加经过特殊处理的ATCG四种碱基，特殊的地方有两点：一个是碱基部分加入了荧光基团，可以激发出不同的颜色，另一个是脱氧核糖3号位加入了叠氮基团而不是常规的羟基，这个叠氮集团保证了每次只能够在序列上添加1个碱基. 这样每1轮测序，保证只有1个碱基加入的当前测序链。这时候测序仪会发出激发光，并扫描荧光。因为一个cluster中所有的序列是一样的，所以理论上，这时候cluster中发出的荧光应该颜色一致。随后加入试剂，将脱氧核糖3号位的—N2改变成—OH，然后切掉部分荧光基团，使其在下一轮反应中，不再发出荧光。如此往复，就可以测出序列的内容。 我们在第1问中，问了大家一个问题“Illumina测序技术为什么不能像第1代测序技术一样测500bp以上？”，这里面主要涉及到两种错误，一种叫phasing，一种叫pre-phasing，分别是什么意思？ 通俗来讲phasing表示本来同步添加的碱基有一些没加上，而pre-phasing则是加多了，都会导致当前bp的荧光检测出现噪音，造成phasing的主要原因是合成酶的活性降低，而pre-phasing则可能是叠氮基团性质不稳定，转化为羟基在一步检测中添加了不止一个碱基。 reference: Diagnosing problems with phasing and pre-phasing on Illumina platforms ","date":"2020-02-16","objectID":"/bioinfo-q-a-4/:1:0","tags":["AQ100","illumina","SBS","phase correct"],"title":"【bioinfo】-Q\u0026A-「4」","uri":"/bioinfo-q-a-4/"},{"categories":["bioinfo","ngs"],"content":"Illumina测序技术细节探究 目前我们最常使用的就是Illumina公司的测序技术，Illumina公司的测序技术最明显的几个特点是：价格低，通量高，测序读长短。那么我们今天的问题，就是围绕Illumina测序技术的细节来提问的。 什么是Illumina测序adapter？同一批上机的adapter序列一样吗？它的作用是什么？ adapter的中文意思为适配器或者接口，在illumina测序过程中关键一步是将文库片段固定在flowcell上，然后通过桥式PCR将片段扩增，在被打断成300~500bp的长度的片段末端被补平后adaptor将被添加到片段两端，一方面用于将片段固定在flowcell上，同时adaptor中还包含桥式PCR所需要的引物 一个完整的Illumina测序过程是那几步？ 完整的测序过程仅包含两步，第一是桥式PCR扩增，第二是以4色荧光可逆终止反应为核心技术的测序； 什么是桥式PCR技术？为什么要进行桥式PCR？ 加上adaptor之后的DNA样品与flowcell上固定的oligo（寡链核苷酸）匹配后就被固定在flowcell上，通过桥式PCR进行扩增成cluster,便于后面的荧光测序，主要步骤为： 进行第一轮扩增，将序列补成双链。加入NaOH强碱性溶液破坏DNA的双链，并洗脱。由于最开始的序列是使用化学键连接的，所以不会被洗。 加入缓冲溶液，这时候序列自由端的部分就会和旁边的oligo进行匹配 进行一轮PCR，在PCR的过程中，序列是弯成桥状，所以叫桥式PCR，一轮桥式PCR可以使得序列扩增1倍 如此循环下去，就会得到一个具有完全相同序列的cluster 我们都说，测序结果会包含index，那么index是什么？有什么作用？ 一条lane能测得的数据量在30G左右，而一个样品的测序量一般不会这么大，所以在建库的时候对每一种样品的接头加上不同的标签序列，这个标签就叫做Index，有了index就可以同时在一个lane中测多种数据了，后期可以根据index将数据分开； 我们所说的flowcell，lane，tile都是什么意思？ flowcell 是指Illumina测序时，测序反应发生的位置，1个flowcell含有8条lane lane 每一个flowcell上都有8条泳道，用于测序反应，可以添加试剂，洗脱等等 tile 每一次测序荧光扫描的最小单位 Illumina测序结果质量表示方法采用的是Phred33还是Phred64？ 最新的测序质量结果一般都为Phred33，但是早期的测序数据可能出现Phred64。 ","date":"2020-02-16","objectID":"/bioinfo-q-a-3/:1:0","tags":["AQ100","illumina"],"title":"【bioinfo】-Q\u0026A-「3」","uri":"/bioinfo-q-a-3/"},{"categories":["bioinfo","ngs"],"content":"测序技术初探 现在我们实验室或者公司常用第1代测序与第2代测序，那么： 第1代测序 sanger 测序法的原理是什么？通量比较低的核心原因是什么？ sanger法测序及双脱氧链终止法，它采取DNA复制原理，通过在DNA复制过程中添加双脱氧三磷酸核苷酸（ddNTP）终止DNA链的延伸，在DNA链不同位置的延伸终止判断该位置的碱基类型。但是凝胶电泳的时间较长，导致sanger法测序通量低。 作为2006年正式发布的illumina测序技术，或者称为第2代测序技术的代表性技术，其最大的特点是什么？ 高通量，成本低，但测序长度较短。 Illumina测序技术的核心是什么？ 核心内容有两个，一个是桥式PCR，主要用于扩大信号；另一个是4色荧光可逆终止反应，使illumina测序可以实现边合成边测序的技术。 Illumina测序技术为什么不能像第1代测序技术一样测500bp以上？ 主要的原因有两个，一方面测序时，经过长时间的PCR，会有不同步的情况。比如一开始1个cluster中是100个完全一样的DNA链，但是经过1轮增加碱基，其中99个都加入了1个碱基，显示了红色，另外1个没有加入碱基，不显示颜色。这时候整体为红色，我们可以顺利得到结果。随后，在第2轮再加入碱基进行合成的时候，之前没有加入的加入了1个碱基显示红色，剩下的99个显示绿色，这个时候就会出现杂信号。当测序长度不断延长，这个杂信号会越来越多，最后很有可能出现50个红，50个绿色，这时信号不足以判断碱基类型；第二就是测序过程中合成酶的活性越来越不稳定，后面碱基添加出现问题。 ","date":"2020-02-16","objectID":"/bioinfo-q-a-2/:1:0","tags":["AQ100","illumina"],"title":"【bioinfo】-Q\u0026A-「2」","uri":"/bioinfo-q-a-2/"},{"categories":["bioinfo","ngs"],"content":"FASTA 与 FASTQ格式详解 写在最前面的话： 为什么第2篇要写fastq和fasta这两种储存sequence的格式呢？主要是因为这两种数据储存格式是我们后续分析主要处理的两种数据格式。无论是后面的双序列比对（pairwise alignment）还是进化树构建（phylogenetic tree）亦或是高通量分析的回贴（mapping）数据的原始输入都是这两种格式。所以，为了后面更复杂的一些算法软件，我们就得先打好基础喽，Let’s go ！ ","date":"2020-02-16","objectID":"/bioinfo-q-a-1/:0:0","tags":["AQ100","fasta","fastq","ngs"],"title":"【bioinfo】-Q\u0026A-「1」","uri":"/bioinfo-q-a-1/"},{"categories":["bioinfo","ngs"],"content":"FASTA 概述一下，fasta格式是一种非常简单的储存序列的格式，可以储存核酸序列（DNA/RNA）也可以储存蛋白质的氨基酸序列（Amino Acid sequence，简称AA序列），主要分成2个部分。 是以“\u003e”为开始的一行主要储存的是序列的描述信息； 剩下的是序列部分，中间，前后都可以有空格。序列部分按照官方文档的说明应该是小于120就行，一般70到80左右。 其实实际操作中，程序处理的时候都是自动去掉空格和换行符，把序列读成1行再处理，所以，我也干过把整条人类染色体都放到一行的233举动，这么算下来，一行可以有240*10E6这么长！~~~ 举一个栗子！ ","date":"2020-02-16","objectID":"/bioinfo-q-a-1/:1:0","tags":["AQ100","fasta","fastq","ngs"],"title":"【bioinfo】-Q\u0026A-「1」","uri":"/bioinfo-q-a-1/"},{"categories":["bioinfo","ngs"],"content":"AA序列 \u003esp|P69905|HBA_HUMAN Hemoglobin subunit alpha OS=Homo sapiens GN=HBA1 MVLSPADKTNVKAAWGKVGAHAGEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHG KKVADALTNAVAHVDDMPNALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTP AVHASLDKFLASVSTVLTSKYR 这个例子是从UniRef数据库中下载的人类血红蛋白α亚基的序列。我们先看第1行： \u003esp|P69905|HBA_HUMAN Hemoglobin subunit alpha OS=Homo sapiens GN=HBA1 这一行中， P69905是这个序列在UniRef中的编号 HBA_HUMAN是这个序列的简称，Hemoglobin subunit alpha是全称 OS=Homo sapiens是物种 GN=HBA1是指基因的名字为HBA1. 后面的内容就是这个HBA1基因对应的蛋白的序列。其实根据官方文档，氨基酸都是用单字母表示，对应表如下： A alanine P proline B aspartate/asparagine Q glutamine C cystine R arginine D aspartate S serine E glutamate T threonine F phenylalanine U selenocysteine G glycine V valine H histidine W tryptophan I isoleucine Y tyrosine K lysine Z glutamate/glutamine L leucine X any M methionine * translation stop N asparagine - gap of indeterminate length ","date":"2020-02-16","objectID":"/bioinfo-q-a-1/:1:1","tags":["AQ100","fasta","fastq","ngs"],"title":"【bioinfo】-Q\u0026A-「1」","uri":"/bioinfo-q-a-1/"},{"categories":["bioinfo","ngs"],"content":"核酸序列 为了方便大家理解，我们继续使用人类血红蛋白a亚基对应的mRNA序列，这个序列是从NCBI RefSeq数据库中下载的。 \u003egi|13650073|gb|AF349571.1| Homo sapiens hemoglobin alpha-1 globin chain (HBA1) mRNA, complete cds CCCACAGACTCAGAGAGAACCCACCATGGTGCTGTCTCCTGACGACAAGACCAACGTCAAGGCCGCCTGG GGTAAGGTCGGCGCGCACGCTGGCGAGTATGGTGCGGAGGCCCTGGAGAGGATGTTCCTGTCCTTCCCCA CCACCAAGACCTACTTCCCGCACTTCGACCTGAGCCACGGCTCTGCCCAGGTTAAGGGCCACGGCAAGAA GGTGGCCGACGCGCTGACCAACGCCGTGGCGCACGTGGACGACATGCCCAACGCGCTGTCCGCCCTGAGC GACCTGCACGCGCACAAGCTTCGGGTGGACCCGGTCAACTTCAAGCTCCTAAGCCACTGCCTGCTGGTGA CCCTGGCCGCCCACCTCCCCGCCGAGTTCACCCCTGCGGTGCACGCCTCCCTGGACAAGTTCCTGGCTTC TGTGAGCACCGTGCTGACCTCCAAATACCGTTAAGCTGGAGCCTCGGTGGCCATGCTTCTTGCCCCTTTG G 对于第1行， 所有来自于NCBI的序列都有一个gi号，就是数据库中的流水号，具有唯一性。 gb|AF349571.1是genebank编号的信息。 后面就是对序列的一个通俗的描述。这里使用的是mRNA，包含完整的CDS（Coding sequence）区域。 对于下面的序列，大家可能会有一个疑问，**为什么mRNA的序列还是用T来表示，而不是U？**其实这是为了保证数据的统一性，因为U只是在RNA中替换了原来的T，所以为了下游的方便分析处理，无论RNA序列还是DNA序列都是使用T而不是U。对于核苷酸序列的信息，我们一般使用下面的对应表。 A adenosine C cytidine G guanine T thymidine N A/G/C/T (any) U uridine K G/T (keto) S G/C (strong) Y T/C (pyrimidine) M A/C (amino) W A/T (weak) R G/A (purine) B G/T/C D G/A/T H A/C/T V G/C/A - gap of indeterminate length 基本上FASTA就介绍到这里，这个格式主要是把序列储蓄到数据库中的一种格式，但是它不适合储存我们刚刚测到的测序数据。一个很重要的原因就是，**它没有序列的质量信息。**那一般带有测序质量信息的FASTQ格式就成了储存测序数据的常用格式啦！ ","date":"2020-02-16","objectID":"/bioinfo-q-a-1/:1:2","tags":["AQ100","fasta","fastq","ngs"],"title":"【bioinfo】-Q\u0026A-「1」","uri":"/bioinfo-q-a-1/"},{"categories":["bioinfo","ngs"],"content":"FASTQ 下面是一个Illumina平台测序的真实数据，其中包含了1条reads的信息。 @ST-E00126:128:HJFLHCCXX:2:1101:7405:1133 TTGCAAAAAATTTCTCTCATTCTGTAGGTTGCCTGTTCACTCTGATGATAGTTTGTTTTGG + FFKKKFKKFKF\u003cKK\u003cF,AFKKKKK7FFK77\u003cFKK,\u003cF7K,,7AF\u003cFF7FKK7AA,7\u003cFA,, FASTQ格式储存的序列信息，每1条reads的信息，可以分成4行。 第1行主要储存序列测序时的坐标等信息 @ST-E00126:128:HJFLHCCXX:2:1101:7405:1133 @ 开始的标记符号 ST-E00126:128:HJFLHCCXX 测序仪唯一的设备名称 2 lane的编号 1101 tail的坐标 7405 在tail中的X坐标 1133 在tail中的Y坐标 第2行就是测序得到的序列信息，一般用ATCGN来表示，其中N表示荧光信号干扰无法判断到底是哪个碱基。 第3行以“+”开始，可以储存一些附加信息，一般是空的。 第4行储存的是质量信息，与第2行的碱基序列是一一对应的，其中的每一个符号对应的ASCII值成为phred值，可以简单理解为对应位置碱基的质量值，越大说明测序的质量越好。 不同的版本对应的不同。 ","date":"2020-02-16","objectID":"/bioinfo-q-a-1/:2:0","tags":["AQ100","fasta","fastq","ngs"],"title":"【bioinfo】-Q\u0026A-「1」","uri":"/bioinfo-q-a-1/"},{"categories":["bioinfo","ngs"],"content":"详细谈谈FASTQ质量值的计算方法 在测序仪进行测序的时候，会自动根据荧光信号的强弱给出一个参考的测序错误概率（error probility，P）根据定义来说，P值肯定是越小越好。我们怎么储存他们呢？直接储存成小数点？比如1%储存成0.01？这肯定是不高效的，因为1个碱基的信息，占用了至少4个字符。 所以科学家们的做法想了一个办法： 1.将P取log10之后再乘以-10，得到的结果为Q。 比如，P=1%，那么对应的Q=-10*log10（0.01）=20 2.把这个Q加上33或者64转成一个新的数值，称为Phred，最后把Phred对应的ASCII字符对应到这个碱基。 如Q=20，Phred = 20 + 33 = 53，对应的符号是”5” 这样就可以用1个符号与1个碱基一一对应，是不是很聪明？！ ","date":"2020-02-16","objectID":"/bioinfo-q-a-1/:2:1","tags":["AQ100","fasta","fastq","ngs"],"title":"【bioinfo】-Q\u0026A-「1」","uri":"/bioinfo-q-a-1/"},{"categories":["bioinfo","ngs"],"content":"各版本不同Phred对应的ASCII值 在计算Q值和加上33/64的时候，不同测序仪，产生的数据不同，大概如下所示： Solexa标准 Illumina标准 不同测序仪的不同Phred值对应的ASCII表 ","date":"2020-02-16","objectID":"/bioinfo-q-a-1/:2:2","tags":["AQ100","fasta","fastq","ngs"],"title":"【bioinfo】-Q\u0026A-「1」","uri":"/bioinfo-q-a-1/"},{"categories":null,"content":"From local optima to global optima ","date":"0001-01-01","objectID":"/greedy-algorithm/:1:0","tags":null,"title":"","uri":"/greedy-algorithm/"},{"categories":null,"content":"Distribution problem 455.Assign Cookies (Easy) int findContentChildren(vector\u003cint\u003e\u0026 children, vector\u003cint\u003e\u0026 cookies) { sort(children.begin(), children.end()); sort(cookies.begin(), cookies.end()); int child = 0, cookie = 0; while (child \u003c children.size() \u0026\u0026 cookie \u003c cookies.size()) { if (children[child] \u003c= cookies[cookie]) ++child; ++cookie; } return child; } You need to sort two vector from small to large. If the kid with lower desire meet the requirement, first assign to him. If can’t meet, just to see next requirement. ","date":"0001-01-01","objectID":"/greedy-algorithm/:1:1","tags":null,"title":"","uri":"/greedy-algorithm/"},{"categories":null,"content":"Interval problem 435.Non-overlapping Intervals (Medium) int eraseOverlapIntervals(vector\u003cvector\u003cint\u003e\u003e\u0026 intervals) { if (intervals.empty()) { return 0; } int n = intervals.size(); sort(intervals.begin(), intervals.end(), [](vector\u003cint\u003e a, vector\u003cint\u003e b) { return a[1] \u003c b[1]; }); int total = 0, prev = intervals[0][1]; for (int i = 1; i \u003c n; ++i) { if (intervals[i][0] \u003c prev) { ++total; } else { prev = intervals[i][1]; } } return total; } Sequence the vector by end number because we first try to meet the smallest spilt out. In that case, the end number smaller, the better. We set latter number as flag, if next vector begin number is over it, we don’t need to spilt out but to check the next vector begin number. ","date":"0001-01-01","objectID":"/greedy-algorithm/:1:2","tags":null,"title":"","uri":"/greedy-algorithm/"}]